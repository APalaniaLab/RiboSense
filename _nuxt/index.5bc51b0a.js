import{r as Ss,z as $6,c as N6,j as O6,o as _6,A as F6,l as fr,m as We,B as Et,C as Ni,t as _r,D as MS,v as Dr,E as PS,F as LS,G as US,H as zS,I as VS,J as D6,k as hr,x as B6,y as M6}from"./entry.0e067acc.js";import{_ as P6}from"./_plugin-vue_export-helper.c27b6911.js";function L6(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}function U6(){return new Worker(""+new URL("workerModel-72b5941c.js",import.meta.url).href)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6=1e-7,V6=1e-4;class Kk{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class YI{refCount(e){return xs("refCount")}incRef(e){return xs("incRef")}timerAvailable(){return!0}time(e){return xs("time")}read(e){return xs("read")}readSync(e){return xs("readSync")}readToGPU(e,t){return xs("readToGPU")}numDataIds(){return xs("numDataIds")}disposeData(e,t){return xs("disposeData")}write(e,t,r){return xs("write")}move(e,t,r,s,i){return xs("move")}createTensorFromGPUData(e,t,r){return xs("createTensorFromGPUData")}memory(){return xs("memory")}floatPrecision(){return xs("floatPrecision")}epsilon(){return this.floatPrecision()===32?z6:V6}dispose(){return xs("dispose")}}function xs(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,gl(n,e,t)}function Ic(n,e,t){return Math.max(n,Math.min(e,t))}function ZI(n){return n%2===0?n:n+1}function gl(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function G6(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function ce(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function JI(n,e,t=""){ce(vn(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Xk(n){ce(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Ye(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function vn(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Ol(n){return n%1===0}function Cv(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function kl(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function WS(n,e=s=>0,t,r){return new Promise((s,i)=>{let a=0;const o=()=>{if(n()){s();return}a++;const c=e(a);if(t!=null&&a>=t){i();return}r!=null?r(o,c):setTimeout(o,c)};o()})}function Yk(n,e){let t=1,r=-1;for(let i=0;i<n.length;++i)if(n[i]>=0)t*=n[i];else if(n[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(n[i]<0)throw Error(`Shapes can not be < 0. Found ${n[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function Yt(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),ce(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),ce(n.every(r=>Ol(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function _o(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||s?null:Yt(e,n).sort();let a=0;for(let o=0;o<n.length;++o){if(i!=null){if(i[a]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(i[a]==null||i[a]>o)&&n[o]===1&&(t.push(n[o]),r.push(o)),i[a]<=o&&a++}n[o]!==1&&(t.push(n[o]),r.push(o))}return{newShape:t,keptDims:r}}function Hr(n,e){return nr(n,e)}function nr(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function H6(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function q6(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function Zk(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function Rp(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function j6(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function Af(n){return typeof n=="string"||n instanceof String}function K6(n){return typeof n=="boolean"}function Rv(n){return typeof n=="number"}function Kl(n){return Array.isArray(n)?Kl(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Rv(n)?"float32":Af(n)?"string":K6(n)?"bool":"float32"}function kv(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Ev(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Rt(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function Jk(n,e,t,r=!1){const s=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let a=0;a<i;a++)s[a]=t[n+a]}else{const i=e[0],a=e.slice(1),o=a.reduce((c,l)=>c*l)*(r?2:1);for(let c=0;c<i;c++)s[c]=Jk(n+c*o,a,t,r)}return s}function Li(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,i)=>s*i)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return Jk(0,n,e,t)}function X6(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function QI(n,e){const t=qr(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function qr(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function Qk(n,e){const t=n.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Li(n,new Float32Array(t));if(e==="int32")return Li(n,new Int32Array(t));if(e==="bool")return Li(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Ka(n){n.forEach(e=>{ce(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function ga(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function Xl(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function eb(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GS="tfjsflags";class Y6{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Z6,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(Ge().getBool("IS_TEST")||Ge().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];Ge().getBool("IS_TEST")||Ge().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(eb(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);GS in e&&e[GS].split(",").forEach(r=>{const[s,i]=r.split(":");this.urlFlags[s]=Q6(s,i)})}}function Z6(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(J6(e,r[0],r[1]),r.join("="))),e}function J6(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function Q6(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function Ge(){return eE}let eE=null;function eU(n){eE=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let R1;function tE(){if(R1==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");R1=n}return R1}function tU(){const n=tE();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function tb(n,e){const t=tU();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const gg="Abs",$f="Acos",Nf="Acosh",Yl="Add",nb="AddN",rb="All",sb="Any",mg="ArgMax",vg="ArgMin",Of="Asin",_f="Asinh",Ff="Atan",Df="Atanh",Bf="Atan2",Ig="AvgPool",ib="AvgPoolGrad",bg="AvgPool3D",ab="AvgPool3DGrad",yg="BatchMatMul",xg="BatchToSpaceND",ob="Bincount",cb="BitwiseAnd",nU="BroadcastTo",nE="BroadcastArgs",Mf="Cast",Pf="Ceil",Lf="ClipByValue",lb="Complex",wg="ComplexAbs",Sg="Concat",Cg="Conv2D",ub="Conv2DBackpropFilter",Rg="Conv2DBackpropInput",kg="Conv3D",fb="Conv3DBackpropFilterV2",hb="Conv3DBackpropInputV2",Uf="Cos",zf="Cosh",db="Cumprod",Eg="Cumsum",pb="CropAndResize",gb="DenseBincount",mb="DepthToSpace",Tg="DepthwiseConv2dNative",vb="DepthwiseConv2dNativeBackpropFilter",Ib="DepthwiseConv2dNativeBackpropInput",rE="Diag",Ag="Dilation2D",Tv="Dilation2DBackpropInput",Av="Dilation2DBackpropFilter",rU="Draw",Vf="RealDiv",sE="Einsum",Wf="Elu",bb="EluGrad",Gf="Erf",$g="Equal",Hf="Exp",Ng="ExpandDims",qf="Expm1",yb="FFT",xb="Fill",wb="FlipLeftRight",jf="Floor",Kf="FloorDiv",Og="FusedBatchNorm",_g="GatherV2",iE="GatherNd",Fg="Greater",Xf="GreaterEqual",Yf="Identity",Sb="IFFT",Cb="Imag",Zf="IsFinite",Jf="IsInf",Qf="IsNan",Dg="LeakyRelu",Bg="Less",Mg="LessEqual",aE="LinSpace",eh="Log",th="Log1p",Pg="LogicalAnd",Lg="LogicalNot",Ug="LogicalOr",sU="LogSoftmax",zg="LRN",Rb="LRNGrad",Vg="Max",nh="Maximum",Wg="MaxPool",kb="MaxPoolGrad",Gg="MaxPool3D",Eb="MaxPool3DGrad",oE="MaxPoolWithArgmax",Hg="Mean",qg="Min",rh="Minimum",jg="MirrorPad",sh="Mod",cE="Multinomial",ih="Multiply",Kg="Neg",Xg="NotEqual",Tb="NonMaxSuppressionV3",Ab="NonMaxSuppressionV4",$b="NonMaxSuppressionV5",Yg="OnesLike",Zg="OneHot",Jg="Pack",Qg="PadV2",ah="Pow",em="Prelu",tm="Prod",lE="RaggedGather",uE="RaggedRange",fE="RaggedTensorToTensor",Nb="Range",Ob="Real",oh="Reciprocal",ch="Relu",nm="Reshape",rm="ResizeNearestNeighbor",_b="ResizeNearestNeighborGrad",sm="ResizeBilinear",Fb="ResizeBilinearGrad",lh="Relu6",im="Reverse",uh="Round",fh="Rsqrt",hE="ScatterNd",dE="TensorScatterUpdate",pE="SearchSorted",am="Select",hh="Selu",om="Slice",dh="Sin",ph="Sinh",gh="Sign",mh="Sigmoid",vh="Softplus",Ih="Sqrt",cm="Sum",lm="SpaceToBatchND",um="SplitV",fm="Softmax",gE="SparseFillEmptyRows",mE="SparseReshape",vE="SparseSegmentMean",IE="SparseSegmentSum",bE="SparseToDense",bh="SquaredDifference",Db="Square",Bb="StaticRegexReplace",Mb="StridedSlice",yE="StringNGrams",xE="StringSplit",wE="StringToHashBucketFast",yh="Sub",xh="Tan",wh="Tanh",Sh="Tile",Pb="TopK",Lb="Transform",El="Transpose",Ub="Unique",hm="Unpack",dm="UnsortedSegmentSum",pm="ZerosLike",Ch="Step",iU="FromPixels",zb="RotateWithOffset",kp="_FusedMatMul",Ep="FusedConv2D",SE="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(...n){Ge().getBool("IS_TEST")||Ge().getBool("PROD")||console.warn(...n)}function aU(...n){Ge().getBool("IS_TEST")||Ge().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tp=tb("kernelRegistry",()=>new Map),$v=tb("gradRegistry",()=>new Map);function HS(n,e){const t=RE(n,e);return Tp.get(t)}function qS(n){return $v.get(n)}function jS(n){const e=Tp.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[i,a]=s,[o]=i.split("_");o===n&&t.push(a)}return t}function CE(n){const{kernelName:e,backendName:t}=n,r=RE(e,t);Tp.has(r)&&Ls(`The kernel '${e}' for backend '${t}' is already registered`),Tp.set(r,n)}function oU(n){const{kernelName:e}=n;$v.has(e)&&Ge().getBool("DEBUG")&&Ls(`Overriding the gradient for '${e}'`),$v.set(e,n)}function RE(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var Hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cU(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function EE(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var i=Function.bind.apply(e,s);return new i}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var TE=Bn,ui=null;try{ui=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Bn(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Bn.prototype.__isLong__;Object.defineProperty(Bn.prototype,"__isLong__",{value:!0});function Ns(n){return(n&&n.__isLong__)===!0}Bn.isLong=Ns;var KS={},XS={};function Oc(n,e){var t,r,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(r=XS[n],r)?r:(t=Mn(n,(n|0)<0?-1:0,!0),s&&(XS[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(r=KS[n],r)?r:(t=Mn(n,n<0?-1:0,!1),s&&(KS[n]=t),t))}Bn.fromInt=Oc;function fi(n,e){if(isNaN(n))return e?fc:hi;if(e){if(n<0)return fc;if(n>=AE)return OE}else{if(n<=-ZS)return ks;if(n+1>=ZS)return NE}return n<0?fi(-n,e).neg():Mn(n%_l|0,n/_l|0,e)}Bn.fromNumber=fi;function Mn(n,e,t){return new Bn(n,e,t)}Bn.fromBits=Mn;var Ap=Math.pow;function Vb(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return hi;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Vb(n.substring(1),e,t).neg();for(var s=fi(Ap(t,8)),i=hi,a=0;a<n.length;a+=8){var o=Math.min(8,n.length-a),c=parseInt(n.substring(a,a+o),t);if(o<8){var l=fi(Ap(t,o));i=i.mul(l).add(fi(c))}else i=i.mul(s),i=i.add(fi(c))}return i.unsigned=e,i}Bn.fromString=Vb;function Hi(n,e){return typeof n=="number"?fi(n,e):typeof n=="string"?Vb(n,e):Mn(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Bn.fromValue=Hi;var YS=65536,lU=1<<24,_l=YS*YS,AE=_l*_l,ZS=AE/2,JS=Oc(lU),hi=Oc(0);Bn.ZERO=hi;var fc=Oc(0,!0);Bn.UZERO=fc;var Cl=Oc(1);Bn.ONE=Cl;var $E=Oc(1,!0);Bn.UONE=$E;var Nv=Oc(-1);Bn.NEG_ONE=Nv;var NE=Mn(-1,2147483647,!1);Bn.MAX_VALUE=NE;var OE=Mn(-1,-1,!0);Bn.MAX_UNSIGNED_VALUE=OE;var ks=Mn(0,-2147483648,!1);Bn.MIN_VALUE=ks;var ft=Bn.prototype;ft.toInt=function(){return this.unsigned?this.low>>>0:this.low};ft.toNumber=function(){return this.unsigned?(this.high>>>0)*_l+(this.low>>>0):this.high*_l+(this.low>>>0)};ft.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ks)){var t=fi(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=fi(Ap(e,6),this.unsigned),a=this,o="";;){var c=a.div(i),l=a.sub(c.mul(i)).toInt()>>>0,u=l.toString(e);if(a=c,a.isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}};ft.getHighBits=function(){return this.high};ft.getHighBitsUnsigned=function(){return this.high>>>0};ft.getLowBits=function(){return this.low};ft.getLowBitsUnsigned=function(){return this.low>>>0};ft.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ks)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};ft.isZero=function(){return this.high===0&&this.low===0};ft.eqz=ft.isZero;ft.isNegative=function(){return!this.unsigned&&this.high<0};ft.isPositive=function(){return this.unsigned||this.high>=0};ft.isOdd=function(){return(this.low&1)===1};ft.isEven=function(){return(this.low&1)===0};ft.equals=function(e){return Ns(e)||(e=Hi(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ft.eq=ft.equals;ft.notEquals=function(e){return!this.eq(e)};ft.neq=ft.notEquals;ft.ne=ft.notEquals;ft.lessThan=function(e){return this.comp(e)<0};ft.lt=ft.lessThan;ft.lessThanOrEqual=function(e){return this.comp(e)<=0};ft.lte=ft.lessThanOrEqual;ft.le=ft.lessThanOrEqual;ft.greaterThan=function(e){return this.comp(e)>0};ft.gt=ft.greaterThan;ft.greaterThanOrEqual=function(e){return this.comp(e)>=0};ft.gte=ft.greaterThanOrEqual;ft.ge=ft.greaterThanOrEqual;ft.compare=function(e){if(Ns(e)||(e=Hi(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ft.comp=ft.compare;ft.negate=function(){return!this.unsigned&&this.eq(ks)?ks:this.not().add(Cl)};ft.neg=ft.negate;ft.add=function(e){Ns(e)||(e=Hi(e));var t=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,a=e.high>>>16,o=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,f=0,d=0,p=0;return p+=i+l,d+=p>>>16,p&=65535,d+=s+c,f+=d>>>16,d&=65535,f+=r+o,u+=f>>>16,f&=65535,u+=t+a,u&=65535,Mn(d<<16|p,u<<16|f,this.unsigned)};ft.subtract=function(e){return Ns(e)||(e=Hi(e)),this.add(e.neg())};ft.sub=ft.subtract;ft.multiply=function(e){if(this.isZero())return hi;if(Ns(e)||(e=Hi(e)),ui){var t=ui.mul(this.low,this.high,e.low,e.high);return Mn(t,ui.get_high(),this.unsigned)}if(e.isZero())return hi;if(this.eq(ks))return e.isOdd()?ks:hi;if(e.eq(ks))return this.isOdd()?ks:hi;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(JS)&&e.lt(JS))return fi(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,a=this.low&65535,o=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,f=0,d=0,p=0,m=0;return m+=a*u,p+=m>>>16,m&=65535,p+=i*u,d+=p>>>16,p&=65535,p+=a*l,d+=p>>>16,p&=65535,d+=s*u,f+=d>>>16,d&=65535,d+=i*l,f+=d>>>16,d&=65535,d+=a*c,f+=d>>>16,d&=65535,f+=r*u+s*l+i*c+a*o,f&=65535,Mn(p<<16|m,f<<16|d,this.unsigned)};ft.mul=ft.multiply;ft.divide=function(e){if(Ns(e)||(e=Hi(e)),e.isZero())throw Error("division by zero");if(ui){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?ui.div_u:ui.div_s)(this.low,this.high,e.low,e.high);return Mn(t,ui.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?fc:hi;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return fc;if(e.gt(this.shru(1)))return $E;i=fc}else{if(this.eq(ks)){if(e.eq(Cl)||e.eq(Nv))return ks;if(e.eq(ks))return Cl;var a=this.shr(1);return r=a.div(e).shl(1),r.eq(hi)?e.isNegative()?Cl:Nv:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(ks))return this.unsigned?fc:hi;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=hi}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),c=o<=48?1:Ap(2,o-48),l=fi(r),u=l.mul(e);u.isNegative()||u.gt(s);)r-=c,l=fi(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=Cl),i=i.add(l),s=s.sub(u)}return i};ft.div=ft.divide;ft.modulo=function(e){if(Ns(e)||(e=Hi(e)),ui){var t=(this.unsigned?ui.rem_u:ui.rem_s)(this.low,this.high,e.low,e.high);return Mn(t,ui.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ft.mod=ft.modulo;ft.rem=ft.modulo;ft.not=function(){return Mn(~this.low,~this.high,this.unsigned)};ft.and=function(e){return Ns(e)||(e=Hi(e)),Mn(this.low&e.low,this.high&e.high,this.unsigned)};ft.or=function(e){return Ns(e)||(e=Hi(e)),Mn(this.low|e.low,this.high|e.high,this.unsigned)};ft.xor=function(e){return Ns(e)||(e=Hi(e)),Mn(this.low^e.low,this.high^e.high,this.unsigned)};ft.shiftLeft=function(e){return Ns(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Mn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Mn(0,this.low<<e-32,this.unsigned)};ft.shl=ft.shiftLeft;ft.shiftRight=function(e){return Ns(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Mn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Mn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ft.shr=ft.shiftRight;ft.shiftRightUnsigned=function(e){if(Ns(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return Mn(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Mn(t,0,this.unsigned):Mn(t>>>e-32,0,this.unsigned)};ft.shru=ft.shiftRightUnsigned;ft.shr_u=ft.shiftRightUnsigned;ft.toSigned=function(){return this.unsigned?Mn(this.low,this.high,!1):this};ft.toUnsigned=function(){return this.unsigned?this:Mn(this.low,this.high,!0)};ft.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ft.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ft.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Bn.fromBytes=function(e,t,r){return r?Bn.fromBytesLE(e,t):Bn.fromBytesBE(e,t)};Bn.fromBytesLE=function(e,t){return new Bn(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Bn.fromBytesBE=function(e,t){return new Bn(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const _E=cU(TE),uU=L6({__proto__:null,default:_E},[TE]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cc=_E||uU;function gm(n){return cc.fromString(n,!0,16)}const FE=gm("c3a5c85c97cb3127"),ic=gm("b492b66fbe98f273"),Qr=gm("9ae16a3b2f90404f");function Ov(n){return n.xor(n.shru(47))}function DE(n,e,t){const r=n.slice(e,e+t);return cc.fromBytes(Array.from(r),!0,!0)}function An(n,e){return DE(n,e,8)}function QS(n,e){return DE(n,e,4)}function Er(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function bo(n,e,t=gm("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function fU(n,e,t,r,s,i){s=s.add(n),i=Er(i.add(s).add(r),21);const a=s;return s=s.add(e),s=s.add(t),i=i.add(Er(s,44)),[s.add(r),i.add(a)]}function jd(n,e,t,r){return fU(An(n,e),An(n,e+8),An(n,e+16),An(n,e+24),t,r)}function hU(n,e=n.length){if(e>=8){const t=Qr.add(e*2),r=An(n,0).add(Qr),s=An(n,e-8),i=Er(s,37).mul(t).add(r),a=Er(r,25).add(s).mul(t);return bo(i,a,t)}if(e>=4){const t=Qr.add(e*2),r=QS(n,0);return bo(r.shl(3).add(e),QS(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],i=t+(r<<8),a=e+(s<<2);return Ov(Qr.mul(i).xor(FE.mul(a))).mul(Qr)}return Qr}function dU(n,e=n.length){const t=Qr.add(e*2),r=An(n,0).mul(ic),s=An(n,8),i=An(n,e-8).mul(t),a=An(n,e-16).mul(Qr);return bo(Er(r.add(s),43).add(Er(i,30)).add(a),r.add(Er(s.add(Qr),18)).add(i),t)}function pU(n,e=n.length){const t=Qr.add(e*2),r=An(n,0).mul(Qr),s=An(n,8),i=An(n,e-8).mul(t),a=An(n,e-16).mul(Qr),o=Er(r.add(s),43).add(Er(i,30)).add(a),c=bo(o,r.add(Er(s.add(Qr),18)).add(i),t),l=An(n,16).mul(t),u=An(n,24),f=o.add(An(n,e-32)).mul(t),d=c.add(An(n,e-24)).mul(t);return bo(Er(l.add(u),43).add(Er(f,30)).add(d),l.add(Er(u.add(r),18)).add(f),t)}function gU(n,e=n.length){const t=cc.fromNumber(81,!0);if(e<=32)return e<=16?hU(n,e):dU(n,e);if(e<=64)return pU(n,e);let r=t,s=t.mul(ic).add(113),i=Ov(s.mul(Qr).add(113)).mul(Qr),a=[cc.UZERO,cc.UZERO],o=[cc.UZERO,cc.UZERO];r=r.mul(Qr).add(An(n,0));let c=0;const l=(e-1>>6)*64,u=l+(e-1&63)-63;do r=Er(r.add(s).add(a[0]).add(An(n,c+8)),37).mul(ic),s=Er(s.add(a[1]).add(An(n,c+48)),42).mul(ic),r=r.xor(o[1]),s=s.add(a[0]).add(An(n,c+40)),i=Er(i.add(o[0]),33).mul(ic),a=jd(n,c,a[1].mul(ic),r.add(o[0])),o=jd(n,c+32,i.add(o[1]),s.add(An(n,c+16))),[i,r]=[r,i],c+=64;while(c!==l);const f=ic.add(i.and(255).shl(1));return c=u,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=Er(r.add(s).add(a[0]).add(An(n,c+8)),37).mul(f),s=Er(s.add(a[1]).add(An(n,c+48)),42).mul(f),r=r.xor(o[1].mul(9)),s=s.add(a[0].mul(9).add(An(n,c+40))),i=Er(i.add(o[0]),33).mul(f),a=jd(n,c,a[1].mul(f),r.add(o[0])),o=jd(n,c+32,i.add(o[1]),s.add(An(n,c+16))),[i,r]=[r,i],bo(bo(a[0],o[0],f).add(Ov(s).mul(FE)).add(i),bo(a[1],o[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fo(n,e){return e==="string"?yo(n):_c([n],e)}function mU(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function _c(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=bc(n)),Ge().getBool("DEBUG")&&H6(n,e),mU(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function ls(){return Ge().platform.now()}function yo(n,e="utf-8"){return e=e||"utf-8",Ge().platform.encode(n,e)}function Ro(n,e="utf-8"){return e=e||"utf-8",Ge().platform.decode(n,e)}function vi(n){return Ge().platform.isTypedArray!=null?Ge().platform.isTypedArray(n):kE(n)}function bc(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||eb(n)||n==null||vi(n)&&t)e.push(n);else if(Array.isArray(n)||vi(n))for(let r=0;r<n.length;++r)bc(n[r],e,t);else{let r=-1;for(const s of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)bc(n[s],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vU{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new bU)}profileKernel(e,t,r){let s;const i=()=>{s=r()};let a;const o=ls();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(const l of s)l.dataSync();a=Promise.resolve({kernelMs:ls()-o})}if(Ge().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<s.length;l++){const u=s[l];u.data().then(f=>{IU(f,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:a.then(l=>l.kernelMs),extraInfo:a.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:i,extraInfo:a}=e;r.forEach(o=>{Promise.all([o.data(),s,a]).then(c=>{this.logger.logKernelProfile(t,o,c[0],c[1],i,c[2])})})}}function IU(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class bU{logKernelProfile(e,t,r,s,i,a){const o=typeof s=="number"?kl(`${s}ms`,9):s.error,c=kl(e,25),l=t.rank,u=t.size,f=kl(t.shape.toString(),14);let d="";for(const p in i){const m=i[p];if(m!=null){const I=m.shape||t.shape,v=I.length;d+=`${p}: ${v}D ${v>0?I:""} `}}console.log(`%c${c}	%c${o}	%c${l}D ${f}	%c${u}	%c${d}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(n,e,t){const r={},s={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<n.length;c++){const l=n[c],u=l.inputs;for(const f in u){const d=u[f];let p=!1;for(let m=0;m<e.length;m++)if(r[d.id]){l.outputs.forEach(I=>r[I.id]=!0),p=!0,s[l.id]=!0;break}if(p)break}}const i={};i[t.id]=!0;const a={};for(let c=n.length-1;c>=0;c--){const l=n[c],u=l.inputs;for(let f=0;f<l.outputs.length;f++)if(i[l.outputs[f].id]){for(const d in u)i[u[d].id]=!0,a[l.id]=!0;break}}const o=[];for(let c=0;c<n.length;c++){const l=n[c];if(s[l.id]&&a[l.id]){const u={};for(const d in l.inputs){const p=l.inputs[d];r[p.id]&&(u[d]=p)}const f=Object.assign({},l);f.inputs=u,f.outputs=l.outputs,o.push(f)}}return o}function xU(n,e,t,r){for(let s=e.length-1;s>=0;s--){const i=e[s],a=[];if(i.outputs.forEach(c=>{const l=n[c.id];l!=null?a.push(l):a.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const o=i.gradient(a);for(const c in i.inputs){if(!(c in o))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(o)}.`);const l=t(()=>o[c]());if(l.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${l.dtype}'`);const u=i.inputs[c];if(!vn(l.shape,u.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${c}' has shape '${l.shape}', which does not match the shape of the input '${u.shape}'`);if(n[u.id]==null)n[u.id]=l;else{const f=n[u.id];n[u.id]=r(f,l),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eC=20,qu=3,k1=7;function wU(n,e,t,r){const s=Rt(e),i=SU(n,e,t,s),a=e.length,o=mp(n,e,t,s,i),c=["Tensor"];return r&&(c.push(`  dtype: ${t}`),c.push(`  rank: ${a}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(o.map(l=>"    "+l).join(`
`)),c.join(`
`)}function SU(n,e,t,r){const s=Ye(e),i=r[r.length-1],a=new Array(i).fill(0),o=e.length,c=t==="complex64"?Qu(n):n;if(o>1)for(let l=0;l<s/i;l++){const u=l*i;for(let f=0;f<i;f++)a[f]=Math.max(a[f],Ju(c[u+f],0,t).length)}return a}function Ju(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(k1))} + ${parseFloat(n[1].toFixed(k1))}j`:Af(n)?r=`'${n}'`:t==="bool"?r=BE(n):r=parseFloat(n.toFixed(k1)).toString(),kl(r,e)}function BE(n){return n===0?"false":"true"}function mp(n,e,t,r,s,i=!0){const a=t==="complex64"?2:1,o=e[0],c=e.length;if(c===0){if(t==="complex64"){const I=Qu(n);return[Ju(I[0],0,t)]}return t==="bool"?[BE(n[0])]:[n[0].toString()]}if(c===1){if(o>eC){const v=qu*a;let b=Array.from(n.slice(0,v)),y=Array.from(n.slice((o-qu)*a,o*a));return t==="complex64"&&(b=Qu(b),y=Qu(y)),["["+b.map((S,w)=>Ju(S,s[w],t)).join(", ")+", ..., "+y.map((S,w)=>Ju(S,s[o-qu+w],t)).join(", ")+"]"]}return["["+(t==="complex64"?Qu(n):Array.from(n)).map((v,b)=>Ju(v,s[b],t)).join(", ")+"]"]}const l=e.slice(1),u=r.slice(1),f=r[0]*a,d=[];if(o>eC){for(let I=0;I<qu;I++){const v=I*f,b=v+f;d.push(...mp(n.slice(v,b),l,t,u,s,!1))}d.push("...");for(let I=o-qu;I<o;I++){const v=I*f,b=v+f;d.push(...mp(n.slice(v,b),l,t,u,s,I===o-1))}}else for(let I=0;I<o;I++){const v=I*f,b=v+f;d.push(...mp(n.slice(v,b),l,t,u,s,I===o-1))}const p=c===2?",":"";d[0]="["+(o>0?d[0]+p:"");for(let I=1;I<d.length-1;I++)d[I]=" "+d[I]+p;let m=`,
`;for(let I=2;I<c;I++)m+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":m),d}function Qu(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pr{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=Ye(e),r!=null){const s=r.length;ce(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||nr(t,this.size),this.strides=Rt(e)}set(e,...t){t.length===0&&(t=[0]),ce(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Bi().makeTensor(this.values,this.shape,this.dtype)}}let Bi=null,ml=null;function CU(n){Bi=n}function RU(n){ml=n}class dr{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ye(e),this.strides=Rt(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ml.buffer(this.shape,this.dtype,e)}bufferSync(){return ml.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Li(this.shape,e,this.dtype==="complex64")}arraySync(){return Li(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Bi().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>Ro(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Bi().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Bi().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Ro(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Bi().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Bi().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ml.print(this,e)}clone(){return this.throwIfDisposed(),ml.clone(this)}toString(e=!1){const t=this.dataSync();return wU(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ml.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),Bi().makeVariable(this,e,t,r)}}Object.defineProperty(dr,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Ke(){return tb("Tensor",()=>dr)}Ke();class $p extends dr{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!vn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Bi().disposeTensor(this),this.dataId=e.dataId,Bi().incRef(this,null)}dispose(){Bi().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty($p,Symbol.hasInstance,{value:n=>n instanceof dr&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tC;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(tC||(tC={}));var _v;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(_v||(_v={}));var Fv;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(Fv||(Fv={}));var Dv;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(Dv||(Dv={}));var Bv;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(Bv||(Bv={}));const kU={float32:Dv,int32:_v,bool:Fv,complex64:Bv};function Ts(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return kU[n][e]}function Wb(n){return Ts(n,"int32")}function ME(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function PE(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sr(n,e){if(n.dtype===e.dtype)return[n,e];const t=Ts(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function LE(n){const e=[];return UE(n,e,new Set),e}function UE(n,e,t){if(n==null)return;if(n instanceof dr){e.push(n);return}if(!EU(n))return;const r=n;for(const s in r){const i=r[s];t.has(i)||(t.add(i),UE(i,e,t))}}function EU(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(n){return n.kernelName!=null}class nC{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Fl{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new nC}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Ls(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new vU(this.backendInstance),!0}setupRegisteredKernels(){jS(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){jS(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof YI)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,i=r.then(a=>s<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Ls(`Initialization of backend ${e} failed`),Ls(a.stack||a.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Ls(`Initialization of backend ${e} failed`),Ls(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:i}=this.initializeBackend(r);if(i||s)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,i=this.readSync(t),a=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,i,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return Fl.nextTensorId++}nextVariableId(){return Fl.nextVariableId++}clone(e){const t=Fe.runKernel(Yf,{x:e}),r={x:e},s=a=>({x:()=>{const o="float32",c={x:a},l={dtype:o};return Fe.runKernel(Mf,c,l)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,i,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(HS(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let i=0;r.forEach(c=>{i+=c.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=s-t-i-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let c;const l=E1(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(E1(e)){const{kernelName:m,inputs:I,attrs:v}=e;this.backendName==null&&this.backend;const b=HS(m,this.backendName);ce(b!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),o=()=>{const y=this.backend.numDataIds();c=b.kernelFunc({inputs:I,attrs:v,backend:this.backend});const S=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,y,S);const w=S.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(s){const C=this.getTensorsForGradient(m,I,w);r=this.saveTensorsForBackwardMode(C)}return w}}else{const{forwardFunc:m}=e,I=v=>{s&&(r=v.map(b=>this.keep(this.clone(b))))};o=()=>{const v=this.backend.numDataIds();c=this.tidy(()=>m(this.backend,I));const b=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,v,b),b}}const{inputs:u,attrs:f}=e,d=E1(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(p=this.profiler.profileKernel(l,u,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),t=p.outputs)}),s&&this.addTapeNode(l,u,t,d,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(m=>u[m]!=null?u[m].shape:null),outputShapes:t.map(m=>m.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=qS(e);if(s!=null){const i=s.inputsToSave||[],a=s.outputsToSave||[];let o;s.saveAllInputs?(ce(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(l=>t[l])):o=i.map(l=>t[l]);const c=r.filter((l,u)=>a[u]);return o.concat(c)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let i=e;r==="string"&&Af(e[0])&&(i=e.map(c=>yo(c)));const a=s.write(i,t,r),o=new dr(t,r,a,this.nextTensorId());if(this.trackTensor(o,s),r==="string"){const c=this.state.tensorInfo.get(a),l=j6(i);this.state.numBytes+=l-c.bytes,c.bytes=l}return o}makeTensorFromDataId(e,t,r,s){r=r||"float32";const i={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(i,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:i}=e,a=new dr(s,i,r,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const i=new $p(e,t,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Rp(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof $p||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Rp(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,i,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:i},c=qS(e);c!=null&&(s=c.gradFunc),s!=null&&(o.gradient=l=>(l=l.map((u,f)=>{if(u==null){const d=r[f],p=qr(d.size,d.dtype);return this.makeTensor(p,d.shape,d.dtype)}return u}),s(l.length>1?l:l[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=LE(e),r=new Set(t.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const a=this.state.activeScope.track[i];!a.kept&&!r.has(a.id)&&a.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(i=>{!i.kept&&i.scopeId===s.id&&this.track(i)})}gradients(e,t,r,s=!1){if(ce(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));ce(i instanceof dr,()=>"The result y returned by f() must be a tensor.");const a=yU(this.state.activeTape,t,i);if(!s&&a.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[i.id]=r??TU(i.shape),xU(o,a,l=>this.tidy(l),AU);const c=t.map(l=>o[l.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(l=>{for(const u of l.saved)u.dispose()}),this.state.activeTape=null),{value:i,grads:c}})}customGrad(e){return ce(kv(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{ce(t.every(o=>o instanceof dr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((o,c)=>{s[c]=o});const i=(o,c)=>(r=e(...t,c),ce(r.value instanceof dr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ce(kv(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,c)=>{const l=r.gradFunc(o,c),u=Array.isArray(l)?l:[l];ce(u.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ce(u.every(d=>d instanceof dr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return u.forEach((d,p)=>{f[p]=()=>d}),f};return this.runKernelFunc({forwardFunc:i,backwardsFunc:a,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=ls(),r=await this.backend.time(e);return r.wallMs=ls()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new nC;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Fl.nextTensorId=0;Fl.nextVariableId=0;function TU(n){const e=QI(Ye(n),"float32");return Fe.makeTensor(e,n,"float32")}function zE(){const n=tE();if(n._tfengine==null){const e=new Y6(n);n._tfengine=new Fl(e)}return eU(n._tfengine.ENV),CU(()=>n._tfengine),n._tfengine}const Fe=zE();function AU(n,e){const t={a:n,b:e};return Fe.runKernel(Yl,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(){return typeof navigator<"u"&&navigator!=null}function VE(n){if(n||$U()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function WE(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=Ge();ds.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ds.registerFlag("IS_BROWSER",()=>WE());ds.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ds.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ds.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ds.registerFlag("PROD",()=>!1);ds.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ds.getBool("DEBUG"));ds.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ds.registerFlag("IS_TEST",()=>!1);ds.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ds.getBool("DEBUG"));ds.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ds.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ds.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mm(n,e){let t=n;if(vi(n))return e==="string"?[]:[n.length];if(ME(n)){const s=n.channels||"RGBA";return[n.height,n.width*s.length]}else if(PE(n))return[n.buffer.size/(e==null?4:Rp(e))];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||vi(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&Ge().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&GE(n,r,[]),r}function GE(n,e,t){if(t=t||[],!Array.isArray(n)&&!vi(n)){ce(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}ce(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),ce(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)GE(n[s],r,t.concat(s))}function rC(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function we(n,e,t,r="numeric"){if(n instanceof dr)return rC(r,n.dtype,e,t),n;let s=Kl(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),rC(r,s,e,t),n==null||!vi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const c=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${c}'`)}const i=mm(n,s);!vi(n)&&!Array.isArray(n)&&(n=[n]);const o=s!=="string"?_c(n,s):bc(n,[],!0);return Fe.makeTensor(o,i,s)}function HE(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((i,a)=>we(i,`${e}[${a}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU="__op";function Pe(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+NU;const s=(...i)=>{Fe.startScope(t);try{const a=r(...i);return eb(a)&&console.error("Cannot return a Promise inside of tidy."),Fe.endScope(a),a}catch(a){throw Fe.endScope(null),a}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(n,e){const t=we(n,"real","complex"),r=we(e,"imag","complex");JI(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return Fe.runKernel(lb,s)}const Dl=Pe({complex_:OU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vm(n,e,t,r){if(r==null)r=Kl(n);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(PE(n)||ME(n)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Fe.backend.createTensorFromGPUData(n,e||t,r)}if(!vi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ka(e);const s=Ye(e),i=Ye(t);ce(s===i,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${i}`);for(let a=0;a<t.length;++a){const o=t[a],c=a===t.length-1?o!==Ye(e.slice(a)):!0;ce(t[a]===e[a]||!c,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!vi(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?_c(n,r):bc(n,[],!0),Fe.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qE(n,e,t){const r=mm(n,t);return vm(n,e,r,t)}class Zl{static join(e){return new Zl(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>vi(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const i=t+s.byteLength;this.shards.push({buffer:s,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=t-e,i=new ArrayBuffer(s),a=new Uint8Array(i);let o=0;for(let c=r;c<this.shards.length;c++){const l=this.shards[c],f=e+o-l.start,d=o,m=Math.min(t,l.end)-l.start,I=new Uint8Array(l.buffer,f,m-f);if(a.set(I,d),o+=I.length,t<l.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(s){return e<s.start?-1:e>=s.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=_U(this.shards,t);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function _U(n,e){let t=0,r=n.length;for(;t<=r;){const s=Math.floor((r-t)/2)+t,i=e(n[s]);if(i===0)return s;i<0?r=s:t=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sC=4;async function iC(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(a=>a.name):Object.keys(n);for(let a=0;a<s.length;++a){const o=s[a],c=Array.isArray(n)?n[a].tensor:n[o];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${c.dtype}`);const l={name:o,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const u=new Promise(async f=>{const d=await c.bytes(),p=d.reduce((v,b)=>v+b.length,0)+sC*d.length,m=new Uint8Array(p);let I=0;for(let v=0;v<d.length;v++){const b=d[v],y=new Uint8Array(new Uint32Array([b.length]).buffer);m.set(y,I),I+=sC,m.set(b,I),I+=b.length}f(m)});r.push(u)}else r.push(c.data());e!=null&&(l.group=e),t.push(l)}const i=await Promise.all(r);return{data:FU(i),specs:t}}function FU(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(i=>{if(e+=i.byteLength,t.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(i=>{r.set(new Uint8Array(i.buffer),s),s+=i.byteLength}),r.buffer}const Gb=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function aC(n){return Gb?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function DU(n){if(Gb)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function BU(n){if(Gb){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function MU(n){return Zl.join(n)}function jE(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:aC(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:aC(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Zl(n.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Zr.instance==null&&(Zr.instance=new Zr),Zr.instance}static registerSaveRouter(e){Zr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Zr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Zr.getHandlers(e,"save")}static getLoadHandlers(e,t){return Zr.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?Zr.getInstance().loadRouters:Zr.getInstance().saveRouters).forEach(a=>{const o=a(e,r);o!==null&&s.push(o)}),s}}const PU=n=>Zr.getSaveHandlers(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mv="tensorflowjs",Pv=1,hc="models_store",mo="model_info_store";function KE(){if(!Ge().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Lv(n){const e=n.result;e.createObjectStore(hc,{keyPath:"modelPath"}),e.createObjectStore(mo,{keyPath:"modelPath"})}class yc{constructor(e){if(this.indexedDB=KE(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const i=this.indexedDB.open(Mv,Pv);i.onupgradeneeded=()=>Lv(i),i.onsuccess=()=>{const a=i.result;if(t==null){const o=a.transaction(hc,"readonly"),l=o.objectStore(hc).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=u=>(a.close(),s(l.error)),o.oncomplete=()=>a.close()}else{t.weightData=Zl.join(t.weightData);const o=jE(t),c=a.transaction(mo,"readwrite");let l=c.objectStore(mo),u;try{u=l.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(d){return s(d)}let f;u.onsuccess=()=>{f=a.transaction(hc,"readwrite");const d=f.objectStore(hc);let p;try{p=d.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o})}catch(m){return s(m)}p.onsuccess=()=>r({modelArtifactsInfo:o}),p.onerror=m=>{l=c.objectStore(mo);const I=l.delete(this.modelPath);I.onsuccess=()=>(a.close(),s(p.error)),I.onerror=v=>(a.close(),s(p.error))}},u.onerror=d=>(a.close(),s(u.error)),c.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},i.onerror=a=>s(i.error)})}}yc.URL_SCHEME="indexeddb://";const XE=n=>Ge().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(yc.URL_SCHEME)?LU(n.slice(yc.URL_SCHEME.length)):null;Zr.registerSaveRouter(XE);Zr.registerLoadRouter(XE);function LU(n){return new yc(n)}function UU(n){return n.startsWith(yc.URL_SCHEME)?n.slice(yc.URL_SCHEME.length):n}class zU{constructor(){this.indexedDB=KE()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(Mv,Pv);r.onupgradeneeded=()=>Lv(r),r.onsuccess=()=>{const s=r.result,i=s.transaction(mo,"readonly"),o=i.objectStore(mo).getAll();o.onsuccess=()=>{const c={};for(const l of o.result)c[l.modelPath]=l.modelArtifactsInfo;e(c)},o.onerror=c=>(s.close(),t(o.error)),i.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=UU(e),new Promise((t,r)=>{const s=this.indexedDB.open(Mv,Pv);s.onupgradeneeded=()=>Lv(s),s.onsuccess=()=>{const i=s.result,a=i.transaction(mo,"readwrite"),o=a.objectStore(mo),c=o.get(e);let l;c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=o.delete(e),f=()=>{l=i.transaction(hc,"readwrite");const p=l.objectStore(hc).delete(e);p.onsuccess=()=>t(c.result.modelArtifactsInfo),p.onerror=m=>r(c.error)};u.onsuccess=f,u.onerror=d=>(f(),i.close(),r(c.error))}},c.onerror=u=>(i.close(),r(c.error)),a.oncomplete=()=>{l==null?i.close():l.oncomplete=()=>i.close()}},s.onerror=i=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const La="/",vl="tensorflowjs_models",YE="info",VU="model_topology",WU="weight_specs",GU="weight_data",HU="model_metadata";function ZE(n){return{info:[vl,n,YE].join(La),topology:[vl,n,VU].join(La),weightSpecs:[vl,n,WU].join(La),weightData:[vl,n,GU].join(La),modelMetadata:[vl,n,HU].join(La)}}function JE(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function qU(n){const e=n.split(La);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(La)}function jU(n){return n.startsWith(xc.URL_SCHEME)?n.slice(xc.URL_SCHEME.length):n}class xc{constructor(e){if(!Ge().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ZE(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=jE(e),i=Zl.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,DU(i));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:s}}catch{throw JE(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const o=JSON.parse(i);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(t.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=BU(a),t}}xc.URL_SCHEME="localstorage://";const QE=n=>Ge().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(xc.URL_SCHEME)?KU(n.slice(xc.URL_SCHEME.length)):null;Zr.registerSaveRouter(QE);Zr.registerLoadRouter(QE);function KU(n){return new xc(n)}class XU{constructor(){ce(Ge().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ce(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=vl+La,r=La+YE;for(let s=0;s<this.LS.length;++s){const i=this.LS.key(s);if(i.startsWith(t)&&i.endsWith(r)){const a=qU(i);e[a]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=jU(e);const t=ZE(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return JE(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oC="://";class ca{constructor(){this.managers={}}static getInstance(){return ca.instance==null&&(ca.instance=new ca),ca.instance}static registerManager(e,t){ce(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(oC)&&(e=e.slice(0,e.indexOf(oC))),ce(e.length>0,()=>"scheme must not be an empty string.");const r=ca.getInstance();ce(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=ca.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(ca.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YU{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!Ge().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return kE(e)}}if(Ge().get("IS_BROWSER")){Ge().setPlatform("browser",new YU);try{ca.registerManager(xc.URL_SCHEME,new XU)}catch{}try{ca.registerManager(yc.URL_SCHEME,new zU)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZU={importFetch:()=>require("node-fetch")};let T1;class JU{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return Ge().global.fetch!=null?Ge().global.fetch(e,t):(T1==null&&(T1=ZU.importFetch()),T1(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Ge().get("IS_NODE")&&!Ge().get("IS_BROWSER")&&Ge().setPlatform("node",new JU);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(n,e="float32",t){return e=e||"float32",Ka(n),new Pr(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(n,e){const t=we(n,"x","cast");if(!q6(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return Fe.runKernel(Mf,r,s)}const gt=Pe({cast_:QU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(n){const t={x:we(n,"x","clone","string_or_numeric")};return Fe.runKernel(Yf,t)}const gc=Pe({clone_:e8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */zE();const n8={buffer:Xt,cast:gt,clone:gc,print:t8};RU(n8);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oa(){return Fe}function Uv(){return Fe.memory()}function Ve(n,e){return Fe.tidy(n,e)}function Qt(n){LE(n).forEach(t=>t.dispose())}function ma(n){return Fe.keep(n)}function eT(n,e,t=1){return Fe.registerBackend(n,e,t)}function r8(){return Fe.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(n,e){let t=we(n,"a","add"),r=we(e,"b","add");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(Yl,s)}const at=Pe({add_:s8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i8(n,e){let t=we(n,"a","floorDiv"),r=we(e,"b","floorDiv");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(Kf,s)}const tT=Pe({floorDiv_:i8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a8(n,e){let t=we(n,"a","div"),r=we(e,"b","div");if([t,r]=sr(t,r),t.dtype==="int32"&&r.dtype==="int32")return tT(t,r);const s={a:t,b:r},i={};return Fe.runKernel(Vf,s,i)}const $t=Pe({div_:a8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(n,e){let t=we(n,"a","mul"),r=we(e,"b","mul");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(ih,s)}const _e=Pe({mul_:o8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(n){const e=we(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Fe.runKernel(wg,t)}else{const t={x:e};return Fe.runKernel(gg,t)}}const Jr=Pe({abs_:c8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l8(n){const t={x:we(n,"x","acos")};return Fe.runKernel($f,t)}const u8=Pe({acos_:l8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(n){const t={x:we(n,"x","acosh")};return Fe.runKernel(Nf,t)}const h8=Pe({acosh_:f8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(n,e=null,t=!1){const s={x:we(n,"x","all","bool")},i={axis:e,keepDims:t};return Fe.runKernel(rb,s,i)}const nT=Pe({all_:d8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(n,e=null,t=!1){const s={x:we(n,"x","any","bool")},i={axis:e,keepDims:t};return Fe.runKernel(sb,s,i)}const zv=Pe({any_:p8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(n,e=0){const r={x:we(n,"x","argMax")},s={axis:e};return Fe.runKernel(mg,r,s)}const wc=Pe({argMax_:g8});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(n,e=0){const r={x:we(n,"x","argMin")},s={axis:e};return Fe.runKernel(vg,r,s)}const v8=Pe({argMin_:m8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(n){const t={x:we(n,"x","asin")};return Fe.runKernel(Of,t)}const b8=Pe({asin_:I8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(n){const t={x:we(n,"x","asinh")};return Fe.runKernel(_f,t)}const x8=Pe({asinh_:y8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(n){const t={x:we(n,"x","atan")};return Fe.runKernel(Ff,t)}const S8=Pe({atan_:w8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(n,e){let t=we(n,"a","atan2"),r=we(e,"b","atan2");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(Bf,s)}const R8=Pe({atan2_:C8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(n){const t={x:we(n,"x","atanh")};return Fe.runKernel(Df,t)}const E8=Pe({atanh_:k8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(n,e,t,r,s="NHWC",i){const a=n[3],o=[...e,a],c=Ya(s);return Lr(n,o,t,i,r,null,null,c)}function xi(n,e,t,r,s,i,a="channelsLast"){const[o,c]=df(e);let l;if(a==="channelsLast")l=[o,c,n[3],n[3]];else if(a==="channelsFirst")l=[o,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Lr(n,l,t,r,s,i,!1,a)}function Xa(n,e,t,r,s,i,a="NDHWC"){const[o,c,l]=Vv(e);let u,f;if(a==="NDHWC")f="channelsLast",u=[o,c,l,n[4],n[4]];else if(a==="NCDHW")f="channelsFirst",u=[o,c,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${a}`);return Do(n,u,t,r,s,!1,f,i)}function Lr(n,e,t,r,s,i,a=!1,o="channelsLast"){let[c,l,u,f]=[-1,-1,-1,-1];if(o==="channelsLast")[c,l,u,f]=n;else if(o==="channelsFirst")[c,f,l,u]=n;else throw new Error(`Unknown dataFormat ${o}`);const[d,p,,m]=e,[I,v]=df(t),[b,y]=df(r),S=Tl(d,b),w=Tl(p,y),{padInfo:C,outHeight:N,outWidth:E}=$8(s,l,u,I,v,S,w,i,o),A=a?m*f:m;let M;return o==="channelsFirst"?M=[c,A,N,E]:o==="channelsLast"&&(M=[c,N,E,A]),{batchSize:c,dataFormat:o,inHeight:l,inWidth:u,inChannels:f,outHeight:N,outWidth:E,outChannels:A,padInfo:C,strideHeight:I,strideWidth:v,filterHeight:d,filterWidth:p,effectiveFilterHeight:S,effectiveFilterWidth:w,dilationHeight:b,dilationWidth:y,inShape:n,outShape:M,filterShape:e}}function Do(n,e,t,r,s,i=!1,a="channelsLast",o){let[c,l,u,f,d]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[c,l,u,f,d]=n;else if(a==="channelsFirst")[c,d,l,u,f]=n;else throw new Error(`Unknown dataFormat ${a}`);const[p,m,I,,v]=e,[b,y,S]=Vv(t),[w,C,N]=Vv(r),E=Tl(p,w),A=Tl(m,C),M=Tl(I,N),{padInfo:z,outDepth:Y,outHeight:re,outWidth:ne}=N8(s,l,u,f,b,y,S,E,A,M,o),le=i?v*d:v;let j;return a==="channelsFirst"?j=[c,le,Y,re,ne]:a==="channelsLast"&&(j=[c,Y,re,ne,le]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:u,inWidth:f,inChannels:d,outDepth:Y,outHeight:re,outWidth:ne,outChannels:le,padInfo:z,strideDepth:b,strideHeight:y,strideWidth:S,filterDepth:p,filterHeight:m,filterWidth:I,effectiveFilterDepth:E,effectiveFilterHeight:A,effectiveFilterWidth:M,dilationDepth:w,dilationHeight:C,dilationWidth:N,inShape:n,outShape:j,filterShape:e}}function T8(n,e,t,r,s){r==null&&(r=Hb(n,e,t));const i=n[0],a=n[1],o=pf((i-e+2*r)/t+1,s),c=pf((a-e+2*r)/t+1,s);return[o,c]}function A8(n,e,t,r,s,i){s==null&&(s=Hb(n,e[0],r[0]));const a=[0,0,0,t];for(let o=0;o<3;o++)n[o]+2*s>=e[o]&&(a[o]=pf((n[o]-e[o]+2*s)/r[o]+1,i));return a}function Hb(n,e,t,r=1){const s=Tl(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function df(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Vv(n){return typeof n=="number"?[n,n,n]:n}function Tl(n,e){return e<=1?n:n+(n-1)*(e-1)}function $8(n,e,t,r,s,i,a,o,c){let l,u,f;if(typeof n=="number"){l={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const p=T8([e,t],i,r,n,o);u=p[0],f=p[1]}else if(n==="same"){u=Math.ceil(e/r),f=Math.ceil(t/s);const d=Math.max(0,(u-1)*r+i-e),p=Math.max(0,(f-1)*s+a-t),m=Math.floor(d/2),I=d-m,v=Math.floor(p/2),b=p-v;l={top:m,bottom:I,left:v,right:b,type:"SAME"}}else if(n==="valid")l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),f=Math.ceil((t-a+1)/s);else if(typeof n=="object"){const d=c==="channelsLast"?n[1][0]:n[2][0],p=c==="channelsLast"?n[1][1]:n[2][1],m=c==="channelsLast"?n[2][0]:n[3][0],I=c==="channelsLast"?n[2][1]:n[3][1];l={top:d,bottom:p,left:m,right:I,type:d===0&&p===0&&m===0&&I===0?"VALID":"EXPLICIT"},u=pf((e-i+d+p)/r+1,o),f=pf((t-a+m+I)/s+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:l,outHeight:u,outWidth:f}}function N8(n,e,t,r,s,i,a,o,c,l,u){let f,d,p,m;if(n==="valid"&&(n=0),typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=A8([e,t,r,1],[o,c,l],1,[s,i,a],n,u);d=v[0],p=v[1],m=v[2]}else if(n==="same"){d=Math.ceil(e/s),p=Math.ceil(t/i),m=Math.ceil(r/a);const I=(d-1)*s+o-e,v=(p-1)*i+c-t,b=(m-1)*a+l-r,y=Math.floor(I/2),S=I-y,w=Math.floor(v/2),C=v-w,N=Math.floor(b/2),E=b-N;f={top:w,bottom:C,left:N,right:E,front:y,back:S,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:d,outHeight:p,outWidth:m}}function pf(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Sc(n){const[e,t,r]=df(n);return e===1&&t===1&&r===1}function jr(n,e){return Sc(n)||Sc(e)}function Cc(n){return df(n).every(e=>e>0)}function Ya(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function gs(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")ce(Ol(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{ce(Ol(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O8(n,e){const r={x:we(n,"x","reshape","string_or_numeric")},s={shape:e};return Fe.runKernel(nm,r,s)}const Me=Pe({reshape_:O8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(n,e,t,r,s){const i=we(n,"x","avgPool","float32"),a=1;ce(jr(t,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);let o=i,c=!1;i.rank===3&&(c=!0,o=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ce(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),gs("avgPool",r,s);const l={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let f=Fe.runKernel(Ig,l,u);return f=gt(f,i.dtype),c?Me(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const qb=Pe({avgPool_:_8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F8(n,e,t,r,s,i="NDHWC"){const a=we(n,"x","avgPool3d","float32");let o=a,c=!1;a.rank===4&&(c=!0,o=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ce(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),ce(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),ce(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),gs("avgPool3d",r,s);const l={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i};let f=Fe.runKernel(bg,l,u);return f=gt(f,o.dtype),c?Me(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const D8=Pe({avgPool3d_:F8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(n,e=0){ce(n.length>=1,()=>"Pass at least one tensor to concat");const t=HE(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),t.length===1)return gc(t[0]);const r=t,s={axis:e};return Fe.runKernel(Sg,r,s)}const hs=Pe({concat_:B8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(n,e,t=!1,r=!1){let s=we(n,"a","matMul"),i=we(e,"b","matMul");[s,i]=sr(s,i);const a={a:s,b:i},o={transposeA:t,transposeB:r};return Fe.runKernel(yg,a,o)}const mn=Pe({matMul_:M8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P8(n){const t={x:we(n,"x","sigmoid","float32")};return Fe.runKernel(mh,t)}const Jl=Pe({sigmoid_:P8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L8(n,e,t){const r=we(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},i={begin:e,size:t};return Fe.runKernel(om,s,i)}const $n=Pe({slice_:L8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(n){const t={x:we(n,"x","tanh","float32")};return Fe.runKernel(wh,t)}const jb=Pe({tanh_:U8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z8(n,e,t){const r=we(n,"x","batchToSpaceND"),s=e.reduce((o,c)=>o*c);ce(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),ce(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),ce(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const i={x:r},a={blockShape:e,crops:t};return Fe.runKernel(xg,i,a)}const Kb=Pe({batchToSpaceND_:z8});function V8(n){let e;return n.rank===0||n.rank===1?e=Me(n,[1,1,1,n.size]):n.rank===2?e=Me(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=Me(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8(n,e,t,r,s,i){i==null&&(i=.001);const a=we(n,"x","batchNorm"),o=we(e,"mean","batchNorm"),c=we(t,"variance","batchNorm");let l;s!=null&&(l=we(s,"scale","batchNorm"));let u;r!=null&&(u=we(r,"offset","batchNorm")),ce(o.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ce(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ce(l==null||o.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:V8(a),scale:l,offset:u,mean:o,variance:c},p={varianceEpsilon:i},m=Fe.runKernel(Og,d,p);return Me(m,a.shape)}const Im=Pe({batchNorm_:W8});function G8(n,e,t,r,s,i){const a=we(n,"x","batchNorm"),o=we(e,"mean","batchNorm"),c=we(t,"variance","batchNorm");let l;s!=null&&(l=we(s,"scale","batchNorm"));let u;return r!=null&&(u=we(r,"offset","batchNorm")),ce(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),ce(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),ce(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&ce(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&ce(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Im(a,o,c,u,l,i)}const H8=Pe({batchNorm2d_:G8});function q8(n,e,t,r,s,i){const a=we(n,"x","batchNorm"),o=we(e,"mean","batchNorm"),c=we(t,"variance","batchNorm");let l;s!=null&&(l=we(s,"scale","batchNorm"));let u;return r!=null&&(u=we(r,"offset","batchNorm")),ce(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),ce(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),ce(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&ce(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&ce(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Im(a,o,c,u,l,i)}const j8=Pe({batchNorm3d_:q8});function K8(n,e,t,r,s,i){const a=we(n,"x","batchNorm"),o=we(e,"mean","batchNorm"),c=we(t,"variance","batchNorm");let l;s!=null&&(l=we(s,"scale","batchNorm"));let u;return r!=null&&(u=we(r,"offset","batchNorm")),ce(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),ce(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),ce(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&ce(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&ce(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Im(a,o,c,u,l,i)}const X8=Pe({batchNorm4d_:K8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(n,e,t){const r=we(n,"x","bincount"),s=we(e,"weights","bincount");ce(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),ce(t>=0,()=>`size must be non-negative, but got ${t}.`),ce(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const i={x:r,weights:s},a={size:t};return Fe.runKernel(ob,i,a)}const Z8=Pe({bincount_:Y8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J8(n,e){let t=we(n,"broadcastTo","x");const r=t.shape;if(Ka(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const l=t.shape.slice();for(;l.length<e.length;)l.unshift(1);t=Me(t,l)}const s=t.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(s[l]===e[l])i[l]=1;else if(t.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((l,u)=>l>1?u:-1).filter(l=>l>=0).length===0)return gc(t);const o={x:t},c={reps:i};return Fe.runKernel(Sh,o,c)}const cf=Pe({broadcastTo_:J8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8(n){const t={x:we(n,"x","ceil","float32")};return Fe.runKernel(Pf,t)}const ez=Pe({ceil_:Q8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bm(n,e,t){Ka(n),t=t||Kl(e);const r={shape:n,value:e,dtype:t};return Fe.runKernel(xb,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(n,e,t){const r=we(n,"x","clipByValue");if(ce(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return bm(r.shape,e,r.dtype);const s={x:r},i={clipValueMin:e,clipValueMax:t};return Fe.runKernel(Lf,s,i)}const Hs=Pe({clipByValue_:tz});function nz(n){return hs(n,0)}const rz=Pe({concat1d_:nz});function sz(n,e){return hs(n,e)}const iz=Pe({concat2d_:sz});function az(n,e){return hs(n,e)}const oz=Pe({concat3d_:az});function cz(n,e){return hs(n,e)}const lz=Pe({concat4d_:cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(n,e,t,r,s="NHWC",i=[1,1],a){const o=we(n,"x","conv2d","float32"),c=we(e,"filter","conv2d","float32");let l=o,u=!1;o.rank===3&&(u=!0,l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ce(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),ce(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),gs("conv2d",r,a);const f=s==="NHWC"?l.shape[3]:l.shape[1];ce(f===c.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${c.shape[2]}.`),ce(jr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ce(Cc(i),()=>"Error in conv2D: Dilated rates should be larger than 0."),ce(Cc(t),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:l,filter:c},p={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},m=Fe.runKernel(Cg,d,p);return u?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Rc=Pe({conv2d_:uz});function fz(n,e,t,r,s="NWC",i=1,a){const o=we(n,"x","conv1d"),c=we(e,"filter","conv1d");let l=o,u=!1;o.rank===2&&(u=!0,l=Me(o,[1,o.shape[0],o.shape[1]])),ce(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),ce(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),gs("conv1d",r,a),ce(l.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${c.shape[1]}.`),ce(jr(t,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${i}'`),ce(Cc(i),()=>"Error in conv1D: Dilated rates should be larger than 0."),ce(Cc(t),()=>"Error in conv1D: Stride should be larger than 0."),ce(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const f=Me(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=Me(l,[l.shape[0],1,l.shape[1],l.shape[2]]),v=Rc(d,f,[1,t],r,"NHWC",[1,i],a);return u?Me(v,[v.shape[2],v.shape[3]]):Me(v,[v.shape[0],v.shape[2],v.shape[3]])}const rT=Pe({conv1d_:fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(n,e,t,r,s,i="NHWC",a){ce(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,c=e,l=!1;e.rank===3&&(l=!0,c=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),ce(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),ce(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),ce(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const u=i==="NHWC"?o[3]:o[1],f=i==="NHWC"?c.shape[3]:c.shape[1];ce(u===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[2]}.`),ce(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),gs("conv2dDerInput",s,a);const d={dy:c,filter:t},p={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,inputShape:o},m=Fe.runKernel(Rg,d,p);return l?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Xb=Pe({conv2DBackpropInput_:hz});function dz(n,e,t,r,s,i){const a=we(n,"x","conv2dTranspose"),o=we(e,"filter","conv2dTranspose");return Xb(t,a,o,r,s,"NHWC",i)}const sT=Pe({conv2dTranspose_:dz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(n,e,t,r,s="NDHWC",i=[1,1,1]){const a=we(n,"x","conv3d"),o=we(e,"filter","conv3d");let c=a,l=!1;a.rank===4&&(l=!0,c=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ce(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),ce(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),ce(c.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${o.shape[3]}.`),ce(jr(t,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),ce(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),ce(Cc(i),()=>"Error in conv3D: Dilated rates should be larger than 0."),ce(Cc(t),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:c,filter:o},f={strides:t,pad:r,dataFormat:s,dilations:i},d=Fe.runKernel(kg,u,f);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const gz=Pe({conv3d_:pz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(n,e,t,r,s){ce(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let i=n,a=e,o=!1;e.rank===4&&(o=!0,a=Me(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,n[0],n[1],n[2],n[3]]);const c=i[4],l=a.shape[4];ce(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),ce(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),ce(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),ce(c===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${t.shape[3]}.`),ce(l===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${t.shape[4]}.`);const u={dy:a,filter:t},f={pad:s,strides:r,inputShape:i},d=Fe.runKernel(hb,u,f);return o?Me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const iT=Pe({conv3DBackpropInput_:mz});function vz(n,e,t,r,s){const i=we(n,"x","conv3dTranspose"),a=we(e,"filter","conv3dTranspose");return iT(t,i,a,r,s)}const Iz=Pe({conv3dTranspose_:vz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bz(n){const t={x:we(n,"x","cos","float32")};return Fe.runKernel(Uf,t)}const Yb=Pe({cos_:bz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yz(n){const t={x:we(n,"x","cosh","float32")};return Fe.runKernel(zf,t)}const aT=Pe({cosh_:yz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(n,e=0,t=!1,r=!1){const i={x:we(n,"x","cumprod")},a={axis:e,exclusive:t,reverse:r};return Fe.runKernel(db,i,a)}const Wv=Pe({cumprod_:xz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(n,e=0,t=!1,r=!1){const i={x:we(n,"x","cumsum")},a={axis:e,exclusive:t,reverse:r};return Fe.runKernel(Eg,i,a)}const oT=Pe({cumsum_:wz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(n,e,t,r=!1){const s=we(n,"x","denseBincount"),i=we(e,"weights","denseBincount");ce(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),ce(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),ce(t>=0,()=>`size must be non-negative, but got ${t}.`),ce(i.size===s.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${i.shape}.`);const a={x:s,weights:i},o={size:t,binaryOutput:r};return Fe.runKernel(gb,a,o)}const cC=Pe({denseBincount_:Sz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(n,e,t="NHWC"){const r=we(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],i=t==="NHWC"?r.shape[2]:r.shape[3],a=t==="NHWC"?r.shape[3]:r.shape[1];ce(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),ce(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),ce(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),ce(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},c={blockSize:e,dataFormat:t};return Fe.runKernel(mb,o,c)}const Rz=Pe({depthToSpace_:Cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kz(n,e,t,r,s="NHWC",i=[1,1],a){const o=we(n,"x","depthwiseConv2d","float32"),c=we(e,"filter","depthwiseConv2d","float32");let l=o,u=!1;o.rank===3&&(u=!0,l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ce(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),ce(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const f=s==="NHWC"?l.shape[3]:l.shape[1];ce(f===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${c.shape[2]}.`),gs("depthwiseConv2d",r,a);const d={x:l,filter:c},p={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a},m=Fe.runKernel(Tg,d,p);return u?Me(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Zb=Pe({depthwiseConv2d_:kz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(n,e,t,r,s=[1,1],i="NHWC"){const a=we(n,"x","dilation2d"),o=we(e,"filter","dilation2d");ce(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),ce(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),ce(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let c=a,l=!1;a.rank===3&&(c=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=!0),ce(c.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${o.shape[2]}`);const u={x:c,filter:o},f={strides:t,pad:r,dilations:s},d=Fe.runKernel(Ag,u,f);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Tz=Pe({dilation2d_:Ez});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const i=t-1-s,a=n[i]||1;(e[e.length-1-s]||1)>1&&a===1&&r.unshift(i)}return r}function wr(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],i=e.length-r-1,a=e[i];(s==null||s===1&&a>1)&&t.unshift(i)}return t}function Ut(n,e){const t=Math.max(n.length,e.length),r=new Array(t);for(let s=0;s<t;s++){let i=n[n.length-s-1];i==null&&(i=1);let a=e[e.length-s-1];if(a==null&&(a=1),i===1)r[t-s-1]=a;else if(a===1)r[t-s-1]=i;else if(i!==a){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else r[t-s-1]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Az(n,e){let t=we(n,"a","equal","string_or_numeric"),r=we(e,"b","equal","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel($g,s)}const ya=Pe({equal_:Az});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $z(n,e,t){const r=we(e,"a","where"),s=we(t,"b","where"),i=we(n,"condition","where","bool"),a=Ut(Ut(i.shape,r.shape),s.shape),o=cf(i,a),c=cf(r,a),l=cf(s,a),u={condition:o,t:c,e:l};return Fe.runKernel(am,u)}const ns=Pe({where_:$z});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(n){const t={x:we(n,"x","zerosLike")};return Fe.runKernel(pm,t)}const un=Pe({zerosLike_:Nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(n,e){let t=we(n,"a","div"),r=we(e,"b","div");[t,r]=sr(t,r);const s=$t(t,r),i=un(s),a=ya(r,i);return ns(a,i,s)}const _z=Pe({divNoNan_:Oz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(n,e){const t=we(n,"t1","dot"),r=we(e,"t2","dot");ce((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],i=r.rank===1?r.size:r.shape[0];if(ce(s===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${i}.`),t.rank===1&&r.rank===1){const a=Me(t,[1,-1]),o=Me(r,[-1,1]),c=mn(a,o);return Me(c,[])}else if(t.rank===1&&r.rank===2){const a=Me(t,[1,-1]),o=Me(r,[r.shape[0],r.shape[1]]),c=mn(a,o);return Me(c,[c.size])}else if(t.rank===2&&r.rank===1){const a=Me(r,[-1,1]),o=mn(t,a);return Me(o,[o.size])}else{const a=Me(r,[r.shape[0],r.shape[1]]);return mn(t,a)}}const Dz=Pe({dot_:Fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(n){const t={x:we(n,"x","elu","float32")};return Fe.runKernel(Wf,t)}const ym=Pe({elu_:Bz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(n){let e=we(n,"x","erf");ce(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=gt(e,"float32"));const t={x:e};return Fe.runKernel(Gf,t)}const Pz=Pe({erf_:Mz});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jb(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function cT(n,e,t){const r=n.length+e.length,s=[];let i=0,a=0;for(let o=0;o<r;o++)t.indexOf(o)===-1?s.push(n[i++]):s.push(e[a++]);return s}function $r(n,e){const t=[],r=n.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&t.push(n[i]);const s=e.map(i=>n[i]);return[t,s]}function mr(n,e){const t=e.map(r=>1);return cT(n,t,e)}function Ur(n,e,t){ce(Jb(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Kn(n,e){if(Jb(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function Bo(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function ir(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lz(n,e=null,t=!1){const s={x:we(n,"x","max")},i={reductionIndices:e,keepDims:t};return Fe.runKernel(Vg,s,i)}const Ui=Pe({max_:Lz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(n,e=null,t=!1){const s={x:we(n,"x","min")},i={axis:e,keepDims:t};return Fe.runKernel(qg,s,i)}const Np=Pe({min_:Uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(n,e){let t=we(n,"base","pow"),r=we(e,"exp","pow");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(ah,s)}const Ml=Pe({pow_:zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bn(n,e){if((vi(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&vi(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return vm(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(n){const t={x:we(n,"x","sqrt","float32")};return Fe.runKernel(Ih,t)}const rs=Pe({sqrt_:Vz});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(n){const e=we(n,"x","square"),t={};return Fe.runKernel("Square",{x:e},t)}const Dn=Pe({square_:Wz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(n,e=null,t=!1){let r=we(n,"x","sum");r.dtype==="bool"&&(r=gt(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return Fe.runKernel(cm,s,i)}const kt=Pe({sum_:Gz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(n,e="euclidean",t=null,r=!1){n=we(n,"x","norm");const s=lT(n,e,t);let i=s.shape;if(r){const a=Yt(t,n.shape);i=mr(s.shape,a)}return Me(s,i)}function lT(n,e,t=null){if(n.rank===0)return Jr(n);if(n.rank!==1&&t===null)return lT(Me(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return kt(Jr(n),t);if(e===1/0)return Ui(Jr(n),t);if(e===-1/0)return Np(Jr(n),t);if(e==="euclidean"||e===2)return rs(kt(Ml(Jr(n),bn(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Ui(kt(Jr(n),t[0]),t[1]-1);if(e===1/0)return Ui(kt(Jr(n),t[1]),t[0]);if(e===-1/0)return Np(kt(Jr(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return rs(kt(Dn(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const xm=Pe({norm_:Hz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qz(n,e=null,t=!1){return xm(n,"euclidean",e,t)}const jz=Pe({euclideanNorm_:qz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(n){const t={x:we(n,"x","exp")};return Fe.runKernel(Hf,t)}const Wa=Pe({exp_:Kz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(n,e=0){const t=we(n,"x","expandDims","string_or_numeric");ce(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return Fe.runKernel(Ng,r,s)}const Cs=Pe({expandDims_:Xz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(n){const t={x:we(n,"x","expm1")};return Fe.runKernel(qf,t)}const Zz=Pe({expm1_:Yz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(n,e){const t=we(n,"x","tile","string_or_numeric");ce(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return Fe.runKernel(Sh,r,s)}const Pi=Pe({tile_:Jz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(n,e,t,r="float32"){e==null&&(e=n);const s=Xt([n,e],r),i=n<=e?n:e;for(let o=0;o<i;++o)s.set(1,o,o);const a=Me(s.toTensor(),[n,e]);if(t==null)return a;if(t.length===1)return Pi(Cs(a,0),[t[0],1,1]);if(t.length===2)return Pi(Cs(Cs(a,0),0),[t[0],t[1],1,1]);if(t.length===3)return Pi(Cs(Cs(Cs(a,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const uT=Pe({eye_:Qz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(n){const t={x:we(n,"x","floor","float32")};return Fe.runKernel(jf,t)}const wm=Pe({floor_:eV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(n,e,t=0,r=0){const s=we(n,"x","gather"),i=we(e,"indices","gather","int32"),a={x:s,indices:i},o={axis:t,batchDims:r};return Fe.runKernel(_g,a,o)}const Qb=Pe({gather_:tV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(n,e){let t=we(n,"a","greater","string_or_numeric"),r=we(e,"b","greater","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Fg,s)}const qs=Pe({greater_:nV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(n,e){let t=we(n,"a","greaterEqual","string_or_numeric"),r=we(e,"b","greaterEqual","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Xf,s)}const Fc=Pe({greaterEqual_:rV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(n){const t={input:we(n,"input","imag")};return Fe.runKernel(Cb,t)}const ey=Pe({imag_:sV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(n){const t={x:we(n,"x","isFinite")};return Fe.runKernel(Zf,t)}const aV=Pe({isFinite_:iV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(n){const t={x:we(n,"x","isInf")};return Fe.runKernel(Jf,t)}const cV=Pe({isInf_:oV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(n){const t={x:we(n,"x","isNaN")};return Fe.runKernel(Qf,t)}const uV=Pe({isNaN_:lV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(n,e=.2){const r={x:we(n,"x","leakyRelu")},s={alpha:e};return Fe.runKernel(Dg,r,s)}const ty=Pe({leakyRelu_:fV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(n,e){let t=we(n,"a","less","string_or_numeric"),r=we(e,"b","less","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Bg,s)}const Op=Pe({less_:hV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(n,e){let t=we(n,"a","lessEqual","string_or_numeric"),r=we(e,"b","lessEqual","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Mg,s)}const Ql=Pe({lessEqual_:dV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pV(n,e=5,t=1,r=1,s=.5){const i=we(n,"x","localResponseNormalization");ce(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),ce(Ol(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const c={x:a},l={depthRadius:e,bias:t,alpha:r,beta:s},u=Fe.runKernel(zg,c,l);return o?Me(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const gV=Pe({localResponseNormalization_:pV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(n){const t={x:we(n,"x","log","float32")};return Fe.runKernel(eh,t)}const xa=Pe({log_:mV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(n){const t={x:we(n,"x","log1p")};return Fe.runKernel(th,t)}const fT=Pe({log1p_:vV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IV(n,e){ce(kv(n),()=>"The f passed in variableGrads(f) must be a function"),ce(e==null||Array.isArray(e)&&e.every(l=>l instanceof $p),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const l in Fe.registeredVariables)e.push(Fe.registeredVariables[l])}const r=t?e.filter(l=>!l.trainable):null,s=e.length;e=e.filter(l=>l.trainable),ce(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const i=!0,{value:a,grads:o}=Fe.gradients(n,e,null,i);ce(o.some(l=>l!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),ce(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const c={};return e.forEach((l,u)=>{o[u]!=null&&(c[l.name]=o[u])}),r!=null&&r.forEach(l=>c[l.name]=null),{value:a,grads:c}}function Pl(n){return Fe.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(n){const t={x:we(n,"x","neg")};return Fe.runKernel(Kg,t)}const rr=Pe({neg_:bV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(n){const t={x:we(n,"x","softplus")};return Fe.runKernel(vh,t)}const kh=Pe({softplus_:yV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(n){const e=we(n,"x","logSigmoid");return Pl(r=>({value:rr(kh(rr(r))),gradFunc:a=>_e(a,Jl(rr(r)))}))(e)}const wV=Pe({logSigmoid_:xV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(n,e){let t=we(n,"a","sub"),r=we(e,"b","sub");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(yh,s)}const Bt=Pe({sub_:SV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(n,e=-1){const t=we(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Pl((s,i)=>{const o=Ui(s,e,!0),c=Bt(s,o),l=Bt(gt(c,"float32"),xa(kt(Wa(c),e,!0)));return i([l]),{value:l,gradFunc:(f,d)=>{const[p]=d,m=!0,I=Wa(p);return Bt(f,_e(kt(f,e,m),I))}}})(t)}const hT=Pe({logSoftmax_:CV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(n,e=null,t=!1){const r=we(n,"x","logSumExp"),s=Yt(e,r.shape),i=Ui(r,s,!0),a=Bt(r,i),o=Wa(a),c=kt(o,s),l=xa(c),u=at(Me(i,l.shape),l);if(t){const f=mr(u.shape,s);return Me(u,f)}return u}const kV=Pe({logSumExp_:RV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(n,e){const t=we(n,"a","logicalAnd","bool"),r=we(e,"b","logicalAnd","bool");Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Pg,s)}const Ga=Pe({logicalAnd_:EV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(n){const t={x:we(n,"x","logicalNot","bool")};return Fe.runKernel(Lg,t)}const ny=Pe({logicalNot_:TV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(n,e){const t=we(n,"a","logicalOr","bool"),r=we(e,"b","logicalOr","bool");Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Ug,s)}const dT=Pe({logicalOr_:AV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(n,e){const t=we(n,"a","logicalXor","bool"),r=we(e,"b","logicalXor","bool");return Ut(t.shape,r.shape),Ga(dT(n,e),ny(Ga(n,e)))}const NV=Pe({logicalXor_:$V});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(n,e,t,r,s){const i=we(n,"x","maxPool"),a=1;let o=i,c=!1;i.rank===3&&(c=!0,o=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ce(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),ce(jr(t,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),gs("maxPool",r,s);const l={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s},f=Fe.runKernel(Wg,l,u);return c?Me(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const ry=Pe({maxPool_:OV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(n,e=[1,1,1],t,r,s,i="NDHWC"){const a=we(n,"x","maxPool3d");let o=a,c=!1;a.rank===4&&(c=!0,o=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),ce(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),ce(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),gs("maxPool3d",r,s);const l={x:o},u={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:i},f=Fe.runKernel(Gg,l,u);return c?Me(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const FV=Pe({maxPool3d_:_V});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(n,e){let t=we(n,"a","maximum"),r=we(e,"b","maximum");[t,r]=sr(t,r),t.dtype==="bool"&&(t=gt(t,"int32"),r=gt(r,"int32")),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(nh,s)}const Mo=Pe({maximum_:DV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(n,e=null,t=!1){const s={x:we(n,"x","mean")},i={axis:e,keepDims:t};return Fe.runKernel(Hg,s,i)}const gr=Pe({mean_:BV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tr(n,e="float32"){if(Ka(n),e==="complex64"){const r=Tr(n,"float32"),s=Tr(n,"float32");return Dl(r,s)}const t=qr(Ye(n),e);return Fe.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dc(n,e="float32"){if(Ka(n),e==="complex64"){const r=Dc(n,"float32"),s=Tr(n,"float32");return Dl(r,s)}const t=QI(Ye(n),e);return Fe.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(n,e){let t=we(n,"a","minimum"),r=we(e,"b","minimum");[t,r]=sr(t,r),t.dtype==="bool"&&(t=gt(t,"int32"),r=gt(r,"int32")),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(rh,s)}const gf=Pe({minimum_:MV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(n,e,t){ce(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=we(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ce(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let o=0;o<r.rank;o++)ce(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ce(e[o][0]>=0&&e[o][0]<=r.shape[o]-s&&e[o][1]>=0&&e[o][1]<=r.shape[o]-s,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-s} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:t},a={x:r};return Fe.runKernel(jg,a,i)}const LV=Pe({mirrorPad_:PV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(n,e){let t=we(n,"a","mod"),r=we(e,"b","mod");[t,r]=sr(t,r);const s={a:t,b:r};return Fe.runKernel(sh,s)}const zV=Pe({mod_:UV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(n,e=null,t=!1){n=we(n,"x","moments");const r=Yt(e,n.shape),s=gr(n,r,t);let i=s.shape;t||(i=mr(s.shape,r));const a=Dn(Bt(gt(n,"float32"),Me(s,i))),o=gr(a,r,t);return{mean:s,variance:o}}const sy=Pe({moments_:VV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WV(n,e){let t=we(n,"a","notEqual","string_or_numeric"),r=we(e,"b","notEqual","string_or_numeric");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r};return Fe.runKernel(Xg,s)}const _p=Pe({notEqual_:WV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:we(n,"indices","oneHot","int32")},o={dtype:s,depth:e,onValue:t,offValue:r};return Fe.runKernel(Zg,a,o)}const pT=Pe({oneHot_:GV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(n){const t={x:we(n,"x","onesLike")};return Fe.runKernel(Yg,t)}const Ii=Pe({onesLike_:HV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(n,e,t=0){const r=we(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},i={x:r};return Fe.runKernel(Qg,i,s)}const iy=Pe({pad_:qV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(n,e,t){const r=we(n,"x","spaceToBatchND");ce(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),ce(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),ce(r.shape.reduce((a,o,c)=>c>0&&c<=e.length?a&&(o+t[c-1][0]+t[c-1][1])%e[c-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},i={blockShape:e,paddings:t};return Fe.runKernel(lm,s,i)}const ay=Pe({spaceToBatchND_:jV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(n,e,t,r,s,i,a){s==null&&(s=[1,1]),i==null&&(i=1),r===0&&(r="valid");const o=we(n,"x","maxPool");let c=o,l=!1;o.rank===3&&(l=!0,c=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ce(jr(i,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${s}'`);const u=xi(c.shape,e,i,s,r),f=[u.dilationHeight,u.dilationWidth];let d;r==="same"?d=YV([u.filterHeight,u.filterWidth],f):d=[[0,0],[0,0]];const p=f[0]===1&&f[1]===1,[m,I]=XV([u.inHeight,u.inWidth],f,d),v=p?r:"valid",b=p?c:ay(c,f,m),S=(t==="avg"?()=>qb(b,e,i,v,a):()=>ry(b,e,i,v,a))(),w=p?S:Kb(S,f,I);return l?Me(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function XV(n,e,t){const r=t.map(u=>u[0]),s=t.map(u=>u[1]),i=n.concat(r,s),a=e.map((u,f)=>(u-i[f]%u)%u),o=s.map((u,f)=>u+a[f]),c=e.map((u,f)=>[r[f],o[f]]),l=e.map((u,f)=>[0,a[f]]);return[c,l]}function YV(n,e){const r=n.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),s=r.map(a=>Math.floor(a/2)),i=r.map((a,o)=>a-s[o]);return r.map((a,o)=>[s[o],i[o]])}const ZV=Pe({pool_:KV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(n,e){const t=we(n,"x","prelu"),r=we(e,"alpha","prelu"),s={x:t,alpha:r};return Fe.runKernel(em,s)}const oy=Pe({prelu_:JV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QV(n,e=null,t=!1){let r=we(n,"x","prod");r.dtype==="bool"&&(r=gt(r,"int32"));const s={x:r},i={axis:e,keepDims:t};return Fe.runKernel(tm,s,i)}const eW=Pe({prod_:QV});var cy={exports:{}};cy.exports;(function(n){(function(e,t,r){function s(c){var l=this,u=o();l.next=function(){var f=2091639*l.s0+l.c*23283064365386963e-26;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=f|0)},l.c=1,l.s0=u(" "),l.s1=u(" "),l.s2=u(" "),l.s0-=u(c),l.s0<0&&(l.s0+=1),l.s1-=u(c),l.s1<0&&(l.s1+=1),l.s2-=u(c),l.s2<0&&(l.s2+=1),u=null}function i(c,l){return l.c=c.c,l.s0=c.s0,l.s1=c.s1,l.s2=c.s2,l}function a(c,l){var u=new s(c),f=l&&l.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&i(f,u),d.state=function(){return i(u,{})}),d}function o(){var c=4022871197,l=function(u){u=String(u);for(var f=0;f<u.length;f++){c+=u.charCodeAt(f);var d=.02519603282416938*c;c=d>>>0,d-=c,d*=c,c=d>>>0,d-=c,c+=d*4294967296}return(c>>>0)*23283064365386963e-26};return l}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(Hn,n,!1)})(cy);var tW=cy.exports,ly={exports:{}};ly.exports;(function(n){(function(e,t,r){function s(o){var c=this,l="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var f=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^f^f>>>8},o===(o|0)?c.x=o:l+=o;for(var u=0;u<l.length+64;u++)c.x^=l.charCodeAt(u)|0,c.next()}function i(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c}function a(o,c){var l=new s(o),u=c&&c.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,p=(l.next()>>>0)/4294967296,m=(d+p)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&i(u,l),f.state=function(){return i(l,{})}),f}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(Hn,n,!1)})(ly);var nW=ly.exports,uy={exports:{}};uy.exports;(function(n){(function(e,t,r){function s(o){var c=this,l="";c.next=function(){var f=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(f^f<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,o===(o|0)?c.x=o:l+=o;for(var u=0;u<l.length+64;u++)c.x^=l.charCodeAt(u)|0,u==l.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function i(o,c){return c.x=o.x,c.y=o.y,c.z=o.z,c.w=o.w,c.v=o.v,c.d=o.d,c}function a(o,c){var l=new s(o),u=c&&c.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,p=(l.next()>>>0)/4294967296,m=(d+p)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&i(u,l),f.state=function(){return i(l,{})}),f}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(Hn,n,!1)})(uy);var rW=uy.exports,fy={exports:{}};fy.exports;(function(n){(function(e,t,r){function s(o){var c=this;c.next=function(){var u=c.x,f=c.i,d,p;return d=u[f],d^=d>>>7,p=d^d<<24,d=u[f+1&7],p^=d^d>>>10,d=u[f+3&7],p^=d^d>>>3,d=u[f+4&7],p^=d^d<<7,d=u[f+7&7],d=d^d<<13,p^=d^d<<9,u[f]=p,c.i=f+1&7,p};function l(u,f){var d,p=[];if(f===(f|0))p[0]=f;else for(f=""+f,d=0;d<f.length;++d)p[d&7]=p[d&7]<<15^f.charCodeAt(d)+p[d+1&7]<<13;for(;p.length<8;)p.push(0);for(d=0;d<8&&p[d]===0;++d);for(d==8?p[7]=-1:p[d],u.x=p,u.i=0,d=256;d>0;--d)u.next()}l(c,o)}function i(o,c){return c.x=o.x.slice(),c.i=o.i,c}function a(o,c){o==null&&(o=+new Date);var l=new s(o),u=c&&c.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,p=(l.next()>>>0)/4294967296,m=(d+p)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(u.x&&i(u,l),f.state=function(){return i(l,{})}),f}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(Hn,n,!1)})(fy);var sW=fy.exports,hy={exports:{}};hy.exports;(function(n){(function(e,t,r){function s(o){var c=this;c.next=function(){var u=c.w,f=c.X,d=c.i,p,m;return c.w=u=u+1640531527|0,m=f[d+34&127],p=f[d=d+1&127],m^=m<<13,p^=p<<17,m^=m>>>15,p^=p>>>12,m=f[d]=m^p,c.i=d,m+(u^u>>>16)|0};function l(u,f){var d,p,m,I,v,b=[],y=128;for(f===(f|0)?(p=f,f=null):(f=f+"\0",p=0,y=Math.max(y,f.length)),m=0,I=-32;I<y;++I)f&&(p^=f.charCodeAt((I+32)%f.length)),I===0&&(v=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,I>=0&&(v=v+1640531527|0,d=b[I&127]^=p+v,m=d==0?m+1:0);for(m>=128&&(b[(f&&f.length||0)&127]=-1),m=127,I=4*128;I>0;--I)p=b[m+34&127],d=b[m=m+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,b[m]=p^d;u.w=v,u.X=b,u.i=m}l(c,o)}function i(o,c){return c.i=o.i,c.w=o.w,c.X=o.X.slice(),c}function a(o,c){o==null&&(o=+new Date);var l=new s(o),u=c&&c.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,p=(l.next()>>>0)/4294967296,m=(d+p)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(u.X&&i(u,l),f.state=function(){return i(l,{})}),f}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(Hn,n,!1)})(hy);var iW=hy.exports,dy={exports:{}};dy.exports;(function(n){(function(e,t,r){function s(o){var c=this,l="";c.next=function(){var f=c.b,d=c.c,p=c.d,m=c.a;return f=f<<25^f>>>7^d,d=d-p|0,p=p<<24^p>>>8^m,m=m-f|0,c.b=f=f<<20^f>>>12^d,c.c=d=d-p|0,c.d=p<<16^d>>>16^m,c.a=m-f|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,o===Math.floor(o)?(c.a=o/4294967296|0,c.b=o|0):l+=o;for(var u=0;u<l.length+20;u++)c.b^=l.charCodeAt(u)|0,c.next()}function i(o,c){return c.a=o.a,c.b=o.b,c.c=o.c,c.d=o.d,c}function a(o,c){var l=new s(o),u=c&&c.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=l.next()>>>11,p=(l.next()>>>0)/4294967296,m=(d+p)/(1<<21);while(m===0);return m},f.int32=l.next,f.quick=f,u&&(typeof u=="object"&&i(u,l),f.state=function(){return i(l,{})}),f}t&&t.exports?t.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(Hn,n,!1)})(dy);var aW=dy.exports,gT={exports:{}};const oW={},cW=Object.freeze(Object.defineProperty({__proto__:null,default:oW},Symbol.toStringTag,{value:"Module"})),py=EE(cW);(function(n){(function(e,t,r){var s=256,i=6,a=52,o="random",c=r.pow(s,i),l=r.pow(2,a),u=l*2,f=s-1,d;function p(w,C,N){var E=[];C=C==!0?{entropy:!0}:C||{};var A=b(v(C.entropy?[w,S(t)]:w??y(),3),E),M=new m(E),z=function(){for(var Y=M.g(i),re=c,ne=0;Y<l;)Y=(Y+ne)*s,re*=s,ne=M.g(1);for(;Y>=u;)Y/=2,re/=2,ne>>>=1;return(Y+ne)/re};return z.int32=function(){return M.g(4)|0},z.quick=function(){return M.g(4)/4294967296},z.double=z,b(S(M.S),t),(C.pass||N||function(Y,re,ne,le){return le&&(le.S&&I(le,M),Y.state=function(){return I(M,{})}),ne?(r[o]=Y,re):Y})(z,A,"global"in C?C.global:this==r,C.state)}function m(w){var C,N=w.length,E=this,A=0,M=E.i=E.j=0,z=E.S=[];for(N||(w=[N++]);A<s;)z[A]=A++;for(A=0;A<s;A++)z[A]=z[M=f&M+w[A%N]+(C=z[A])],z[M]=C;(E.g=function(Y){for(var re,ne=0,le=E.i,j=E.j,ge=E.S;Y--;)re=ge[le=f&le+1],ne=ne*s+ge[f&(ge[le]=ge[j=f&j+re])+(ge[j]=re)];return E.i=le,E.j=j,ne})(s)}function I(w,C){return C.i=w.i,C.j=w.j,C.S=w.S.slice(),C}function v(w,C){var N=[],E=typeof w,A;if(C&&E=="object")for(A in w)try{N.push(v(w[A],C-1))}catch{}return N.length?N:E=="string"?w:w+"\0"}function b(w,C){for(var N=w+"",E,A=0;A<N.length;)C[f&A]=f&(E^=C[f&A]*19)+N.charCodeAt(A++);return S(C)}function y(){try{var w;return d&&(w=d.randomBytes)?w=w(s):(w=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(w)),S(w)}catch{var C=e.navigator,N=C&&C.plugins;return[+new Date,e,N,e.screen,S(t)]}}function S(w){return String.fromCharCode.apply(0,w)}if(b(r.random(),t),n.exports){n.exports=p;try{d=py}catch{}}else r["seed"+o]=p})(typeof self<"u"?self:Hn,[],Math)})(gT);var lW=gT.exports,uW=tW,fW=nW,hW=rW,dW=sW,pW=iW,gW=aW,Bc=lW;Bc.alea=uW;Bc.xor128=fW;Bc.xorwow=hW;Bc.xorshift7=dW;Bc.xor4096=pW;Bc.tychei=gW;var gy=Bc;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mT{constructor(e,t,r,s,i){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=i||Math.random();this.random=gy.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,i,a;do s=2*this.random()-1,i=2*this.random()-1,a=s*s+i*i;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*s*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class mW{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=gy.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(n,e=0,t=1,r,s){if(Ka(n),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new mT(e,t,r,!1,s),a=Xt(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const IW=Pe({randomNormal_:vW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(n,e=0,t=1,r="float32",s){Ka(n);const i=Xt(n,r),a=new mW(e,t,null,s);for(let o=0;o<i.values.length;o++)i.values[o]=a.nextValue();return i.toTensor()}const Eh=Pe({randomUniform_:bW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mf(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return Fe.runKernel(Nb,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yW(n){const t={input:we(n,"input","real")};return Fe.runKernel(Ob,t)}const Fp=Pe({real_:yW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(n){const t={x:we(n,"x","reciprocal")};return Fe.runKernel(oh,t)}const wW=Pe({reciprocal_:xW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(n){const t={x:we(n,"x","relu")};return Fe.runKernel(ch,t)}const Mc=Pe({relu_:SW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(n){const t={x:we(n,"x","relu6")};return Fe.runKernel(lh,t)}const vT=Pe({relu6_:CW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(n,e){const r={x:we(n,"x","reverse")},s={dims:e};return Fe.runKernel(im,r,s)}const kc=Pe({reverse_:RW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(n){const t={x:we(n,"x","round")};return Fe.runKernel(uh,t)}const IT=Pe({round_:kW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(n){const t={x:we(n,"x","rsqrt","float32")};return Fe.runKernel(fh,t)}const bT=Pe({rsqrt_:EW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(n){const t={x:we(n,"x","selu")};return Fe.runKernel(hh,t)}const yT=Pe({selu_:TW});function AW(n,e,t,r,s,i=[1,1],a="NHWC"){const o=we(n,"x","separableConv2d"),c=we(e,"depthwiseFilter","separableConv2d"),l=we(t,"pointwiseFilter","separableConv2d");let u=o,f=!1;if(o.rank===3&&(f=!0,u=Me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ce(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),ce(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),ce(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),ce(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),ce(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const d=c.shape[2],p=c.shape[3];ce(l.shape[2]===d*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*p}, but got ${l.shape[2]}.`);const m=Zb(u,c,r,s,a,i),v=Rc(m,l,1,"valid",a);return f?Me(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const xT=Pe({separableConv2d_:AW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(n){const t={x:we(n,"x","sign")};return Fe.runKernel(gh,t)}const NW=Pe({sign_:$W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(n){const t={x:we(n,"x","sin","float32")};return Fe.runKernel(dh,t)}const wT=Pe({sin_:OW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(n){const t={x:we(n,"x","sinh")};return Fe.runKernel(ph,t)}const ST=Pe({sinh_:_W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(n,e,t){const r=we(n,"x","slice1d");return ce(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),$n(r,[e],[t])}const my=Pe({slice1d_:FW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(n,e,t){const r=we(n,"x","slice2d");return ce(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),$n(r,e,t)}const CT=Pe({slice2d_:DW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(n,e,t){const r=we(n,"x","slice3d");return ce(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),$n(r,e,t)}const vy=Pe({slice3d_:BW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(n,e,t){const r=we(n,"x","slice4d");return ce(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),$n(r,e,t)}const Dp=Pe({slice4d_:MW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(n,e=-1){const t=we(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return Fe.runKernel(fm,r,s)}const Iy=Pe({softmax_:PW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(n){ce(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Fe.runKernel(yb,e)}const RT=Pe({fft_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(n){ce(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Fe.runKernel(Sb,e)}const Gv=Pe({ifft_:UW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=Me(n,[t,e]);r=Gv(s)}else{const s=[t,2*(e-1)],i=Me(Fp(n),[t,e]),a=Me(ey(n),[t,e]),o=kc($n(i,[0,1],[t,e-2]),1),c=_e(kc($n(a,[0,1],[t,e-2]),1),bn(-1)),l=hs([i,o],1),u=hs([a,c],1),f=Me(Dl(l,u),[s[0],s[1]]);r=Gv(f)}if(r=Fp(r),n.rank===3&&n.shape[0]!==0){const s=r,i=n.shape[0];r=Me(r,[i,r.shape[0]/i,r.shape[1]]),s.dispose()}return r}const VW=Pe({irfft_:zW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(n,e,t=0){const s={x:we(n,"x","split")},i={numOrSizeSplits:e,axis:t};return Fe.runKernel(um,s,i)}const Gs=Pe({split_:WW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(n,e){ce(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const m=n.shape.map(v=>0),I=n.shape.map(v=>v);I[n.shape.length-1]=e,s=$n(n,m,I),t=e}else if(e!=null&&e>t){const m=n.shape.map(I=>I);m[n.shape.length-1]=e-t,s=hs([n,Tr(m)],n.shape.length-1),t=e}else s=n;const i=un(s),a=Me(Dl(s,i),[r,t]),o=RT(a),c=Math.floor(t/2)+1,l=Fp(o),u=ey(o),f=Gs(l,[c,t-c],l.shape.length-1),d=Gs(u,[c,t-c],u.shape.length-1),p=s.shape.slice();return p[s.shape.length-1]=c,Me(Dl(f[0],d[0]),p)}const HW=Pe({rfft_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(n,e){let t=we(n,"a","squaredDifference"),r=we(e,"b","squaredDifference");[t,r]=sr(t,r),Ut(t.shape,r.shape);const s={a:t,b:r},i={};return Fe.runKernel(bh,s,i)}const jW=Pe({squaredDifference_:qW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(n,e){const t=we(n,"x","squeeze","string_or_numeric");return Me(t,_o(t.shape,e).newShape)}const Th=Pe({squeeze_:KW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(n,e=0){const t=HE(n,"tensors","stack","string_or_numeric");ce(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&ce(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return Fe.runKernel(Jg,r,s)}const ko=Pe({stack_:XW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(n,e=0){const r={x:we(n,"x","step")},s={alpha:e};return Fe.runKernel(Ch,r,s)}const Ah=Pe({step_:YW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(n,e,t,r,s=0,i=0,a=0,o=0,c=0){const u={x:we(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:r,beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:c};return Fe.runKernel(Mb,u,f)}const JW=Pe({stridedSlice_:ZW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(n){const t={x:we(n,"x","tan","float32")};return Fe.runKernel(xh,t)}const eG=Pe({tan_:QW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zs(n,e){Xk(n);const t=mm(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return vm(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(n,e,t){if(Xk(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=mm(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return vm(n,e,r,t)}function kT(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(i+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(i+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(i+` update.rank != ${s+n.length-r}`);for(let a=0;a<s;++a)if(t.shape[a]!==e.shape[a])throw new Error(i+` updates.shape[${a}] (${t.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<t.rank-s;++a)if(t.shape[a+s]!==n[a+r])throw new Error(i+` updates.shape[${a+s}] (${t.shape[a+s]}) != shape[${a+s}] (${n[a+s]})`)}function tG(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}kT(t,e,n)}function Pc(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,i=t.length;let a=1;for(let f=s;f<i;++f)a*=t[f];const o=s<1?1:s,c=Ye(e.shape)/o,l=[...Rt(t.slice(0,s)),1],u=Ye(t);return{sliceRank:s,numUpdates:c,sliceSize:a,strides:l,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(n,e=1,t=!0){const r=we(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const i={x:r},a={k:e,sorted:t},[o,c]=Fe.runKernel(Pb,i,a);return{values:o,indices:c}}const rG=Pe({topk_:nG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(n,e=0,t=1,r,s){if(Ka(n),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new mT(e,t,r,!0,s),a=Xt(n,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}const ET=Pe({truncatedNormal_:sG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(n,e=0){const t=we(n,"x","unique","string_or_numeric");ce(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[i,a]=Fe.runKernel(Ub,r,s);return{values:i,indices:a}}const aG=Pe({unique_:iG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(n,e,t){const r=we(n,"x","unsortedSegmentSum"),s=we(e,"segmentIds","unsortedSegmentSum","int32");ce(Ol(t),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:s},a={numSegments:t};return Fe.runKernel(dm,i,a)}const TT=Pe({unsortedSegmentSum_:oG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(n,e=0){const t=we(n,"x","unstack","string_or_numeric");ce(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return Fe.runKernel(hm,r,s)}const Ec=Pe({unstack_:cG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(n,e=!0,t,r){return Fe.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AT(n,e){const t=[];for(let i=0;i<e.length;i++)e[i]&&t.push(i);const r=Xt(n,"int32"),s=Xt([t.length,n.length],"int32");for(let i=0;i<t.length;i++){const a=r.indexToLoc(t[i]),o=i*n.length;s.values.set(a,o)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(n,e,t){const r=we(n,"x","transpose");if(e==null&&(e=r.shape.map((a,o)=>o).reverse()),ce(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(a=>{ce(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},i={perm:e};return r.dtype==="complex64"?Ve(()=>{let a=Fp(r),o=ey(r);return a=Fe.runKernel(El,{x:a},i),o=Fe.runKernel(El,{x:o},i),t&&(o=rr(o)),Dl(a,o)}):Fe.runKernel(El,s,i)}const ln=Pe({transpose_:uG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(n,e){if(e==null)return n.shape.slice();if(vn(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(n,e,t,r){const s=we(n,"x","dropout");if(ce(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),ce(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof dr?s.clone():s;const i=fG(s,t),a=1-e,o=$t(wm(at(Eh(i,0,1,"float32",r),a)),a);return _e(s,o)}const dG=Pe({dropout_:hG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(n,e,t,r,s,i="NHWC",a){let o=n;n.rank===3&&(o=Me(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ce(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),ce(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),ce(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const l=i==="NHWC"?o.shape[3]:o.shape[1],u=i==="NHWC"?c.shape[3]:c.shape[1];ce(l===t[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${t[2]}.`),ce(u===t[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${t[3]}).`),gs("conv2dDerFilter",s,a);const f={x:o,dy:c},d={strides:r,pad:s,dataFormat:i,dimRoundingMode:a,filterShape:t};return Fe.runKernel(ub,f,d)}const by=Pe({conv2DBackpropFilter_:pG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return _e(n,Ah(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function xy(n,e){let t=e;const r=wr(n.shape,e.shape);return r.length>0&&(t=kt(t,r)),Me(t,n.shape)}function wy(n,e,t,r){if(e==="linear")return n;if(e==="relu")return Mc(n);if(e==="elu")return ym(n);if(e==="relu6")return vT(n);if(e==="prelu")return oy(n,t);if(e==="leakyrelu")return ty(n,r);if(e==="sigmoid")return Jl(n);throw new Error(`Unknown fused activation ${e}.`)}const Sy=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:i=[1,1],dimRoundingMode:a,bias:o,activation:c="linear",preluActivationWeights:l,leakyreluAlpha:u}){if(c=c||"linear",Sy(Fe.state.gradientDepth,c)===!1){ce(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let N=Rc(n,e,t,r,s,i,a);return o!=null&&(N=at(N,o)),wy(N,c,l,u)}const f=we(n,"x","conv2d","float32"),d=we(e,"filter","conv2d","float32");let p=f,m=!1;f.rank===3&&(m=!0,p=Me(f,[1,f.shape[0],f.shape[1],f.shape[2]])),ce(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),ce(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),gs("fused conv2d",r,a);const I=s==="NHWC"?p.shape[3]:p.shape[1];ce(d.shape[2]===I,()=>`Error in conv2d: depth of input (${I}) must match input depth for filter ${d.shape[2]}.`),ce(jr(t,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);const v=Lr(p.shape,d.shape,t,i,r,a);let b;o!=null&&(b=we(o,"bias","fused conv2d"),[b]=sr(b,f),s==="NHWC"?Ut(v.outShape,b.shape):(ce(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),ce(b.shape.length===0||b.shape[0]===v.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let y;if(l!=null){const N=l.shape;if(ce(N.length<=1||N.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${N.length}.`),N.length===1)ce(N[0]===1||N[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${N}) is not compatible with the number of output channels (${v.outChannels}).`);else if(N.length===3)try{Ut(N,v.outShape)}catch{const A=`Error in fused conv2d: PReLU activation weights (${N}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(A)}y=we(l,"prelu weights","fused conv2d")}const S=(N,E)=>{ce(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[A,M,z,Y]=E,re=yy(N,z,c);ce(Sc(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const ne=Xb(M.shape,re,A,t,r),le=by(M,re,A.shape,t,r),j=[ne,le];if(Y!=null){const ge=xy(Y,re);j.push(ge)}return j},w={x:p,filter:d,bias:b,preluActivationWeights:y},C={strides:t,pad:r,dataFormat:s,dilations:i,dimRoundingMode:a,activation:c,leakyreluAlpha:u};return o==null?Pl((E,A,M)=>{let z=Fe.runKernel(Ep,w,C);return M([A,E,z]),m&&(z=Me(z,[z.shape[1],z.shape[2],z.shape[3]])),{value:z,gradFunc:S}})(p,d):Pl((E,A,M,z)=>{let Y=Fe.runKernel(Ep,w,C);return z([A,E,Y,M]),m&&(Y=Me(Y,[Y.shape[1],Y.shape[2],Y.shape[3]])),{value:Y,gradFunc:S}})(p,d,b)}const mG=Pe({fusedConv2d_:gG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(n,e,t,r,s,i=[1,1],a){let o=n;n.rank===3&&(o=Me(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let c=e;c.rank===3&&(c=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={x:o,dy:c},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,filterShape:t};return Fe.runKernel(vb,l,u)}const IG=Pe({depthwiseConv2dNativeBackpropFilter_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(n,e,t,r,s,i=[1,1],a){let o=e,c=!1;e.rank===3&&(c=!0,o=Me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={dy:o,filter:t},u={strides:r,pad:s,dimRoundingMode:a,dilations:i,inputShape:n},f=Fe.runKernel(Ib,l,u);return c?Me(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const yG=Pe({depthwiseConv2dNativeBackpropInput_:bG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:i="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(Sy(Fe.state.gradientDepth,i)===!1){let Y=mn(n,e,t,r);return s!=null&&(Y=at(Y,s)),wy(Y,i,a,o)}let c=we(n,"a","fused matMul"),l=we(e,"b","fused matMul");[c,l]=sr(c,l);const u=t?c.shape[c.rank-2]:c.shape[c.rank-1],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],d=t?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?l.shape[l.rank-2]:l.shape[l.rank-1],m=c.shape.slice(0,-2),I=l.shape.slice(0,-2),v=Ye(m),b=Ye(I);ce(u===f,()=>`Error in fused matMul: inner shapes (${u}) and (${f}) of Tensors with shapes ${c.shape} and ${l.shape} and transposeA=${t} and transposeB=${r} must match.`);const S=Ut(c.shape.slice(0,-2),l.shape.slice(0,-2)).concat([d,p]),w=t?Me(c,[v,u,d]):Me(c,[v,d,u]),C=r?Me(l,[b,p,f]):Me(l,[b,f,p]);let N;s!=null&&(N=we(s,"bias","fused matMul"),[N]=sr(N,c),Ut(S,N.shape));let E;a!=null&&(E=we(a,"prelu weights","fused matMul"));const A=(Y,re)=>{const[ne,le,j,ge]=re,Se=yy(Me(Y,j.shape),j,i);let me,ye;if(!t&&!r?(me=mn(Se,le,!1,!0),ye=mn(ne,Se,!0,!1)):!t&&r?(me=mn(Se,le,!1,!1),ye=mn(Se,ne,!0,!1)):t&&!r?(me=mn(le,Se,!1,!0),ye=mn(ne,Se,!1,!1)):(me=mn(le,Se,!0,!0),ye=mn(Se,ne,!0,!0)),s!=null){const Ce=xy(ge,Se);return[me,ye,Ce]}else return[me,ye]},M={a:w,b:C,bias:N,preluActivationWeights:E},z={transposeA:t,transposeB:r,activation:i,leakyreluAlpha:o};return s==null?Pl((re,ne,le)=>{const j=Fe.runKernel(kp,M,z);return le([re,ne,j]),{value:Me(j,S),gradFunc:A}})(w,C):Pl((re,ne,le,j)=>{const ge=Fe.runKernel(kp,M,z);return j([re,ne,ge,le]),{value:Me(ge,S),gradFunc:A}})(w,C,N)}const lC=Pe({fusedMatMul_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(n,e,t,r,s="bilinear",i=0){const a=we(n,"image","cropAndResize"),o=we(e,"boxes","cropAndResize","float32"),c=we(t,"boxInd","cropAndResize","int32"),l=o.shape[0];ce(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),ce(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${o.shape}.`),ce(c.rank===1&&c.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${o.shape}.`),ce(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),ce(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),ce(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:a,boxes:o,boxInd:c},f={method:s,extrapolationValue:i,cropSize:r};return Fe.runKernel(pb,u,f)}const SG=Pe({cropAndResize_:wG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(n){const e=we(n,"image","flipLeftRight","float32");ce(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Fe.runKernel(wb,t,{})}const RG=Pe({flipLeftRight_:CG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(n){const e=we(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];ce(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),ce(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,Pi(e,s)}const EG=Pe({grayscaleToRGB_:kG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(n,e,t=0,r=.5){const s=we(n,"image","rotateWithOffset","float32");ce(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const i={image:s},a={radians:e,fillValue:t,center:r};return Fe.runKernel(zb,i,a)}const AG=Pe({rotateWithOffset_:TG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(n,e,t,r,s,i){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),i==null&&(i=0);const a=n.shape[0];return t=Math.min(t,a),ce(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),ce(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),ce(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),ce(e.rank===1,()=>"scores must be a 1D tensor"),ce(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),ce(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=we(n,"boxes","nonMaxSuppression","float32"),a=we(e,"scores","nonMaxSuppression","float32"),o=eu(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const c={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return Fe.runKernel(Tb,{boxes:i,scores:a},c)}const NG=Pe({nonMaxSuppression_:$G});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(n,e,t){const r=_G(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function _G(n,e,t){return DG(n,e,t||FG)}function FG(n,e){return n>e?1:n<e?-1:0}function DG(n,e,t){let r=0,s=n.length,i=0,a=!1;for(;r<s;){i=r+(s-r>>>1);const o=t(e,n[i]);o>0?r=i+1:(s=i,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(n,e,t,r,s){return Ey(n,e,t,r,s,0)}function Ry(n,e,t,r,s,i){return Ey(n,e,t,r,s,0,!1,i,!0)}function ky(n,e,t,r,s,i){return Ey(n,e,t,r,s,i,!0)}function Ey(n,e,t,r,s,i,a=!1,o=!1,c=!1){const l=[];for(let v=0;v<e.length;v++)e[v]>s&&l.push({score:e[v],boxIndex:v,suppressBeginIndex:0});l.sort(uC);const u=i>0?-.5/i:0,f=[],d=[];for(;f.length<t&&l.length>0;){const v=l.pop(),{score:b,boxIndex:y,suppressBeginIndex:S}=v;if(b<s)break;let w=!1;for(let C=f.length-1;C>=S;--C){const N=BG(n,y,f[C]);if(N>=r){w=!0;break}if(v.score=v.score*MG(r,u,N),v.score<=s)break}v.suppressBeginIndex=f.length,w||(v.score===b?(f.push(y),d.push(v.score)):v.score>s&&OG(l,v,uC))}const p=f.length,m=t-p;o&&m>0&&(f.push(...new Array(m).fill(0)),d.push(...new Array(m).fill(0)));const I={selectedIndices:f};return a&&(I.selectedScores=d),c&&(I.validOutputs=p),I}function BG(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),f=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),p=(o-i)*(c-a),m=(f-l)*(d-u);if(p<=0||m<=0)return 0;const I=Math.max(i,l),v=Math.max(a,u),b=Math.min(o,f),y=Math.min(c,d),S=Math.max(b-I,0)*Math.max(y-v,0);return S/(p+m-S)}function MG(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function uC(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function PG(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const i=we(n,"boxes","nonMaxSuppressionAsync"),a=we(e,"scores","nonMaxSuppressionAsync"),o=eu(i,a,t,r,s);t=o.maxOutputSize,r=o.iouThreshold,s=o.scoreThreshold;const c=await Promise.all([i.data(),a.data()]),l=c[0],u=c[1],{selectedIndices:f}=Cy(l,u,t,r,s);return i!==n&&i.dispose(),a!==e&&a.dispose(),zs(f,"int32")}const LG=PG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=we(n,"boxes","nonMaxSuppression"),o=we(e,"scores","nonMaxSuppression"),c=eu(a,o,t,r,s,i);t=c.maxOutputSize,r=c.iouThreshold,s=c.scoreThreshold,i=c.softNmsSigma;const l={boxes:a,scores:o},u={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:i},f=Fe.runKernel($b,l,u);return{selectedIndices:f[0],selectedScores:f[1]}}const zG=Pe({nonMaxSuppressionWithScore_:UG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function VG(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=0){const a=we(n,"boxes","nonMaxSuppressionAsync"),o=we(e,"scores","nonMaxSuppressionAsync"),c=eu(a,o,t,r,s,i);t=c.maxOutputSize,r=c.iouThreshold,s=c.scoreThreshold,i=c.softNmsSigma;const l=await Promise.all([a.data(),o.data()]),u=l[0],f=l[1],{selectedIndices:d,selectedScores:p}=ky(u,f,t,r,s,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:zs(d,"int32"),selectedScores:zs(p)}}const WG=VG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=we(n,"boxes","nonMaxSuppression"),o=we(e,"scores","nonMaxSuppression"),c=eu(a,o,t,r,s,null),l=c.maxOutputSize,u=c.iouThreshold,f=c.scoreThreshold,d={boxes:a,scores:o},p={maxOutputSize:l,iouThreshold:u,scoreThreshold:f,padToMaxOutputSize:i},m=Fe.runKernel(Ab,d,p);return{selectedIndices:m[0],validOutputs:m[1]}}const HG=Pe({nonMaxSuppressionPadded_:GG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qG(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,i=!1){const a=we(n,"boxes","nonMaxSuppressionAsync"),o=we(e,"scores","nonMaxSuppressionAsync"),c=eu(a,o,t,r,s,null),l=c.maxOutputSize,u=c.iouThreshold,f=c.scoreThreshold,[d,p]=await Promise.all([a.data(),o.data()]),{selectedIndices:m,validOutputs:I}=Ry(d,p,l,u,f,i);return a!==n&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:zs(m,"int32"),validOutputs:bn(I,"int32")}}const jG=qG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(n,e,t=!1,r=!1){const s=we(n,"images","resizeBilinear");ce(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),ce(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),ce(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},c={alignCorners:t,halfPixelCenters:r,size:e},l=Fe.runKernel(sm,o,c);return a?Me(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const $T=Pe({resizeBilinear_:KG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n,e,t=!1,r=!1){const s=we(n,"images","resizeNearestNeighbor");ce(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),ce(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),ce(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),ce(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=s,a=!1;s.rank===3&&(a=!0,i=Me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const o={images:i},c={alignCorners:t,halfPixelCenters:r,size:e},l=Fe.runKernel(rm,o,c);return a?Me(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const NT=Pe({resizeNearestNeighbor_:XG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(n,e="binary",t=!1,r=.5){const s=we(n,"image","threshold"),i=.2989,a=.587,o=.114,c=s.shape[0]*s.shape[1];let l=_e(zs([r]),255),u,f,d,p;if(ce(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),ce(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),ce(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),ce(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,f,d]=Gs(s,[1,1,1],-1);const v=_e(u,i),b=_e(f,a),y=_e(d,o);p=at(at(v,b),y)}else p=n;if(e==="otsu"){const v=Z8(gt(IT(p),"int32"),qE([]),256);l=ZG(v,c)}const m=t?Ql(p,l):qs(p,l);return gt(_e(m,255),"int32")}function ZG(n,e){let t=zs([-1]),r=zs([0]),s=zs([0]),i,a,o,c,l,u;for(let f=0;f<n.size-1;f++){i=$n(n,0,f+1),a=$n(n,f+1),l=$t(kt(i),e),u=$t(kt(a),e);const d=kt(_e(i,mf(0,i.size)));o=$t(d,kt(i));const p=bm(a.shape,i.size),m=at(mf(0,a.size),p),I=_e(a,m);c=$t(kt(I),kt(a));const v=Bt(o,c),b=Bt(o,c),y=_e(l,u);s=_e(_e(y,v),b);const S=qs(s,r);r=ns(S,s,r),t=ns(S,zs([f]),t)}return t}const JG=Pe({threshold_:YG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(n,e,t="nearest",r="constant",s=0,i){const a=we(n,"image","transform","float32"),o=we(e,"transforms","transform","float32");ce(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),ce(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),ce(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const c={image:a,transforms:o},l={interpolation:t,fillMode:r,fillValue:s,outputShape:i};return Fe.runKernel(Lb,c,l)}const e7=Pe({transform_:QG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t7(n,e,t){const r=we(n,"a","bandPart");ce(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[i,a]=r.shape.slice(-2);let o,c;typeof e=="number"?(ce(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),ce(e<=i,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`),o=we(e<0?i:e,"numLower","bandPart")):(ce(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=ns(Op(e,0),i,gf(e,i))),typeof t=="number"?(ce(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),ce(t<=a,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${a}).`),c=we(t<0?a:t,"numUpper","bandPart")):(ce(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=ns(Op(t,0),a,gf(t,a)));const l=Me(mf(0,i,1,"int32"),[-1,1]),u=mf(0,a,1,"int32"),f=Bt(l,u),d=Ga(Ql(f,o),Fc(f,rr(c))),p=Tr([i,a],r.dtype);return Me(ko(Ec(Me(r,[-1,i,a])).map(m=>ns(d,m,p))),s)}const n7=Pe({bandPart_:t7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(n){let e;if(Array.isArray(n)){e=!1,ce(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let i=1;i<n.length;++i)ce(n[i].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[i].shape[0]} vs. ${s})`)}else e=!0,n=Gs(n,n.shape[0],0).map(s=>Th(s,[0]));ce(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(Fe.tidy(()=>{let i=r[s];if(s>0)for(let a=0;a<s;++a){const o=_e(kt(_e(t[a],i)),t[a]);i=Bt(i,o)}return $t(i,xm(i,"euclidean"))}));return e?ko(t,0):t}const s7=Pe({gramSchmidt_:r7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n,e=!1){if(ce(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return fC(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((c,l)=>c*l),r=Ec(Me(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],i=[];r.forEach(c=>{const[l,u]=fC(c,e);s.push(l),i.push(u)});const a=Me(ko(s,0),n.shape),o=Me(ko(i,0),n.shape);return[a,o]}}function fC(n,e=!1){return Fe.tidy(()=>{ce(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=uT(t),i=gc(n);const a=A1([[1]],[1,1]);let o=gc(a);const c=t>=r?r:t;for(let l=0;l<c;++l){const u=i,f=o,d=s;[o,i,s]=Fe.tidy(()=>{const p=$n(i,[l,l],[t-l,1]),m=xm(p),I=$n(i,[l,l],[1,1]),v=ns(qs(I,0),A1([[-1]]),A1([[1]])),b=Bt(I,_e(v,m)),y=$t(p,b);y.shape[0]===1?o=gc(a):o=hs([a,$n(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const S=rr($t(mn(v,b),m)),w=$n(i,[l,0],[t-l,r]),C=_e(S,o),N=ln(o);if(l===0)i=Bt(w,mn(C,mn(N,w)));else{const M=Bt(w,mn(C,mn(N,w)));i=hs([$n(i,[0,0],[l,r]),M],0)}const E=ln(C),A=$n(s,[0,l],[t,s.shape[1]-l]);if(l===0)s=Bt(A,mn(mn(A,o),E));else{const M=Bt(A,mn(mn(A,o),E));s=hs([$n(s,[0,0],[t,l]),M],1)}return[o,i,s]}),Qt([u,f,d])}return!e&&t>r&&(s=$n(s,[0,0],[t,r]),i=$n(i,[0,0],[r,r])),[s,i]})}const a7=Pe({qr_:i7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ua={flipLeftRight:RG,grayscaleToRGB:EG,resizeNearestNeighbor:NT,resizeBilinear:$T,rotateWithOffset:AG,cropAndResize:SG,nonMaxSuppression:NG,nonMaxSuppressionAsync:LG,nonMaxSuppressionWithScore:zG,nonMaxSuppressionWithScoreAsync:WG,nonMaxSuppressionPadded:HG,nonMaxSuppressionPaddedAsync:jG,threshold:JG,transform:e7},o7={bandPart:n7,gramSchmidt:s7,qr:a7};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7=new Map,l7=new Map;class tu{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class li{constructor(){this.classNameMap={}}static getMap(){return li.instance==null&&(li.instance=new li),li.instance}static register(e){li.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function et(n,e,t){ce(n.className!=null,()=>"Class being registered does not have the static className property defined."),ce(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),ce(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const r=t,s=e+">"+r;return li.register(n),c7.set(s,n),l7.set(n,s),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Po extends tu{minimize(e,t=!1,r){const{value:s,grads:i}=this.computeGradients(e,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:i[o.name]}));this.applyGradients(a)}else this.applyGradients(i);return Qt(i),t?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return IV(e,t)}dispose(){this.iterations_!=null&&Qt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:bn(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Po,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OT extends Po{static get className(){return"Adadelta"}constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Fe.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Fe.registeredVariables[r],a=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:Ve(()=>un(i).variable(a))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:Ve(()=>un(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const c=this.accumulatedGrads[s].variable,l=this.accumulatedUpdates[s].variable;Ve(()=>{const u=at(_e(c,this.rho),_e(Dn(o),1-this.rho)),f=_e($t(rs(at(l,this.epsilon)),rs(at(c,this.epsilon))),o),d=at(_e(l,this.rho),_e(Dn(f),1-this.rho));c.assign(u),l.assign(d);const p=at(_e(f,-this.learningRate),i);i.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Qt(this.accumulatedGrads.map(e=>e.variable)),Qt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _T extends Po{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Fe.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:Ve(()=>bm(i.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const o=this.accumulatedGrads[s].variable;Ve(()=>{const c=at(o,Dn(a));o.assign(c);const l=at(_e($t(a,rs(at(c,Fe.backend.epsilon()))),-this.learningRate),i);i.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Qt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FT extends Po{static get className(){return"Adam"}constructor(e,t,r,s=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ve(()=>{this.accBeta1=bn(t).variable(),this.accBeta2=bn(r).variable()}),s==null&&(this.epsilon=Fe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ve(()=>{const r=Bt(1,this.accBeta1),s=Bt(1,this.accBeta2);t.forEach((i,a)=>{const o=Fe.registeredVariables[i],c=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:Ve(()=>un(o).variable(c))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${i}/v`,variable:Ve(()=>un(o).variable(c))});const l=Array.isArray(e)?e[a].tensor:e[i];if(l==null)return;const u=this.accumulatedFirstMoment[a].variable,f=this.accumulatedSecondMoment[a].variable,d=at(_e(u,this.beta1),_e(l,1-this.beta1)),p=at(_e(f,this.beta2),_e(Dn(l),1-this.beta2)),m=$t(d,r),I=$t(p,s);u.assign(d),f.assign(p);const v=at(_e($t(m,at(rs(I),this.epsilon)),-this.learningRate),o);o.assign(v)}),this.accBeta1.assign(_e(this.accBeta1,this.beta1)),this.accBeta2.assign(_e(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Qt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),Ve(()=>{this.accBeta1.assign(Ml(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ml(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DT extends Po{static get className(){return"Adamax"}constructor(e,t,r,s=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=s,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ve(()=>{this.iteration=bn(0).variable(),this.accBeta1=bn(t).variable()}),s==null&&(this.epsilon=Fe.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ve(()=>{const r=Bt(1,this.accBeta1),s=$t(-this.learningRate,at(_e(this.iteration,this.decay),1));t.forEach((i,a)=>{const o=Fe.registeredVariables[i],c=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${i}/m`,variable:un(o).variable(c)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${i}/v`,variable:un(o).variable(c)});const l=Array.isArray(e)?e[a].tensor:e[i];if(l==null)return;const u=this.accumulatedFirstMoment[a].variable,f=this.accumulatedWeightedInfNorm[a].variable,d=at(_e(u,this.beta1),_e(l,1-this.beta1)),p=_e(f,this.beta2),m=Jr(l),I=Mo(p,m);u.assign(d),f.assign(I);const v=at(_e($t(s,r),$t(d,at(I,this.epsilon))),o);o.assign(v)}),this.iteration.assign(at(this.iteration,1)),this.accBeta1.assign(_e(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Qt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ty extends Po{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=Fe.registeredVariables[r];Ve(()=>{const o=at(_e(this.c,i),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ma(bn(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BT extends Ty{static get className(){return"Momentum"}constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=bn(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Fe.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:Ve(()=>un(i).variable(!1))});const a=this.accumulations[s].variable,o=Array.isArray(e)?e[s].tensor:e[r];o!=null&&Ve(()=>{let c;const l=at(_e(this.m,a),o);this.useNesterov?c=at(_e(this.c,at(o,_e(l,this.m))),i):c=at(_e(this.c,l),i),a.assign(l),i.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Qt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MT extends Po{static get className(){return"RMSProp"}constructor(e,t=.9,r=0,s=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,s==null&&(this.epsilon=Fe.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const i=Fe.registeredVariables[r],a=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:Ve(()=>un(i).variable(a))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:Ve(()=>un(i).variable(a))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:Ve(()=>un(i).variable(a))});const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const c=this.accumulatedMeanSquares[s].variable,l=this.accumulatedMoments[s].variable;Ve(()=>{const u=at(_e(c,this.decay),_e(Dn(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[s].variable,d=at(_e(f,this.decay),_e(o,1-this.decay)),p=$t(_e(o,this.learningRate),rs(Bt(u,at(Dn(d),this.epsilon)))),m=at(_e(l,this.momentum),p);c.assign(u),f.assign(d),l.assign(m);const I=Bt(i,m);i.assign(I)}else{const f=at(_e(c,this.decay),_e(Dn(o),1-this.decay)),d=at(_e(l,this.momentum),$t(_e(o,this.learningRate),rs(at(f,this.epsilon))));c.assign(f),l.assign(d);const p=Bt(i,d);i.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Qt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Qt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Qt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7=[OT,_T,FT,DT,BT,MT,Ty];function f7(){for(const n of u7)et(n)}function Ay(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(Ye(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,i=s[s.length-1];let a=1;for(let f=0;f<s.length-1;++f)a*=s[f];const o=n.shape,c=s.slice();c.pop();let l=1;for(let f=i;f<t;++f)l*=o[f],c.push(o[f]);const u=[...Rt(n.shape).map(f=>f/l),1].slice(0,i);return[c,a,l,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hv=-2,h7=-1;function $y(n,e,t){const r=n.shape.length;ce(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),ce(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)ce(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function d7(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function Ny(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function PT(n,e,t,r){const s=[...n];for(let i=s.length;i<r.length;i++)s.push(1);for(let i=0;i<t;i++)i===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function LT(n,e,t){return t<=n?t:t-(e-1)}function UT(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function p7(n,e,t,r,s,i,a,o,c){const l=n.length;let u=new Array(l),f=new Array(l),d=new Array(l);if(e.length&&t>0){const p=e[0],m=t+1;u=zT(a,p,m,r,n),f=VT(o,p,m,s,n),d=PT(i,p,m,n)}else for(let p=0;p<l;p++)u[p]=GT(a,r,i,n,p,c),f[p]=HT(o,s,i,n,p,c),d[p]=WT(i,p,c);return{begin:u,end:f,strides:d}}function zT(n,e,t,r,s){const i=[...s],a=UT(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=0;else{const c=LT(e,t,o);let l=r[c];n&1<<c&&(l=0),i[o]=l}return i}function VT(n,e,t,r,s){const i=[...s],a=UT(t,e);for(let o=0;o<i.length;o++)if(a.indexOf(o)>-1)i[o]=Number.MAX_SAFE_INTEGER;else{const c=LT(e,t,o);let l=r[c];n&1<<c&&(l=Number.MAX_SAFE_INTEGER),i[o]=l}for(let o=0;o<i.length;o++){const c=s[o];i[o]<0&&(i[o]+=c),i[o]=Ic(0,i[o],s[o])}return i}function WT(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function GT(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const c=r[s];return a<0&&(a+=c),a=Ic(0,a,c-1),a}function HT(n,e,t,r,s,i){let a=e[s];const o=t[s]||1;(n&1<<s||i&1<<s||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const c=r[s];return a<0&&(a+=c),o>0?a=Ic(0,a,c):a=Ic(-1,a,c-1),a}function Oy(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function _y(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function Sm(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(a=>{ce(a!==-1,()=>"slice() does not support negative begin indexing.")});let i;return t==null?i=new Array(s).fill(-1):typeof t=="number"?i=[t,...new Array(s-1).fill(-1)]:t.length<s?i=t.concat(new Array(s-t.length).fill(-1)):i=t,i=i.map((a,o)=>a>=0?a:(ce(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),n.shape[o]-r[o])),[r,i]}function Fy(n,e,t,r,s,i,a,o,c){let l;if(r==null?(l=new Array(e.length),l.fill(1)):l=r,a!=null&&a&a-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const f={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:l.slice(),beginMask:s,endMask:i,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:c};for(let S=0;S<f.dims;S++)u&&1<<S&o&&f.numAddAxisAfterEllipsis++,1<<S&a&&(u=!0);u||(f.ellipsisMask|=1<<f.dims,f.dims++);const d={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};g7(f,d);let p=!0,m=!0,I=!0;const v=[],b=[];for(let S=0;S<n.length;++S){if(d.strides[S]===0)throw Error(`strides[${S}] must be non-zero`);const w=!!(d.shrinkAxisMask&1<<S),C=n[S];if(C===-1){v.push(w?1:-1);continue}const N=[d.beginMask&1<<S,d.endMask&1<<S],E=[d.strides[S]>0?0:-1,d.strides[S]>0?C:C-1];if(w&&d.strides[S]<=0)throw Error("only stride 1 allowed on non-range indexing.");I=I&&d.strides[S]===1;const A=!!(d.beginMask&1<<S&&d.endMask&1<<S);if(d.beginValid&&d.endValid){if(w){const re=d.begin[S]<0?C+d.begin[S]:d.begin[S];if(d.begin[S]=re,d.end[S]=d.begin[S]+1,re<0||re>=C)throw Error(`slice index ${d.begin[S]} of dimension ${S} out of bounds.`)}else d.begin[S]=hC(d.begin[S],0,d.strides[S],C,N,E),d.end[S]=hC(d.end[S],1,d.strides[S],C,N,E);const Y=d.strides[S]===1&&d.begin[S]===0&&d.end[S]===C;p=p&&Y,m=m&&(S===0&&d.strides[S]===1||Y)}else p=p&&d.strides[S]===1&&A,m=m&&(S===0&&d.strides[S]===1||A);let M,z=!1;if(d.beginValid&&d.endValid?(M=d.end[S]-d.begin[S],z=!0):w?(M=1,z=!0):A&&C>=0&&(d.strides[S]<0?M=-C:M=C,z=!0),z){let Y;M===0||M<0!=d.strides[S]<0?Y=0:Y=Math.trunc(M/d.strides[S])+(M%d.strides[S]!==0?1:0),v.push(Y)}else v.push(-1)}for(let S=0;S<d.finalShapeGatherIndices.length;++S){const w=d.finalShapeGatherIndices[S];w>=0?b.push(v[w]):w===Hv&&b.push(1)}return{finalShapeSparse:b.filter((S,w)=>d.finalShapeGatherIndices[w]!==Hv),finalShape:b,isIdentity:p,sliceDim0:m,isSimpleSlice:I,begin:d.begin,end:d.end,strides:d.strides}}function g7(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(Hv),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(h7),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function hC(n,e,t,r,s,i){if(s[e])return t>0?i[e]:i[e+1&1];{const a=n<0?r+n:n;return a<i[0]?i[0]:a>i[1]?i[1]:a}}const m7=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:$y,computeFlatOffset:_y,computeOutShape:Ny,getNormalizedAxes:p7,isSliceContinous:Oy,maskToAxes:d7,parseSliceParams:Sm,sliceInfo:Fy,startForAxis:GT,startIndicesWithElidedDims:zT,stopForAxis:HT,stopIndicesWithElidedDims:VT,stridesForAxis:WT,stridesWithElidedDims:PT},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v7{static sgd(e){return new Ty(e)}static momentum(e,t,r=!1){return new BT(e,t,r)}static rmsprop(e,t=.9,r=0,s=null,i=!1){return new MT(e,t,r,s,i)}static adam(e=.001,t=.9,r=.999,s=null){return new FT(e,t,r,s)}static adadelta(e=.001,t=.95,r=null){return new OT(e,t,r)}static adamax(e=.002,t=.9,r=.999,s=null,i=0){return new DT(e,t,r,s,i)}static adagrad(e,t=.1){return new _T(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fl=v7;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n())();function qT(){return new Promise(n=>I7(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dy(n,e){const t=n[0].length;n.forEach((s,i)=>{ce(s.length===t,()=>`Error in concat${t}D: rank of tensors[${i}] must be the same as the rank of the rest (${t})`)}),ce(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,i)=>{for(let a=0;a<t;a++)ce(a===e||s[a]===r[a],()=>`Error in concat${t}D: Shape of tensors[${i}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function va(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mi;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Mi||(Mi={}));function jT(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const i=t[s],a=r[r.length-t.length+s],o=r[a];if(i>=0)if(o>=0){if(o!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${i} but shape[${s+n}] = ${o}`)}else r[a]=i}return r}function KT(n){const e={FIRST_DIM_SIZE:Mi.FIRST_DIM_SIZE,VALUE_ROWIDS:Mi.VALUE_ROWIDS,ROW_LENGTHS:Mi.ROW_LENGTHS,ROW_SPLITS:Mi.ROW_SPLITS,ROW_LIMITS:Mi.ROW_LIMITS,ROW_STARTS:Mi.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function XT(n){return n.length===0?0:n[0]===Mi.FIRST_DIM_SIZE?n.length-1:n.length}function YT(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const i=n[s],a=e[s+1];if(i>=0&&a>=0&&i!==1&&i!==a)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${i} but ragged tensor input.flatValues.shape[${s-n.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const By=30;function Cm(n){return n<=By?n:Ev(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function My(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $h(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const i=e.length;for(let a=0;a<i;++a)s=s.concat([n[a+1]/e[a],e[a]]);s=s.concat(n.slice(i+1))}return s}function Nh(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],i=[];for(let a=1;a<n;++a)a>=e*2+1||a%2===1?i.push(a):s.push(a);r.push(...s),r.push(0),r.push(...i)}return r}function Oh(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let i=1;i<n.length;++i)i<=e.length?r?s.push(e[i-1]*n[i]):s.push(n[i]/e[i-1]):s.push(n[i]);return s}function Py(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function Ly(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rm=1.7580993408473768,km=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uy=.3275911,zy=.254829592,Vy=-.284496736,Wy=1.421413741,Gy=-1.453152027,Hy=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function ZT(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function JT(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function QT(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function qy(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function eA(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function tA(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const i=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(i),r[s]=Math.sin(i)}return{real:t,imag:r}}function nA(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),i=Math.sin(r);return{real:s,imag:i}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1="->",b7=/->/g,dC=",",pC="...";function jy(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(b7,"").length)/$1.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${$1}").`);const[r,s]=n.split($1);ce(r.indexOf(pC)===-1,()=>`The ellipsis notation ("${pC}") is not supported yet.`);const i=r.split(dC),a=i.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let d=0;d<s.length;++d){const p=s[d];if(!i.some(m=>m.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);o.indexOf(p)===-1&&o.push(p)}for(let d=0;d<r.length;++d){const p=r[d];o.indexOf(p)===-1&&p!==dC&&o.push(p)}const c=new Array(i.length);for(let d=0;d<a;++d){if(new Set(i[d].split("")).size!==i[d].length)throw new Error(`Found duplicate axes in input component ${i[d]}. Support for duplicate axes in input is not implemented yet.`);c[d]=[];for(let p=0;p<i[d].length;++p)c[d].push(o.indexOf(i[d][p]))}const l=o.length,u=s.length,f=[];for(let d=u;d<l;++d)f.push(d);return{allDims:o,summedDims:f,idDims:c}}function Ky(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function Xy(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const i=t[s].shape;for(let a=0;a<e[s].length;++a)r[e[s][a]]===void 0?r[e[s][a]]=i[a]:ce(r[e[s][a]]===i[a],()=>`Expected dimension ${r[e[s][a]]} at axis ${a} of input shaped ${JSON.stringify(i)}, but got dimension ${i[a]}`)}}function Yy(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let a=0;a<s;++a)r.push([]);const i=[];for(let a=0;a<t.length;++a){const o=t[a],c=y7(e,o);for(const l of c)i.indexOf(l)===-1&&(r[a].push(l),i.push(l))}return{path:t,steps:r}}function Zy(n){return n.every((e,t)=>e===t)}function y7(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function Jy(n,e,t=0){let r=[];if(typeof e=="number")ce(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);ce(s<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const a=e.reduce((o,c)=>c>0?o+c:o);e[i]=n.shape[t]-a}ce(n.shape[t]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function sA(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function iA(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aA(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function oA(n,e){return`size ${n} must be non-negative, not ${e}`}function cA(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function lA(n,e){const t=Ye(n),r=Ye(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function uA(n,e){const t=Ye(n),r=Ye(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qv(){return"segment ids must be >= 0"}function fA(){return"segment ids are not increasing"}function hA(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function dA(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pA(n,e){let t=!1,r;for(n<=By?(r=n,t=!0):r=Ev(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=Ev(n,r+1);return r}function gA(n,e,t){const r=[],s=n.length;for(let i=0;i<s;i++)i!==e?r.push(n[i]):r.push(t);return r}function Qy(n,e,t,r){const s=e.shape.length,i=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let f=0;f<r;++f)if(n.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const a=n.shape[t],o=[];let c=1,l=1,u=1;for(let f=0;f<r;++f)o.push(n.shape[f]),c*=n.shape[f];for(let f=r;f<t;f++)o.push(n.shape[f]),l*=n.shape[f];for(let f=r;f<s;f++)o.push(e.shape[f]);for(let f=t+1;f<i;f++)o.push(n.shape[f]),u*=n.shape[f];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:a,outputShape:o}}const x7=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Qy,computeOutShape:gA,segOpComputeOptimalWindowSize:pA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qa(n){try{return n.map(e=>Ro(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function mA(n){return n.map(e=>yo(e))}const w7=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:zy,ERF_A2:Vy,ERF_A3:Wy,ERF_A4:Gy,ERF_A5:Hy,ERF_P:Uy,PARALLELIZE_THRESHOLD:By,get RowPartitionType(){return Mi},SELU_SCALE:km,SELU_SCALEALPHA:Rm,applyActivation:wy,assertAndGetBroadcastShape:Ut,assertAxesAreInnerMostDims:Ur,assertParamsConsistent:Dy,assignToTypedArray:eA,axesAreInnerMostDims:Jb,calculateShapes:Pc,checkEinsumDimSizes:Xy,checkPadOnDimRoundingMode:gs,combineLocations:cT,combineRaggedTensorToTensorShapes:jT,complexWithEvenIndex:JT,complexWithOddIndex:QT,computeConv2DInfo:Lr,computeConv3DInfo:Do,computeDefaultPad:Hb,computeDilation2DInfo:Rh,computeOptimalWindowSize:Cm,computeOutAndReduceShapes:$r,computeOutShape:va,computePool2DInfo:xi,computePool3DInfo:Xa,convertConv2DDataFormat:Ya,decodeEinsumEquation:jy,eitherStridesOrDilationsAreOne:jr,expandShapeToKeepDim:mr,exponent:nA,exponents:tA,fromStringArrayToUint8:mA,fromUint8ToStringArray:qa,getAxesPermutation:Kn,getBroadcastDims:Bl,getComplexWithIndex:qy,getEinsumComputePath:Yy,getEinsumPermutation:Ky,getFusedBiasGradient:xy,getFusedDyActivation:yy,getImageCenter:My,getInnerMostAxes:ir,getPermuted:Nh,getRaggedRank:XT,getReductionAxes:wr,getReshaped:$h,getReshapedPermuted:Oh,getRowPartitionTypesHelper:KT,getSliceBeginCoords:Py,getSliceSize:Ly,getSparseFillEmptyRowsIndicesDenseShapeMismatch:rA,getSparseFillEmptyRowsNegativeIndexErrorMessage:sA,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:iA,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:cA,getSparseReshapeInputOutputMismatchErrorMessage:uA,getSparseReshapeInputOutputMultipleErrorMessage:lA,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:aA,getSparseReshapeNegativeOutputDimErrorMessage:oA,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:dA,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:qv,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:fA,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:hA,getUndoAxesPermutation:Bo,isIdentityPermutation:Zy,log:aU,mergeRealAndImagArrays:Ha,prepareAndValidate:Ay,prepareSplitSize:Jy,segment_util:x7,shouldFuse:Sy,slice_util:m7,splitRealAndImagArrays:ZT,stridesOrDilationsArePositive:Cc,tupleValuesAreOne:Sc,upcastType:Ts,validateDefaultValueShape:YT,validateInput:tG,validateUpdateShape:kT,warn:Ls},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */f7();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vA={kernelName:gg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,Ah(gt(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={kernelName:$f,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=Dn(gt(t,"float32")),s=rs(Bt(bn(1),r));return rr($t(n,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7={kernelName:Nf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=rs(Bt(Dn(gt(t,"float32")),1));return $t(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7={kernelName:Yl,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{let o=n;const c=wr(t.shape,s);return c.length>0&&(o=kt(o,c)),Me(o,t.shape)},b:()=>{let o=n;const c=wr(r.shape,s);return c.length>0&&(o=kt(o,c)),Me(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k7={kernelName:nb,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((r,s)=>{t[s]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7={kernelName:mg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>un(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7={kernelName:vg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>un(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A7={kernelName:Of,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,rs(Bt(bn(1),Dn(gt(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7={kernelName:_f,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=rs(at(bn(1),Dn(gt(t,"float32"))));return $t(n,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7={kernelName:Bf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{const o=at(Dn(t),Dn(r));let c=_e(n,$t(r,o));const l=wr(t.shape,s);return l.length>0&&(c=kt(c,l)),Me(c,t.shape)},b:()=>{const o=at(Dn(t),Dn(r));let c=rr(_e(n,$t(t,o)));const l=wr(r.shape,s);return l.length>0&&(c=kt(c,l)),Me(c,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7={kernelName:Ff,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,at(Dn(gt(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7={kernelName:Df,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,Bt(bn(1),Dn(gt(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(n,e,t,r,s,i){const a=we(n,"dy","avgPool3dGrad"),o=we(e,"input","avgPool3dGrad");let c=a,l=o,u=!1;o.rank===4&&(u=!0,c=Me(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),l=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ce(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),ce(l.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`),gs("avgPool3dGrad",s,i);const f={dy:c,input:l},d={filterSize:t,strides:r,pad:s,dimRoundingMode:i},p=Fe.runKernel(ab,f,d);return u?Me(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const D7=Pe({avgPool3dGrad_:F7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B7={kernelName:bg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:a,dimRoundingMode:o}=t;return{x:()=>D7(n,r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n,e,t,r,s){const i=we(n,"dy","avgPoolGrad"),a=we(e,"input","avgPoolGrad");ce(a.rank===i.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${i.rank})`);let o=a,c=i,l=!1;a.rank===3&&(l=!0,o=Me(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=Me(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ce(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),ce(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const u={dy:c,input:o},f={filterSize:t,strides:r,pad:s},d=Fe.runKernel(ib,u,f);return l?Me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const P7=Pe({avgPoolGrad_:M7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7={kernelName:Ig,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{filterSize:s,strides:i,pad:a}=t;return{x:()=>P7(n,r,s,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7={kernelName:yg,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[r,s]=e,{transposeA:i,transposeB:a}=t;return!i&&!a?{a:()=>mn(n,s,!1,!0),b:()=>mn(r,n,!0,!1)}:!i&&a?{a:()=>mn(n,s,!1,!1),b:()=>mn(n,r,!0,!1)}:i&&!a?{a:()=>mn(s,n,!1,!0),b:()=>mn(r,n,!1,!1)}:{a:()=>mn(s,n,!0,!0),b:()=>mn(n,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7={kernelName:xg,gradFunc:(n,e,t)=>{const{blockShape:r,crops:s}=t;return{x:()=>ay(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7={kernelName:nU,gradFunc:(n,e,t)=>{const r=t,s=r.inputShape,i=r.shape,a=Array.from(i);for(let c=s.length-1;c>=0;c--)if(s[c]===i[c])a[c]=1;else if(s[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${i}].`);const o=[];for(let c=0;c<a.length;c++)a[c]>1&&o.push(c);return{x:()=>kt(n,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:Mf,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7={kernelName:Pf,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H7={kernelName:Lf,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{clipValueMin:s,clipValueMax:i}=t;return{x:()=>ns(Ga(Fc(r,s),Ql(r,i)),n,un(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7={kernelName:wg,inputsToSave:["x"],gradFunc:vA.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7={kernelName:Sg,saveAllInputs:!0,gradFunc:(n,e,t)=>{const r=e.map(c=>c.shape),{axis:s}=t,i=Yt(s,e[0].shape)[0],a=r.map(c=>c[i]);return Gs(n,a,i).map(c=>()=>c)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K7={kernelName:Cg,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{dilations:i,strides:a,pad:o,dataFormat:c}=t;return ce(Sc(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>Xb(r.shape,n,s,a,o,c),filter:()=>by(r,n,s.shape,a,o,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X7={kernelName:Rg,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,{strides:i,pad:a,dataFormat:o,dimRoundingMode:c}=t;return{dy:()=>Rc(n,s,i,a,o,1,c),filter:()=>by(n,r,s.shape,i,a,o,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(n,e,t,r,s){let i=n;n.rank===4&&(i=Me(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let a=e;a.rank===4&&(a=Me(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),ce(i.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${i.shape}.`),ce(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),ce(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),ce(i.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${t[3]}.`),ce(a.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${t[4]}).`);const o={x:i,dy:a},c={strides:r,pad:s,filterShape:t};return Fe.runKernel(fb,o,c)}const Z7=Pe({conv3DBackpropFilter_:Y7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7={kernelName:kg,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i}=t;ce(Sc(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=e;return{x:()=>iT(a.shape,n,o,s,i),filter:()=>Z7(a,n,o.shape,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7={kernelName:Uf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(rr(wT(gt(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eH={kernelName:zf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(ST(gt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tH={kernelName:Eg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s,exclusive:i,reverse:a}=t;return{x:()=>{const o=Kn([s],r.rank);let c=oT(n,s,i,!a);return o!=null&&(c=ln(c,o)),c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nH={kernelName:Tg,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:r,strides:s,pad:i,dimRoundingMode:a}=t,o=r??[1,1];ce(Sc(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[c,l]=e;return ce(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),ce(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),ce(c.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),ce(jr(s,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${o}'.`),gs("depthwiseConv2d",i,a),{x:()=>yG(c.shape,n,l,s,i,o,a),filter:()=>IG(c,n,l.shape,s,i,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rH={kernelName:Ag,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[r,s]=e,i={x:r,filter:s,dy:n},a={x:r,filter:s,dy:n};return{x:()=>Fe.runKernel(Tv,i,t),filter:()=>Fe.runKernel(Av,a,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sH={kernelName:Wf,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,r={dy:n,y:t};return{x:()=>Fe.runKernel(bb,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iH={kernelName:Gf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=_e(Wa(rr(Dn(t))),2/Math.sqrt(Math.PI));return{x:()=>_e(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aH={kernelName:Hf,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oH={kernelName:Ng,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>Me(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cH={kernelName:qf,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,Wa(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lH={kernelName:jf,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uH={kernelName:Kf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{const o=$t(n,gt(r,"float32")),c=wr(t.shape,s);return c.length>0?Me(kt(o,c),t.shape):o},b:()=>{let o=_e(n,gt(t,"float32"));const c=wr(r.shape,s);c.length>0&&(o=Me(kt(o,c),r.shape));const l=Dn(r);return rr($t(o,gt(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fH={kernelName:Og,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:r}=t,[s,i,a,o]=e,c=o??bn(1),l=wr(i.shape,s.shape),u=[];if(i.rank===1){for(let w=0;w<s.shape.length-1;++w)u.push(s.shape[w]);u.push(1)}const f=Bt(s,i),d=_e(n,c),p=bT(at(a,bn(r))),m=_e(_e(_e(p,p),p),bn(-.5));return{x:()=>i.rank===1?Me(_e(_e(n,Pi(Me(p,[1,1,1,i.shape[0]]),u)),c),s.shape):Me(_e(_e(n,p),c),s.shape),mean:()=>{let w=_e(_e(p,bn(-1)),d);return i.rank===1&&(w=kt(w,l)),Me(w,i.shape)},variance:()=>{let w=_e(_e(m,f),d);return i.rank===1&&(w=kt(w,l)),Me(w,i.shape)},scale:()=>{const w=_e(f,p);let C=_e(n,w);return i.rank===1&&(C=kt(C,l)),Me(C,i.shape)},offset:()=>{let w=n;return i.rank===1&&(w=kt(w,l)),Me(w,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hH={kernelName:_g,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[r,s]=e,{axis:i}=t,a=Yt(i,r.shape)[0];return{x:()=>{const c=r.shape,l=s.size,u=c.slice(0,a),f=u.length,d=c.slice(i,c.length).slice(1),p=d.length,m=gC(0,f),I=gC(f+1,f+1+p),v=mC([u,[l],d]),b=Me(n,v),y=Me(s,[l]),S=mC([[f],m,I]),w=ln(b,S);let C=TT(w,y,r.shape[a]);const N=Bo(S);return C=ln(C,N),C},indices:()=>s}}};function gC(n,e){const t=[];for(let r=n;r<e;++r)t.push(r);return t}function mC(n){const e=[];for(let t=0;t<n.length;++t)for(let r=0;r<n[t].length;++r)e.push(n[t][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dH={kernelName:Xf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>un(t),b:()=>un(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH={kernelName:Yf,gradFunc:n=>({x:()=>gt(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gH={kernelName:Zf,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mH={kernelName:Jf,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vH={kernelName:Qf,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IH={kernelName:Dg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{alpha:s}=t,i=qs(r,0);return{x:()=>ns(i,n,_e(n,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bH={kernelName:th,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,at(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH={kernelName:eh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,gt(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xH={kernelName:sU,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;return{logits:()=>{const a=Wa(r);return Bt(n,_e(kt(n,s,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(n,e,t,r=5,s=1,i=1,a=.5){const o={x:n,y:e,dy:t},c={depthRadius:r,bias:s,alpha:i,beta:a};return Fe.runKernel(Rb,o,c)}const SH=Pe({localResponseNormalizationBackprop_:wH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CH={kernelName:zg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{depthRadius:i,bias:a,alpha:o,beta:c}=t;return{x:()=>SH(r,s,n,i,a,o,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IA(n,e,t,r){return e.rank<t.rank&&(e=Me(e,mr(e.shape,r))),n.rank<t.rank&&(n=Me(n,mr(n.shape,r))),{x:()=>_e(n,gt(ya(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vC={kernelName:Vg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{reductionIndices:s}=r,i=e[0],a=e[1],o=Yt(s,i.shape),c=IA(n,a,i,o);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH={kernelName:nh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>_e(n,gt(Fc(t,r),"float32")),b:()=>_e(n,gt(Op(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(n,e,t,r,s,i,a){const o=we(n,"dy","maxPool3dGrad"),c=we(e,"input","maxPool3dGrad"),l=we(t,"output","maxPool3dGrad");let u=o,f=c,d=l,p=!1;c.rank===4&&(p=!0,u=Me(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),f=Me(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=Me(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),ce(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),ce(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),ce(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),gs("maxPool3dGrad",i,a);const m={dy:u,input:f,output:d},I={filterSize:r,strides:s,pad:i,dimRoundingMode:a},v=Fe.runKernel(Eb,m,I);return p?Me(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const EH=Pe({maxPool3dGrad_:kH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TH={kernelName:Gg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:c}=t;return{x:()=>EH(n,r,s,i,a,o,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n,e,t,r,s,i,a){const o=we(n,"dy","maxPoolGrad"),c=we(e,"input","maxPoolGrad"),l=we(t,"output","maxPoolGrad");ce(c.rank===o.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${o.rank})`),ce(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),ce(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),gs("maxPoolGrad",i,a);const u={dy:o,input:c,output:l},f={filterSize:r,strides:s,pad:i,dimRoundingMode:a};return Fe.runKernel(kb,u,f)}const $H=Pe({maxPoolGrad_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NH={kernelName:Wg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r,s]=e,{filterSize:i,strides:a,pad:o}=t;return{x:()=>$H(n,r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OH={kernelName:Hg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t,i=Yt(s,r.shape),o=$r(r.shape,i)[1],c=Ye(o);return{x:()=>{const u=r.shape.slice();i.forEach(p=>{u[p]=1});const f=Me(n,u);return $t(_e(f,Dc(r.shape,"float32")),c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H={kernelName:qg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const r=t,{axis:s}=r,[i,a]=e,o=Yt(s,i.shape),c=IA(n,a,i,o);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH={kernelName:rh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e;return{a:()=>_e(n,gt(Ql(t,r),"float32")),b:()=>_e(n,gt(qs(t,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DH={kernelName:jg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(a=>a[0]);return{x:()=>$n(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BH={kernelName:sh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{const o=wr(t.shape,s);return o.length>0?Me(kt(n,o),t.shape):n},b:()=>{const o=_e(n,rr(wm($t(t,r)))),c=wr(r.shape,s);return c.length>0?Me(kt(o,c),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH={kernelName:ih,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{const o=_e(n,gt(r,"float32")),c=wr(t.shape,s);return c.length>0?Me(kt(o,c),t.shape):o},b:()=>{const o=_e(n,gt(t,"float32")),c=wr(r.shape,s);return c.length>0?Me(kt(o,c),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH={kernelName:Kg,gradFunc:n=>({x:()=>rr(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LH={kernelName:Zg,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>Tr(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UH={kernelName:Yg,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH={kernelName:Jg,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:r}=t;return Ec(n,r).map(i=>()=>i)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IC={kernelName:Qg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const r=e[0],{paddings:s}=t,i=s.map(a=>a[0]);return{x:()=>$n(n,i,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VH={kernelName:ah,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,r,s]=e,i=t,a=r,o=Ut(i.shape,a.shape);return{a:()=>{const u=gt(a,"float32");let f=_e(n,_e(u,Ml(i,Bt(u,bn(1)))));const d=wr(i.shape,o);return d.length>0&&(f=kt(f,d)),Me(f,i.shape)},b:()=>{const u=qs(i,0),f=ns(u,xa(i),un(i));let d=_e(n,_e(s,f));const p=wr(a.shape,o);return p.length>0&&(d=kt(d,p)),Me(d,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH={kernelName:em,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,r]=e,s=qs(t,0);return{x:()=>ns(s,n,_e(n,r)),alpha:()=>{let i=ns(s,un(n),_e(n,t));const a=wr(r.shape,n.shape);return a.length>0&&(i=kt(i,a)),Me(i,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(n,e,t){const r=n.shape.slice();r[t]=1;const s=Me(e,r),i=Wv(n,t,!0,!1),a=Wv(n,t,!0,!0),o=_e(i,a);return _e(s,o)}function HH(n,e,t){const r=n.shape.length,s=r-t.length,i=Kn(t,r);let a=n;i!=null&&(a=ln(n,i));const o=a.shape.slice(),l=o.splice(r-t.length,t.length).reduce((d,p)=>d*p,1);o.push(l);const u=a.reshape(o);let f=GH(u,e,s);if(f=f.reshape(a.shape),i!=null){const d=Bo(i);f=ln(f,d)}return f}const qH={kernelName:tm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{axis:s}=t;let i=[];return s==null?i=r.shape.map((a,o)=>o):typeof s=="number"?i=[s]:i=s,{x:()=>HH(r,n,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jH={kernelName:Vf,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{const o=$t(n,gt(r,"float32")),c=wr(t.shape,s);return c.length>0?Me(kt(o,c),t.shape):o},b:()=>{let o=_e(n,gt(t,"float32"));const c=wr(r.shape,s);c.length>0&&(o=Me(kt(o,c),r.shape));const l=Dn(r);return rr($t(o,gt(l,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH={kernelName:oh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,rr(Dn(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XH={kernelName:lh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,r=_e(Ql(t,6),Ah(t));return{x:()=>_e(n,gt(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH={kernelName:ch,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,gt(Ah(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH={kernelName:nm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Me(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH={kernelName:sm,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>Fe.runKernel(Fb,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QH={kernelName:rm,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[r]=e,s={dy:n,images:r};return{images:()=>Fe.runKernel(_b,s,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e9={kernelName:im,gradFunc:(n,e,t)=>{const{dims:r}=t,s=Yt(r,n.shape);return{x:()=>kc(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t9={kernelName:uh,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n9={kernelName:fh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>rr($t(n,_e(Ml(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r9={kernelName:am,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>gt(un(t),"float32"),t:()=>_e(n,gt(t,n.dtype)),e:()=>_e(n,gt(ny(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9={kernelName:hh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const r=qs(t,bn(0)),s=bn(Rm),i=bn(km),a=_e(n,i),o=_e(_e(n,s),Wa(gt(t,"float32")));return ns(r,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9={kernelName:mh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,_e(t,Bt(bn(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9={kernelName:gh,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9={kernelName:dh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(Yb(gt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c9={kernelName:ph,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(aT(gt(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9={kernelName:om,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{begin:s,size:i}=t,a=r.shape,[o,c]=Sm(r,s,i),l=[];for(let u=0;u<n.rank;u++)l.push([o[u],a[u]-o[u]-c[u]]);return{x:()=>iy(n,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9={kernelName:fm,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[r]=e,{dim:s}=t,i=!0,a=_e(n,r);return{logits:()=>Bt(a,_e(kt(a,[s],i),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f9={kernelName:vh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,Jl(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bC={kernelName:lm,gradFunc:(n,e,t)=>{const{blockShape:r,paddings:s}=t;return{x:()=>Kb(n,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yC={kernelName:um,gradFunc:(n,e,t)=>{const{axis:r}=t;return{x:()=>hs(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9={kernelName:Ih,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,_e(rs(gt(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d9={kernelName:Db,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(n,_e(gt(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p9={kernelName:bh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=bn(2);return{a:()=>_e(n,_e(s,Bt(t,r))),b:()=>_e(n,_e(s,Bt(r,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g9={kernelName:Ch,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m9={kernelName:yh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,r]=e,s=Ut(t.shape,r.shape);return{a:()=>{let o=n;const c=wr(t.shape,s);return c.length>0&&(o=kt(o,c)),Me(o,t.shape)},b:()=>{let o=n;const c=wr(r.shape,s);return c.length>0&&(o=kt(o,c)),Me(rr(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v9={kernelName:cm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,s=r.shape.slice(),{axis:i}=t;Yt(i,r.shape).forEach(l=>{s[l]=1});const o=Me(n,s),c=_e(o,Dc(r.shape,"float32"));return{x:()=>c}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I9={kernelName:xh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>$t(n,Dn(Yb(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b9={kernelName:wh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>_e(Bt(bn(1),Dn(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y9={kernelName:Sh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[r]=e,{reps:s}=t;return{x:()=>{let a=un(r);if(r.rank===1)for(let o=0;o<s[0];++o)a=at(a,$n(n,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<s[0];++o)for(let c=0;c<s[1];++c)a=at(a,$n(n,[o*r.shape[0],c*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<s[0];++o)for(let c=0;c<s[1];++c)for(let l=0;l<s[2];++l)a=at(a,$n(n,[o*r.shape[0],c*r.shape[1],l*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<s[0];++o)for(let c=0;c<s[1];++c)for(let l=0;l<s[2];++l)for(let u=0;u<s[3];++u)a=at(a,$n(n,[o*r.shape[0],c*r.shape[1],l*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x9={kernelName:El,gradFunc:(n,e,t)=>{const r=t,{perm:s}=r,i=Bo(s);return{x:()=>ln(n,i)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w9={kernelName:hm,gradFunc:(n,e,t)=>{const r=t,{axis:s}=r;return{value:()=>ko(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S9={kernelName:dm,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>C9(n,t)}}};function C9(n,e){const t=Mo(e,un(e)),r=Qb(n,t);let s=Fc(e,bn(0,"int32"));const i=r.rank-s.rank;for(let o=0;o<i;++o)s=Cs(s,o+1);s=Ga(s,Dc(r.shape,"bool"));const a=un(r);return ns(s,r,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R9={kernelName:pm,gradFunc:n=>({x:()=>un(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k9=[vA,S7,C7,R7,k7,E7,T7,A7,$7,N7,O7,_7,B7,L7,U7,z7,V7,W7,G7,H7,q7,j7,X7,K7,J7,Q7,eH,tH,nH,rH,jH,sH,iH,aH,oH,cH,uH,lH,fH,hH,dH,pH,gH,mH,vH,IH,bH,yH,xH,CH,vC,vC,RH,TH,NH,OH,_H,FH,DH,BH,MH,PH,LH,UH,zH,IC,IC,VH,WH,qH,KH,XH,YH,ZH,JH,QH,e9,t9,n9,r9,s9,i9,a9,o9,c9,l9,u9,f9,bC,bC,yC,yC,h9,p9,d9,g9,m9,v9,I9,b9,y9,x9,w9,S9,R9];for(const n of k9)oU(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.abs=function(){return this.throwIfDisposed(),Jr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.acos=function(){return this.throwIfDisposed(),u8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.acosh=function(){return this.throwIfDisposed(),h8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.add=function(n){return this.throwIfDisposed(),at(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.all=function(n,e){return this.throwIfDisposed(),nT(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.any=function(n,e){return this.throwIfDisposed(),zv(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.argMax=function(n){return this.throwIfDisposed(),wc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.argMin=function(n){return this.throwIfDisposed(),v8(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.asScalar=function(){return this.throwIfDisposed(),ce(this.size===1,()=>"The array must have only 1 element."),Me(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.asType=function(n){return this.throwIfDisposed(),gt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.as1D=function(){return this.throwIfDisposed(),Me(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.as2D=function(n,e){return this.throwIfDisposed(),Me(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),Me(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.as4D=function(n,e,t,r){return this.throwIfDisposed(),Me(this,[n,e,t,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.as5D=function(n,e,t,r,s){return this.throwIfDisposed(),Me(this,[n,e,t,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.asin=function(){return this.throwIfDisposed(),b8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.asinh=function(){return this.throwIfDisposed(),x8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.atan=function(){return this.throwIfDisposed(),S8(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.atan2=function(n){return this.throwIfDisposed(),R8(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.atanh=function(){return this.throwIfDisposed(),E8(this)};Ke().prototype.avgPool=function(n,e,t,r){return this.throwIfDisposed(),qb(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),Kb(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.batchNorm=function(n,e,t,r,s){return this.throwIfDisposed(),Im(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.broadcastTo=function(n){return this.throwIfDisposed(),cf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.cast=function(n){return this.throwIfDisposed(),gt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.ceil=function(){return this.throwIfDisposed(),ez(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),Hs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof dr&&(n=[n]),hs([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.conv1d=function(n,e,t,r,s,i){return this.throwIfDisposed(),rT(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.conv2dTranspose=function(n,e,t,r,s){return this.throwIfDisposed(),sT(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.conv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),Rc(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.cos=function(){return this.throwIfDisposed(),Yb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.cosh=function(){return this.throwIfDisposed(),aT(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),Wv(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),oT(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),Rz(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.depthwiseConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),Zb(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.dilation2d=function(n,e,t,r,s){return this.throwIfDisposed(),Tz(this,n,e,t,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.divNoNan=function(n){return this.throwIfDisposed(),_z(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.div=function(n){return this.throwIfDisposed(),$t(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.dot=function(n){return this.throwIfDisposed(),Dz(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.elu=function(){return this.throwIfDisposed(),ym(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.equal=function(n){return this.throwIfDisposed(),ya(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.erf=function(){return this.throwIfDisposed(),Pz(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),jz(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.exp=function(){return this.throwIfDisposed(),Wa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.expandDims=function(n){return this.throwIfDisposed(),Cs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.expm1=function(){return this.throwIfDisposed(),Zz(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.fft=function(){return this.throwIfDisposed(),RT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.flatten=function(){return this.throwIfDisposed(),Me(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.floor=function(){return this.throwIfDisposed(),wm(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.floorDiv=function(n){return this.throwIfDisposed(),tT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.gather=function(n,e,t){return this.throwIfDisposed(),Qb(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Fc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.greater=function(n){return this.throwIfDisposed(),qs(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.ifft=function(){return this.throwIfDisposed(),Gv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.irfft=function(){return this.throwIfDisposed(),VW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.isFinite=function(){return this.throwIfDisposed(),aV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.isInf=function(){return this.throwIfDisposed(),cV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.isNaN=function(){return this.throwIfDisposed(),uV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.leakyRelu=function(n){return this.throwIfDisposed(),ty(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.lessEqual=function(n){return this.throwIfDisposed(),Ql(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.less=function(n){return this.throwIfDisposed(),Op(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.localResponseNormalization=function(n,e,t,r){return this.throwIfDisposed(),gV(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logSigmoid=function(){return this.throwIfDisposed(),wV(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logSoftmax=function(n){return this.throwIfDisposed(),hT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),kV(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.log=function(){return this.throwIfDisposed(),xa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.log1p=function(){return this.throwIfDisposed(),fT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logicalAnd=function(n){return this.throwIfDisposed(),Ga(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logicalNot=function(){return this.throwIfDisposed(),ny(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logicalOr=function(n){return this.throwIfDisposed(),dT(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.logicalXor=function(n){return this.throwIfDisposed(),NV(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),mn(this,n,e,t)};Ke().prototype.maxPool=function(n,e,t,r){return this.throwIfDisposed(),ry(this,n,e,t,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.max=function(n,e){return this.throwIfDisposed(),Ui(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.maximum=function(n){return this.throwIfDisposed(),Mo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.mean=function(n,e){return this.throwIfDisposed(),gr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.min=function(n,e){return this.throwIfDisposed(),Np(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.minimum=function(n){return this.throwIfDisposed(),gf(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),LV(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.mod=function(n){return this.throwIfDisposed(),zV(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.mul=function(n){return this.throwIfDisposed(),_e(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.neg=function(){return this.throwIfDisposed(),rr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.norm=function(n,e,t){return this.throwIfDisposed(),xm(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.notEqual=function(n){return this.throwIfDisposed(),_p(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),pT(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.onesLike=function(){return this.throwIfDisposed(),Ii(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.pad=function(n,e){return this.throwIfDisposed(),iy(this,n,e)};Ke().prototype.pool=function(n,e,t,r,s,i){return this.throwIfDisposed(),ZV(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.pow=function(n){return this.throwIfDisposed(),Ml(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.prelu=function(n){return this.throwIfDisposed(),oy(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.prod=function(n,e){return this.throwIfDisposed(),eW(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.reciprocal=function(){return this.throwIfDisposed(),wW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.relu=function(){return this.throwIfDisposed(),Mc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.relu6=function(){return this.throwIfDisposed(),vT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.reshapeAs=function(n){return this.throwIfDisposed(),Me(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.reshape=function(n){return this.throwIfDisposed(),Me(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),$T(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),NT(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.reverse=function(n){return this.throwIfDisposed(),kc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.rfft=function(){return this.throwIfDisposed(),HW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.round=function(){return this.throwIfDisposed(),IT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.rsqrt=function(){return this.throwIfDisposed(),bT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.selu=function(){return this.throwIfDisposed(),yT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.separableConv2d=function(n,e,t,r,s,i){return this.throwIfDisposed(),xT(this,n,e,t,r,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sigmoid=function(){return this.throwIfDisposed(),Jl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sign=function(){return this.throwIfDisposed(),NW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sin=function(){return this.throwIfDisposed(),wT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sinh=function(){return this.throwIfDisposed(),ST(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.slice=function(n,e){return this.throwIfDisposed(),$n(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.softmax=function(n){return this.throwIfDisposed(),Iy(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.softplus=function(){return this.throwIfDisposed(),kh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),ay(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.split=function(n,e){return this.throwIfDisposed(),Gs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sqrt=function(){return this.throwIfDisposed(),rs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.square=function(){return this.throwIfDisposed(),Dn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.squaredDifference=function(n){return this.throwIfDisposed(),jW(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.squeeze=function(n){return this.throwIfDisposed(),Th(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof dr?[this,n]:[this,...n];return ko(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.step=function(n){return this.throwIfDisposed(),Ah(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.stridedSlice=function(n,e,t,r,s,i,a,o){return this.throwIfDisposed(),JW(this,n,e,t,r,s,i,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sub=function(n){return this.throwIfDisposed(),Bt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.sum=function(n,e){return this.throwIfDisposed(),kt(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.tan=function(){return this.throwIfDisposed(),eG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.tanh=function(){return this.throwIfDisposed(),jb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.tile=function(n){return this.throwIfDisposed(),Pi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.toBool=function(){return this.throwIfDisposed(),gt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.toFloat=function(){return this.throwIfDisposed(),gt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.toInt=function(){return this.throwIfDisposed(),gt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.topk=function(n,e){return this.throwIfDisposed(),rG(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.transpose=function(n){return this.throwIfDisposed(),ln(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.unique=function(n){return this.throwIfDisposed(),aG(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),TT(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.unstack=function(n){return this.throwIfDisposed(),Ec(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.where=function(n,e){return this.throwIfDisposed(),ns(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ke().prototype.zerosLike=function(){return this.throwIfDisposed(),un(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class la extends Error{constructor(e){super(e),Object.setPrototypeOf(this,la.prototype)}}class di extends Error{constructor(e){super(e),Object.setPrototypeOf(this,di.prototype)}}class Oe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Oe.prototype)}}class Wt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Wt.prototype)}}class ex extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ex.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bA{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tc(n,e){if(Array.isArray(n)){let t=[];for(let r=0;r<e;r++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function ua(n,e){if(!n)throw new ex(e)}function xC(n,e){let t=0;for(const r of n)r===e&&t++;return t}function us(n){return n.length===1?n[0]:n}function Fn(n){return Array.isArray(n)?n:[n]}function Pa(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function lc(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let si={};function tx(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function jv(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>jv(e));else{const e=Object.keys(n);for(const t of e){const r=n[t];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?n[t]=r.value:jv(r))}}}function _h(n,e={},t={},r="object",s=!1){if(typeof n=="string"){const i=n;let a;if(i in t)a=t[i];else if(i in si)a=si[i];else if(a=e[i],a==null)throw new Oe(`Unknown ${r}: ${n}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const i=n;if(i.className==null||i.config==null)throw new Oe(`${r}: Improper config format: ${JSON.stringify(i)}.
'className' and 'config' must set.`);const a=i.className;let o,c;if(a in t?[o,c]=t[a]:a in si?[o,c]=si.className:a in e&&([o,c]=e[a]),o==null)throw new Oe(`Unknown ${r}: ${a}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){const l={};for(const p of Object.keys(si))l[p]=si[p];for(const p of Object.keys(t))l[p]=t[p];const u=i.config;u.customObjects=l;const f=Object.assign({},si);for(const p of Object.keys(t))si[p]=t[p];jv(i.config);const d=c(o,i.config,t,s);return si=Object.assign({},f),d}else{const l=Object.assign({},si);for(const f of Object.keys(t))si[f]=t[f];const u=new o(i.config);return si=Object.assign({},l),u}}}function E9(n,e){return n<e?-1:n>e?1:0}function Kd(n,e){return-1*E9(n,e)}function xo(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function T9(n){if(n==null)throw new Oe(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Lc(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new Oe(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function nx(n,e,t=0,r=1/0){return ua(t>=0),ua(r>=t),Array.isArray(n)&&n.length>=t&&n.length<=r&&n.every(s=>typeof s===e)}function Ar(n,e){Array.isArray(n)?(ce(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,r)=>Ar(t,`element ${r+1} of ${e}`))):ce(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${yA(n)}.`)}function yA(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>yA(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function A9(n,e,t){let r=t!=null?t():ls(),s;return(...a)=>{const o=t!=null?t():ls();return o-r<e||(r=o,s=n(...a)),s}}function xA(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let $9=0;function wA(){return $9++}const Xd={};function Em(n=""){return n in Xd||(Xd[n]=0),Xd[n]+=1,n+Xd[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const N9=["channelsFirst","channelsLast"],O9=["nearest","bilinear"],_9=["valid","same","causal"],F9=["max","avg"],D9=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hl=new Map;function ar(n){Lc(N9,"DataFormat",n)}function B9(n){Lc(O9,"InterpolationFormat",n)}function js(n){Lc(_9,"PaddingMode",n)}function SA(n){Lc(F9,"PoolMode",n)}const lf=[],wC="/";function mc(n,e){lf.push(n);try{const t=e();return lf.pop(),t}catch(t){throw lf.pop(),t}}function M9(){return lf.length===0?"":lf.join(wC)+wC}function CA(n){if(!kA(n))throw new Error("Not a valid tensor name: '"+n+"'");return M9()+n}function RA(n){if(!kA(n))throw new Error("Not a valid tensor name: '"+n+"'");hl.has(n)||hl.set(n,0);const e=hl.get(n);if(hl.set(n,hl.get(n)+1),e>0){const t=`${n}_${e}`;return hl.set(t,1),t}else return n}const P9=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function kA(n){return!!n.match(P9)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function L9(n){return n===parseInt(n.toString(),10)}function wo(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let r=1;for(let s=e;s<t;++s)r*=n[s];return r}function Ll(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r<e&&(e=r)}return e}function Eo(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const r=n[t];r>e&&(e=r)}return e}function Vi(n,e){if(e<n)throw new Oe(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let r=n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let N1;function Ir(){return N1==null&&(N1=r8().epsilon()),N1}function Wi(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ia(n,e){return gt(n,e)}function Fh(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),Me(n,t)}function U9(n,e){return Ve(()=>{if(n.shape.length!==2)throw new Oe(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=Fh(n,1);return Kv(t,[1,e,1])})}function z9(n){const e=[wo(n.shape)];return Me(n,e)}function V9(n){if(n.rank<=1)throw new Oe(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],wo(n.shape,1)];return Me(n,e)}function vc(n,e,t){return Ve(()=>{switch(n.rank){case 1:return my(n,e,t);case 2:return CT(n,[e,0],[t,n.shape[1]]);case 3:return vy(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return Dp(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return $n(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return $n(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new Oe(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function O1(n,e,t){return Ve(()=>{switch(n.rank){case 1:return my(n,e,t);case 2:return CT(n,[0,e],[n.shape[0],t]);case 3:return vy(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return Dp(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new Oe(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Yd(n,e,t,r){return Ve(()=>{switch(n.rank){case 1:return my(n,e,t);case 2:switch(r){case 1:return vc(n,e,t);case 2:return O1(n,e,t);default:throw new Oe(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return vc(n,e,t);case 2:return vy(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return O1(n,e,t);default:throw new Oe(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return vc(n,e,t);case 2:return Dp(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return Dp(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return O1(n,e,t);default:throw new Oe(`The axis is not within the rank of the tensor ${r}`)}default:throw new Oe(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function rx(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),hs(n,e)}function SC(n,e){switch(n.rank){case 1:return rz([n,e]);case 2:return iz([n,e],0);case 3:return oz([n,e],0);case 4:return lz([n,e],0);default:throw new Oe(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function Kv(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new Oe(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return Pi(n,e)}function Tm(n,e=0,t=1,r,s){return IW(n,e,t,r,s)}function ba(n,e,t,r){if(n.rank<2||e.rank<2)throw new Wt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=n.shape.slice(-1)[0],i=e.shape.slice(-2)[0];if(s!==i)throw new Wt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return lC({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?Xv(n.rank,r,Wi()):null,activation:t});{const s=n.shape.slice(),i=s.pop();n=Me(n,[-1,i]);const a=e.shape.slice(),o=a.pop(),c=a.pop(),l=[...a,o],u=Array.from({length:e.rank},(m,I)=>I===0?e.rank-2:I<=e.rank-2?I-1:I);e=Me(ln(e,u),[c,-1]);const f=[...s,...l];return Me(lC({a:n,b:e,transposeA:!1,transposeB:!1,bias:r?Xv(n.rank,r,Wi()):null,activation:t}),f)}}function EA(n,e,t){return Ve(()=>(Array.isArray(e)?e=zs(e,"int32"):e=gt(e,"int32"),Qb(n,e,t)))}function Dh(n){return _e(n,n)}function Xv(n,e,t){const r=e.shape;if(e.rank!==1&&e.rank!==n)throw new Oe(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return r.length===1?Me(e,[1,r[0],1,1,1]):Me(e,[1,r[3],r[0],r[1],r[2]]);if(t==="channelsLast")return r.length===1?Me(e,[1,1,1,1,r[0]]):Me(e,[1].concat(r))}else if(n===4){if(t==="channelsFirst")return r.length===1?Me(e,[1,r[0],1,1]):Me(e,[1,r[2],r[0],r[1]]);if(t==="channelsLast")return r.length===1?Me(e,[1,1,1,r[0]]):Me(e,[1].concat(r))}else if(n===3){if(t==="channelsFirst")return r.length===1?Me(e,[1,r[0],1]):Me(e,[1,r[1],r[0]]);if(t==="channelsLast")return r.length===1?Me(e,[1,1,r[0]]):Me(e,[1].concat(r))}else if(n<3)return e;throw new Oe(`Unsupported input rank by biasAdd: ${e.rank}`)}function qi(n,e,t){return Ve(()=>(t==null&&(t=Wi()),ar(t),at(n,Xv(n.rank,e,t))))}function W9(n,e=1){if(e!==1)throw new Wt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return ym(n)}function G9(n){return Ve(()=>$t(n,at(Jr(n),1)))}function TA(n,e,t,r){return Ve(()=>dG(n,e,t,r))}function H9(n){return Ve(()=>{const e=at(.5,_e(.2,n));return Hs(e,0,1)})}function Bh(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const q9=["fanIn","fanOut","fanAvg"],j9=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K9(n){Lc(q9,"FanMode",n)}function X9(n){Lc(j9,"Distribution",n)}class wi extends tu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class AA extends wi{apply(e,t){return Tr(e,t)}}AA.className="Zeros";et(AA);class sx extends wi{apply(e,t){return Dc(e,t)}}sx.className="Ones";et(sx);class $A extends wi{constructor(e){if(super(),typeof e!="object")throw new Oe(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Oe(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return Ve(()=>_e(bn(this.value),Dc(e,t)))}getConfig(){return{value:this.value}}}$A.className="Constant";et($A);class NA extends wi{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Eh(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}NA.className="RandomUniform";et(NA);class OA extends wi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Wt(`randomNormal does not support dType ${t}.`);return Tm(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}OA.className="RandomNormal";et(OA);class _A extends wi{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Wt(`truncatedNormal does not support dType ${t}.`);return ET(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}_A.className="TruncatedNormal";et(_A);class FA extends wi{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return Ve(()=>{if(e.length!==2||e[0]!==e[1])throw new Oe("Identity matrix initializer can only be used for 2D square matrices.");return _e(this.gain,uT(e[0]))})}getConfig(){return{gain:this.gain}}}FA.className="Identity";et(FA);function Y9(n,e="channelsLast"){let t,r;if(ar(e),n.length===2)t=n[0],r=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const s=wo(n,2);t=n[1]*s,r=n[0]*s}else if(e==="channelsLast"){const s=wo(n,0,n.length-2);t=n[n.length-2]*s,r=n[n.length-1]*s}}else{const s=wo(n);t=Math.sqrt(s),r=Math.sqrt(s)}return[t,r]}class As extends wi{constructor(e){if(super(),e.scale<0)throw new Oe(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,K9(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,X9(this.distribution),this.seed=e.seed}apply(e,t){const r=Y9(e),s=r[0],i=r[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,s):this.mode==="fanOut"?a/=Math.max(1,i):a/=Math.max(1,(s+i)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new Wt(`${this.getClassName()} does not support dType ${t}.`);return ET(e,0,o,t,this.seed)}else{const o=Math.sqrt(3*a);return Eh(e,-o,o,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}As.className="VarianceScaling";et(As);class ix extends As{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}ix.className="GlorotUniform";et(ix);class ax extends As{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}ax.className="GlorotNormal";et(ax);class ox extends As{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}ox.className="HeNormal";et(ox);class cx extends As{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}cx.className="HeUniform";et(cx);class lx extends As{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return As.className}}lx.className="LeCunNormal";et(lx);class ux extends As{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return As.className}}ux.className="LeCunUniform";et(ux);class DA extends wi{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return Ve(()=>{if(e.length<2)throw new Wt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const r=Ye(e.slice(0,-1)),s=e[e.length-1],i=r*s;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);const a=[Math.max(s,r),Math.min(s,r)],o=Tm(a,0,1,t,this.seed),c=o7.qr(o,!1);let l=c[0];const f=c[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return l=_e(l,f.sign()),r<s&&(l=l.transpose()),_e(bn(this.gain),l.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}DA.className="Orthogonal";et(DA);const CC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function RC(n,e={}){return _h(n,li.getMap().classNameMap,e,"initializer")}function qn(n){return tx(n)}function zn(n){if(typeof n=="string"){const e=n in CC?CC[n]:n;if(e==="GlorotNormal")return new ax;if(e==="GlorotUniform")return new ix;if(e==="HeNormal")return new ox;if(e==="HeUniform")return new cx;if(e==="LeCunNormal")return new lx;if(e==="LeCunUniform")return new ux;{const t={};return t.className=e,t.config={},RC(t)}}else return n instanceof wi?n:RC(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yv(n){return Array.isArray(n)&&Array.isArray(n[0])}function Bp(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Ft(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new Oe(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function dn(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new Oe(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mp(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kC="Variable";class Z9{constructor(e,t="float32",r=kC,s=!0,i=null){this.dtype=t??"float32",this.shape=e.shape,this.id=wA(),r=r??kC,this.originalName=CA(r),this.name=RA(this.originalName),this.trainable_=s,this.constraint=i,this.val=lG(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),J9(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function J9(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function Zv(n){return n.map(e=>e.read())}function fx(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class br{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class da{constructor(e,t,r,s,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=r,this.inputs=s,this.callArgs=i,this.outputTensorIndex=o,this.id=wA(),a!=null&&(this.originalName=CA(a),this.name=RA(this.originalName)),this.rank=t.length}}let Q9=0;class Am{constructor(e,t){this.callArgs=t,this.id=Q9++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let eq=0;class Zt extends tu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=eq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const r=this.getClassName();t=Pa(r)+"_"+Em(r)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let i=null;e.batchSize!=null&&(i=e.batchSize),r=[i].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new di(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Oe(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return us(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return us(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new la(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new la(`Layer ${this.name} is not connected, no input to return.`);return us(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new la(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new la(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return us(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Fn(e),this.inputSpec==null||this.inputSpec.length===0)return;const t=Fn(this.inputSpec);if(e.length!==t.length)throw new Oe(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let r=0;r<e.length;r++){const s=e[r],i=t[r];if(i==null)continue;const a=s.rank;if(i.ndim!=null&&a!==i.ndim)throw new Oe(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new Oe(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new Oe(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&s.dtype!==i.dtype)throw new Oe(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${s.dtype}.`);if(i.axes){const o=s.shape;for(const c in i.axes){const l=Number(c),u=i.axes[c],f=l>=0?o[l]:o[o.length+l];if(u!=null&&[u,null].indexOf(f)===-1)throw new Oe(`Input ${r} is incompatible with layer ${this.name}: expected axis ${l} of input shape to have value ${u} but got shape ${o}.`)}}if(i.shape!=null)for(let o=0;o<i.shape.length;++o){const c=i.shape[o],l=s.shape[o];if(c!=null&&l!=null&&c!==l)throw new Oe(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${s.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const r=Fn(e);let s=!0;for(const a of r)if(!(a instanceof da)){s=!1;break}let i=!0;for(const a of r)if(a instanceof da){i=!1;break}if(s===i)throw new Oe("Arguments to apply() must be all SymbolicTensors or all Tensors");return mc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const o of Fn(e))a.push(o.shape);this.build(us(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let a=this.call(e,t);const o=Fn(a),c=[];for(let l of o)r.indexOf(l)!==-1&&(l=l.clone()),c.push(l);if(a=us(c),this.activityRegularizer!=null)throw new Wt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=tq(e),o=this.computeOutputShape(a);let c;const l=nq(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?c=o.map((u,f)=>new da(l,u,this,Fn(e),t,this.name,f)):c=new da(l,o,this,Fn(e),t,this.name),this.addInboundNode(e,c,null,null,a,o,t),this._refCount++,this.activityRegularizer!=null)throw new Wt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new la(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const r=JSON.stringify(t.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new la(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new di(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Mp(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Zv(e?this.trainableWeights:this.weights)}setWeights(e){Ve(()=>{const t=this.weights;if(t.length!==e.length)throw new Oe(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const r=[],s=Zv(t);for(let i=0;i<s.length;++i){const a=s[i],o=t[i],c=e[i];if(!vn(a.shape,c.shape))throw new Oe(`Layer weight shape ${a.shape} not compatible with provided weight shape ${c.shape}`);r.push([o,c])}fx(r)})}addWeight(e,t,r,s,i,a,o,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new Oe(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=c!=null?c():zn("zeros"));const l=s.apply(t,r),u=new Z9(l,r,e,a,o);return l.dispose(),i!=null&&this.addLoss(()=>i.apply(u.read())),a==null&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Fn(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}addInboundNode(e,t,r,s,i,a,o=null){const c=Fn(e);t=Fn(t),r=Fn(r),s=Fn(s),i=Bp(i),a=Bp(a);const l=[],u=[],f=[];for(const d of c)l.push(d.sourceLayer),u.push(d.nodeIndex),f.push(d.tensorIndex);new Am({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:f,inputTensors:c,outputTensors:t,inputMasks:r,outputMasks:s,inputShapes:i,outputShapes:a},o);for(let d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function tq(n){n=Fn(n);const e=[];for(const t of n)e.push(t.shape);return us(e)}function nq(n){return"float32"}function BA(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const r=e.inboundNodes[t];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let i=0;i<r.inboundLayers.length;i++){const a=r.inputTensors[i],o=r.inboundLayers[i],c=r.nodeIndices[i],l=BA(a,o,c);for(const u of l)s.indexOf(u)===-1&&s.push(u)}return s}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mh extends Zt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Em("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Oe("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new Oe("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Oe("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=t,this.dtype=r,this.inputSpec=[{shape:t}];const s=new da(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new Am({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Oe(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Mh.className="InputLayer";et(Mh);function rq(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new Oe("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new Mh({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sq(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return gt(e,n.dtype)}catch{throw new Oe(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class vo{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof vo)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=sq(e,t),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new Oe(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof da){if(this.id2Value[e.id]==null)throw new Oe(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Oe(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof da){if(this.id2Value[e.id]==null)throw new Oe(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Oe(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&Qt(this.id2Mask)}}const Pp=new bA,Lp=new bA;function iq(n){Pp!=null&&Pp.setMaxEntries(n),Lp!=null&&Lp.setMaxEntries(n)}function ef(n,e,t,r){const s=t==null?!1:t.training,i=Array.isArray(n),a=i?n:[n],o=a.map(m=>m.name),c=[],l=e.names();for(const m of o)l.indexOf(m)!==-1?c.push(e.getValue(m)):c.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=o.join(",")+"|"+e.names().sort().join(",");let f=Pp.get(u),d;if(f==null){const m=aq(a,e);f=m.sorted,d=m.recipientCounts,Pp.put(u,f),Lp.put(u,d)}d={},s||Object.assign(d,Lp.get(u));const p=new vo(e);for(let m=0;m<f.length;++m){if(r!=null){const M=Uv().numTensors;M>r.maxNumTensors&&(r.maxNumTensors=M),M<r.minNumTensors&&(r.minNumTensors=M)}const I=f[m],v=I.sourceLayer;if(v instanceof Mh)continue;const b=[],y=[],S=[];let w=!1;for(const M of I.inputs){const z=p.getValue(M),Y=p.getMask(M);b.push(z),y.push(Y),Y!=null&&(w=!0),s||(d[M.name]--,d[M.name]===0&&!e.hasKey(M)&&o.indexOf(M.name)===-1&&!z.isDisposed&&M.sourceLayer.stateful!==!0&&S.push(z))}w&&(t=t||{},t.mask=y[0]);const C=Fn(v.apply(b,t));let N=null;v.supportsMasking&&(N=v.computeMask(b,y));const E=cq(I),A=Array.isArray(E)?E:[E];for(let M=0;M<A.length;++M){p.hasKey(A[M])||p.add(A[M],C[M],Array.isArray(N)?N[0]:N);const z=o.indexOf(A[M].name);z!==-1&&(c[z]=C[M])}s||Qt(S)}return p.disposeMasks(),i?c:c[0]}function aq(n,e){ce(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],r={};if(n.length===1){const s=EC(n[0],e);t=s.sorted,r=s.recipientMap}else{const s=new Set;for(const i of n){const{sorted:a,recipientMap:o}=EC(i,e);for(const c of a)s.has(c.name)||(t.push(c),s.add(c.name));for(const c in o)r[c]==null&&(r[c]=new Set),o[c].forEach(l=>r[c].add(l))}}return{sorted:t,recipientCounts:oq(r)}}function oq(n){const e={};for(const t in n)e[t]=n[t].size;return e}function EC(n,e){const t=new Set,r=[],s={};for(const o of e.names())t.add(o);const i=[],a=[];for(i.push(n);i.length>0;){const o=i[i.length-1];if(t.has(o.name)){i.pop();continue}const c=a[a.length-1]===i.length-1;if(o.inputs.length===0||c)i.pop(),r.push(o),t.add(o.name),c&&a.pop();else{a.push(i.length-1);for(const l of o.inputs)s[l.name]==null&&(s[l.name]=new Set),s[l.name].add(o.name),!t.has(l.name)&&i.push(l)}}return{sorted:r,recipientMap:s}}function cq(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let r=0;r<n.sourceLayer.inboundNodes.length;++r)for(const s of n.sourceLayer.inboundNodes[r].outputTensors)if(s.id===n.id){t=r;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lq=Ge();lq.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,iq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hx(n,e){return Ve(()=>rs(kt(_e(n,n),e,!0)))}class Ph extends tu{getConfig(){return{}}}class MA extends Ph{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>{const t=hx(e,this.axis),r=Hs(t,0,this.maxValue);return _e(e,$t(r,at(Ir(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}MA.className="MaxNorm";et(MA);class PA extends Ph{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>$t(e,at(Ir(),hx(e,this.axis))))}getConfig(){return{axis:this.axis}}}PA.className="UnitNorm";et(PA);class LA extends Ph{apply(e){return Mc(e)}}LA.className="NonNeg";et(LA);class UA extends Ph{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ve(()=>{const t=hx(e,this.axis),r=at(_e(this.rate,Hs(t,this.minValue,this.maxValue)),_e(1-this.rate,t));return _e(e,$t(r,at(Ir(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}UA.className="MinMaxNorm";et(UA);const TC={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function yr(n){return tx(n)}function AC(n,e={}){return _h(n,li.getMap().classNameMap,e,"constraint")}function xr(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in TC?TC[n]:n,config:{}};return AC(t)}else return n instanceof Ph?n:AC(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function rc(n){if(n==null)return;const e=[],t=[],r=[];for(const s in n){const i=n[s];if(typeof i!="number"){const a=i;e.push(a.data()),t.push(s),r.push(a)}}if(e.length>0){const s=await Promise.all(e);for(let i=0;i<s.length;++i)n[t[i]]=s[i][0];Qt(r)}}function zA(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var $C;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})($C||($C={}));const uq=125;class vf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class fq{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const r of this.callbacks)await r.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class hq extends vf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const r=t.size==null?0:t.size;this.seen+=r;for(const s in t){const i=t[s];if(typeof i=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+i*r;else{let a;s in this.totals?a=this.totals[s]:this.totals[s]=0;const o=Ve(()=>at(this.totals[s],_e(i,r)));this.totals[s]=o,a!=null&&a.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?t[r]=this.totals[r]/this.seen:Ve(()=>{const s=_e($t(1,this.seen),this.totals[r]);t[r]=s,this.totals[r].dispose(),ma(t[r])}))}}class dq extends vf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const r in t)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(t[r])}async syncData(){const e=[],t=[],r=[];for(const i in this.history){const a=this.history[i];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const c=a[o];e.push(c.data()),t.push(i),r.push(o)}}const s=await Promise.all(e);for(let i=0;i<s.length;++i)this.history[t[i]][r[i]].dispose(),this.history[t[i]][r[i]]=s[i][0]}}class pq extends vf{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||qT,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=uq),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Rv(this.yieldEvery)&&(this.maybeWait=A9(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,r){const s=[];this.yield!=null&&(await rc(r),s.push(this.yield(e,t,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await rc(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const r=[];this.epochEnd!=null&&(await rc(t),r.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,t){this.batchBegin!=null&&(await rc(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const r=[];this.batchEnd!=null&&(await rc(t),r.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):Rv(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await rc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await rc(e),await this.trainEnd(e))}}function VA(n,e){return n==null&&(n={}),n instanceof vf?[n]:Array.isArray(n)&&n[0]instanceof vf?n:Fn(n).map(r=>new pq(r,e))}class oi{constructor(){}static registerCallbackConstructor(e,t){ce(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),oi.checkForDuplicate(t),oi.constructors[e]==null&&(oi.constructors[e]=[]),oi.constructors[e].push(t)}static checkForDuplicate(e){for(const t in oi.constructors)oi.constructors[+t].forEach(s=>{if(s===e)throw new Oe("Duplicate callback constructor.")})}static clear(){oi.constructors={}}static createCallbacks(e){const t=[];for(const r in oi.constructors){const s=+r;e>=s&&t.push(...oi.constructors[s])}return t.map(r=>new r)}}oi.constructors={};function WA(n,e,t,r,s,i,a,o,c){const l=new dq,u=[new hq,...oi.createCallbacks(e)];n!=null&&u.push(...n),u.push(l);const f=new fq(u);return f.setParams({epochs:t,initialEpoch:r,samples:s,steps:i,batchSize:a,verbose:e,doValidation:o,metrics:c}),{callbackList:f,history:l}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Va(n,e={},t=!1){return _h(n,li.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Up(n,e){return Ve(()=>{n.dtype!=="float32"&&(n=gt(n,"float32"));const t=kt(Dh(n),e,!0),r=bm(t.shape,Ir()),s=rs(Mo(t,r));return $t(n,s)})}function $m(n,e){return Ve(()=>gr(Dh(Bt(e,n)),-1))}function dx(n,e){return Ve(()=>gr(Jr(Bt(e,n)),-1))}function px(n,e){return Ve(()=>{const t=Bt(n,e),r=Hs(Jr(n),Ir(),Number.MAX_VALUE),s=Jr($t(t,r));return _e(100,gr(s,-1))})}function gq(n,e){return Ve(()=>{const t=Hs(e,Ir(),Number.MAX_VALUE),r=xa(at(1,t)),s=Hs(n,Ir(),Number.MAX_VALUE),i=xa(at(1,s));return gr(Dh(Bt(r,i)),-1)})}function mq(n,e){return Ve(()=>{const t=Mo(0,Bt(1,_e(n,e)));return gr(Dh(t),-1)})}function vq(n,e){return Ve(()=>{const t=Mo(0,Bt(1,_e(n,e)));return gr(t,-1)})}function Iq(n,e){return Ve(()=>{const t=kt(_e(n,e),-1),r=Ui(_e(Bt(1,n),e),-1);return Mo(0,at(1,Bt(r,t)))})}function bq(n,e){return Ve(()=>{const t=Math.log(2),r=Bt(e,n),s=Bt(at(r,kh(_e(-2,r))),t);return gr(s,-1)})}function If(n,e,t=!1){return Ve(()=>{if(t)e=Iy(e);else{const r=kt(e,e.shape.length-1,!0);e=$t(e,r)}return e=Hs(e,Ir(),1-Ir()),rr(kt(_e(gt(n,"float32"),xa(e)),e.shape.length-1))})}function zp(n,e,t=!1){return Ve(()=>{const r=gt(wm(z9(n)),"int32");e=Hs(e,Ir(),1-Ir());const s=e.shape,i=Me(pT(r,s[s.length-1]),s);return If(i,e,t)})}function yq(n,e){if(!vn(n.shape,e.shape))throw new Oe(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return Ve(()=>{const t=Mc(e),r=rr(Jr(e));return at(Bt(t,_e(e,n)),fT(Wa(r)))})}function Nm(n,e){return Ve(()=>{let t;return t=Hs(e,Ir(),1-Ir()),t=xa($t(t,Bt(1,t))),gr(yq(n,t),-1)})}function xq(n,e){return Ve(()=>{const t=Hs(n,Ir(),1),r=Hs(e,Ir(),1);return kt(_e(n,xa($t(t,r))),-1)})}function wq(n,e){return Ve(()=>{const t=xa(at(Ir(),e));return gr(Bt(e,_e(n,t)),-1)})}function GA(n,e){return Ve(()=>{const t=Up(n,-1),r=Up(e,-1),s=_e(t,r);return rr(kt(s,-1))})}const Vp={meanSquaredError:$m,meanAbsoluteError:dx,meanAbsolutePercentageError:px,meanSquaredLogarithmicError:gq,squaredHinge:mq,hinge:vq,categoricalHinge:Iq,logcosh:bq,categoricalCrossentropy:If,sparseCategoricalCrossentropy:zp,binaryCrossentropy:Nm,kullbackLeiblerDivergence:xq,poisson:wq,cosineProximity:GA};function _1(n){if(typeof n=="string"){if(n in Vp)return Vp[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Oe(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function HA(n,e){return Ve(()=>{const t=_e(.5,Ii(e)),r=Ia(qs(e,t),n.dtype);return gr(ya(n,r),-1)})}function qA(n,e){return Ve(()=>Ia(ya(wc(n,-1),wc(e,-1)),"float32"))}function Sq(n,e){return Ve(()=>gt(kt(Ga(ya(n,1),ya(e,1))),"float32"))}function Cq(n,e){return Ve(()=>gt(kt(Ga(ya(n,0),ya(e,1))),"float32"))}function Rq(n,e){return Ve(()=>{const t=Sq(n,e),r=Cq(n,e),s=at(t,r);return gt(ns(qs(s,0),$t(t,s),0),"float32")})}function kq(n,e){return Nm(n,e)}function Eq(n,e){return n.rank===e.rank&&(n=Th(n,[n.rank-1])),e=wc(e,-1),e.dtype!==n.dtype&&(e=gt(e,n.dtype)),gt(ya(n,e),"float32")}const Tq=$m,Aq=$m,$q=dx,Nq=dx,Oq=px,_q=px,jA=If,Fq=GA,KA=zp,Wp={binaryAccuracy:HA,categoricalAccuracy:qA,precision:Rq,categoricalCrossentropy:jA,sparseCategoricalCrossentropy:KA,mse:Tq,MSE:Aq,mae:$q,MAE:Nq,mape:Oq,MAPE:_q,cosine:Fq};function Dq(n){if(typeof n=="string"&&n in Wp)return Wp[n];if(typeof n!="string"&&n!=null)return n;throw new Oe(`Unknown metric ${n}`)}function Zd(n){if(ua(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(Vp))if(Vp[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Wp))if(Wp[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bq(n){const e={Adagrad:()=>fl.adagrad(.01),Adadelta:()=>fl.adadelta(1,.95,Ir()),Adam:()=>fl.adam(.001,.9,.999,Ir()),Adamax:()=>fl.adamax(.002,.9,.999,Ir(),0),RMSProp:()=>fl.rmsprop(.001,.9,0,Ir()),SGD:()=>fl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new Oe(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const NC=1*1024*1024;function OC(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!Jv(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const r=JSON.stringify(n);r.length>NC&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${NC}.`)}}function Jv(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!Jv(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!Jv(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mq(n,e,t,r=console.log){const s=Lq(n),i=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(u=>Math.floor(e*u)));let a;if(!s){i.push("Receives inputs"),a=[];for(const u in n.nodesByDepth)a.push(...n.nodesByDepth[u])}r("_".repeat(e)),Gp(i,t,r),r("=".repeat(e));const o=n.layers;for(let u=0;u<o.length;++u)s?Uq(o[u],t,r):zq(o[u],t,a,r),r((u===o.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const c=Pq(n),l=Mp(n.nonTrainableWeights);r(`Total params: ${c+l}`),r(`Trainable params: ${c}`),r(`Non-trainable params: ${l}`),r("_".repeat(e))}function Pq(n){let e;return n.collectedTrainableWeights!=null?e=Mp(n.collectedTrainableWeights):e=Mp(n.trainableWeights),e}function Lq(n){let e=!0;const t=[],r=[];for(const s in n.nodesByDepth)t.push(n.nodesByDepth[s]);for(const s of t){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of n.layers){let i=!1;for(const a of s.inboundNodes)if(r.indexOf(a)!==-1)if(i){e=!1;break}else i=!0;if(!e)break}return e}function Gp(n,e,t=console.log){let r="";for(let s=0;s<n.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=n[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);t(r)}function Uq(n,e,t){let r,s;try{s=n.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=n.name,a=n.getClassName(),o=[`${i} (${a})`,s,r,n.countParams().toString()];Gp(o,e,t)}function zq(n,e,t,r){let s,i;try{i=n.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=[];for(const f of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let d=0;d<f.inboundLayers.length;++d){const p=f.inboundLayers[d].name,m=f.nodeIndices[d],I=f.tensorIndices[d];a.push(`${p}[${m}][${I}]`)}const o=n.name,c=n.getClassName(),l=a.length===0?"":a[0],u=[`${o} (${c})`,i,s,n.countParams().toString(),l];Gp(u,e,r);for(let f=1;f<a.length;++f)Gp(["","","","",a[f]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function XA(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function Qv(n,e){if(n===null)return null;if(typeof n=="string")return lc(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];XA(e,s,i)?t.push(i):t.push(Qv(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r];if(r==="name"&&typeof s=="string")t[r]=s;else{const i=lc(r);t[i]=Qv(s,i)}}return t}}function eI(n,e){if(n==null)return null;if(typeof n=="string")return Pa(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],r=n.length;for(let s=0;s<r;++s){const i=n[s];XA(e,s,i)?t.push(i):t.push(eI(i,e))}return t}else{const t={};for(const r of Object.keys(n)){const s=n[r],i=Pa(r);(r==="name"||r==="className")&&typeof s=="string"?t[i]=s:t[i]=eI(s,r)}return t}}/** @license See the LICENSE file. */const YA="4.8.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Di extends Zt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=Em(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],xo(this.inputs).length!==this.inputs.length)throw new Oe(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);xo(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const S=y.sourceLayer,w=y.nodeIndex,C=y.tensorIndex;this.outputLayers.push(S),this.outputLayersNodeIndices.push(w),this.outputLayersTensorIndices.push(C)}for(const y of this.inputs){const S=y.sourceLayer,w=y.nodeIndex,C=y.tensorIndex;ua(w===0,"input layer has >1 nodes"),ua(C===0,"input layer has >1 tensors"),this.inputLayers.push(S),this.inputLayersNodeIndices.push(w),this.inputLayersTensorIndices.push(C)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const S=this.inputLayers[y];if(!(S instanceof Mh))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${S.getClassName()}.`);this.inputNames.push(S.name),this.feedInputShapes.push(S.batchInputShape),this.feedInputNames.push(S.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const t={},r={},s={},i={},a={},o=[],c=(y,S,w,C,N,E)=>{(C==null||N==null||E==null)&&(C=y.sourceLayer,N=y.nodeIndex,E=y.tensorIndex);const A=C.inboundNodes[N];if(w.indexOf(A)!==-1)throw new di(`The tensor ${y.name} at layer "${C.name}" is part of a cycle.`);if(S.indexOf(A)!==-1)return;this.containerNodes.add(Di.nodeKey(C,N)),C.id in a||(a[C.id]=Object.keys(a).length),w.indexOf(A)===-1&&w.push(A);const M=A.inboundLayers.length;for(let z=0;z<M;z++){const Y=A.inputTensors[z],re=A.inboundLayers[z],ne=A.nodeIndices[z],le=A.tensorIndices[z];c(Y,S,w,re,ne,le)}for(S.push(A);w.indexOf(A)>=0;)w.splice(w.indexOf(A),1);o.push(A)},l=[],u=[];for(const y of this.outputs)c(y,l,u);const f=o.slice().reverse();for(const y of f){r[y.id]=y,y.id in t||(t[y.id]=0);let S=t[y.id];const w=s[y.outboundLayer.id]==null?0:s[y.outboundLayer.id];S=Math.max(S,w),s[y.outboundLayer.id]=S,i[y.outboundLayer.id]=y.outboundLayer,t[y.id]=S;for(let C=0;C<y.inboundLayers.length;C++){const N=y.inboundLayers[C],E=y.nodeIndices[C],A=N.inboundNodes[E],M=t[A.id]==null?0:t[A.id];t[A.id]=Math.max(S+1,M),r[A.id]=A}}const d={};for(const y in t){const S=t[y];S in d||(d[S]=[]),d[S].push(r[y])}const p={};for(const y in s){const S=s[y];S in p||(p[S]=[]),p[S].push(i[y])}let m=Object.keys(p).map(y=>parseInt(y,10)).sort(Kd);this.layers=[];for(const y of m){const S=p[y];S.sort((w,C)=>{const N=a[w.id],E=a[C.id];return N<E?-1:N>E?1:0});for(const w of S)w instanceof Di&&this.internalContainerRefs.push(w),this.layers.push(w)}this.layersByDepth=p,m=Object.keys(d).map(y=>parseInt(y,10)).sort(Kd);const I=this.inputs.slice(),v=[];for(const y of m)for(const S of d[y]){const w=S.outboundLayer;if(w!=null){for(const C of S.inputTensors)if(I.indexOf(C)===-1)throw new di(`Graph disconnected: cannot obtain value for tensor ${C} at layer "${w.name}". The following previous layers were accessed without issue: ${v}`);for(const C of S.outputTensors)I.push(C);v.push(w.name)}}this.nodesByDepth=d;const b=this.layers.map(y=>y.name);for(const y of b){const S=b.filter(w=>w===y).length;if(S!==1)throw new di(`The name "${y}" is used ${S} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new Am({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Oe("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.layers)t.push(...r.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const r={};let s=0;for(const a of this.layers)for(const o of a.weights){if(r[o.originalName]!=null)throw new Oe(`Duplicate weight name: ${o.originalName}`);r[o.originalName]=o,s++}const i=[];for(const a in e){let o=a;if(r[a]==null){const c=a.split("/");o=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[o]!=null)i.push([r[o],e[a]]);else if(t)throw new Oe(`Provided weight data has no target variable: ${a}`);delete r[o]}if(t){const a=[];for(const o in r)a.push(o);if(a.length>0)throw new Oe(`${a.length} of ${s} weights are not set: ${a}`)}fx(i)}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${YA}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const r=eI(this.updatedConfig());return t?JSON.stringify(r):r}call(e,t){return Ve(()=>{e=Fn(e);const r=new vo;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return ef(this.outputs,r,t)})}computeMask(e,t){return Ve(()=>{e=Fn(e);let r;return t==null?r=Tc(null,e.length):r=Fn(t),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const t=Bp(e);if(t.length!==this.inputLayers.length)throw new Oe(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<t.length;o++){const c=this.inputLayers[o],l=t[o],u=c.name+"_0_0";r[u]=l}const s=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Kd);if(s.length>1)for(const o of s){const c=this.nodesByDepth[o];for(const l of c){const u=l.outboundLayer;if(this.inputLayers.map(I=>I.id).indexOf(u.id)!==-1)continue;const f=[];for(let I=0;I<l.inboundLayers.length;I++){const v=l.inboundLayers[I],b=l.nodeIndices[I],y=l.tensorIndices[I],S=`${v.name}_${b}_${y}`,w=r[S];f.push(w)}const d=u.computeOutputShape(us(f)),p=Bp(d),m=u.inboundNodes.indexOf(l);for(let I=0;I<p.length;I++){const v=`${u.name}_${m}_${I}`;r[v]=p[I]}}}const i=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const c=this.outputLayers[o],l=this.outputLayersNodeIndices[o],u=this.outputLayersTensorIndices[o],f=`${c.name}_${l}_${u}`;a.push(f)}for(let o=0;o<a.length;o++){const c=a[o];ua(c in r),i.push(r[c])}return us(i)}runInternalGraph(e,t){t==null&&(t=Tc(null,e.length));const r={};for(let c=0;c<this.inputs.length;++c){const l=this.inputs[c],u=e[c],f=t[c];r[l.id]=[u,f]}const s=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(Kd);for(const c of s){const l=this.nodesByDepth[c];for(const u of l){const f=u.outboundLayer,d=u.inputTensors,p=u.outputTensors,m=new Array;for(const I of d)I.id in r&&m.push(r[I.id]);if(m.length===d.length){let I={},v,b,y,S;if(u.callArgs!=null&&(I=u.callArgs),m.length===1){const[w,C]=m[0];I.mask==null&&(I.mask=C),y=Fn(f.call(w,I)),S=Fn(f.computeMask(w,C)),v=[w],b=[C]}else v=m.map(w=>w[0]),b=m.map(w=>w[1]),I.mask==null&&(I.mask=b),y=Fn(f.call(v,I)),S=Fn(f.computeMask(v,b));if(f.activityRegularizer)throw new Wt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let w=0;w<p.length;++w){const C=p[w],N=y[w],E=S[w];r[C.id]=[N,E]}}}}const i=[],a=[],o=[];for(const c of this.outputs){ua(c.id in r,`Could not compute output ${c.name} : ${c.id}`);const[l,u]=r[c.id];o.push(l.shape),i.push(l),a.push(u)}return[i,a,o]}buildNodeConversionMap(e){const t={};let r;for(const s of this.layers){r=s instanceof Di?1:0;for(let i=0;i<s.inboundNodes.length;i++){const a=Di.nodeKey(s,i);this.containerNodes.has(a)&&(t[a]=r,r+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new Oe("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new Oe(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Oe(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Ve(()=>{const e=[];for(const t of this.layers)for(let r=0;r<t.inboundNodes.length;++r){const s=Di.nodeKey(t,r);this.containerNodes.has(s)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),r=[];for(const a of this.layers){const o=a.getClassName(),c=a.getConfig(),l=[];for(let f=0;f<a.inboundNodes.length;f++){const d=a.inboundNodes[f],p=Di.nodeKey(a,f);let m={};if(this.containerNodes.has(p)){if(d.callArgs)try{JSON.stringify(d.callArgs),m=d.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),m={}}if(d.inboundLayers.length>0){const I=[];for(let v=0;v<d.inboundLayers.length;v++){const b=d.inboundLayers[v],y=d.nodeIndices[v],S=d.tensorIndices[v],w=Di.nodeKey(b,y);let C=t[w];C==null&&(C=0),I.push([b.name,C,S,m])}l.push(I)}}}const u={};u.name=a.name,u.className=o,u.config=c,u.inboundNodes=l,r.push(u)}e.layers=r;const s=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],c=this.inputLayersNodeIndices[a],l=Di.nodeKey(o,c);if(!this.containerNodes.has(l))continue;let u=t[l];u==null&&(u=0);const f=this.inputLayersTensorIndices[a];s.push([o.name,u,f])}e.inputLayers=s;const i=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],c=this.outputLayersNodeIndices[a],l=Di.nodeKey(o,c);if(!this.containerNodes.has(l))continue;let u=t[l];u==null&&(u=0);const f=this.outputLayersTensorIndices[a];i.push([o.name,u,f])}return e.outputLayers=i,e}static fromConfig(e,t,r={},s=!1){const i={},a={};function o(v,b){v.name in a?a[v.name].push(b):a[v.name]=[b]}function c(v,b){const y=[];let S;for(const w of b){const C=w[0],N=w[1],E=w[2];if(S=w[3]==null?{}:w[3],!(C in i)){o(v,b);return}const A=i[C];if(A.inboundNodes.length<=N){o(v,b);return}const M=A.inboundNodes[N];y.push(M.outputTensors[E])}y.length>0&&v.apply(us(y),S)}function l(v){const b=v.name,y=Va(v,t.customObjects!=null?t.customObjects:{});y.setFastWeightInitDuringBuild(s),i[b]=y,v.inboundNodes.forEach(w=>{if(!(w instanceof Array))throw new Oe(`Corrupted configuration, expected array for nodeData: ${w}`);o(y,w)})}const u=t.name,f=t.layers;for(const v of f)l(v);for(;!T9(a);)for(const v of f){const b=i[v.name];if(b.name in a){const y=a[b.name];delete a[b.name];for(const S of y)c(b,S)}}const d=[],p=[],m=t.inputLayers;for(const v of m){const b=v[0],y=v[1],S=v[2];ua(b in i);const C=i[b].inboundNodes[y].outputTensors;d.push(C[S])}const I=t.outputLayers;for(const v of I){const b=v[0],y=v[1],S=v[2];ua(b in i);const C=i[b].inboundNodes[y].outputTensors;p.push(C[S])}return new e({inputs:d,outputs:p,name:u})}get stateful(){if(this._stateful)throw new Oe("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Ve(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vq(n,e,t){const r=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>null);if(r===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==r)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const s=[];return e.forEach(i=>{i in n?s.push(n[i]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${t} must be either an array with ${r} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function ZA(n,e){return Vq(n,e,"classWeight")}async function JA(n,e,t,r){if(e!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(t!=null){const s=Ve(()=>{if(n.shape.length===1)return gc(n);if(n.shape.length===2){if(n.shape[1]>1)return wc(n,1);if(n.shape[1]===1)return Me(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await s.data());Qt(s);const a=[];return i.forEach(o=>{if(t[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(t[o])}),zs(a,"float32")}else return null}function Wq(n,e){return _e(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Gq=32;function QA(n,e){let t,r;const s=e;t=s.xs,r=s.ys,ce(t!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const i=_C("input",n.inputNames,t),a=_C("output",n.outputNames,r),o=i[0].shape[0];ce(i.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),ce(a.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let c=0;c<i.length;c++)ce(i[c].shape[0]===o,()=>`Batch size mismatch: input ${n.inputNames[c]} has ${i[c].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);for(let c=0;c<a.length;c++)ce(a[c].shape[0]===o,()=>`Batch size mismatch: output ${n.outputNames[c]} has ${a[c].shape[0]}; expected  ${o} based on input ${n.inputNames[0]}.`);return{xs:i,ys:a}}function _C(n,e,t){if(t instanceof dr)return[t];if(Array.isArray(t))return ce(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const r=[];for(const s of e){if(t[s]==null)throw new Oe(`The feature data generated by the dataset lacks the required ${n} key '${s}'.`);r.push(t[s])}return r}}function Hq(n){if(n.length===3)throw new Wt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function qq(n,e,t){const r=t.batchesPerEpoch!=null;if(ce(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),ce(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),ce(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),ce(!r||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),ce(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const s=t.validationData!=null;let i,a;if(s)if(FC(t.validationData))ce(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=Hq(t.validationData);i=v.xs,a=v.ys}const o=n.makeTrainFunction(),c=n.getDedupedMetricsNames();let l;s?l=c.slice().concat(c.map(v=>"val_"+v)):l=c.slice();const u=VA(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:d,history:p}=WA(u,f,t.epochs,null,null,jq(e,t),null,s,l);d.setModel(n),n.history=p,await d.onTrainBegin(),n.stopTraining_=!1;let m=t.initialEpoch==null?0:t.initialEpoch,I=await e.iterator();for(;m<t.epochs;){const v={};await d.onEpochBegin(m);let b=0,y=0;for(r||(I=await e.iterator());!r||b<t.batchesPerEpoch;){const S=await I.next();if(r&&S.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${b} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(S.value!=null){const{xs:w,ys:C}=QA(n,S.value),N={};N.batch=y,N.size=w[0].shape[0],await d.onBatchBegin(y,N);const E=[];if(t.classWeight!=null){const z=ZA(t.classWeight,n.outputNames);for(let Y=0;Y<z.length;++Y)E.push(await JA(C[Y],null,z[Y]))}const A=w.concat(C).concat(E),M=o(A);Qt(A);for(let z=0;z<c.length;++z){const Y=c[z],re=M[z];N[Y]=re,ma(re)}await d.onBatchEnd(y,N),zA(N),y++,b++}if(r?b>=t.batchesPerEpoch:S.done){if(s){let w;FC(t.validationData)?w=Fn(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):w=Fn(n.evaluate(i,a,{batchSize:t.validationBatchSize==null?Gq:t.validationBatchSize,verbose:0}));for(let C=0;C<n.metricsNames.length;++C)v[`val_${n.metricsNames[C]}`]=w[C]}break}if(n.stopTraining_)break}if(await d.onEpochEnd(m,v),m++,n.stopTraining_)break}return await d.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function jq(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function FC(n){return typeof n.iterator=="function"}function Kq(n){return typeof n.next=="function"}async function Xq(n,e,t){t=t||{};const r=t.batches!=null,s=n.testFunction;let i=[];if(t.verbose>0)throw new Wt("Verbose mode is not implemented yet.");ce(!r||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const a=Kq(e)?e:await e.iterator();let o=0,c=0;for(;!r||c<t.batches;){const l=await a.next();if(i=Ve(()=>{if(l.value){const{xs:u,ys:f}=QA(n,l.value),d=u.concat(f),p=Ve(()=>s(d));if(Qt(d),c===0)for(let I=0;I<p.length;++I)i.push(bn(0));const m=d[0].shape[0];for(let I=0;I<p.length;++I){const v=p[I],b=i[I];i[I]=Ve(()=>at(i[I],_e(m,v))),c>0&&Qt(b)}Qt(p),o+=m,++c}return i}),l.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<i.length;++l){const u=i[l];i[l]=$t(i[l],o),Qt(u)}return us(i)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F1(n){ce(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function ju(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(r=>vc(r,e,t-e)):vc(n,e,t-e)}function tI(n,e){return Ve(()=>n==null?null:Array.isArray(n)?n.map(t=>tI(t,e)):EA(n,e.dtype==="int32"?e:gt(e,"int32")))}function D1(n,e){const t=[];let r=0,s=null;for(;r<n;)s=r+e,s>=n&&(s=n),t.push([r,s]),r=s;return t}function e$(n){const e=[];n instanceof dr&&(n=[n]);for(let t=0;t<n.length;++t){const r=n[t];if(r.rank===1)e.push(Fh(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Oi(n,e){if(n==null)return;const t=[];if(e instanceof dr)t.push(e.id);else if(Array.isArray(e))e.forEach(s=>t.push(s.id));else if(e!=null)for(const s in e){const i=e[s];t.push(i.id)}const r=[];if(n instanceof dr)t.indexOf(n.id)===-1&&r.push(n);else if(Array.isArray(n))n.forEach(s=>{t.indexOf(s.id)===-1&&r.push(s)});else if(n!=null)for(const s in n){const i=n[s];t.indexOf(i.id)===-1&&r.push(i)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yq(n){return n instanceof dr}function nI(n){return Array.isArray(n)}function DC(n){return!Yq(n)&&!nI(n)}function BC(n,e,t,r=!0,s=""){if(e==null||e.length===0){if(n!=null){let a=!1;if(nI(n)&&n.length>0)a=!0;else if(DC(n)){for(const o in n)if(n.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new Oe(`Error when checking model ${s} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(a=>null);let i;if(DC(n)){n=n,i=[];for(const a of e){if(n[a]==null)throw new Oe(`No data provided for "${a}". Need data for each key in: ${e}`);i.push(n[a])}}else if(nI(n)){if(n=n,n.length!==e.length)throw new Oe(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);i=n}else{if(n=n,e.length>1)throw new Oe(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);i=[n]}if(i=e$(i),t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new Oe(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s). but got array with shape ${o.shape}`);for(let c=0;c<t[a].length;++c){if(c===0&&!r)continue;const l=o.shape[c],u=t[a][c];if(u!=null&&u>=0&&l!==u)throw new Oe(`${s} expected a batch of elements where each example has shape [${t[a].slice(1,t[a].length)}] (i.e.,tensor shape [*,${t[a].slice(1,t[a].length)}]) but the ${s} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return i}function Zq(n,e,t){const r=xo(n.map(i=>i.shape[0]));r.sort();const s=xo(e.map(i=>i.shape[0]));if(s.sort(),r.length>1)throw new Oe(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(i=>i.shape))}`);if(s.length>1)throw new Oe(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(i=>i.shape))}`);if(r.length>0&&s.length>0&&!vn(r,s))throw new Oe(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function Jq(n,e,t){const r=[$m,Nm,If];for(let s=0;s<n.length;++s){const i=n[s],a=e[s],o=t[s];if(a!=null){if(a===If&&i.shape[i.shape.length-1]===1)throw new Oe(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(a)!==-1){const c=i.shape.slice(1),l=o.slice(1);for(let u=0;u<c.length;++u){const f=c[u],d=l[u];if(d!=null&&f!==d)throw new Oe(`A target Tensor with shape ${i.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function MC(n,e,t,r=!0,s=""){let i;if(Array.isArray(n)){if(n.length!==e.length)throw new Oe(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);i=n}else{if(e.length>1)throw new Oe(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);i=[n]}if(t!=null)for(let a=0;a<e.length;++a){if(t[a]==null)continue;const o=i[a];if(o.shape.length!==t[a].length)throw new Oe(`Error when checking ${s}: expected ${e[a]} to have ${t[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let c=0;c<t[a].length;++c){if(c===0&&!r)continue;const l=o.shape[c],u=t[a][c];if(u!=null&&u!==l)throw new Oe(`Error when checking ${s}: expected ${e[a]} to have shape ${JSON.stringify(t[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function Qq(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(r=>t);{const r=[];for(const s of e){let i=t.hasOwnProperty(s)?t[s]:[];Array.isArray(i)||(i=[i]),r.push(i)}return r}}const ej="layers-model";class Al extends Di{constructor(e){super(e),this.isTraining=!1}summary(e,t,r=console.log){if(!this.built)throw new Oe("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Mq(this,e,t,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Bq(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Po))throw new Oe("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new Oe(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),t.push(_1(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Oe(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(o=>_1(o))}else{const a=_1(e.loss);this.outputs.forEach(o=>{t.push(a)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],c=this.outputNames[a];this.feedOutputNames.push(c),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],mc("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const s=Qq(e.metrics,this.outputNames),i=(a,o,c)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([c,a])};mc("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=s[a];(l=>{const u="";let f,d,p;for(const m of l){if(typeof m=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(m)!==-1){const v=this.internalOutputShapes[a];v[v.length-1]===1||this.lossFunctions[a]===Nm?["accuracy","acc"].indexOf(m)!==-1?d=HA:["crossentropy","ce"].indexOf(m)!==-1&&(d=kq):this.lossFunctions[a]===zp?["accuracy","acc"].indexOf(m)!==-1?d=Eq:["crossentropy","ce"].indexOf(m)!==-1&&(d=KA):["accuracy","acc"].indexOf(m)!==-1?d=qA:["crossentropy","ce"].indexOf(m)!==-1&&(d=jA);let b;["accuracy","acc"].indexOf(m)!==-1?b="acc":["crossentropy","ce"].indexOf(m)!==-1&&(b="ce"),p=d,f=u+b}else p=Dq(m),f=u+Zd(m);let I;mc(f,()=>{I=p}),i(a,f,I)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,r={}){const s=r.batchSize==null?32:r.batchSize;F1(s);const i=!0,a=this.standardizeUserDataXY(e,t,i,s);try{const o=a[0].concat(a[1]);this.makeTestFunction();const c=this.testFunction,l=this.testLoop(c,o,s,r.verbose,r.steps);return us(l)}finally{Oi(a[0],e),Oi(a[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),Xq(this,e,t)}checkNumSamples(e,t,r,s="steps"){let i;if(r!=null){if(i=null,t!=null)throw new Oe(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?i=e[0].shape[0]:i=e.shape[0];else throw new Oe(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new Oe("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(t),s=r?t:[t],i=this.retrieveSymbolicTensors(s),a=new vo;if(e instanceof dr&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Oe(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)a.add(this.inputs[c],e[c])}else for(const c of this.inputs){const l=e[c.name];if(l==null)throw new Oe(`No value is provided for the model's input ${c.name}`);a.add(c,l)}const o=ef(i,a);return r?o:o[0]}retrieveSymbolicTensors(e){const t=Tc(null,e.length);let r=e.length;for(const s of this.layers){const i=Array.isArray(s.output)?s.output:[s.output],a=i.map(o=>o.name);for(let o=0;o<e.length;++o){const c=a.indexOf(e[o]);if(c!==-1&&(t[o]=i[c],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw t.forEach((i,a)=>{i==null&&s.push(e[a])}),new Oe(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return t}predictLoop(e,t=32,r=!1){return Ve(()=>{const s=this.checkNumSamples(e);if(r)throw new Wt("Verbose predictLoop() is not implemented yet.");const i=D1(s,t),a=this.outputs.map(o=>[]);for(let o=0;o<i.length;++o)Ve(()=>{const l=i[o][0],u=i[o][1],f=ju(e,l,u),d=[];if(Array.isArray(f))for(let m=0;m<f.length;++m)d.push({key:this.inputs[m],value:f[m]});else d.push({key:this.inputs[0],value:f});const p=new vo(d);return ef(this.outputs,p)}).forEach((l,u)=>a[u].push(l));return us(a.map(o=>hs(o,0)))})}predict(e,t={}){const r=e$(e);MC(r,this.inputNames,this.feedInputShapes,!1);try{const s=t.batchSize==null?32:t.batchSize;return F1(s),this.predictLoop(r,s)}finally{Oi(r,e)}}predictOnBatch(e){MC(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,r=!0,s){if(this.optimizer_==null)throw new di("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===zp?i.push(o.slice(0,o.length-1).concat([1])):i.push(o)}if(e=BC(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=BC(t,this.feedOutputNames,i,!1,"target"),Zq(e,t),Jq(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new Oe(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,r,s,i=!0,a){const[o,c]=this.standardizeUserDataXY(e,t,i,a);if(r!=null)throw new Error("sample weight is not supported yet.");let l=null;if(s!=null){const u=ZA(s,this.outputNames);l=[];for(let f=0;f<u.length;++f)l.push(await JA(c[f],null,u[f]))}return[o,c,l]}testLoop(e,t,r,s=0,i){return Ve(()=>{const a=this.checkNumSamples(t,r,i,"steps"),o=[];if(s>0)throw new Wt("Verbose mode is not implemented yet.");if(i!=null)throw new Wt("steps mode in testLoop() is not implemented yet");{const c=D1(a,r),l=zs(Vi(0,a));for(let u=0;u<c.length;++u){const f=c[u][0],d=c[u][1],p=vc(l,f,d-f),m=tI(t,p),I=e(m);if(u===0)for(let v=0;v<I.length;++v)o.push(bn(0));for(let v=0;v<I.length;++v){const b=I[v];o[v]=at(o[v],_e(d-f,b))}}for(let u=0;u<o.length;++u)o[u]=$t(o[u],a)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let r=0;r<e.length;++r){const s=e[r];let i=s;if(xC(e,s)>1){const a=xC(e.slice(0,r),s);i+=`_${a}`}t.push(i)}return t}makeTrainFunction(){return e=>{const t=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const f=[];for(let I=0;I<this.inputs.length;++I)f.push({key:this.inputs[I],value:r[I]});const d=new vo(f),p=ef(this.outputs,d,{training:!0});let m;for(let I=0;I<this.lossFunctions.length;++I){const v=this.lossFunctions[I];let b=v(s[I],p[I]);i[I]!=null&&(b=Wq(b,i[I]));const y=gr(b);t.push(y),I===0?m=b:m=at(m,b)}for(let I=0;I<this.metricsTensors.length;++I){let v;if(this.outputs.length>1&&I<this.outputs.length)v=t[I];else{const b=this.metricsTensors[I][0],y=this.metricsTensors[I][1];v=gr(b(s[y],p[y]))}ma(v),a.push(v)}return m=gr(m),this.calculateLosses().forEach(I=>{m=at(m,I)}),m},c=this.collectedTrainableWeights.map(f=>f.read()),l=!0;return[this.optimizer_.minimize(o,l,c)].concat(a)}}makeTestFunction(){this.testFunction=e=>Ve(()=>{const t=[];let r;const s=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let l=0;l<this.inputs.length;++l)a.push({key:this.inputs[l],value:s[l]});const o=new vo(a),c=ef(this.outputs,o);for(let l=0;l<this.lossFunctions.length;++l){const u=this.lossFunctions[l],f=gr(u(i[l],c[l]));l===0?r=f:r=at(r,f),t.push(r)}for(let l=0;l<this.metricsTensors.length;++l){const u=this.metricsTensors[l][0],f=this.metricsTensors[l][1],d=gr(u(i[f],c[f]));t.push(d)}return t})}async fit(e,t,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,i,a,o,c,l,u,f,d;try{const p=r.batchSize==null?32:r.batchSize;F1(p);const m=!1,I=await this.standardizeUserData(e,t,r.sampleWeight,r.classWeight,m,p);s=I[0],i=I[1],d=I[2];let v=!1,b;if(r.validationData!=null&&r.validationData.length>0){if(v=!0,r.validationData.length===2)c=r.validationData[0],l=r.validationData[1];else throw r.validationData.length===3?new Wt("validationData including sample weights is not supported yet."):new Oe(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const M=!0,z=await this.standardizeUserData(c,l,null,null,M,p);u=z[0],f=z[1],b=u.concat(f)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){v=!0;const M=Math.floor(s[0].shape[0]*(1-r.validationSplit)),z=s[0].shape[0];u=ju(s,M,z),a=s,s=ju(s,0,M),f=ju(i,M,z),o=i,i=ju(i,0,M),b=u.concat(f)}else r.validationSteps!=null&&(v=!0);const y=s.concat(i).concat(d);this.checkTrainableWeightsConsistency();const S=this.makeTrainFunction(),w=this.getDedupedMetricsNames();let C,N;v?(this.makeTestFunction(),C=this.testFunction,N=w.slice().concat(w.map(M=>"val_"+M))):(C=null,b=[],N=w.slice());const E=VA(r.callbacks,r.yieldEvery);return await this.fitLoop(S,y,w,p,r.epochs,r.verbose,E,C,b,r.shuffle,N,r.initialEpoch,null,null)}finally{this.isTraining=!1,Oi(s,e),Oi(i,t),Oi(a,e),Oi(o,t),Oi(u,c),Oi(f,l),d!=null&&Qt(d)}}async fitLoop(e,t,r,s,i,a,o,c,l,u,f,d,p,m){s==null&&(s=32),i==null&&(i=1),u==null&&(u=!0),d==null&&(d=0);let I=!1;if(c!=null&&l!=null&&(I=!0),m!=null&&(I=!0,p==null))throw new Oe("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,s,p,"steps_per_epoch");let b;v!=null&&(b=Vi(0,v)),a==null&&(a=1);const{callbackList:y,history:S}=WA(o,a,i,d,v,p,s,I,f);y.setModel(this),this.history=S,await y.onTrainBegin(),this.stopTraining_=!1;for(let w=d;w<i;++w){await y.onEpochBegin(w);const C={};if(p!=null)throw new Wt("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Wt("batch shuffling is not implemneted yet");u&&W6(b);const N=zs(b),E=D1(v,s);for(let A=0;A<E.length;++A){const M={};if(await y.onBatchBegin(A,M),Ve(()=>{const z=E[A][0],Y=E[A][1],re=vc(N,z,Y-z);M.batch=A,M.size=Y-z;const ne=tI(t,re),le=e(ne);for(let j=0;j<r.length;++j){const ge=r[j],Se=le[j];M[ge]=Se,ma(Se)}if(A===E.length-1&&I){const j=this.testLoop(c,l,s);for(let ge=0;ge<r.length;++ge){const Se=r[ge],me=j[ge];ma(me),C["val_"+Se]=me}}}),await y.onBatchEnd(A,M),zA(M),this.stopTraining_)break}N.dispose()}if(await y.onEpochEnd(w,C),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return qq(this,e,t)}async trainOnBatch(e,t){const r=await this.standardizeUserData(e,t),s=r[0],i=r[1],o=this.makeTrainFunction()(s.concat(i)),c=[];for(const l of o){const u=await l.data();c.push(u[0])}return Qt(o),Oi(r[0],e),Oi(r[1],t),us(c)}getNamedWeights(e){const t=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,i=this.getWeights(r);for(let a=0;a<s.length;++a)r&&!s[a].trainable||t.push({name:s[a].originalName,tensor:i[a]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=Uv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Uv().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Pa(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>Pa(t))}else{const t=Object.keys(this.loss);e={};const r=this.loss;for(const s of t)if(typeof r[s]=="string")e[s]=Pa(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Pa(Zd(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Pa(Zd(e)));{const e={};for(const t in this.metrics)e[t]=Pa(Zd(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=Qv(e.optimizer_config),r=Va(t);let s;if(typeof e.loss=="string")s=lc(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(a=>lc(a));else if(e.loss!=null){s={};for(const a in e.loss)s[a]=lc(e.loss[a])}let i;if(Array.isArray(e.metrics))i=e.metrics.map(a=>lc(a));else if(e.metrics!=null){i={};for(const a in e.metrics)i[a]=lc(e.metrics[a])}this.compile({loss:s,metrics:i,optimizer:r})}async save(e,t){if(typeof e=="string"){const l=PU(e);if(l.length===0)throw new Oe(`Cannot find any save handlers for URL '${e}'`);if(l.length>1)throw new Oe(`Found more than one (${l.length}) save handlers for URL '${e}'`);e=l[0]}if(e.save==null)throw new Oe("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await iC(this.getNamedWeights(t)),s=!1,i=null,o={modelTopology:this.toJSON(i,s),format:ej,generatedBy:`TensorFlow.js tfjs-layers v${YA}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const l="optimizer",{data:u,specs:f}=await iC(await this.optimizer.getWeights(),l);r.specs.push(...f),r.data=MU([r.data,u])}return this.userDefinedMetadata!=null&&(OC(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,e.save(o)}setUserDefinedMetadata(e){OC(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Al.className="Model";et(Al);class t$ extends Al{}t$.className="Functional";et(t$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bf extends Al{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Em("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new Oe(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof bf||e instanceof Al;let r;if(t){if(r=e,r.outputs.length!==1)throw new Oe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new Oe("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Oe("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=rq({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(t)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new Oe(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Oe("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=BA(this.outputs[0])}this.inboundNodes=[],new Am({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Tc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(dn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Al({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,r=console.log){this.built||this.build(),super.summary(e,t,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,r={}){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.evaluate(e,t,r)}async evaluateDataset(e,t){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,r={}){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.fit(e,t,r)}async fitDataset(e,t){if(!this.built)throw new di("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,r={},s=!1){let i,a={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new Oe("Legacy serialization format not supported yet.");i=t}else ce(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),i=t.layers,delete t.layers,a=t;const o=new e(a);if(!(o instanceof bf))throw new Wt(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const c of i){const u=Va(c,void 0,s);s&&u.setFastWeightInitDuringBuild(!0),o.add(u)}return o}set stopTraining(e){if(this.model==null)throw new Oe("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Oe("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const r={};r.className=t.getClassName(),r.config=t.getConfig(),e.push(r)}return{name:this.name,layers:e}}}bf.className="Sequential";et(bf);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ms=class extends tu{getConfig(){return{}}};class n$ extends ms{apply(e,t=1){return W9(e,t)}}n$.className="elu";et(n$);class r$ extends ms{apply(e){return yT(e)}}r$.className="selu";et(r$);class s$ extends ms{apply(e){return Mc(e)}}s$.className="relu";et(s$);class i$ extends ms{apply(e){return Ve(()=>gf(6,Mc(e)))}}i$.className="relu6";et(i$);class a$ extends ms{apply(e){return e}}a$.className="linear";et(a$);class o$ extends ms{apply(e){return Jl(e)}}o$.className="sigmoid";et(o$);class c$ extends ms{apply(e){return H9(e)}}c$.className="hardSigmoid";et(c$);class l$ extends ms{apply(e){return kh(e)}}l$.className="softplus";et(l$);class u$ extends ms{apply(e){return G9(e)}}u$.className="softsign";et(u$);class f$ extends ms{apply(e){return jb(e)}}f$.className="tanh";et(f$);let gx=class extends ms{apply(e,t=-1){return Iy(e,t)}};gx.className="softmax";et(gx);class h$ extends ms{apply(e,t=-1){return hT(e,t)}}h$.className="logSoftmax";et(h$);class d$ extends ms{apply(e,t=1){return Ve(()=>_e(Jl(_e(e,t)),e))}}d$.className="swish";et(d$);class p$ extends ms{apply(e){return Ve(()=>_e(e,jb(kh(e))))}}p$.className="mish";et(p$);function To(n){return n.getClassName()}function B1(n,e={}){return _h(n,li.getMap().classNameMap,e,"activation")}function Ao(n){if(n==null){const e={};return e.className="linear",e.config={},B1(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},B1(e)}else return n instanceof ms?n:B1(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tj(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class g$ extends tu{}class m$ extends g${constructor(e){super(),tj(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Ve(()=>{let t=Tr([1]);return this.hasL1&&(t=at(t,kt(_e(this.l1,Jr(e))))),this.hasL2&&(t=at(t,kt(_e(this.l2,Dh(e))))),Me(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}m$.className="L1L2";et(m$);const PC={l1l2:"L1L2"};function kn(n){return tx(n)}function LC(n,e={}){return _h(n,li.getMap().classNameMap,e,"regularizer")}function Vn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in PC?PC[n]:n,config:{}};return LC(t)}else return n instanceof g$?n:LC(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class v$ extends Zt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=Ft(e);let r=Mc(e);return this.maxValue!=null&&(r=Hs(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}v$.className="ReLU";et(v$);class I$ extends Zt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=Ft(e);return ty(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}I$.className="LeakyReLU";et(I$);class b$ extends Zt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=zn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Vn(e.alphaRegularizer),this.alphaConstraint=xr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Oe(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=dn(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)t[s-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new br({ndim:e.length,axes:r})],this.built=!0}call(e,t){return e=Ft(e),oy(e,this.alpha.read())}getConfig(){const e={alphaInitializer:qn(this.alphaInitializer),alphaRegularizer:kn(this.alphaRegularizer),alphaConstraint:yr(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}b$.className="PReLU";et(b$);let y$=class extends Zt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Wt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const r=Ft(e);return ym(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};y$.className="ELU";et(y$);class x$ extends Zt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const r=Ft(e);return _e(r,gt(qs(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}x$.className="ThresholdedReLU";et(x$);class w$ extends Zt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new gx().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){const r=Ft(e);return this.softmax(r,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}w$.className="Softmax";et(w$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $l(n,e,t){if(typeof n=="number")return Tc(n,e);if(n.length!==e)throw new Oe(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let r=0;r<e;++r){const s=n[r];if(!L9(s))throw new Oe(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${s}`)}return n}function zi(n,e,t,r,s=1){if(n==null)return n;const i=e+(e-1)*(s-1);let a;return t==="same"?a=n:a=n-i+1,Math.floor((a+r-1)/r)}function fa(n,e,t,r){if(n==null)return null;if(r==="valid")n=n*e+Eo([t-e,0]);else if(r==="same")n=n*e;else throw new Oe(`Unsupport padding mode: ${r}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mx(n,e){return Ve(()=>(ar(e),e==="channelsFirst"?ln(n,[0,2,3,1]):n))}function S$(n,e){return Ve(()=>(ar(e),e==="channelsFirst"?ln(n,[0,2,3,4,1]):n))}function nj(n,e,t,r=1,s="valid",i,a=1){return Ve(()=>{if(i==null&&(i=Wi()),ar(i),n.shape.length!==3)throw new Oe(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new Oe(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new Oe(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(i==="channelsFirst"&&(n=ln(n,[0,2,1])),s==="causal")throw new Wt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=rT(n,e,r,s==="same"?"same":"valid","NWC",a);return t!=null&&(o=qi(o,t)),o})}function UC(n,e,t,r=[1,1],s="valid",i,a,o=null){return Ve(()=>{if(i==null&&(i=Wi()),ar(i),n.rank!==3&&n.rank!==4)throw new Oe(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Oe(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let c=mx(n,i);if(s==="causal")throw new Wt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=mG({x:c,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:t,activation:o}),i==="channelsFirst"&&(c=ln(c,[0,3,1,2])),c})}function rj(n,e,t,r=[1,1,1],s="valid",i,a){return Ve(()=>{if(i==null&&(i=Wi()),ar(i),n.rank!==4&&n.rank!==5)throw new Oe(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Oe(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let o=S$(n,i);if(s==="causal")throw new Wt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=gz(o,e,r,s==="same"?"same":"valid","NDHWC",a),t!=null&&(o=qi(o,t)),i==="channelsFirst"&&(o=ln(o,[0,4,1,2,3])),o})}class Om extends Zt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Om.verifyArgs(t),this.rank=e,Ar(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Wt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=$l(t.kernelSize,e,"kernelSize"),this.strides=$l(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,js(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,ar(this.dataFormat),this.activation=Ao(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=zn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=xr(t.biasConstraint),this.biasRegularizer=Vn(t.biasRegularizer),this.activityRegularizer=Vn(t.activityRegularizer),this.dilationRate=$l(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Oe(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Oe(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Oe(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ua("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!nx(e.kernelSize,"number",1,3))throw new Oe(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:To(this.activation),useBias:this.useBias,biasInitializer:qn(this.biasInitializer),biasRegularizer:kn(this.biasRegularizer),activityRegularizer:kn(this.activityRegularizer),biasConstraint:yr(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class nu extends Om{constructor(e,t){super(e,t),this.kernel=null,nu.verifyArgs(t),this.filters=t.filters,Ar(this.filters,"filters"),this.kernelInitializer=zn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=xr(t.kernelConstraint),this.kernelRegularizer=Vn(t.kernelRegularizer)}build(e){e=dn(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Oe(`The channel dimension of the input should be defined. Found ${e[t]}`);const r=e[t],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:r}}],this.built=!0}call(e,t){return Ve(()=>{e=Ft(e);let r;const s=this.bias==null?null:this.bias.read(),i=xA(this.activation.getClassName());if(i!=null&&this.rank===2)r=UC(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(this.rank===1)r=nj(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=UC(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=rj(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Wt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=dn(e);const t=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let i=0;i<r.length;++i){const a=zi(r[i],this.kernelSize[i],this.padding,this.strides[i],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[i]);t.push(a)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(t),s.push(this.filters)):(s.push(this.filters),s=s.concat(t)),s}getConfig(){const e={filters:this.filters,kernelInitializer:qn(this.kernelInitializer),kernelRegularizer:kn(this.kernelRegularizer),kernelConstraint:yr(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Oe(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Lh extends nu{constructor(e){super(2,e),Lh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!nx(e.kernelSize,"number",1,2))throw new Oe(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Lh.className="Conv2D";et(Lh);class Uh extends nu{constructor(e){super(3,e),Uh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Oe(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Uh.className="Conv3D";et(Uh);class C$ extends Lh{constructor(e){if(super(e),this.inputSpec=[new br({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Oe(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dn(e),e.length!==4)throw new Oe("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Oe("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new br({ndim:4,axes:{[t]:r}})],this.built=!0}call(e,t){return Ve(()=>{let r=Ft(e);if(r.shape.length!==4)throw new Oe(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const c=s[a],l=s[o],u=this.kernelSize[0],f=this.kernelSize[1],d=this.strides[0],p=this.strides[1],m=fa(c,d,u,this.padding),I=fa(l,p,f,this.padding),v=[i,m,I,this.filters];this.dataFormat!=="channelsLast"&&(r=ln(r,[0,2,3,1]));let b=sT(r,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(b=ln(b,[0,3,1,2])),this.bias!=null&&(b=qi(b,this.bias.read(),this.dataFormat)),this.activation!=null&&(b=this.activation.apply(b)),b})}computeOutputShape(e){e=dn(e);const t=e.slice();let r,s,i;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3):(r=3,s=1,i=2);const a=this.kernelSize[0],o=this.kernelSize[1],c=this.strides[0],l=this.strides[1];return t[r]=this.filters,t[s]=fa(t[s],c,a,this.padding),t[i]=fa(t[i],l,o,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}C$.className="Conv2DTranspose";et(C$);class R$ extends Uh{constructor(e){if(super(e),this.inputSpec=[new br({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Oe(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=dn(e),e.length!==5)throw new Oe("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Oe("The channel dimension of the inputs should be defined. Found `None`.");const r=e[t],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new br({ndim:5,axes:{[t]:r}})],this.built=!0}call(e,t){return Ve(()=>{let r=Ft(e);if(r.shape.length!==5)throw new Oe(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,i=s[0];let a,o,c;this.dataFormat==="channelsFirst"?(c=2,a=3,o=4):(c=1,a=2,o=3);const l=s[c],u=s[a],f=s[o],d=this.kernelSize[0],p=this.kernelSize[1],m=this.kernelSize[2],I=this.strides[0],v=this.strides[1],b=this.strides[2],y=fa(l,I,d,this.padding),S=fa(u,v,p,this.padding),w=fa(f,b,m,this.padding),C=[i,y,S,w,this.filters];this.dataFormat!=="channelsLast"&&(r=ln(r,[0,2,3,4,1]));let N=Iz(r,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(N=ln(N,[0,4,1,2,3])),this.bias!==null&&(N=qi(N,this.bias.read(),this.dataFormat)),this.activation!==null&&(N=this.activation.apply(N)),N})}computeOutputShape(e){e=dn(e);const t=e.slice();let r,s,i,a;this.dataFormat==="channelsFirst"?(r=1,s=2,i=3,a=4):(r=4,s=1,i=2,a=3);const o=this.kernelSize[0],c=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],f=this.strides[1],d=this.strides[2];return t[r]=this.filters,t[s]=fa(t[s],u,o,this.padding),t[i]=fa(t[i],f,c,this.padding),t[a]=fa(t[a],d,l,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}R$.className="Conv3DTranspose";et(R$);class k$ extends nu{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new Oe("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new Oe("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new Oe(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=zn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Vn(t.depthwiseRegularizer),this.depthwiseConstraint=xr(t.depthwiseConstraint),this.pointwiseInitializer=zn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Vn(t.pointwiseRegularizer),this.pointwiseConstraint=xr(t.pointwiseConstraint)}build(e){if(e=dn(e),e.length<this.rank+2)throw new Oe(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new Oe(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const r=e[t],s=this.kernelSize.concat([r,this.depthMultiplier]),i=[];for(let o=0;o<this.rank;++o)i.push(1);i.push(r*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new br({ndim:this.rank+2,axes:{[t]:r}})],this.built=!0}call(e,t){return Ve(()=>{e=Ft(e);let r;if(this.rank===1)throw new Wt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=ln(e,[0,2,3,1])),r=xT(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=qi(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=ln(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=qn(this.depthwiseInitializer),e.pointwiseInitializer=qn(this.pointwiseInitializer),e.depthwiseRegularizer=kn(this.depthwiseRegularizer),e.pointwiseRegularizer=kn(this.pointwiseRegularizer),e.depthwiseConstraint=yr(this.depthwiseConstraint),e.pointwiseConstraint=yr(this.pointwiseConstraint),e}}k$.className="SeparableConv";class E$ extends k${constructor(e){super(2,e)}}E$.className="SeparableConv2D";et(E$);class _m extends nu{constructor(e){super(1,e),_m.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!nx(e.kernelSize,"number",1,1))throw new Oe(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}_m.className="Conv1D";et(_m);class T$ extends Zt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return Ve(()=>{if(e=Ft(e),this.dataFormat==="channelsLast"){const r=Yd(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Yd(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Yd(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Yd(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}T$.className="Cropping2D";et(T$);class A$ extends Zt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ar(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,B9(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,r]}else{const t=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],t,r,e[3]]}}call(e,t){return Ve(()=>{let r=Ft(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=ln(r,[0,2,3,1]);const i=this.size[0]*s[2],a=this.size[1]*s[3],o=this.interpolation==="nearest"?Ua.resizeNearestNeighbor(r,[i,a]):Ua.resizeBilinear(r,[i,a]);return ln(o,[0,3,1,2])}else{const i=this.size[0]*s[1],a=this.size[1]*s[2];return this.interpolation==="nearest"?Ua.resizeNearestNeighbor(r,[i,a]):Ua.resizeBilinear(r,[i,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}A$.className="UpSampling2D";et(A$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sj(n,e,t=[1,1],r="valid",s,i){return Ve(()=>{s==null&&(s=Wi()),ar(s);let a=mx(n,s);if(n.rank!==4)throw new Oe(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new Oe(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=Zb(a,e,t,r==="same"?"same":"valid","NHWC",i),s==="channelsFirst"&&(a=ln(a,[0,3,1,2])),a})}class $$ extends Om{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=zn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=xr(e.depthwiseConstraint),this.depthwiseRegularizer=Vn(e.depthwiseRegularizer)}build(e){if(e=dn(e),e.length<4)throw new Oe(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new Oe(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const r=e[t],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ve(()=>{e=Ft(e);let r=sj(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=qi(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=dn(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=zi(t,this.kernelSize[0],this.padding,this.strides[0]),a=zi(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,i,a]:[e[0],i,a,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=qn(this.depthwiseInitializer),e.depthwiseRegularizer=kn(this.depthwiseRegularizer),e.depthwiseConstraint=yr(this.depthwiseRegularizer),e}}$$.className="DepthwiseConv2D";et($$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N$(n,e,t,r){if(Array.isArray(n)){if(e!=null||t!=null)throw new Oe("When inputs is an array, neither initialState or constants should be provided");r!=null&&(t=n.slice(n.length-r,n.length),n=n.slice(0,n.length-r)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function s(i){return i==null||Array.isArray(i)?i:[i]}return e=s(e),t=s(t),{inputs:n,initialState:e,constants:t}}function O$(n,e,t,r=!1,s,i,a=!1,o=!1){return Ve(()=>{const c=e.shape.length;if(c<3)throw new Oe(`Input should be at least 3D, but is ${c}D.`);const l=[1,0].concat(Vi(2,c));if(e=ln(e,l),i!=null)throw new Wt("The rnn() functoin of the deeplearn.js backend does not support constants yet.");a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=gt(gt(s,"bool"),"float32"),s.rank===c-1&&(s=Cs(s,-1)),s=ln(s,l)),r&&(e=kc(e,0),s!=null&&(s=kc(s,0)));const u=[];let f,d=t;const p=e.shape[0],m=Ec(e);let I;s!=null&&(I=Ec(s));for(let b=0;b<p;++b){const y=m[b],S=Ve(()=>n(y,d));if(s==null)f=S[0],d=S[1];else{const w=Ve(()=>{const C=I[b],N=Bt(Ii(C),C),E=at(_e(S[0],C),_e(d[0],N)),A=d.map((M,z)=>at(_e(S[1][z],C),_e(M,N)));return{output:E,newStates:A}});f=w.output,d=w.newStates}o&&u.push(f)}let v;return o&&(v=ko(u,1)),[f,v,d]})}class Lo extends Zt{constructor(e){super(e);let t;if(e.cell==null)throw new Oe("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new bx({cells:e.cell}):t=e.cell,t.stateSize==null)throw new Oe("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new br({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Vi(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Yv(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const r=t[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const i=[];for(const a of t)i.push([e[0],a]);return[s].concat(i)}else return s}computeMask(e,t){return Ve(()=>{Array.isArray(t)&&(t=t[0]);const r=this.returnSequences?t:null;if(this.returnState){const s=this.states.map(i=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let r=0;r<e;++r)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Wt("Constants support is not implemented in RNN yet.");Yv(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new br({shape:[t,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let i;if(Array.isArray(this.cell.stateSize)?i=this.cell.stateSize:i=[this.cell.stateSize],this.stateSpec!=null){if(!vn(this.stateSpec.map(a=>a.shape[a.shape.length-1]),i))throw new Oe(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(a=>new br({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){Ve(()=>{if(!this.stateful)throw new la("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new Oe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Tr([r,s])):this.states_=[Tr([r,this.cell.stateSize])];else if(e==null)Qt(this.states_),this.keptStates!=null&&(Qt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>Tr([r,s])):this.states_[0]=Tr([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Oe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):Qt(this.states_);for(let s=0;s<this.states_.length;++s){const i=e[s],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,o=[r,a];if(!vn(i.shape,o))throw new Oe(`State ${s} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${i.shape}`);this.states_[s]=i}}this.states_=this.states_.map(s=>ma(s.clone()))})}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=N$(e,r,s,this.numConstants);e=i.inputs,r=i.initialState,s=i.constants;let a=[],o=[];if(r!=null){t.initialState=r,a=a.concat(r),this.stateSpec=[];for(const l of r)this.stateSpec.push(new br({shape:l.shape}));o=o.concat(this.stateSpec)}if(s!=null&&(t.constants=s,a=a.concat(s),this.numConstants=s.length),a[0]instanceof da){const l=[e].concat(a),u=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=u;const d=super.apply(l,t);return this.inputSpec=f,d}else return super.apply(e,t)}call(e,t){return Ve(()=>{const r=t==null?null:t.mask,s=t==null?null:t.training;let i=t==null?null:t.initialState;e=Ft(e),i==null&&(this.stateful?i=this.states_:i=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new Oe(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:s},l=O$((m,I)=>{const v=this.cell.call([m].concat(I),o);return[v[0],v.slice(1)]},e,i,this.goBackwards,r,null,this.unroll,this.returnSequences),u=l[0],f=l[1],d=l[2];this.stateful&&this.resetStates(d,s);const p=this.returnSequences?f:u;return this.returnState?[p].concat(d):p})}getInitialState(e){return Ve(()=>{let t=Tr(e.shape);return t=kt(t,[1,2]),t=Fh(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?Kv(t,[1,r]):t):this.cell.stateSize>1?[Kv(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Lo.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}static fromConfig(e,t,r={}){const s=t.cell,i=Va(s,r);return new e(Object.assign(t,{cell:i}))}}Lo.className="RNN";et(Lo);class Fm extends Zt{}class vx extends Fm{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ar(this.units,"units"),this.activation=Ao(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Vn(e.kernelRegularizer),this.recurrentRegularizer=Vn(e.recurrentRegularizer),this.biasRegularizer=Vn(e.biasRegularizer),this.kernelConstraint=xr(e.kernelConstraint),this.recurrentConstraint=xr(e.recurrentConstraint),this.biasConstraint=xr(e.biasConstraint),this.dropout=Ll([1,Eo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ll([1,Eo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ve(()=>{if(e=e,e.length!==2)throw new Oe(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$o({ones:()=>Ii(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$o({ones:()=>Ii(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let i;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?i=ba(_e(e,a),this.kernel.read()):i=ba(e,this.kernel.read()),this.bias!=null&&(i=qi(i,this.bias.read())),o!=null&&(r=_e(r,o));let c=at(i,ba(r,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:To(this.activation),useBias:this.useBias,kernelInitializer:qn(this.kernelInitializer),recurrentInitializer:qn(this.recurrentInitializer),biasInitializer:qn(this.biasInitializer),kernelRegularizer:kn(this.kernelRegularizer),recurrentRegularizer:kn(this.recurrentRegularizer),biasRegularizer:kn(this.biasRegularizer),activityRegularizer:kn(this.activityRegularizer),kernelConstraint:yr(this.kernelConstraint),recurrentConstraint:yr(this.recurrentConstraint),biasConstraint:yr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}vx.className="SimpleRNNCell";et(vx);class _$ extends Lo{constructor(e){e.cell=new vx(e),super(e)}call(e,t){return Ve(()=>{this.cell.dropoutMask!=null&&(Qt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return new e(t)}}_$.className="SimpleRNN";et(_$);class Ix extends Fm{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Oe("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Ar(this.units,"units"),this.activation=Ao(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ao(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Vn(e.kernelRegularizer),this.recurrentRegularizer=Vn(e.recurrentRegularizer),this.biasRegularizer=Vn(e.biasRegularizer),this.kernelConstraint=xr(e.kernelConstraint),this.recurrentConstraint=xr(e.recurrentConstraint),this.biasConstraint=xr(e.biasConstraint),this.dropout=Ll([1,Eo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ll([1,Eo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=dn(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return Ve(()=>{if(e=e,e.length!==2)throw new Oe(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training==null?!1:t.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$o({ones:()=>Ii(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$o({ones:()=>Ii(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let o,c,l;0<this.dropout&&this.dropout<1&&(e=_e(e,i[0]));let u=ba(e,this.kernel.read());this.useBias&&(u=qi(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_e(s,a[0]));const f=this.recurrentKernel.read(),[d,p]=Gs(f,[2*this.units,this.units],f.rank-1),m=ba(s,d),[I,v,b]=Gs(u,3,u.rank-1),[y,S]=Gs(m,2,m.rank-1);o=this.recurrentActivation.apply(at(I,y)),c=this.recurrentActivation.apply(at(v,S));const w=ba(_e(c,s),p);l=this.activation.apply(at(b,w));const C=at(_e(o,s),_e(at(1,rr(o)),l));return[C,C]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:To(this.activation),recurrentActivation:To(this.recurrentActivation),useBias:this.useBias,kernelInitializer:qn(this.kernelInitializer),recurrentInitializer:qn(this.recurrentInitializer),biasInitializer:qn(this.biasInitializer),kernelRegularizer:kn(this.kernelRegularizer),recurrentRegularizer:kn(this.recurrentRegularizer),biasRegularizer:kn(this.biasRegularizer),activityRegularizer:kn(this.activityRegularizer),kernelConstraint:yr(this.kernelConstraint),recurrentConstraint:yr(this.recurrentConstraint),biasConstraint:yr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}Ix.className="GRUCell";et(Ix);class F$ extends Lo{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ix(e),super(e)}call(e,t){return Ve(()=>{this.cell.dropoutMask!=null&&(Qt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}F$.className="GRU";et(F$);class Dm extends Fm{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Ar(this.units,"units"),this.activation=Ao(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ao(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=zn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=zn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=zn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Vn(e.kernelRegularizer),this.recurrentRegularizer=Vn(e.recurrentRegularizer),this.biasRegularizer=Vn(e.biasRegularizer),this.kernelConstraint=xr(e.kernelConstraint),this.recurrentConstraint=xr(e.recurrentConstraint),this.biasConstraint=xr(e.biasConstraint),this.dropout=Ll([1,Eo([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ll([1,Eo([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=dn(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const i=this.biasInitializer,a=this.units;s=new(t=class extends wi{apply(c,l){const u=i.apply([a]),f=new sx().apply([a]),d=i.apply([a*2]);return SC(SC(u,f),d)}},t.className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return Ve(()=>{const r=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new Oe(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$o({ones:()=>Ii(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$o({ones:()=>Ii(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let c,l,u,f;0<this.dropout&&this.dropout<1&&(e=_e(e,a[0]));let d=ba(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=_e(s,o[0])),d=at(d,ba(s,this.recurrentKernel.read())),this.useBias&&(d=qi(d,this.bias.read()));const[p,m,I,v]=Gs(d,4,d.rank-1);c=this.recurrentActivation.apply(p),l=this.recurrentActivation.apply(m),u=at(_e(l,i),_e(c,this.activation.apply(I))),f=this.recurrentActivation.apply(v);const b=_e(f,this.activation.apply(u));return[b,b,u]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:To(this.activation),recurrentActivation:To(this.recurrentActivation),useBias:this.useBias,kernelInitializer:qn(this.kernelInitializer),recurrentInitializer:qn(this.recurrentInitializer),biasInitializer:qn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:kn(this.kernelRegularizer),recurrentRegularizer:kn(this.recurrentRegularizer),biasRegularizer:kn(this.biasRegularizer),activityRegularizer:kn(this.activityRegularizer),kernelConstraint:yr(this.kernelConstraint),recurrentConstraint:yr(this.recurrentConstraint),biasConstraint:yr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Dm.className="LSTMCell";et(Dm);class D$ extends Lo{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Dm(e),super(e)}call(e,t){return Ve(()=>{this.cell.dropoutMask!=null&&(Qt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}D$.className="LSTM";et(D$);class bx extends Fm{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return Ve(()=>{e=e;let r=e.slice(1);const s=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?s.push(r.splice(0,o.stateSize.length)):s.push(r.splice(0,1));s.reverse();const i=[];let a;for(let o=0;o<this.cells.length;++o){const c=this.cells[o];r=s[o],o===0?a=[e[0]].concat(r):a=[a[0]].concat(r),a=c.call(a,t),i.push(a.slice(1))}r=[];for(const o of i.slice().reverse())r.push(...o);return[a[0]].concat(r)})}build(e){Yv(e)&&(e=e[0]),e=e;let t;this.cells.forEach((r,s)=>{mc(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?t=r.stateSize[0]:t=r.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=i=>({className:i.getClassName(),config:i.getConfig()}),s={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,t,r={}){const s=[];for(const i of t.cells)s.push(Va(i,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const r of this.cells)t.push(...r.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return Zv(e)}setWeights(e){const t=[];for(const r of this.cells){const s=r.weights.length,i=e.splice(s);for(let a=0;a<r.weights.length;++a)t.push([r.weights[a],i[a]])}fx(t)}}bx.className="StackedRNNCells";et(bx);function $o(n){const{ones:e,rate:t,training:r=!1,count:s=1,dropoutFunc:i}=n,a=()=>i!=null?i(e(),t):TA(e(),t),o=()=>Bh(a,e,r);return!s||s<=1?ma(o().clone()):Array(s).fill(void 0).map(o).map(l=>ma(l.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var ij=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class B$ extends Lo{constructor(e){if(e.unroll)throw new Wt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Wt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new br({ndim:5})]}call(e,t){return Ve(()=>{if(this.cell.dropoutMask!=null&&(Qt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Oe("ConvRNN2D cell does not support constants");const r=t==null?null:t.mask,s=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:r,training:s,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return Ve(()=>{const{stateSize:t}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)],a=Tr(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){Ve(()=>{if(!this.stateful)throw new la("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),i=[s[0],...s.slice(2)];if(r[0]==null)throw new Oe("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Tr(i)):this.states_=[Tr(i)];else if(e==null)Qt(this.states_),this.keptStates!=null&&(Qt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Tr(i)):this.states_[0]=Tr(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Oe(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):Qt(this.states_);for(let o=0;o<this.states_.length;++o){const c=e[o],l=i;if(!vn(c.shape,l))throw new Oe(`State ${o} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${c.shape}`);this.states_[o]=c}}this.states_=this.states_.map(o=>ma(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:r,kernelSize:s,padding:i,strides:a,dilationRate:o}=this.cell,c=t==="channelsFirst",l=e[c?3:2],u=e[c?4:3],f=zi(l,s[0],i,a[0],o[0]),d=zi(u,s[1],i,a[1],o[1]);return[...e.slice(0,2),...c?[r,f,d]:[f,d,r]]}}B$.className="ConvRNN2D";class yx extends Dm{constructor(e){const{filters:t,kernelSize:r,strides:s,padding:i,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Ar(this.filters,"filters"),this.kernelSize=$l(r,2,"kernelSize"),this.kernelSize.forEach(c=>Ar(c,"kernelSize")),this.strides=$l(s||1,2,"strides"),this.strides.forEach(c=>Ar(c,"strides")),this.padding=i||"valid",js(this.padding),this.dataFormat=a||"channelsLast",ar(this.dataFormat),this.dilationRate=$l(o||1,2,"dilationRate"),this.dilationRate.forEach(c=>Ar(c,"dilationRate"))}build(e){var t;e=dn(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new Oe(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],i=4,a=this.kernelSize.concat([s,this.filters*i]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*i]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const l=this.biasInitializer,u=this.filters;c=new(t=class extends wi{apply(d,p){const m=l.apply([u]),I=Dc([u]),v=l.apply([u*2]);return rx([m,I,v])}},t.className="CustomInit",t)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*i],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return Ve(()=>{if(e.length!==3)throw new Oe(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=t.training||!1,s=e[0],i=e[1],a=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=$o({ones:()=>Ii(s),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,l=(Ce,he,Ne)=>!he||!he[Ne]?Ce:_e(he[Ne],Ce);let u=l(s,c,0),f=l(s,c,1),d=l(s,c,2),p=l(s,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=$o({ones:()=>Ii(i),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let I=l(i,m,0),v=l(i,m,1),b=l(i,m,2),y=l(i,m,3);const S=3,[w,C,N,E]=Gs(this.kernel.read(),o,S),[A,M,z,Y]=this.useBias?Gs(this.bias.read(),o):[null,null,null,null];u=this.inputConv(u,w,A,this.padding),f=this.inputConv(f,C,M,this.padding),d=this.inputConv(d,N,z,this.padding),p=this.inputConv(p,E,Y,this.padding);const[re,ne,le,j]=Gs(this.recurrentKernel.read(),o,S);I=this.recurrentConv(I,re),v=this.recurrentConv(v,ne),b=this.recurrentConv(b,le),y=this.recurrentConv(y,j);const ge=this.recurrentActivation.apply(at(u,I)),Se=this.recurrentActivation.apply(at(f,v)),me=at(_e(Se,a),_e(ge,this.activation.apply(at(d,b)))),ye=_e(this.recurrentActivation.apply(at(p,y)),this.activation.apply(me));return[ye,ye,me]})}getConfig(){const e=super.getConfig(),t=ij(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}inputConv(e,t,r,s){const i=Rc(e,t,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?qi(i,r,this.dataFormat):i}recurrentConv(e,t){return Rc(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}yx.className="ConvLSTM2DCell";et(yx);class M$ extends B${constructor(e){const t=new yx(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}M$.className="ConvLSTM2D";et(M$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xx extends Zt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?t[s]:this.noiseShape[s]);return r}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e);if(0<this.rate&&this.rate<1){const s=t.training==null?!1:t.training,i=this.getNoiseShape(r);return Bh(()=>TA(r,this.rate,i,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}xx.className="Dropout";et(xx);class P$ extends xx{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}P$.className="SpatialDropout1D";et(P$);class L$ extends Zt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Ar(this.units,"units"),this.activation=Ao(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=zn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=zn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=xr(e.kernelConstraint),this.biasConstraint=xr(e.biasConstraint),this.kernelRegularizer=Vn(e.kernelRegularizer),this.biasRegularizer=Vn(e.biasRegularizer),this.activityRegularizer=Vn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=dn(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=dn(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e),s=xA(this.activation.getClassName());let i;return s!=null?i=ba(r,this.kernel.read(),s,this.bias?this.bias.read():null):(i=ba(r,this.kernel.read()),this.bias!=null&&(i=qi(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))),i})}getConfig(){const e={units:this.units,activation:To(this.activation),useBias:this.useBias,kernelInitializer:qn(this.kernelInitializer),biasInitializer:qn(this.biasInitializer),kernelRegularizer:kn(this.kernelRegularizer),biasRegularizer:kn(this.biasRegularizer),activityRegularizer:kn(this.activityRegularizer),kernelConstraint:yr(this.kernelConstraint),biasConstraint:yr(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}L$.className="Dense";et(L$);class U$ extends Zt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=dn(e);for(const t of e.slice(1))if(t==null)throw new Oe(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],wo(e,1)]}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);let r=Ft(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let i=2;i<r.rank;++i)s.push(i);s.push(1),r=ln(r,s)}return V9(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}U$.className="Flatten";et(U$);class z$ extends Zt{constructor(e){super(e),this.supportsMasking=!0,this.activation=Ao(e.activation)}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e);return this.activation.apply(r)})}getConfig(){const e={activation:To(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}z$.className="Activation";et(z$);class V$ extends Zt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return Ve(()=>(e=Ft(e),U9(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}V$.className="RepeatVector";et(V$);class W$ extends Zt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const r="Total size of new array must be unchanged.",s=t.slice();let i=1,a=null;for(let c=0;c<s.length;++c){const l=s[c];if(this.isUnknown(l))if(a===null)a=c;else throw new Oe("Can only specifiy one unknown dimension.");else i*=l}const o=wo(e);if(a!==null){if(i===0||o%i!==0)throw new Oe(r);s[a]=o/i}else if(o!==i)throw new Oe(r);return s}computeOutputShape(e){let t=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e),s=r.shape,i=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return Me(r,i)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}W$.className="Reshape";et(W$);class G$ extends Zt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Vi(1,e.dims.length+1);if(!vn(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new br({ndim:this.dims.length+1})]}computeOutputShape(e){e=dn(e);const t=e.slice();return this.dims.forEach((r,s)=>{t[s+1]=e[r]}),t}call(e,t){return ln(Ft(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}G$.className="Permute";et(G$);class H$ extends Zt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const r=Ft(e),s=-1;return zv(_p(r,this.maskValue),s)}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e),s=-1,i=!0,a=zv(_p(r,this.maskValue),s,i);return _e(r,gt(a,r.dtype))})}}H$.className="Masking";et(H$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class q$ extends Zt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Fn(e.inputLength))}this.inputDim=e.inputDim,Ar(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Ar(this.outputDim,"outputDim"),this.embeddingsInitializer=zn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Vn(e.embeddingsRegularizer),this.activityRegularizer=Vn(e.activityRegularizer),this.embeddingsConstraint=xr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return Ve(()=>this.maskZero?(e=Ft(e),_p(e,un(e))):null)}computeOutputShape(e){if(e=dn(e),this.inputLength==null)return[...e,this.outputDim];const t=Fn(this.inputLength);if(t.length!==e.length-1)throw new Oe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<t.length;++s){const i=t[s],a=e[s+1];if(i!=null&&a!=null&&i!==a)throw new Oe(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i==null&&(t[r]=a),r++}}return[e[0],...t,this.outputDim]}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);let r=Ft(e);r.dtype!=="int32"&&(r=Ia(r,"int32"));const s=EA(this.embeddings.read(),Me(r,[r.size]));return Me(s,dn(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:qn(this.embeddingsInitializer),embeddingsRegularizer:kn(this.embeddingsRegularizer),activityRegularizer:kn(this.activityRegularizer),embeddingsConstraint:yr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}q$.className="Embedding";et(q$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Uc extends Zt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Wt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const r=e.slice(0,e.length-t.length);for(let s=0;s<t.length;++s){const i=e[e.length-t.length+s],a=t[s];if(i==null||a==null||i<0||a<0)r.push(null);else if(i===1)r.push(a);else if(a===1)r.push(i);else{if(i!==a)throw new Oe("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));r.push(i)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[dn(e)]),e=e,e.length<2)throw new Oe(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const i of e)i!=null&&i[0]!==null&&t.push(i[0]);if(t=xo(t),t.length>1)throw new Oe(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let i=1;i<e.length;++i){const a=e[i]==null?null:e[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}const s=e.map(i=>i.length);e.indexOf(null)===-1&&xo(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return Ve(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(i=>i.rank);if(s.indexOf(null)===-1){const i=Eo(s);for(let a of e){const o=a.rank;for(let c=0;c<i-o;++c)a=Fh(a,1);r.push(a)}return this.mergeFunction(r)}else{let i=!1;for(const c of e){const l=c.rank;if(l==null){const u=c.shape,f=u[0],d=u.slice(1).concat([f]);let p=Me(c,[f].concat(wo(u.slice(1))));p=ln(p,[1,0]),p=Me(p,d),r.push(p),i=!0}else if(l>1){const u=Vi(1,l).concat([0]);r.push(ln(c,u)),i=!0}else r.push(c)}let a=this.mergeFunction(r);const o=a.rank;if(i){if(o==null){const c=a.shape,l=c.length,u=c[l-1],f=[u].concat(c.slice(0,c.length-1));a=Me(ln(Me(a,[-1,u]),[1,0]),f)}else if(o>1){const c=[o-1].concat(Vi(0,o-1));a=ln(a,c)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let s=1;s<e.length;++s){const i=e[s]==null?null:e[s].slice(1);t=this.computeElementwiseOpOutputShape(t,i)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=xo(r),r.length===1?t=r.concat(t):t=[null].concat(t),t}computeMask(e,t){return Ve(()=>{if(t==null)return null;if(!Array.isArray(t))throw new Oe("`mask` should be an Array");if(!Array.isArray(e))throw new Oe("`inputs` should be an Array");if(t.length!==e.length)throw new Oe(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(s=>s==null))return null;t=t.map(s=>s==null?s:Cs(s,0));let r=t[0];for(let s=1;s<t.length-1;++s)r=Ga(r,t[s]);return r})}}class j$ extends Uc{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=at(t,e[r]);return t})}}j$.className="Add";et(j$);class K$ extends Uc{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=_e(t,e[r]);return t})}}K$.className="Multiply";et(K$);class X$ extends Uc{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let t=e[0].clone();for(let r=1;r<e.length;++r)t=at(t,e[r]);return _e(1/e.length,t)})}}X$.className="Average";et(X$);class Y$ extends Uc{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=Mo(t,e[r]);return t})}}Y$.className="Maximum";et(Y$);class Z$ extends Uc{constructor(e){super(e)}mergeFunction(e){return Ve(()=>{let t=e[0];for(let r=1;r<e.length;++r)t=gf(t,e[r]);return t})}}Z$.className="Minimum";et(Z$);class J$ extends Uc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Oe("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const s of e)if(s!=null){t=!1;break}if(t)return;const r=[];for(let s=0;s<e.length;++s){const i=e[s].slice();i.splice(this.axis,1);let a=!1;for(const o of r)if(vn(o,i)){a=!0;break}a||r.push(i)}if(r.length>1)throw new Oe("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ve(()=>rx(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Oe("A `Concatenate` layer should be called on a list of inputs.");const t=e,r=t[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const i of t.slice(1)){if(r[s]==null||i[s]==null){r[s]=null;break}r[s]+=i[s]}return r}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new Oe("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Oe("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Oe(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return Ve(()=>{let r=!0;if(t.forEach(a=>{if(a!=null){r=!1;return}}),r)return null;const s=[];for(let a=0;a<e.length;++a)t[a]==null?s.push(gt(Ii(e[a]),"bool")):t[a].rank<e[a].rank?s.push(Cs(t[a],-1)):s.push(t[a]);const i=hs(s,this.axis);return nT(i,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}J$.className="Concatenate";et(J$);function Ku(n,e){for(;n<0;)n+=e;return n}function aj(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new Wt("batchDot is not implemented for tensors of 4D or higher rank yet");if(ce(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),ce(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new Wt("batchDot is not implemented for complex64-type Tensors yet.");const r=n.shape.length,s=e.shape.length;t==null&&(t=[r-1,s-2]);const i=t;return Ve(()=>{let a;if(r>s){a=r-s;const c=[];for(let l=0;l<a;++l)c.push(1);e=Me(e,e.shape.concat(c))}else if(s>r){a=s-r;const c=[];for(let l=0;l<a;++l)c.push(1);n=Me(n,n.shape.concat(c))}else a=0;let o;if(n.shape.length===2&&e.shape.length===2)i[0]===i[1]?o=kt(_e(n,e),i[0]):o=kt(_e(ln(n,[1,0]),e),i[1]);else{const c=i[0]!==n.shape.length-1,l=i[1]===e.shape.length-1;o=mn(n,e,c,l)}if(a>0){let c;r>s?c=r+s-3:c=r-1;const l=[];for(let u=c;u<c+a;++u)l.push(u);o=Th(o,l)}return o.shape.length===1&&(o=Cs(o,1)),o})}class Q$ extends Uc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){ce(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],r=e[1];if(t.length>3||r.length>3)throw new Wt("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);if(t[s[0]]!==r[s[1]])throw new Oe(`Dimension incompatibility: ${t[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Oe(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((i,a)=>Ku(i,e[a].shape.length)):s=[Ku(this.axes,t.shape.length),Ku(this.axes,r.shape.length)],this.normalize&&(t=Up(t,s[0]),r=Up(r,s[1])),aj(t,r,s)}interpretAxes(e,t){let r;return Array.isArray(this.axes)?r=this.axes:r=[Ku(this.axes,e.length),Ku(this.axes,t.length)],r}computeOutputShape(e){ce(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),r=e[1].slice();if(t.length>3||r.length>3)throw new Wt("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(t,r);t.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const i=t.concat(r);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}Q$.className="Dot";et(Q$);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class eN extends Zt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e);return Bh(()=>at(Tm(r.shape,0,this.stddev),r),()=>r,t.training||!1)})}}eN.className="GaussianNoise";et(eN);class tN extends Zt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ve(()=>{this.invokeCallHook(e,t);const r=Ft(e);return this.rate>0&&this.rate<1?Bh(()=>{const i=Math.sqrt(this.rate/(1-this.rate));return _e(r,Tm(r.shape,1,i))},()=>r,t.training||!1):r})}}tN.className="GaussianDropout";et(tN);class nN extends Zt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Ft(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return Ve(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Bh(()=>{const i=Ft(e),a=1.6732632423543772,o=1.0507009873554805,c=-a*o;let l=Fc(Eh(r),this.rate);l=Ia(l,"float32");const u=((1-this.rate)*(1+this.rate*c**2))**-.5,f=-u*c*this.rate,d=at(_e(i,l),_e(at(l,-1),c));return at(_e(d,u),f)},()=>Ft(e),t.training||!1)}return e})}}nN.className="AlphaDropout";et(nN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yf(n,e,t,r,s,i=.001){let a;if(n.rank===2)a=H8(n,e,t,r,s,i);else if(n.rank===3)a=j8(n,e,t,r,s,i);else if(n.rank===4)a=X8(n,e,t,r,s,i);else throw new Wt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return a}function oj(n,e,t,r,s=.001){return Ve(()=>{const i=sy(n,r),a=i.mean,o=i.variance;return[yf(n,a,o,t,e,s),a,o]})}function cj(n,e,t,r,s=.001){return Ve(()=>{const i=sy(n,r),a=i.mean,o=i.variance,c=[];for(const m of Vi(0,n.rank))r.indexOf(m)!==-1?c.push(1):c.push(n.shape[m]);const l=Me(a,c),u=Me(o,c),f=e==null?null:Me(e,c),d=t==null?null:Me(t,c);return[yf(n,l,u,d,f,s),a,o]})}function lj(n,e,t,r,s=.001){return vn(r.slice().sort(),Vi(0,n.rank-1))?oj(n,e,t,r,s):cj(n,e,t,r,s)}class rN extends Zt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zn(e.betaInitializer||"zeros"),this.gammaInitializer=zn(e.gammaInitializer||"ones"),this.movingMeanInitializer=zn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=zn(e.movingVarianceInitializer||"ones"),this.betaConstraint=xr(e.betaConstraint),this.gammaConstraint=xr(e.gammaConstraint),this.betaRegularizer=Vn(e.betaRegularizer),this.gammaRegularizer=Vn(e.gammaRegularizer)}build(e){e=dn(e);const t=this.axis>=0?this.axis:this.axis+e.length,r=e[t];if(r==null)throw new Oe(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new br({ndim:e.length,axes:{[t]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return Ve(()=>{const r=t.training==null?!1:t.training,s=Ft(e),i=s.shape,a=i.length,o=Vi(0,a),c=this.axis>=0?this.axis:this.axis+a;o.splice(c,1);const l=Tc(1,a);l[c]=i[c];const u=o.slice();u.sort();const f=!vn(u,Vi(0,a).slice(0,a-1)),d=()=>{if(f){const y=Me(this.movingMean.read(),l),S=Me(this.movingVariance.read(),l),w=this.center?Me(this.beta.read(),l):null,C=this.scale?Me(this.gamma.read(),l):null;return yf(s,y,S,w,C,this.epsilon)}else return yf(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[p,m,I]=lj(s,this.gamma.read(),this.beta.read(),o,this.epsilon),v=(y,S,w)=>{Ve(()=>{const C=1-w,N=y.read(),E=_e(Bt(N,S),C);y.write(Bt(N,E))})};return(()=>{v(this.movingMean,m,this.momentum),v(this.movingVariance,I,this.momentum)})(),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:qn(this.betaInitializer),gammaInitializer:qn(this.gammaInitializer),movingMeanInitializer:qn(this.movingMeanInitializer),movingVarianceInitializer:qn(this.movingVarianceInitializer),betaRegularizer:kn(this.betaRegularizer),gammaRegularizer:kn(this.gammaRegularizer),betaConstraint:yr(this.betaConstraint),gammaConstraint:yr(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}rN.className="BatchNormalization";et(rN);class sN extends Zt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=zn(e.betaInitializer||"zeros"),this.gammaInitializer=zn(e.gammaInitializer||"ones"),this.betaRegularizer=Vn(e.betaRegularizer),this.gammaRegularizer=Vn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=dn(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=t);for(const i of this.axis)if(i<0||i>=t)throw new Error(`Invalid axis: ${i}`);if(this.axis.length!==xo(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(i=>e[i]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,t){const r=Ft(e),s=r.shape,i=s.length;return Ve(()=>{let{mean:o,variance:c}=sy(r,this.axis,!0);const l=Tc(1,i);for(const I of this.axis)l[I]=s[I];const u=I=>I!=null&&I.shape.length!==i?Me(I,l):I;let f=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const p=[],m=[];for(let I=0;I<i;++I)this.axis.indexOf(I)!==-1?(p.push(s[I]),m.push(1)):(p.push(1),m.push(s[I]));return o=Pi(o,p),c=Pi(c,p),f!=null&&(f=Pi(f,m)),d!=null&&(d=Pi(d,m)),yf(r,o,c,d,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:qn(this.betaInitializer),gammaInitializer:qn(this.gammaInitializer),betaRegularizer:kn(this.betaRegularizer),gammaRegularizer:kn(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}sN.className="LayerNormalization";et(sN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function uj(n,e,t){return Ve(()=>{if(n.rank!==4)throw new Oe(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Oe("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=Wi()),t!=="channelsLast"&&t!=="channelsFirst")throw new Oe(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return t==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],iy(n,r)})}class iN extends Zt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Wi():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Oe(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,r;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Oe(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new Oe(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[t,r]}this.inputSpec=[new br({ndim:4})]}computeOutputShape(e){e=dn(e);let t,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],t,r]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],t,r,e[3]])}call(e,t){return Ve(()=>uj(Ft(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}iN.className="ZeroPadding2D";et(iN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bm(n,e,t,r,s,i){return Ve(()=>{ar(s),SA(i),js(r),t==null&&(t=[1,1]),r==null&&(r="valid"),s==null&&(s=Wi()),i==null&&(i="max"),n=mx(n,s);let a;const o=r==="same"?"same":"valid";return i==="max"?a=ry(n,e,t,o):a=qb(n,e,t,o),s==="channelsFirst"&&(a=ln(a,[0,3,1,2])),a})}function aN(n,e,t,r,s,i){return Ve(()=>{ar(s),SA(i),js(r),t==null&&(t=[1,1,1]),r==null&&(r="valid"),s==null&&(s=Wi()),i==null&&(i="max"),n=S$(n,s);let a;const o=r==="same"?"same":"valid";return i==="max"?a=FV(n,e,t,o):a=D8(n,e,t,o),s==="channelsFirst"&&(a=ln(a,[0,4,1,2,3])),a})}class oN extends Zt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Oe(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Ar(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Oe(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Ar(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,js(this.padding),this.inputSpec=[new br({ndim:3})]}computeOutputShape(e){e=dn(e);const t=zi(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return Ve(()=>{this.invokeCallHook(e,t),e=Fh(Ft(e),2);const r=this.poolingFunction(Ft(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Th(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class cN extends oN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),Bm(e,t,r,s,i,"max")}}cN.className="MaxPooling1D";et(cN);class lN extends oN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),Bm(e,t,r,s,i,"avg")}}lN.className="AveragePooling1D";et(lN);class uN extends Zt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Oe(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Ar(this.poolSize,"poolSize"),Ar(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ar(this.dataFormat),js(this.padding),this.inputSpec=[new br({ndim:4})]}computeOutputShape(e){e=dn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=zi(t,this.poolSize[0],this.padding,this.strides[0]),r=zi(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r]:[e[0],t,r,e[3]]}call(e,t){return Ve(()=>(this.invokeCallHook(e,t),this.poolingFunction(Ft(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class fN extends uN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),Bm(e,t,r,s,i,"max")}}fN.className="MaxPooling2D";et(fN);class hN extends uN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),Bm(e,t,r,s,i,"avg")}}hN.className="AveragePooling2D";et(hN);class dN extends Zt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Oe(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Ar(this.poolSize,"poolSize"),Ar(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ar(this.dataFormat),js(this.padding),this.inputSpec=[new br({ndim:5})]}computeOutputShape(e){e=dn(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=zi(t,this.poolSize[0],this.padding,this.strides[0]),r=zi(r,this.poolSize[1],this.padding,this.strides[1]),s=zi(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,r,s]:[e[0],t,r,s,e[4]]}call(e,t){return Ve(()=>(this.invokeCallHook(e,t),this.poolingFunction(Ft(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class pN extends dN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),aN(e,t,r,s,i,"max")}}pN.className="MaxPooling3D";et(pN);class gN extends dN{constructor(e){super(e)}poolingFunction(e,t,r,s,i){return ar(i),js(s),aN(e,t,r,s,i,"avg")}}gN.className="AveragePooling3D";et(gN);class mN extends Zt{constructor(e){super(e),this.inputSpec=[new br({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new Wt}}class vN extends mN{constructor(e){super(e||{})}call(e,t){return Ve(()=>{const r=Ft(e);return gr(r,1)})}}vN.className="GlobalAveragePooling1D";et(vN);class IN extends mN{constructor(e){super(e||{})}call(e,t){return Ve(()=>{const r=Ft(e);return Ui(r,1)})}}IN.className="GlobalMaxPooling1D";et(IN);class bN extends Zt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,ar(this.dataFormat),this.inputSpec=[new br({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new Wt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class yN extends bN{call(e,t){return Ve(()=>{const r=Ft(e);return this.dataFormat==="channelsLast"?gr(r,[1,2]):gr(r,[2,3])})}}yN.className="GlobalAveragePooling2D";et(yN);class xN extends bN{call(e,t){return Ve(()=>{const r=Ft(e);return this.dataFormat==="channelsLast"?Ui(r,[1,2]):Ui(r,[2,3])})}}xN.className="GlobalMaxPooling2D";et(xN);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wN extends Zt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,r={}){const s=t.layer,i=Va(s,r);delete t.layer;const a={layer:i};return Object.assign(a,t),new e(a)}}class SN extends wN{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=dn(e),e.length<3)throw new Oe(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=dn(e);const t=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(t),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,t){return Ve(()=>(e=Ft(e),O$((a,o)=>[Ft(this.layer.call(a,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}SN.className="TimeDistributed";et(SN);function fj(n){Lc(D9,"BidirectionalMergeMode",n)}const hj="concat";class CN extends wN{constructor(e){super(e);const t=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=t,this.forwardLayer=Va(r),t.goBackwards=t.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=t,this.backwardLayer=Va(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?hj:e.mergeMode,fj(this.mergeMode),e.weights)throw new Wt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,r=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let r,s,i;return this.returnState&&(i=t.slice(1)),r=t[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(i).concat(i.slice()):[r].concat(i).concat(i.slice()):us(s)}apply(e,t){let r=t==null?null:t.initialState,s=t==null?null:t.constants;t==null&&(t={});const i=N$(e,r,s,this.numConstants);if(e=i.inputs,r=i.initialState,s=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,t);const a=[],o=[];if(r!=null){const l=r.length;if(l%2>0)throw new Oe("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,a.push(...r);const u=r.map(f=>new br({shape:f.shape}));this.forwardLayer.stateSpec=u.slice(0,l/2),this.backwardLayer.stateSpec=u.slice(l/2),o.push(...u)}if(s!=null)throw new Wt("Support for constants in Bidirectional layers is not implemented yet.");const c=a[0]instanceof da;for(const l of a)if(l instanceof da!==c)throw new Oe("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const l=[e].concat(a),u=this.inputSpec.concat(o),f=this.inputSpec;this.inputSpec=u;const d=super.apply(l,t);return this.inputSpec=f,d}else return super.apply(e,t)}call(e,t){return Ve(()=>{const r=t.initialState;let s,i;if(r==null)s=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{const c=r.slice(0,r.length/2),l=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(t,{initialState:c})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:l}))}let a;this.returnState&&(Array.isArray(s)&&(a=s.slice(1).concat(i.slice(1))),s=s[0],i=i[0]),this.returnSequences&&(i=kc(i,1));let o;return this.mergeMode==="concat"?o=rx([s,i]):this.mergeMode==="sum"?o=at(s,i):this.mergeMode==="ave"?o=_e(.5,at(s,i)):this.mergeMode==="mul"?o=_e(s,i):this.mergeMode==null&&(o=[s,i]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){mc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),mc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[t,t]:r=t:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const i=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(i).concat(i):[r].concat(i).concat(i)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const r=Va(t.layer);if(delete t.layer,t.numConstants!=null)throw new Wt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=t;return s.layer=r,new e(s)}}CN.className="Bidirectional";et(CN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class RN extends Zt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ve(()=>(e=Ft(e),e.dtype!=="float32"&&(e=Ia(e,"float32")),at(_e(e,this.scale),this.offset)))}}RN.className="Rescaling";et(RN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:dj,cropAndResize:pj}=Ua;class kN extends Zt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,r,s,i,a,o,c){return Ve(()=>{let l,u=!1;const f=t/a,d=r/o,p=(s+t)/a,m=(i+r)/o,I=[f,d,p,m],v=[];e.rank===3?(u=!0,l=ko([e])):l=e;for(let C=0;C<l.shape[0];C++)v.push(I);const b=qE(v,[v.length,4]),y=mf(0,v.length,1,"int32"),w=pj(l,b,y,[s,i],"nearest");return Ia(u?Ft(Ec(w)):w,c)})}upsize(e,t,r,s){return Ve(()=>{const i=dj(e,[t,r]);return Ia(i,s)})}call(e,t){return Ve(()=>{const r=Ft(e),s=r.dtype,i=r.shape,a=i[i.length-3],o=i[i.length-2];let c=0;a!==this.height&&(c=Math.floor((a-this.height)/2));let l=0;return o!==this.width&&(l=Math.floor((o-this.width)/2),l===0&&(l=1)),c>=0&&l>=0?this.centerCrop(r,c,l,this.height,this.width,a,o,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=dn(e);const t=e.length-3,r=e.length-2;return e[t]=this.height,e[r]=this.width,e}}kN.className="CenterCrop";et(kN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gj(n,e,t,r){let s=Ft(n);if(s.dtype!=="int32"&&(s=Ia(s,"int32")),e==="int")return s;const i=s.shape;if(s.rank===0&&(s=Cs(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=Cs(s,-1)),s.rank>2)throw new Oe(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${i} which would result in output rank ${s.rank}.`);const a=["multiHot","oneHot"].includes(e),o=s;let c;if(typeof r<"u"&&e==="count"?c=cC(o,r,t,a):c=cC(o,[],t,a),e!=="tfIdf")return c;if(r)return _e(c,r);throw new Oe("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class EN extends Zt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=dn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return Ve(()=>{e=Ft(e),e.dtype!=="int32"&&(e=Ia(e,"int32"));let r;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new Oe(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);r=Ft(t.countWeights)}const s=Ui(e),i=Np(e),a=qs(this.numTokens,s).bufferSync().get(0),o=Fc(i,0).bufferSync().get(0);if(!(a&&o))throw new Oe(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return gj(e,this.outputMode,this.numTokens,r)})}}EN.className="CategoryEncoding";et(EN);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mj=["bilinear","nearest"],zC=new Set(mj);class TN extends Zt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(zC.has(e.interpolation))this.interpolation=e.interpolation;else throw new Oe(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=dn(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return Ve(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return Ua.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Ua.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...zC]} are supported`)})}}TN.className="Resizing";et(TN);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AN{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}AN.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $N extends Zt{constructor(e){super(e),this.randomGenerator=new AN(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}$N.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vj=["bilinear","nearest"],VC=new Set(vj);class NN extends $N{constructor(e){super(e);const{factor:t,interpolation:r="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Oe(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Oe(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Oe(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(VC.has(r))this.interpolation=r;else throw new Oe(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=dn(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return Ve(()=>{const r=Ft(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=Eh([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let i=this.widthFactor.dataSync()[0]*s;i=Math.round(i);const a=[this.imgHeight,i];switch(this.interpolation){case"bilinear":return Ua.resizeBilinear(e,a);case"nearest":return Ua.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...VC]} are supported`)}})}}NN.className="RandomWidth";et(NN);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ij=Ge();Ij.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var WC;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(WC||(WC={}));var GC;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(GC||(GC={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var HC;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(HC||(HC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bt(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ce(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bj=AT;class Mm extends YI{nextDataId(){return Mm.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Kk(this,oa())}write(e,t,r){this.firstUse&&(this.firstUse=!1,Ge().get("IS_NODE")&&Ls(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&Af(r[0])){const i=r.map(a=>yo(a));s=this.write(i,e,t)}else s=this.write(r,e,t);return{dataId:s,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,r,s,i){this.data.set(e,{values:t,dtype:s,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:r}=this.data.get(e);if(t==="complex64"){const s=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Ha(s,i)}return X6(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>Ro(s));return Xt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Xt(e.shape,e.dtype,t)}makeOutput(e,t,r){return oa().makeTensorFromTensorInfo(this.makeTensorInfo(t,r,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=ls();return e(),{kernelMs:ls()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){bt([e],"where");const t=this.readSync(e.dataId);return bj(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Mm.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ON(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const yj=n=>{const{x:e}=n.inputs,t=n.backend;bt(e,"abs");let r=new Float32Array(Ye(e.shape));const s=t.data.get(e.dataId).values;return r=ON(s),t.makeOutput(r,e.shape,e.dtype)},xj={kernelName:gg,backendName:"cpu",kernelFunc:yj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function or(n){return(e,t,r,s,i)=>{const a=Ut(e,t),o=a.length,c=Rt(a),l=Ye(a),u=Hr(i,l),f=e.length,d=t.length,p=Rt(e),m=Rt(t),I=Bl(e,a),v=Bl(t,a);if(I.length+v.length===0)for(let b=0;b<u.length;++b)u[b]=n(r[b%r.length],s[b%s.length]);else for(let b=0;b<u.length;++b){const y=Xl(b,o,c),S=y.slice(-f);I.forEach(E=>S[E]=0);const w=ga(S,f,p),C=y.slice(-d);v.forEach(E=>C[E]=0);const N=ga(C,d,m);u[b]=n(r[w],s[N])}return[u,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,o=t.makeTensorInfo(r.shape,"complex64"),c=t.data.get(o.dataId);return c.complexTensorInfos={real:t.makeTensorInfo(r.shape,"float32",i),imag:t.makeTensorInfo(s.shape,"float32",a)},o}const wj={kernelName:lb,backendName:"cpu",kernelFunc:Rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(n,e,t="float32"){if(t==="complex64"){const s=Hp(n,e,"float32"),i=Hp(n,e,"float32");return Rs({inputs:{real:s,imag:i},backend:n})}const r=qr(Ye(e),t);return n.makeTensorInfo(e,t,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wa(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Sj={kernelName:Yf,backendName:"cpu",kernelFunc:wa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ac(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.real,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const Cj={kernelName:Ob,backendName:"cpu",kernelFunc:Ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _N(n,e,t,r){if(r==="int32"){const s=Int32Array.from(n);return[e,"int32",s]}if(r==="bool"){const s=_c([0],t),[i,a]=or((o,c)=>o!==c?1:0)(e,[],n,s,"bool");return[a,"bool",i]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}function No(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return wa({inputs:{x:s},backend:t});const u=Hp(t,s.shape,s.dtype),f=No({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),d=Rs({inputs:{real:f,imag:u},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),d}if(s.dtype==="complex64"){const u=Ac({inputs:{input:s},backend:t}),f=No({inputs:{x:u},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(u),f}if(!Zk(s.dtype,i)){const u=wa({inputs:{x:s},backend:t});return{dataId:u.dataId,shape:u.shape,dtype:i}}const a=t.data.get(s.dataId).values,[o,c,l]=_N(a,s.shape,s.dtype,i);return t.makeTensorInfo(o,c,l)}const Rj={kernelName:Mf,backendName:"cpu",kernelFunc:No};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(n,e,t,r){return t==null?({inputs:s,backend:i})=>{const{a,b:o}=s,c=i;bt([a,o],n);const l=c.data.get(a.dataId).values,u=c.data.get(o.dataId).values,f=a.dtype==="string"?qa(l):l,d=a.dtype==="string"?qa(u):u,p=r||a.dtype,[m,I]=e(a.shape,o.shape,f,d,p);return c.makeTensorInfo(I,p,m)}:({inputs:s,backend:i})=>{const{a,b:o}=s,c=i;if(a.dtype==="complex64"||o.dtype==="complex64"){const l=No({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),u=c.data.get(l.dataId),f=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,p=c.data.get(f.dataId).values,m=c.data.get(d.dataId).values,I=No({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),v=c.data.get(I.dataId),b=v.complexTensorInfos.real,y=v.complexTensorInfos.imag,S=c.data.get(b.dataId).values,w=c.data.get(y.dataId).values,[C,N,E]=t(a.shape,o.shape,p,m,S,w),A=c.makeTensorInfo(E,"float32",C),M=c.makeTensorInfo(E,"float32",N),z=Rs({inputs:{real:A,imag:M},backend:c});return c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(I),c.disposeIntermediateTensorInfo(A),c.disposeIntermediateTensorInfo(M),z}else{const l=c.data.get(a.dataId).values,u=c.data.get(o.dataId).values,f=r||a.dtype,[d,p]=e(a.shape,o.shape,l,u,f);return c.makeTensorInfo(p,f,d)}}}function wx(n){return(e,t,r,s,i,a)=>{const o=Ut(e,t),c=Ye(o),l=o.length,u=Rt(o),f=Hr("float32",c),d=Hr("float32",c),p=Bl(e,o),m=Bl(t,o),I=Ha(r,s),v=Ha(i,a),b=e.length,y=Rt(e),S=t.length,w=Rt(t);if(p.length+m.length===0)for(let C=0;C<f.length;C++){const N=C%I.length,E=C%v.length,A=n(I[N*2],I[N*2+1],v[E*2],v[E*2+1]);f[C]=A.real,d[C]=A.imag}else for(let C=0;C<f.length;C++){const N=Xl(C,l,u),E=N.slice(-b);p.forEach(re=>E[re]=0);const A=ga(E,b,y),M=N.slice(-S);m.forEach(re=>M[re]=0);const z=ga(M,S,w),Y=n(I[A*2],I[A*2+1],v[z*2],v[z*2+1]);f[C]=Y.real,d[C]=Y.imag}return[f,d,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FN=or((n,e)=>n+e),kj=wx((n,e,t,r)=>({real:n+t,imag:e+r})),Ul=Sr(Yl,FN,kj),Ej={kernelName:Yl,backendName:"cpu",kernelFunc:Ul};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sx(n,e,t,r,s){const i=Ye(r),a=qr(s,t);for(let o=0;o<n.length;o++){const c=n[o];if(c<0)throw new Error("Input x must be non-negative!");c>=s||(i>0?a[c]+=e[o]:a[c]+=1)}return a}function DN(n,e,t,r=!1){const s=n.shape[0],i=n.shape[1],a=Xt([s,t],e.dtype);for(let o=0;o<s;o++)for(let c=0;c<i;c++){const l=n.get(o,c);if(l<0)throw new Error("Input x must be non-negative!");l>=t||(r?a.set(1,o,l):e.size>0?a.set(a.get(o,l)+e.get(o,c),o,l):a.set(a.get(o,l)+1,o,l))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BN=or((n,e)=>n&e),Tj=Sr(cb,BN),Aj={kernelName:cb,backendName:"cpu",kernelFunc:Tj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(n){return(e,t,r)=>{const s=nr(t,e.length);for(let i=0;i<e.length;++i)s[i]=n(e[i],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wn(n,e,t){const r=Ca(e);return Uo(n,r,t)}function Uo(n,e,t){return({inputs:r,attrs:s,backend:i})=>{const{x:a}=r;bt(a,n);const o=i,c=o.data.get(a.dataId).values;let l;if(a.dtype==="string"){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");l=qa(c)}else l=c;const u=t||a.dtype,f=e(l,u,s);return o.makeTensorInfo(a.shape,u,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MN=Ca(n=>Math.ceil(n)),$j=Uo(Pf,MN),Nj={kernelName:Pf,backendName:"cpu",kernelFunc:$j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PN(n,e,t,r){const s=nr(t,Ye(e));if(r&&t!=="string"){let i=0;n.forEach(a=>{const o=Ye(a.shape);s.set(a.vals,i),i+=o})}else{let i=0;n.forEach(a=>{const o=t==="string"?qa(a.vals):a.vals;let c=0;for(let l=0;l<a.shape[0];++l){const u=l*e[1]+i;for(let f=0;f<a.shape[1];++f)s[u+f]=o[c++]}i+=a.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LN=or((n,e)=>n===e?1:0),UN=Sr($g,LN,null,"bool"),Oj={kernelName:$g,backendName:"cpu",kernelFunc:UN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zN=Ca(n=>Math.exp(n)),VN=Uo(Hf,zN,"float32"),_j={kernelName:Hf,backendName:"cpu",kernelFunc:VN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WN=Ca(n=>Math.expm1(n)),Fj=Uo(qf,WN),Dj={kernelName:qf,backendName:"cpu",kernelFunc:Fj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GN=Ca(n=>Math.floor(n)),Bj=Uo(jf,GN),Mj={kernelName:jf,backendName:"cpu",kernelFunc:Bj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HN=or((n,e)=>Math.floor(n/e)),Pj=Sr(Kf,HN,null,"int32"),Lj={kernelName:Kf,backendName:"cpu",kernelFunc:Pj};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qN(n,e,t,r,s,i,a,o,c){const l=Xt([r,i],t);for(let u=0;u<r;u++){const f=[];let d=0;for(let p=0;p<s;p++){const m=n[u*s+p];d+=m*a[p],f.push(m)}if(d<0||d>=c/i)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let p=0;p<i;p++)l.values[u*i+p]=e.get(...e.indexToLoc(d*i+p))}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jN(n,e,t){const r=Xt(t,n.dtype);for(let s=0;s<r.size;++s){const a=r.indexToLoc(s).slice(),o=a[0],c=a[2],l=e.locToIndex([o,c]);a[2]=e.values[l];const u=n.locToIndex(a);0<=u&&u<n.values.length&&(r.values[s]=n.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KN=or((n,e)=>n>e?1:0),Uj=Sr(Fg,KN,null,"bool"),zj={kernelName:Fg,backendName:"cpu",kernelFunc:Uj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XN=or((n,e)=>n>=e?1:0),Vj=Sr(Xf,XN,null,"bool"),Wj={kernelName:Xf,backendName:"cpu",kernelFunc:Vj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YN=or((n,e)=>n<e?1:0),Gj=Sr(Bg,YN,null,"bool"),Hj={kernelName:Bg,backendName:"cpu",kernelFunc:Gj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZN=or((n,e)=>n<=e?1:0),qj=Sr(Mg,ZN,null,"bool"),jj={kernelName:Mg,backendName:"cpu",kernelFunc:qj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JN(n,e,t){const r=(e-n)/(t-1),s=qr(t,"float32");s[0]=n;for(let i=1;i<s.length;i++)s[i]=s[i-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN=Ca(n=>Math.log(n)),Kj=Uo(eh,QN),Xj={kernelName:eh,backendName:"cpu",kernelFunc:Kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eO(n,e,t,r){const s=Hr(r,Ye(t));for(let i=0;i<s.length;++i){const a=i*e;let o=n[a];for(let c=0;c<e;++c){const l=n[a+c];(Number.isNaN(l)||l>o)&&(o=l)}s[i]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tO=or((n,e)=>Math.max(n,e)),Yj=Sr(nh,tO),Zj={kernelName:nh,backendName:"cpu",kernelFunc:Yj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nO=or((n,e)=>Math.min(n,e)),Jj=Sr(rh,nO),Qj={kernelName:rh,backendName:"cpu",kernelFunc:Jj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cx=or((n,e)=>n*e),eK=wx((n,e,t,r)=>({real:n*t-e*r,imag:n*r+e*t})),Pm=Sr(ih,Cx,eK),tK={kernelName:ih,backendName:"cpu",kernelFunc:Pm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(n,e,t){const r=Fo(-1,t);return Cx([],e,r,n,t)}function nK(n){const{inputs:e,backend:t}=n,{x:r}=e;bt(r,"neg");const s=t.data.get(r.dataId).values,[i,a]=rO(s,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,i)}const rK={kernelName:Kg,backendName:"cpu",kernelFunc:nK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sO=or((n,e)=>n!==e?1:0),sK=Sr(Xg,sO,null,"bool"),iK={kernelName:Xg,backendName:"cpu",kernelFunc:sK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(n,e,t,r,s){const i=e.length,a=Ye(e),o=Rt(e),c=Rt(s),l=Hr(t,Ye(s));for(let u=0;u<a;++u){const f=Xl(u,i,o),d=new Array(f.length);for(let m=0;m<d.length;m++)d[m]=f[r[m]];const p=ga(d,i,c);l[p]=n[u]}return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ps(n){const{inputs:e,attrs:t,backend:r}=n,{x:s}=e,{perm:i}=t;bt(s,"transpose");const a=s.shape.length,o=new Array(a);for(let f=0;f<o.length;f++)o[f]=s.shape[i[f]];const c=r.data.get(s.dataId).values,l=Rx(c,s.shape,s.dtype,i,o);return{dataId:r.write(l,o,s.dtype),shape:o,dtype:s.dtype}}const aK={kernelName:El,backendName:"cpu",kernelFunc:ps};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iO(n,e,t,r){const[s,i]=$r(n,r),a=Ts(e,"int32"),o=qr(Ye(s),a),c=Ye(i);for(let l=0;l<o.length;++l){const u=l*c;let f=1;for(let d=0;d<c;++d)f*=t[u+d];o[l]=f}return{outVals:o,outShape:s,outDtype:a}}function oK(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;bt(s,"prod");const o=s.shape.length,c=Yt(i,s.shape),l=Kn(c,o);let u=c,f=s;const d=[];l!=null&&(f=ps({inputs:{x:s},backend:t,attrs:{perm:l}}),d.push(f),u=ir(u.length,o));const p=t.data.get(f.dataId).values,{outVals:m,outShape:I,outDtype:v}=iO(f.shape,f.dtype,p,u);let b=I;return a&&(b=mr(I,c)),d.forEach(y=>t.disposeIntermediateTensorInfo(y)),t.makeTensorInfo(b,v,m)}const cK={kernelName:tm,backendName:"cpu",kernelFunc:oK};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n,e,t){n.forEach((r,s)=>{if(r<0||r>=t){const i=Xl(s,e.length,Rt(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${t})`)}})}function uK(n,e){for(let t=0;t<n.length;++t){const r=n[t],s=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function fK(n,e,t,r){const s=[];let i=0;const a=e.length-1+t.length,o=new Array(a).fill(null).map(()=>[0]);uK(t,r);let c=1;for(let l=0;l<e.length-1;++l){c*=e[l];const u=e[l+1];for(let f=1;f<c+1;++f)o[l].push(f*u)}for(let l=0;l<n.length;++l){let u=n[l],f=n[l]+1;for(let d=0;d<t.length;++d){const p=t[d],m=d+e.length-1;if(m>=0){const I=o[m],v=I[I.length-1]-p[u];for(let b=u;b<f;++b)o[m].push(p[b+1]+v)}u=p[u],f=p[f]}f!==u&&(s.push([u,f]),i+=f-u)}return{outSplits:o,valueSlices:s,numValues:i}}function hK(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,s=nr("int32",r);e.push(s),n[t].forEach((i,a)=>s[a]=i)}return e}function qC(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function dK(n,e,t,r,s,i){const a=qC(e,2)[1],o=qC(i,2)[1];let c=0;for(const l of t)for(let u=l[0];u<l[1];++u){for(let f=0;f<r;++f)s[c*o+f]=n[u*a+f];++c}}function pK(n,e,t,r,s){const i=e.slice();i[0]=s;const a=nr(t,Ye(i)),o=n.length,c=o===0?0:o/e[0];return dK(n,e,r,c,a,i),[a,i]}function aO(n,e,t,r,s,i,a,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(lK(i,a,c),r.length===0)throw new Error("params.rank must be nonzero");const l=r[0],{outSplits:u,valueSlices:f,numValues:d}=fK(i,a,n,l),p=hK(u),m=pK(t,r,s,f,d);return[p,m[0],m[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jC=2147483647;function oO(n,e,t,r,s,i,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,c=s.length===0,l=a.length===0,u=[];o||u.push(e[0]),c||u.push(s[0]),l||u.push(a[0]);for(let v=1;v<u.length;++v)if(u[v]!==u[v-1])throw new Error("starts, limits, and deltas must have the same shape");const f=u.length===0?1:u[0],d=nr("int32",f+1);d[0]=0;for(let v=0;v<f;++v){const b=o?n[0]:n[v],y=c?r[0]:r[v],S=l?i[0]:i[v];if(S===0)throw new Error("Requires delta != 0");let w;if(S>0&&y<b||S<0&&y>b)w=0;else if(w=Math.ceil(Math.abs((y-b)/S)),w>jC)throw new Error(`Requires ((limit - start) / delta) <= ${jC}`);d[v+1]=d[v]+w}const p=d[f],m=nr(t,p);let I=0;for(let v=0;v<f;++v){const b=d[v+1]-d[v];let y=o?n[0]:n[v];const S=l?i[0]:i[v];for(let w=0;w<b;++w)m[I++]=y,y+=S}return[d,m]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ii=Mi;class qp{constructor(e,t,r,s,i,a,o,c,l,u){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=s,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=c,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=KT(u),this.raggedRank=XT(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ii.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ii.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ii.VALUE_ROWIDS:return qp.getMaxWidthValueRowID(t);case ii.ROW_SPLITS:return qp.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${ii[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let s=0;s<t-1;++s){const i=e[s+1]-e[s];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,s=e[0],i=0;for(let a=1;a<t;++a){const o=e[a];o!==s&&(s=o,i=Math.max(a-r,i),r=a)}return Math.max(t-r,i)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return XC(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;YT(r,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=jT(this.raggedRank,s,t);a[0]<0&&(a[0]=e);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(e,t,r){const s=Math.min(e,r),i=[];let a=0;for(let o=0;o<s;++o,a+=t)i.push(a);for(let o=s;o<e;++o)i.push(-1);return ce(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,t,r,s){const i=e.length,a=[];for(let o=0;o<i-1;++o){const c=e[o+1]-e[o];let l=Math.min(s,c),u=t[o];u===-1&&(l=0);for(let f=0;f<l;++f)a.push(u),u+=r;for(let f=0;f<c-l;++f)a.push(-1)}if(i>0&&a.length!==e[i-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,t,r,s){const i=e.length,a=[];if(i===0)return[];let o=0,c=e[0];if(c>=t.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${t.length}`);let l=t[c];a.push(l);for(let u=1;u<i;++u){const f=e[u];if(f===c)l>=0&&(++o,o<s?l+=r:l=-1);else{if(o=0,c=f,f>=t.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${t.length}`);l=t[f]}a.push(l)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,t,r,s){const i=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case ii.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,r,s);case ii.ROW_SPLITS:if(i.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,r,s);default:throw new Error(`Unsupported partition type: ${ii[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case ii.FIRST_DIM_SIZE:return e[0];case ii.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ii.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ii[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let c=s.length-2;c>=0;--c)s[c]=s[c+1]*r[c+1];const i=XC(r,!1),a=nr(this.valuesDType,Ye(i));if(s[0]*r[0]>0){let c=this.calculateFirstParentOutputIndex(t,s[0],r[0]);for(let l=1;l<=this.raggedRank;++l)c=this.calculateOutputIndex(l-1,c,s[l],r[l]);this.setOutput(this.raggedRank,c,a,i)}return[i,a]}setOutput(e,t,r,s){if(r.length===0)return;const i=this.values,a=r;let o=s.slice();o=o.slice(e+1);const c=Ye(o),l=t.length;let u=this.defaultValue;if(u.length!==c&&u.length!==1){const m=this.defaultValueShape;Ve(()=>{const I=Me(u,m);u=cf(I,o).dataSync()})}let f=0,d=0,p=0;for(let m=0;m<=l;++m){let I=m<l?t[m]:-1;if(I===p){++p;continue}if(d<p){const v=i.subarray(f*c),b=a.subarray(d*c),y=(p-d)*c;KC(b,v,y)}if(m>=l){const v=r.length;I=Math.floor(v/c)}if(I>p)if(this.defaultValue.length===1)a.subarray(p*c,I*c).fill(this.defaultValue[0]),p=I;else for(;I>p;){const v=a.slice(p*c);KC(v,u,c),++p}I<0?(f=m+1,d=p):(f=m,d=p,p=d+1)}}}function KC(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function XC(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function cO(n,e,t,r,s,i,a,o,c,l){return new qp(n,e,t,r,s,i,a,o,c,l).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lO(n,e,t,r){const s=n===e,i=n<e&&t<0,a=e<n&&t>1;if(s||i||a)return qr(0,r);const o=Math.abs(Math.ceil((e-n)/t)),c=qr(o,r);e<n&&t===1&&(t=-1),c[0]=n;for(let l=1;l<c.length;l++)c[l]=c[l-1]+t;return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uO=Ca(n=>1/Math.sqrt(n)),gK=Uo(fh,uO),mK={kernelName:fh,backendName:"cpu",kernelFunc:gK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dc(n,e,t,r,s,i,a,o,c,l){const u=[r/s,s],f=n.values,d=e.values;if(r===0)return Xt(t,e.dtype);const p=c instanceof Pr?c:Xt(u,e.dtype);typeof c=="string"||typeof c=="number"?p.values.fill(c):typeof c=="boolean"&&p.values.fill(+c);for(let m=0;m<i;m++){const I=[];let v=0;for(let b=0;b<a;b++){const y=f[m*a+b];I.push(y),v+=y*o[b]}if(v<0||v>=r/s)throw new Error(`Invalid indices: ${I} does not index into ${t}`);for(let b=0;b<s;b++)l?p.values[v*s+b]+=d[m*s+b]:p.values[v*s+b]=e.rank===0?d[0]:d[m*s+b]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK=Ca(n=>1/(1+Math.exp(-n))),fO=wn(mh,n=>1/(1+Math.exp(-n))),IK={kernelName:mh,backendName:"cpu",kernelFunc:fO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hO(n,e,t,r,s){const i=Oy(r,e,t),a=Ye(t),o=Rt(r);if(i){const f=_y(e,o);return s==="string"?n.slice(f,f+a):n.subarray(f,f+a)}const c=s==="string"?qa(n):n,l=Xt(r,s,c),u=Xt(t,s);for(let f=0;f<u.size;++f){const d=u.indexToLoc(f),p=d.map((m,I)=>m+e[I]);u.set(l.get(...p),...d)}return s==="string"?mA(u.values):u.values}function $c(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:a}=r;bt(s,"slice");const[o,c]=Sm(s,i,a);$y(s,o,c);const l=t.data.get(s.dataId).values,u=hO(l,o,c,s.shape,s.dtype);return t.makeTensorInfo(c,s.dtype,u)}const bK={kernelName:om,backendName:"cpu",kernelFunc:$c};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dO(n,e,t,r,s,i,a){const o=e[0],c=i[0],l=new Array(c),u=new Array(o),f=e[1];if(c===0){if(o!==0)throw new Error(rA(o));const v=nr(t,0),b=nr(s,0);return[v,[0,f],b,l,u]}let d=!0,p=0;const m=new Array(c).fill(0);for(let v=0;v<o;++v){const b=n[v*f];if(b<0)throw new Error(sA(v,b));if(b>=c)throw new Error(iA(v,b,c));++m[b],d=d&&b>=p,p=b}let I=!0;for(let v=0;v<c;++v){const b=m[v]===0;l[v]=b,I=I&&!b,m[v]=Math.max(m[v],1),v>0&&(m[v]+=m[v-1])}if(I&&d){const v=n,b=r;for(let y=0;y<o;++y)u[y]=y;return[v,[o,f],b,l,u]}else{const v=m[c-1],b=nr(t,v*f),y=nr(s,v),S=new Array(c).fill(0);for(let w=0;w<o;++w){const C=n[w*f],N=S[C],E=(C===0?0:m[C-1])+N;S[C]++;for(let A=0;A<f;++A)b[E*f+A]=n[w*f+A];y[E]=r[w],u[w]=E}for(let w=0;w<c;++w)if(S[w]===0){const N=w===0?0:m[w-1];b[N*f+0]=w;for(let E=1;E<f;++E)b[N*f+E]=0;y[N]=a}return[b,[v,f],y,l,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pO(n,e,t,r,s){const i=Ye(r),a=e[0],o=s.length,c=[];let l=1,u=-1;for(let v=0;v<o;++v){const b=s[v];if(b===-1){if(u!==-1)throw new Error(aA(u,v));u=v,c.push(1)}else{if(b<0)throw new Error(oA(v,b));l*=b,c.push(b)}}if(u!==-1){if(l<=0)throw new Error(cA());const v=Math.trunc(i/l);if(l*v!==i)throw new Error(lA(r,c));c[u]=v}if(Ye(c)!==i)throw new Error(uA(r,c));const d=r.length,p=[];if(d>0){p[d-1]=1;for(let v=d-2;v>=0;--v)p[v]=p[v+1]*r[v+1]}const m=[];if(o>0){m[o-1]=1;for(let v=o-2;v>=0;--v)m[v]=m[v+1]*c[v+1]}const I=nr(t,a*o);for(let v=0;v<a;++v){let b=0;for(let y=0;y<d;++y)b+=n[v*d+y]*p[y];for(let y=0;y<o;++y)I[v*o+y]=Math.trunc(b/m[y]),b%=m[y]}return[I,[a,o],c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kx(n,e,t,r,s,i=!1,a=0){const o=r.length,c=[e[0],n.length/e[0]],l=c[1],f=o>0?s[o-1]+1:0;if(f<0)throw new Error(qv());const d=e.slice();d[0]=f;const p=d.reduce((S,w)=>S*w,1),m=nr(t,p);if(o===0)return f>0&&m.fill(a),[m,d];if(f<=0)throw new Error(qv());let I=0,v=1,b=0,y=s[I];for(;;){let S=0;if(v<o){if(S=s[v],y===S){++v;continue}if(y>=S)throw new Error(fA())}if(y<0||y>=f)throw new Error(hA(y,f));y>b&&m.fill(a,b*l,y*l);for(let w=I;w<v;++w){const C=r[w];if(C<0||C>=c[0])throw new Error(dA(w,r[w],c[0]));for(let N=0;N<l;N++)m[y*l+N]+=n[C*l+N]}if(i)for(let w=0;w<l;w++)m[y*l+w]/=v-I;if(I=v,++v,b=y+1,y=S,v>o)break}return b<f&&m.fill(a,b*l,f*l),[m,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK=Ca(n=>Math.sqrt(n)),xK=wn(Ih,n=>Math.sqrt(n)),wK={kernelName:Ih,backendName:"cpu",kernelFunc:xK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gO=or((n,e)=>{const t=n-e;return t*t}),SK=Sr(bh,gO),CK={kernelName:bh,backendName:"cpu",kernelFunc:SK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mO=Ca((n,e)=>{const{pattern:t,replaceGlobal:r,rewrite:s}=e;return n.replace(new RegExp(t,r?"g":""),s)}),RK=Uo(Bb,mO),kK={kernelName:Bb,backendName:"cpu",kernelFunc:RK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vO(n,e,t,r){const s=Xt(n,e.dtype);for(let i=0;i<s.size;i++){const a=s.indexToLoc(i),o=new Array(a.length);for(let c=0;c<o.length;c++)o[c]=a[c]*t[c]+r[c];s.set(e.get(...o),...a)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EK{constructor(e,t,r,s,i,a){this.separator=yo(e),this.nGramWidths=t,this.leftPad=yo(r),this.rightPad=yo(s),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,s,i,a){for(let o=0;o<i;++o){const c=this.getPadWidth(a),l=Math.max(0,c-o),u=Math.max(0,c-(i-(o+1))),f=a-(l+u),d=t+(l>0?0:o-c);let p=0;p+=l*this.leftPad.length;for(let y=0;y<f;++y)p+=e[d+y].length;p+=u*this.rightPad.length;const m=l+u+f-1;p+=m*this.separator.length,r[s+o]=new Uint8Array(p);const I=r[s+o];let v=0;const b=y=>y.forEach(S=>I[v++]=S);for(let y=0;y<l;++y)b(this.leftPad),b(this.separator);for(let y=0;y<f-1;++y)b(e[d+y]),b(this.separator);if(f>0){b(e[d+f-1]);for(let y=0;y<u;++y)b(this.separator),b(this.rightPad)}else{for(let y=0;y<u-1;++y)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(e,t){const r=e.length,s=t.length;if(s>0){let c=t[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let l=1;l<s;++l){let u=t[l]>=c;if(u=u&&t[l]<=r,!u)throw new Error(`Invalid split value ${t[l]}, must be in [${c}, ${r}]`);c=t[l]}if(c!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${c}`)}const i=s-1,a=nr("int32",s);if(r===0||s===0){const c=new Array(r);for(let l=0;l<=i;++l)a[l]=0;return[c,a]}a[0]=0;for(let c=1;c<=i;++c){const l=t[c]-t[c-1];let u=0;this.nGramWidths.forEach(f=>{u+=this.getNumNGrams(l,f)}),this.preserveShort&&l>0&&u===0&&(u=1),a[c]=a[c-1]+u}const o=new Array(a[i]);for(let c=0;c<i;++c){const l=t[c];let u=a[c];if(this.nGramWidths.forEach(f=>{const d=t[c+1]-t[c],p=this.getNumNGrams(d,f);this.createNGrams(e,l,o,u,p,f),u+=p}),this.preserveShort&&u===a[c]){const f=t[c+1]-t[c];if(f===0)continue;const d=f+2*this.padWidth,p=1;this.createNGrams(e,l,o,u,p,d)}}return[o,a]}}function IO(n,e,t,r,s,i,a,o){return new EK(t,r,s,i,a,o).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TK(n,e,t,r){if(!n.length)return;if(e.length===0){for(let i=0;i<n.length;++i)r.push(n.subarray(i,i+1));return}if(e.length===1){const i=e[0];let a=n.indexOf(i);for(;a!==-1;){const o=n.subarray(0,a);(!t||o.length!==0)&&r.push(o),n=n.subarray(a+1),a=n.indexOf(i)}(!t||n.length!==0)&&r.push(n);return}let s=0;for(let i=0;i<n.length+1;i++)if(i===n.length||e.indexOf(n[i])!==-1){const a=n.subarray(s,i);(!t||a.length!==0)&&r.push(a),s=i+1}}function bO(n,e,t){const r=n.length,s=[];let i=0,a=0;const o=new Array(r);for(let d=0;d<r;++d){const p=s.length;TK(n[d],e,t,s);const m=s.length-p;o[d]=m,i+=m,a=Math.max(a,m)}const c=nr("int32",i*2),l=new Array(i),u=[r,a];let f=0;for(let d=0;d<r;++d)for(let p=0;p<o[d];++p)c[f*2]=d,c[f*2+1]=p,l[f]=s[f],++f;return[c,l,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yO(n,e){const t=nr("int32",n.length);for(let r=0;r<n.length;++r)t[r]=gU(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xO=or((n,e)=>n-e),AK=wx((n,e,t,r)=>({real:n-t,imag:e-r})),Ex=Sr(yh,xO,AK),$K={kernelName:yh,backendName:"cpu",kernelFunc:Ex};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wO(n,e){const t=new Array(n.rank);for(let s=0;s<t.length;s++)t[s]=n.shape[s]*e[s];const r=Xt(t,n.dtype);for(let s=0;s<r.values.length;++s){const i=r.indexToLoc(s),a=new Array(n.rank);for(let c=0;c<a.length;c++)a[c]=i[c]%n.shape[c];const o=n.locToIndex(a);r.values[s]=n.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tf=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function SO(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const o=r-t+1,c=e-t+1,l=Math.log(o),u=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*u*(o-u)/o)*Math.sign(c-o/2),d=Math.max(t,Math.floor(e-c*u/o+f)),p=Math.min(r,Math.floor(e+(o-c)*u/o+f));SO(n,e,d,p)}const s=n[e];let i=t,a=r;for(gl(n,t,e),tf(n[r],s)>0&&gl(n,t,r);i<a;){for(gl(n,i,a),i++,a--;tf(n[i],s)<0;)i=i+1;for(;tf(n[a],s)>0;)a=a-1}tf(n[t],s)===0?gl(n,t,a):(a=a+1,gl(n,a,r)),a<=e&&(t=a+1),e<=a&&(r=a-1)}}function CO(n,e,t,r,s){const i=e[e.length-1],[a,o]=[n.length/i,i],c=Hr(t,a*r),l=Hr("int32",a*r);for(let f=0;f<a;f++){const d=f*o,p=n.subarray(d,d+o);let m=new Array(p.length);p.forEach((y,S)=>m[S]={value:y,index:S}),r<m.length&&(SO(m,r),m=m.slice(0,r)),s&&m.sort(tf);const I=f*r,v=c.subarray(I,I+r),b=l.subarray(I,I+r);for(let y=0;y<r;y++)v[y]=m[y].value,b[y]=m[y].index}const u=e.slice();return u[u.length-1]=r,[Xt(u,t,c),Xt(u,"int32",l)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RO(n,e,t,r){const s=Yt(e,t)[0],i=[1,t[0],1];for(let m=0;m<s;m++)i[0]*=t[m];i[1]=t[s];for(let m=s+1;m<t.length;m++)i[2]*=t[m];const a=new Map,o=new Int32Array(t[s]),c=new Pr(i,r,n),l=[],u=i[0]===1&&i[2]===1;for(let m=0;m<t[s];m++){let I;if(u)I=n[m].toString();else{const b=[];for(let y=0;y<i[0];y++)for(let S=0;S<i[2];S++)b.push(c.get(y,m,S));I=b.join(",")}const v=a.get(I);if(v!=null)o[m]=v;else{const b=a.size;a.set(I,b),o[m]=b,l.push(m)}}const f=i.slice();f[1]=a.size;const d=new Pr(f,r);l.forEach((m,I)=>{for(let v=0;v<i[0];v++)for(let b=0;b<i[2];b++)d.set(c.get(v,m,b),v,I,b)});const p=t.slice();return p[s]=f[1],{outputValues:d.values,outputShape:p,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NK=Object.freeze(Object.defineProperty({__proto__:null,addImpl:FN,bincountImpl:Sx,bincountReduceImpl:DN,bitwiseAndImpl:BN,castImpl:_N,ceilImpl:MN,concatImpl:PN,equalImpl:LN,expImpl:zN,expm1Impl:WN,floorDivImpl:HN,floorImpl:GN,gatherNdImpl:qN,gatherV2Impl:jN,greaterEqualImpl:XN,greaterImpl:KN,lessEqualImpl:ZN,lessImpl:YN,linSpaceImpl:JN,logImpl:QN,maxImpl:eO,maximumImpl:tO,minimumImpl:nO,multiplyImpl:Cx,negImpl:rO,notEqualImpl:sO,prodImpl:iO,raggedGatherImpl:aO,raggedRangeImpl:oO,raggedTensorToTensorImpl:cO,rangeImpl:lO,rsqrtImpl:uO,scatterImpl:dc,sigmoidImpl:vK,simpleAbsImpl:ON,sliceImpl:hO,sparseFillEmptyRowsImpl:dO,sparseReshapeImpl:pO,sparseSegmentReductionImpl:kx,sqrtImpl:yK,squaredDifferenceImpl:gO,staticRegexReplaceImpl:mO,stridedSliceImpl:vO,stringNGramsImpl:IO,stringSplitImpl:bO,stringToHashBucketFastImpl:yO,subImpl:xO,tileImpl:wO,topKImpl:CO,transposeImpl:Rx,uniqueImpl:RO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */eT("cpu",()=>new Mm,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kO=wn(Wf,n=>n>=0?n:Math.exp(n)-1),OK={kernelName:Wf,backendName:"cpu",kernelFunc:kO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r;bt([s],"leakyRelu");const a=Ye(s.shape),o=t.data.get(s.dataId).values,c=Hr("float32",a);for(let l=0;l<o.length;l++)c[l]=o[l]<0?i*o[l]:o[l];return t.makeTensorInfo(s.shape,"float32",c)}const _K={kernelName:Dg,backendName:"cpu",kernelFunc:EO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK=or((n,e)=>n<0?e*n:n);function TO(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e;bt([r,s],"prelu");const i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,[o,c]=FK(r.shape,s.shape,i,a,"float32");return t.makeTensorInfo(c,"float32",o)}const DK={kernelName:em,backendName:"cpu",kernelFunc:TO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AO=wn(ch,n=>Math.max(0,n)),BK={kernelName:ch,backendName:"cpu",kernelFunc:AO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $O=wn(lh,n=>Math.min(Math.max(0,n),6)),MK={kernelName:lh,backendName:"cpu",kernelFunc:$O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(n,e,t,r,s){if(t==="linear")return wa({inputs:{x:e},backend:n});if(t==="relu")return AO({inputs:{x:e},backend:n});if(t==="elu")return kO({inputs:{x:e},backend:n});if(t==="relu6")return $O({inputs:{x:e},backend:n});if(t==="prelu")return TO({inputs:{x:e,alpha:r},backend:n});if(t==="leakyrelu")return EO({inputs:{x:e},backend:n,attrs:{alpha:s}});if(t==="sigmoid")return fO({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,a=Ye(s.shape),o=Yk(i,a),c=Ye(o);ce(a===c,()=>`The new shape (${o}) has ${c} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),t.incRef(s.dataId);const l=t.data.get(s.dataId);if(l.complexTensorInfos!=null){const u=l.complexTensorInfos.real,f=l.complexTensorInfos.imag;u.shape=o,f.shape=o}return{dataId:s.dataId,shape:o,dtype:s.dtype}}const PK={kernelName:nm,backendName:"cpu",kernelFunc:Nn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NO(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:a,transposeB:o}=r;bt([s,i],"matMul");const c=s.shape.length,l=i.shape.length,u=a?s.shape[c-2]:s.shape[c-1],f=o?i.shape[l-1]:i.shape[l-2],d=a?s.shape[c-1]:s.shape[c-2],p=o?i.shape[l-2]:i.shape[l-1],m=s.shape.slice(0,-2),I=i.shape.slice(0,-2),v=Ye(m),b=Ye(I),S=Ut(s.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,p]);ce(u===f,()=>`Error in matMul: inner shapes (${u}) and (${f}) of Tensors with shapes ${s.shape} and ${i.shape} and transposeA=${a} and transposeB=${o} must match.`);const w=a?[v,u,d]:[v,d,u],C=o?[b,p,f]:[b,f,p],N=Nn({inputs:{x:s},backend:t,attrs:{shape:w}}),E=Nn({inputs:{x:i},backend:t,attrs:{shape:C}}),A=a?N.shape[1]:N.shape[2],M=a?N.shape[2]:N.shape[1],z=o?E.shape[1]:E.shape[2],Y=Math.max(v,b),re=t.data.get(N.dataId).values,ne=t.data.get(E.dataId).values,le=Rt(N.shape),j=Rt(E.shape),[ge,Se,me]=a?[le[0],1,le[1]]:[le[0],le[1],1],[ye,Ce,he]=o?[1,j[1],j[0]]:[j[1],1,j[0]],Ne=M*z,xe=Xt([Y,M,z],N.dtype),ae=xe.values,J=t.blockSize;for(let D=0;D<Y;D++){const P=D%v,Q=D%b;for(let pe=0;pe<M;pe+=J){const Ee=Math.min(pe+J,M);for(let L=0;L<z;L+=J){const q=Math.min(L+J,z);for(let Z=0;Z<A;Z+=J){const se=Math.min(Z+J,A);for(let ie=pe;ie<Ee;ie++)for(let B=L;B<q;B++){let R=0;for(let k=Z;k<se;k++){const X=re[P*ge+ie*Se+k*me],fe=ne[k*ye+B*Ce+Q*he];R+=X*fe}ae[D*Ne+(ie*z+B)]+=R}}}}}return t.disposeIntermediateTensorInfo(N),t.disposeIntermediateTensorInfo(E),t.makeTensorInfo(S,xe.dtype,xe.values)}const LK={kernelName:yg,backendName:"cpu",kernelFunc:NO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UK(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:f}=r;let d,p,m;const I=[];d=NO({inputs:{a:s,b:i},attrs:{transposeA:c,transposeB:l},backend:t}),a&&(p=Ul({inputs:{a:d,b:a},backend:t}),I.push(d),d=p),u&&(m=jp(t,d,u,o,f),I.push(d),d=m);for(const b of I)t.disposeIntermediateTensorInfo(b);return d}const zK={kernelName:kp,backendName:"cpu",kernelFunc:UK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK=wn($f,n=>Math.acos(n)),WK={kernelName:$f,backendName:"cpu",kernelFunc:VK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK=wn(Nf,n=>Math.acosh(n)),HK={kernelName:Nf,backendName:"cpu",kernelFunc:GK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(n){const{inputs:e,backend:t}=n,r=e;bt(e,"addN");const s=r.map(o=>t.data.get(o.dataId).values),i=Xt(r[0].shape,r[0].dtype),a=i.values;for(let o=0;o<r.length;o++){const c=s[o];for(let l=0;l<a.length;l++)a[l]+=c[l]}return t.makeTensorInfo(i.shape,i.dtype,i.values)}const jK={kernelName:nb,backendName:"cpu",kernelFunc:qK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KK(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;bt(s,"all");const o=Yt(i,s.shape);let c=o;const l=Kn(c,s.shape.length);let u=s;l!=null&&(u=ps({inputs:{x:s},backend:t,attrs:{perm:l}}),c=ir(c.length,s.shape.length)),Ur("all",c,u.shape.length);const[f,d]=$r(u.shape,c),p=Ye(d),m=qr(Ye(f),u.dtype),I=t.data.get(u.dataId).values;for(let b=0;b<m.length;++b){const y=b*p;let S=I[y];for(let w=0;w<p;++w){const C=I[y+w];S=S&&C}m[b]=S}l!=null&&t.disposeIntermediateTensorInfo(u);const v=t.makeTensorInfo(f,u.dtype,m);if(a){const b=mr(f,o),y=Nn({inputs:{x:v},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(v),y}return v}const XK={kernelName:rb,backendName:"cpu",kernelFunc:KK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;bt(s,"any");const o=Yt(i,s.shape);let c=o;const l=Kn(c,s.shape.length);let u=s;l!=null&&(u=ps({inputs:{x:s},backend:t,attrs:{perm:l}}),c=ir(c.length,s.shape.length)),Ur("any",c,u.shape.length);const[f,d]=$r(u.shape,c),p=Ye(d),m=qr(Ye(f),u.dtype),I=t.data.get(u.dataId).values;for(let b=0;b<m.length;++b){const y=b*p;let S=I[y];for(let w=0;w<p;++w){const C=I[y+w];S=S||C}m[b]=S}l!=null&&t.disposeIntermediateTensorInfo(u);const v=t.makeTensorInfo(f,u.dtype,m);if(a){const b=mr(f,o),y=Nn({inputs:{x:v},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(v),y}return v}const ZK={kernelName:sb,backendName:"cpu",kernelFunc:YK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JK(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;bt(s,"argMax");let a=Yt(i,s.shape);const o=Kn(a,s.shape.length);let c=s;const l=[];o!=null&&(c=ps({inputs:{x:s},backend:t,attrs:{perm:o}}),l.push(c),a=ir(a.length,c.shape.length)),a=[a[0]],Ur("argMax",a,c.shape.length);const[u,f]=$r(c.shape,a),d=Ye(u),p=qr(d,"int32"),m=Ye(f),I=t.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const b=v*m;let y=I[b],S=0;for(let w=0;w<m;++w){const C=I[b+w];C>y&&(y=C,S=w)}p[v]=S}return l.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(u,"int32",p)}const QK={kernelName:mg,backendName:"cpu",kernelFunc:JK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;bt(s,"argMin");let a=Yt(i,s.shape);const o=Kn(a,s.shape.length);let c=s;const l=[];o!=null&&(c=ps({inputs:{x:s},backend:t,attrs:{perm:o}}),l.push(c),a=ir(a.length,c.shape.length)),a=[a[0]],Ur("argMin",a,c.shape.length);const[u,f]=$r(c.shape,a),d=Ye(u),p=qr(d,"int32"),m=Ye(f),I=t.data.get(c.dataId).values;for(let v=0;v<p.length;++v){const b=v*m;let y=I[b],S=0;for(let w=0;w<m;++w){const C=I[b+w];C<y&&(y=C,S=w)}p[v]=S}return l.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(u,"int32",p)}const tX={kernelName:vg,backendName:"cpu",kernelFunc:eX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX=wn(Of,n=>Math.asin(n)),rX={kernelName:Of,backendName:"cpu",kernelFunc:nX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX=wn(_f,n=>Math.asinh(n)),iX={kernelName:_f,backendName:"cpu",kernelFunc:sX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=wn(Ff,n=>Math.atan(n)),oX={kernelName:Ff,backendName:"cpu",kernelFunc:aX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX=or((n,e)=>Math.atan2(n,e)),lX=Sr(Bf,cX),uX={kernelName:Bf,backendName:"cpu",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX=wn(Df,n=>Math.atanh(n)),hX={kernelName:Df,backendName:"cpu",kernelFunc:fX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tx(n,e,t,r,s,i){const a=s.strideHeight,o=s.strideWidth,c=s.dilationHeight,l=s.dilationWidth,u=s.effectiveFilterHeight,f=s.effectiveFilterWidth,d=s.padInfo.top,p=s.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=Xt(s.outShape,t),v=I.values,b=s.outShape[1]*s.outShape[2]*s.outShape[3],y=s.outShape[2]*s.outShape[3],S=s.outShape[3];for(let w=0;w<s.batchSize;++w){const C=w*b,N=w*r[0];for(let E=0;E<s.inChannels;++E)for(let A=0;A<s.outHeight;++A){const M=A*a-d,z=Math.max(0,M),Y=Math.min(s.inHeight,u+M),re=C+A*y;for(let ne=0;ne<s.outWidth;++ne){const le=ne*o-p,j=Math.max(0,le),ge=Math.min(s.inWidth,f+le);let Se=m,me=0,ye=0;for(let he=z;he<Y;he+=c){const Ne=N+he*r[1];for(let xe=j;xe<ge;xe+=l){const ae=Ne+xe*r[2],J=n[ae+E];i==="max"&&J>Se?Se=J:i==="avg"&&(me+=J,ye++)}if(isNaN(Se))break}const Ce=re+ne*S+E;v[Ce]=i==="avg"?me/ye:Se}}}return I}function OO(n,e,t,r,s=!1,i=!1){const a=Xt(r.outShape,"int32"),o=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,I=Xt(e,t,n);for(let v=0;v<r.batchSize;++v)for(let b=0;b<r.inChannels;++b)for(let y=0;y<r.outHeight;++y){const S=y*o-p;let w=S;for(;w<0;)w+=l;const C=Math.min(r.inHeight,f+S);for(let N=0;N<r.outWidth;++N){const E=N*c-m;let A=E;for(;A<0;)A+=u;const M=Math.min(r.inWidth,d+E);let z=Number.NEGATIVE_INFINITY,Y=-1;for(let re=w;re<C;re+=l){const ne=re-S;for(let le=A;le<M;le+=u){const j=le-E,ge=I.get(v,re,le,b);ge>z&&(z=ge,s?Y=i?((v*r.inHeight+re)*r.inWidth+le)*r.inChannels+b:(re*r.inWidth+le)*r.inChannels+b:Y=ne*d+j)}}a.set(Y,v,y,N,b)}}return a}function _O(n,e,t,r,s,i){const a=s.strideDepth,o=s.strideHeight,c=s.strideWidth,l=s.dilationDepth,u=s.dilationHeight,f=s.dilationWidth,d=s.effectiveFilterDepth,p=s.effectiveFilterHeight,m=s.effectiveFilterWidth,I=s.padInfo.front,v=s.padInfo.top,b=s.padInfo.left,y=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,S=Xt(s.outShape,t),w=S.values,C=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],N=s.outShape[2]*s.outShape[3]*s.outShape[4],E=s.outShape[3]*s.outShape[4],A=s.outShape[4];for(let M=0;M<s.batchSize;++M){const z=M*C,Y=M*r[0];for(let re=0;re<s.inChannels;++re)for(let ne=0;ne<s.outDepth;++ne){const le=ne*a-I;let j=le;for(;j<0;)j+=l;const ge=Math.min(s.inDepth,d+le),Se=z+ne*N;for(let me=0;me<s.outHeight;++me){const ye=me*o-v;let Ce=ye;for(;Ce<0;)Ce+=u;const he=Math.min(s.inHeight,p+ye),Ne=Se+me*E;for(let xe=0;xe<s.outWidth;++xe){const ae=xe*c-b;let J=ae;for(;J<0;)J+=f;const D=Math.min(s.inWidth,m+ae),P=Ne+xe*A;let Q=y,pe=0,Ee=0;for(let q=j;q<ge;q+=l){const Z=Y+q*r[1];for(let se=Ce;se<he;se+=u){const ie=Z+se*r[2];for(let B=J;B<D;B+=f){const R=ie+B*r[3],k=n[R+re];if(i==="max"&&k>Q?Q=k:i==="avg"&&(pe+=k,Ee++),isNaN(Q))break}if(isNaN(Q))break}if(isNaN(Q))break}const L=P+re;w[L]=i==="avg"?pe/Math.max(Ee,1):Q}}}}return S}function dX(n,e){const t=Xt(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;for(let I=0;I<e.batchSize;++I)for(let v=0;v<e.inChannels;++v)for(let b=0;b<e.outDepth;++b){const y=b*r-d;let S=y;for(;S<0;)S+=a;const w=Math.min(e.inDepth,l+y);for(let C=0;C<e.outHeight;++C){const N=C*s-p;let E=N;for(;E<0;)E+=o;const A=Math.min(e.inHeight,u+N);for(let M=0;M<e.outWidth;++M){const z=M*i-m;let Y=z;for(;Y<0;)Y+=c;const re=Math.min(e.inWidth,f+z);let ne=Number.NEGATIVE_INFINITY,le=-1;for(let j=S;j<w;j+=a){const ge=j-y;for(let Se=E;Se<A;Se+=o){const me=Se-N;for(let ye=Y;ye<re;ye+=c){const Ce=ye-z,he=n.get(I,j,Se,ye,v);he>=ne&&(ne=he,le=ge*u*f+me*u+Ce)}}}t.set(le,I,b,C,M,v)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;bt(s,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:c}=r,l=1;ce(jr(a,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);const u=xi(s.shape,i,a,l,o,c);let f;if(u.filterWidth===1&&u.filterHeight===1&&vn(u.inShape,u.outShape))f=wa({inputs:{x:s},backend:t});else{const d=t.data.get(s.dataId).values,p=Rt(s.shape),m=Tx(d,s.shape,s.dtype,p,u,"avg");f=t.makeTensorInfo(u.outShape,s.dtype,m.values)}return f}const gX={kernelName:Ig,backendName:"cpu",kernelFunc:pX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:c,dataFormat:l}=r;bt(s,"avgPool3d");const u=Xa(s.shape,i,a,1,o,c,l),f=t.data.get(s.dataId).values,d=_O(f,s.shape,s.dtype,Rt(s.shape),u,"avg");return t.makeTensorInfo(d.shape,"float32",d.values)}const vX={kernelName:bg,backendName:"cpu",kernelFunc:mX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IX(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:c,dimRoundingMode:l}=r;bt([s,i],"avgPool3DGrad");const u=Xa(i.shape,a,o,1,c,l),f=u.strideDepth,d=u.strideHeight,p=u.strideWidth,m=u.filterDepth,I=u.filterHeight,v=u.filterWidth,b=u.dilationDepth,y=u.dilationHeight,S=u.dilationWidth,w=u.effectiveFilterDepth,C=u.effectiveFilterHeight,N=u.effectiveFilterWidth,E=w-1-u.padInfo.front,A=N-1-u.padInfo.left,M=C-1-u.padInfo.top,z=Xt(i.shape,"float32"),Y=1/(m*I*v),re=t.bufferSync(s);for(let ne=0;ne<u.batchSize;++ne)for(let le=0;le<u.inChannels;++le)for(let j=0;j<u.inDepth;++j)for(let ge=0;ge<u.inHeight;++ge)for(let Se=0;Se<u.inWidth;++Se){const me=j-E,ye=ge-M,Ce=Se-A;let he=0;for(let Ne=0;Ne<w;Ne+=b){const xe=(me+Ne)/f;if(!(xe<0||xe>=u.outDepth||Math.floor(xe)!==xe))for(let ae=0;ae<C;ae+=y){const J=(ye+ae)/d;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let D=0;D<N;D+=S){const P=(Ce+D)/p;if(P<0||P>=u.outWidth||Math.floor(P)!==P)continue;const Q=re.get(ne,xe,J,P,le);he+=Q}}}z.set(he*Y,ne,j,ge,Se,le)}return t.makeTensorInfo(z.shape,z.dtype,z.values)}const bX={kernelName:ab,backendName:"cpu",kernelFunc:IX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yX(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i;bt([s,i],"avgPoolGrad");const{filterSize:o,strides:c,pad:l}=r,u=xi(a.shape,o,c,1,l),f=u.strideHeight,d=u.strideWidth,p=u.filterHeight,m=u.filterWidth,I=u.dilationHeight,v=u.dilationWidth,b=u.effectiveFilterHeight,y=u.effectiveFilterWidth,S=y-1-u.padInfo.left,w=b-1-u.padInfo.top,C=Xt(a.shape,"float32"),N=1/(p*m),E=t.data.get(s.dataId).values,A=Xt(s.shape,"float32",E);for(let M=0;M<u.batchSize;++M)for(let z=0;z<u.inChannels;++z)for(let Y=0;Y<u.inHeight;++Y)for(let re=0;re<u.inWidth;++re){const ne=Y-w,le=re-S;let j=0;for(let ge=0;ge<b;ge+=I){const Se=(ne+ge)/f;if(!(Se<0||Se>=u.outHeight||Math.floor(Se)!==Se))for(let me=0;me<y;me+=v){const ye=(le+me)/d;if(ye<0||ye>=u.outWidth||Math.floor(ye)!==ye)continue;const Ce=A.get(M,Se,ye,z);j+=Ce}}C.set(j*N,M,Y,re,z)}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const xX={kernelName:ib,backendName:"cpu",kernelFunc:yX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,scale:i,offset:a,mean:o,variance:c}=e;ce(o.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ce(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ce(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),bt([s,o,c,i,a],"batchNorm");let{varianceEpsilon:l}=r;l==null&&(l=.001);const u=t.data.get(s.dataId).values,f=t.data.get(o.dataId).values,d=t.data.get(c.dataId).values,p=i?t.data.get(i.dataId).values:new Float32Array([1]),m=a?t.data.get(a.dataId).values:new Float32Array([0]),I=new Float32Array(u.length),v=m.length,b=p.length,y=d.length,S=f.length;let w=0,C=0,N=0,E=0;for(let A=0;A<u.length;++A)I[A]=m[w++]+(u[A]-f[C++])*p[N++]/Math.sqrt(d[E++]+l),w>=v&&(w=0),C>=S&&(C=0),N>=b&&(N=0),E>=y&&(E=0);return t.makeTensorInfo(s.shape,s.dtype,I)}const SX={kernelName:Og,backendName:"cpu",kernelFunc:wX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:a}=r;bt([s],"batchToSpaceND");const o=i.reduce((b,y)=>b*y),c=$h(s.shape,i,o),l=Nh(c.length,i.length),u=Oh(s.shape,i,o),f=Py(a,i.length),d=Ly(u,a,i.length),p=Nn({inputs:{x:s},backend:t,attrs:{shape:c}}),m=ps({inputs:{x:p},backend:t,attrs:{perm:l}}),I=Nn({inputs:{x:m},backend:t,attrs:{shape:u}}),v=$c({inputs:{x:I},backend:t,attrs:{begin:f,size:d}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(I),v}const RX={kernelName:xg,backendName:"cpu",kernelFunc:CX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a}=r,o=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,l=Sx(o,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,l)}const EX={kernelName:ob,backendName:"cpu",kernelFunc:kX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TX(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values,o=Ut(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const AX={kernelName:nE,backendName:"cpu",kernelFunc:TX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X=wn(Lf,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),NX={kernelName:Lf,backendName:"cpu",kernelFunc:$X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX=n=>{const{x:e}=n.inputs,t=n.backend,r=new Float32Array(Ye(e.shape)),s=t.data.get(e.dataId),i=s.complexTensorInfos.real,a=s.complexTensorInfos.imag,o=t.data.get(i.dataId).values,c=t.data.get(a.dataId).values;for(let l=0;l<o.length;l++){const u=o[l],f=c[l];r[l]=Math.hypot(u,f)}return t.makeOutput(r,e.shape,"float32")},_X={kernelName:wg,backendName:"cpu",kernelFunc:OX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.data.get(r.dataId).complexTensorInfos.imag,i=t.data.get(s.dataId).values;return t.makeTensorInfo(s.shape,s.dtype,i)}const FX={kernelName:Cb,backendName:"cpu",kernelFunc:zl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=Yt(s,e[0].shape)[0],a=e.map(I=>I.shape);Dy(a,i);let o=va(e.map(I=>I.shape),i);if(Ye(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const c=e.filter(I=>Ye(I.shape)>0);if(c.length===1)return wa({inputs:{x:c[0]},backend:t});if(c[0].dtype==="complex64"){const I=c.map(w=>Ac({inputs:{input:w},backend:t})),v=c.map(w=>zl({inputs:{input:w},backend:t})),b=Vl({inputs:I,backend:t,attrs:{axis:i}}),y=Vl({inputs:v,backend:t,attrs:{axis:i}}),S=Rs({inputs:{real:b,imag:y},backend:t});return I.forEach(w=>t.disposeIntermediateTensorInfo(w)),v.forEach(w=>t.disposeIntermediateTensorInfo(w)),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),S}const l=c.map(I=>{const b=[-1,Ye(I.shape.slice(i))];return Nn({inputs:{x:I},backend:t,attrs:{shape:b}})}),u=l.map(I=>({vals:t.data.get(I.dataId).values,shape:I.shape}));o=va(l.map(I=>I.shape),1);const f=l[0].shape[0]===1,d=PN(u,o,e[0].dtype,f),p=va(c.map(I=>I.shape),i),m=t.makeTensorInfo(p,e[0].dtype,d);return l.forEach(I=>t.disposeIntermediateTensorInfo(I)),m}const DX={kernelName:Sg,backendName:"cpu",kernelFunc:Vl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FO(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dataFormat:c,dilations:l,dimRoundingMode:u}=r;bt([s,i],"conv2d");const f=Ya(c),d=Lr(s.shape,i.shape,a,l,o,u,!1,f),p=d.filterHeight,m=d.filterWidth,I=d.dilationHeight,v=d.dilationWidth,b=d.padInfo.left,y=d.padInfo.top,S=d.dataFormat==="channelsLast",w=new Pr(d.outShape,s.dtype),C=Rt(s.shape),N=Rt(i.shape),E=C[0],A=S?C[1]:C[2],M=S?C[2]:1,z=S?1:C[1],Y=w.strides[0],re=S?w.strides[1]:w.strides[2],ne=S?w.strides[2]:1,le=S?1:w.strides[1],j=t.data.get(s.dataId).values,ge=t.data.get(i.dataId).values,Se=w.values;for(let me=0;me<d.batchSize;++me){const ye=me*E,Ce=me*Y;for(let he=0;he<d.outHeight;++he){const Ne=Ce+he*re,xe=he*d.strideHeight-y;for(let ae=0;ae<p;++ae){const J=xe+ae*I;if(J<0||J>=d.inHeight)continue;const D=ae*N[0],P=ye+J*A;for(let Q=0;Q<d.outWidth;++Q){const pe=Ne+Q*ne,Ee=Q*d.strideWidth-b;for(let L=0;L<m;++L){const q=Ee+L*v;if(q<0||q>=d.inWidth)continue;const Z=D+L*N[1],se=P+q*M;let ie=Z;for(let B=0;B<d.inChannels;++B){const R=j[se+B*z];for(let k=0;k<d.outChannels;++k)Se[pe+k*le]+=R*ge[ie+k];ie+=d.outChannels}}}}}}return t.makeTensorInfo(w.shape,w.dtype,Se)}const BX={kernelName:Cg,backendName:"cpu",kernelFunc:FO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:c,dimRoundingMode:l,filterShape:u}=r;bt([s,i],"conv2dBackpropFilter");const f=Ya(c),d=Lr(s.shape,u,a,1,o,l,!1,f),{strideHeight:p,strideWidth:m,filterHeight:I,filterWidth:v}=d,b=d.dataFormat==="channelsLast",y=new Pr(d.filterShape,"float32"),S=d.padInfo.left,w=d.padInfo.top,C=t.data.get(s.dataId).values,N=t.data.get(i.dataId).values,E=new Pr(s.shape,s.dtype,C),A=new Pr(i.shape,i.dtype,N);for(let M=0;M<I;++M){const z=Math.max(0,Math.ceil((w-M)/p)),Y=Math.min(d.outHeight,(d.inHeight+w-M)/p);for(let re=0;re<v;++re){const ne=Math.max(0,Math.ceil((S-re)/m)),le=Math.min(d.outWidth,(d.inWidth+S-re)/m);for(let j=0;j<d.inChannels;++j)for(let ge=0;ge<d.outChannels;++ge){let Se=0;for(let me=0;me<d.batchSize;++me)for(let ye=z;ye<Y;++ye){const Ce=M+ye*p-w;for(let he=ne;he<le;++he){const Ne=re+he*m-S;b?Se+=E.get(me,Ce,Ne,j)*A.get(me,ye,he,ge):Se+=E.get(me,j,Ce,Ne)*A.get(me,ge,ye,he)}}y.set(Se,M,re,j,ge)}}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const PX={kernelName:ub,backendName:"cpu",kernelFunc:MX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LX(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:a,strides:o,pad:c,dataFormat:l,dimRoundingMode:u}=r;bt([s,i],"conv2dBackpropInput");const f=Rt(i.shape),d=Rt(s.shape);let p=Ya(l);const m=Lr(a,i.shape,o,1,c,u,!1,p),I=new Pr(m.inShape,"float32"),v=I.values,b=t.data.get(s.dataId).values,y=t.data.get(i.dataId).values,[S,w,C]=f,{batchSize:N,filterHeight:E,filterWidth:A,inChannels:M,inHeight:z,inWidth:Y,outChannels:re,outHeight:ne,outWidth:le,strideHeight:j,strideWidth:ge}=m;p=m.dataFormat;const Se=E-1-m.padInfo.top,me=A-1-m.padInfo.left,ye=p==="channelsLast",Ce=I.strides[0],he=ye?I.strides[1]:I.strides[2],Ne=ye?I.strides[2]:1,xe=ye?1:I.strides[1],ae=d[0],J=ye?d[1]:d[2],D=ye?d[2]:1,P=ye?1:d[1];for(let Q=0;Q<N;++Q)for(let pe=0;pe<M;++pe)for(let Ee=0;Ee<z;++Ee){const L=Ee-Se,q=Math.max(0,Math.ceil(L/j)),Z=Math.min(ne,(E+L)/j);for(let se=0;se<Y;++se){const ie=se-me,B=Math.max(0,Math.ceil(ie/ge)),R=Math.min(le,(A+ie)/ge);let k=0;for(let fe=q;fe<Z;++fe){const Te=fe*j-L;for(let Be=B;Be<R;++Be){const He=Be*ge-ie,rt=ae*Q+J*fe+D*Be,ct=S*(E-1-Te)+w*(A-1-He)+C*pe;for(let lt=0;lt<re;++lt){const W=b[rt+P*lt],T=y[ct+lt];k+=W*T}}}const X=Ce*Q+he*Ee+Ne*se+xe*pe;v[X]=k}}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const UX={kernelName:Rg,backendName:"cpu",kernelFunc:LX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:c}=r;bt([s,i],"conv3d");const l=Do(s.shape,i.shape,a,c,o),{filterDepth:u,filterHeight:f,filterWidth:d,dilationDepth:p,dilationHeight:m,dilationWidth:I,padInfo:v}=l,b=v.front,y=v.left,S=v.top,w=new Pr(l.outShape,s.dtype),C=t.data.get(s.dataId).values,N=t.data.get(i.dataId).values,E=w.values,A=Rt(s.shape),M=Rt(i.shape);for(let z=0;z<l.batchSize;++z){const Y=z*A[0],re=z*w.strides[0];for(let ne=0;ne<l.outDepth;++ne){const le=re+ne*w.strides[1],j=ne*l.strideDepth-b;for(let ge=0;ge<u;++ge){const Se=j+ge*p;if(Se<0||Se>=l.inDepth)continue;const me=ge*M[0],ye=Y+Se*A[1];for(let Ce=0;Ce<l.outHeight;++Ce){const he=le+Ce*w.strides[2],Ne=Ce*l.strideHeight-S;for(let xe=0;xe<f;++xe){const ae=Ne+xe*m;if(ae<0||ae>=l.inHeight)continue;const J=me+xe*M[1],D=ye+ae*A[2];for(let P=0;P<l.outWidth;++P){const Q=he+P*l.outChannels,pe=P*l.strideWidth-y;for(let Ee=0;Ee<d;++Ee){const L=pe+Ee*I;if(L<0||L>=l.inWidth)continue;const q=J+Ee*M[2],Z=D+L*l.inChannels;let se=q;for(let ie=0;ie<l.inChannels;++ie){const B=C[Z+ie];for(let R=0;R<l.outChannels;++R)E[Q+R]+=B*N[se+R];se+=l.outChannels}}}}}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const VX={kernelName:kg,backendName:"cpu",kernelFunc:zX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,filterShape:c}=r;bt([s,i],"conv3dBackpropFilterV2");const l=Rt(s.shape),u=Rt(i.shape),f=Do(s.shape,c,a,1,o),d=f.strideDepth,p=f.strideHeight,m=f.strideWidth,I=f.filterDepth,v=f.filterHeight,b=f.filterWidth,y=new Pr(f.filterShape,"float32"),S=y.values,[w,C,N,E]=y.strides,A=t.data.get(i.dataId).values,[M,z,Y,re]=u,ne=t.data.get(s.dataId).values,[le,j,ge,Se]=l,me=f.padInfo.front,ye=f.padInfo.left,Ce=f.padInfo.top;for(let he=0;he<I;++he){const Ne=Math.max(0,Math.ceil((me-he)/d)),xe=Math.min(f.outDepth,(f.inDepth+me-he)/d),ae=he*w;for(let J=0;J<v;++J){const D=Math.max(0,Math.ceil((Ce-J)/p)),P=Math.min(f.outHeight,(f.inHeight+Ce-J)/p),Q=J*C+ae;for(let pe=0;pe<b;++pe){const Ee=Math.max(0,Math.ceil((ye-pe)/m)),L=Math.min(f.outWidth,(f.inWidth+ye-pe)/m),q=pe*N+Q;for(let Z=0;Z<f.inChannels;++Z){const se=Z*E+q;for(let ie=0;ie<f.outChannels;++ie){let B=0;for(let R=0;R<f.batchSize;++R){const k=R*le,X=R*M;for(let fe=Ne;fe<xe;++fe){const Be=(he+fe*d-me)*j+k,He=fe*z+X;for(let rt=D;rt<P;++rt){const lt=(J+rt*p-Ce)*ge+Be,W=rt*Y+He;for(let T=Ee;T<L;++T){const ue=(pe+T*m-ye)*Se+lt,Ae=T*re+W;B+=ne[ue+Z]*A[Ae+ie]}}}}S[se+ie]=B}}}}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const GX={kernelName:fb,backendName:"cpu",kernelFunc:WX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HX(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:a,strides:o,inputShape:c}=r;bt([s],"conv3dBackpropInputV2");const l=Rt(s.shape),u=Rt(i.shape),f=Do(c,i.shape,o,1,a),d=new Pr(f.inShape,"float32"),p=d.values,[m,I,v,b]=d.strides,y=t.data.get(s.dataId).values,[S,w,C,N]=l,E=t.data.get(i.dataId).values,[A,M,z,Y]=u,{batchSize:re,filterDepth:ne,filterHeight:le,filterWidth:j,inChannels:ge,inDepth:Se,inHeight:me,inWidth:ye,outChannels:Ce,outDepth:he,outHeight:Ne,outWidth:xe,strideDepth:ae,strideHeight:J,strideWidth:D}=f,P=ne-1-f.padInfo.front,Q=le-1-f.padInfo.top,pe=j-1-f.padInfo.left;for(let Ee=0;Ee<re;++Ee)for(let L=0;L<ge;++L)for(let q=0;q<Se;++q){const Z=q-P,se=Math.max(0,Math.ceil(Z/ae)),ie=Math.min(he,(ne+Z)/ae);for(let B=0;B<me;++B){const R=B-Q,k=Math.max(0,Math.ceil(R/J)),X=Math.min(Ne,(le+R)/J);for(let fe=0;fe<ye;++fe){const Te=fe-pe,Be=Math.max(0,Math.ceil(Te/D)),He=Math.min(xe,(j+Te)/D);let rt=0;for(let ct=se;ct<ie;++ct){const lt=ct*ae-Z;for(let W=k;W<X;++W){const T=W*J-R;for(let O=Be;O<He;++O){const ue=O*D-Te,Ae=S*Ee+w*ct+C*W+N*O,ze=A*(ne-1-lt)+M*(le-1-T)+z*(j-1-ue)+Y*L;for(let Xe=0;Xe<Ce;++Xe){const Ct=y[Ae+Xe],hn=E[ze+Xe];rt+=Ct*hn}}}}p[m*Ee+I*q+v*B+b*fe+L]=rt}}}return t.makeTensorInfo(d.shape,d.dtype,d.values)}const qX={kernelName:hb,backendName:"cpu",kernelFunc:HX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jX=wn(Uf,n=>Math.cos(n)),KX={kernelName:Uf,backendName:"cpu",kernelFunc:jX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX=wn(zf,n=>Math.cosh(n)),YX={kernelName:zf,backendName:"cpu",kernelFunc:XX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZX(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:a}=e,{cropSize:o,method:c,extrapolationValue:l}=r,[u,f,d,p]=s.shape,m=i.shape[0],[I,v]=o,b=Xt([m,I,v,p],"float32"),y=t.data.get(i.dataId).values,S=t.data.get(a.dataId).values,w=t.data.get(s.dataId).values,C=Rt(s.shape),N=Rt(b.shape);for(let E=0;E<m;E++){const A=E*4,M=y[A],z=y[A+1],Y=y[A+2],re=y[A+3],ne=S[E];if(ne>=u)continue;const le=I>1?(Y-M)*(f-1)/(I-1):0,j=v>1?(re-z)*(d-1)/(v-1):0;for(let ge=0;ge<I;ge++){const Se=I>1?M*(f-1)+ge*le:.5*(M+Y)*(f-1);if(Se<0||Se>f-1){for(let me=0;me<v;me++)for(let ye=0;ye<p;ye++){const Ce=ye+me*N[2]+ge*N[1]+E*N[0];b.values[Ce]=l}continue}if(c==="bilinear"){const me=Math.floor(Se),ye=Math.ceil(Se),Ce=Se-me;for(let he=0;he<v;he++){const Ne=v>1?z*(d-1)+he*j:.5*(z+re)*(d-1);if(Ne<0||Ne>d-1){for(let D=0;D<p;D++){const P=D+he*N[2]+ge*N[1]+E*N[0];b.values[P]=l}continue}const xe=Math.floor(Ne),ae=Math.ceil(Ne),J=Ne-xe;for(let D=0;D<p;D++){let P=D+xe*C[2]+me*C[1]+ne*C[0];const Q=w[P];P=D+ae*C[2]+me*C[1]+ne*C[0];const pe=w[P];P=D+xe*C[2]+ye*C[1]+ne*C[0];const Ee=w[P];P=D+ae*C[2]+ye*C[1]+ne*C[0];const L=w[P],q=Q+(pe-Q)*J,Z=Ee+(L-Ee)*J;P=D+he*N[2]+ge*N[1]+E*N[0],b.values[P]=q+(Z-q)*Ce}}}else for(let me=0;me<v;++me){const ye=v>1?z*(d-1)+me*j:.5*(z+re)*(d-1);if(ye<0||ye>d-1){for(let Ne=0;Ne<p;Ne++){const xe=Ne+me*N[2]+ge*N[1]+E*N[0];b.values[xe]=l}continue}const Ce=Math.round(ye),he=Math.round(Se);for(let Ne=0;Ne<p;Ne++){const xe=Ne+Ce*C[2]+he*C[1]+ne*C[0],ae=Ne+me*N[2]+ge*N[1]+E*N[0];b.values[ae]=w[xe]}}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const JX={kernelName:pb,backendName:"cpu",kernelFunc:ZX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;bt(s,"cumprod");const c=Kn([i],s.shape.length);let l=s;c!=null&&(l=ps({inputs:{x:s},backend:t,attrs:{perm:c}}));const u=ir(1,s.shape.length)[0];if(u!==l.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);const f=Ts(l.dtype,"int32"),d=QI(Ye(l.shape),f),p=t.data.get(l.dataId).values,m=l.shape[l.shape.length-1],I=o?(b,y)=>b+m-y-1:(b,y)=>b+y;for(let b=0;b<p.length;b+=m)for(let y=0;y<m;y++){const S=I(b,y);if(y===0)d[S]=a?1:p[S];else{const w=I(b,y-1);d[S]=a?p[w]*d[w]:p[S]*d[w]}}const v=t.makeTensorInfo(l.shape,f,d);if(c!=null){const b=Bo(c),y=ps({inputs:{x:v},backend:t,attrs:{perm:b}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(l),y}return v}const eY={kernelName:db,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;bt(s,"cumsum");const c=Kn([i],s.shape.length);let l=s;c!=null&&(l=ps({inputs:{x:s},backend:t,attrs:{perm:c}}));const u=ir(1,s.shape.length)[0];if(u!==l.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);const f=Ts(l.dtype,"int32"),d=qr(Ye(l.shape),f),p=t.data.get(l.dataId).values,m=l.shape[l.shape.length-1],I=o?(b,y)=>b+m-y-1:(b,y)=>b+y;for(let b=0;b<p.length;b+=m)for(let y=0;y<m;y++){const S=I(b,y);if(y===0)d[S]=a?0:p[S];else{const w=I(b,y-1);d[S]=a?p[w]+d[w]:p[S]+d[w]}}const v=t.makeTensorInfo(l.shape,f,d);if(c!=null){const b=Bo(c),y=ps({inputs:{x:v},backend:t,attrs:{perm:b}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(l),y}return v}const nY={kernelName:Eg,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(s.shape.length===1){const c=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=Sx(c,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}else if(s.shape.length===2){const c=t.bufferSync(s),l=t.bufferSync(i),u=DN(c,l,a,o);return t.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const sY={kernelName:gb,backendName:"cpu",kernelFunc:rY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:a}=r;ce(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=s.shape[0],c=s.shape[1],l=s.shape[2],u=s.shape[3],f=c*i,d=l*i,p=u/(i*i),m=t.data.get(s.dataId).values,I=new Float32Array(o*f*d*p);let v=0;for(let b=0;b<o;++b)for(let y=0;y<f;++y){const S=Math.floor(y/i),w=y%i;for(let C=0;C<d;++C){const N=Math.floor(C/i),E=C%i,A=(w*i+E)*p;for(let M=0;M<p;++M){const Y=M+A+u*(N+l*(S+c*b));I[v++]=m[Y]}}}return t.makeTensorInfo([o,f,d,p],s.dtype,I)}const aY={kernelName:mb,backendName:"cpu",kernelFunc:iY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:c,dimRoundingMode:l}=r;bt([s,i],"depthwiseConv2DNative");const u=Rt(s.shape),f=Rt(i.shape);let d=c;d==null&&(d=[1,1]),ce(jr(a,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${d}'`);const p=Lr(s.shape,i.shape,a,d,o,l,!0),{filterHeight:m,filterWidth:I,dilationHeight:v,dilationWidth:b,padInfo:y}=p,S=y.left,w=y.top,C=p.outChannels/p.inChannels,N=new Pr(p.outShape,s.dtype),E=t.data.get(s.dataId).values,A=t.data.get(i.dataId).values,M=N.values;for(let z=0;z<p.batchSize;++z){const Y=z*u[0],re=z*N.strides[0];for(let ne=0;ne<p.outHeight;++ne){const le=re+ne*N.strides[1],j=ne*p.strideHeight-w;for(let ge=0;ge<m;++ge){const Se=j+ge*v;if(Se<0||Se>=p.inHeight)continue;const me=ge*f[0],ye=Y+Se*u[1];for(let Ce=0;Ce<p.outWidth;++Ce){const he=le+Ce*N.strides[2],Ne=Ce*p.strideWidth-S;for(let xe=0;xe<I;++xe){const ae=Ne+xe*b;if(ae<0||ae>=p.inWidth)continue;const J=me+xe*f[1],D=ye+ae*p.inChannels;let P=he,Q=J;for(let pe=0;pe<p.inChannels;++pe){const Ee=E[D+pe];for(let L=0;L<C;++L)M[P+L]+=Ee*A[Q+L];P+=C,Q+=C}}}}}}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const oY={kernelName:Tg,backendName:"cpu",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,dilations:o,pad:c,dimRoundingMode:l,filterShape:u}=r;bt([s,i],"depthwiseConv2dNativeBackpropFilter");const f=Lr(s.shape,u,a,o,c,l,!0),{strideHeight:d,strideWidth:p,filterHeight:m,filterWidth:I}=f,v=new Pr(f.filterShape,"float32"),b=f.padInfo.left,y=f.padInfo.top,S=f.outChannels/f.inChannels,w=t.data.get(s.dataId).values,C=new Pr(s.shape,s.dtype,w),N=t.data.get(i.dataId).values,E=new Pr(i.shape,i.dtype,N);for(let A=0;A<m;++A){const M=Math.max(0,Math.ceil((y-A)/d)),z=Math.min(f.outHeight,(f.inHeight+y-A)/d);for(let Y=0;Y<I;++Y){const re=Math.max(0,Math.ceil((b-Y)/p)),ne=Math.min(f.outWidth,(f.inWidth+b-Y)/p);for(let le=0;le<f.outChannels;++le){const j=Math.trunc(le/S),ge=le%S;let Se=0;for(let me=0;me<f.batchSize;++me)for(let ye=M;ye<z;++ye){const Ce=A+ye*d-y;for(let he=re;he<ne;++he){const Ne=Y+he*p-b;Se+=C.get(me,Ce,Ne,j)*E.get(me,ye,he,le)}}v.set(Se,A,Y,j,ge)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const lY={kernelName:vb,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uY(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:a,dilations:o,pad:c,dimRoundingMode:l,inputShape:u}=r;bt([s,i],"depthwiseConv2DNativeBackpropInput");const f=Rt(s.shape),d=Rt(i.shape),p=Lr(u,i.shape,a,o,c,l,!0),m=new Pr(p.inShape,"float32"),I=m.values,[v,b,y]=m.strides,S=t.data.get(s.dataId).values,[w,C,N]=f,E=t.data.get(i.dataId).values,[A,M,z]=d,{batchSize:Y,filterHeight:re,filterWidth:ne,inChannels:le,inHeight:j,inWidth:ge,outChannels:Se,outHeight:me,outWidth:ye,strideHeight:Ce,strideWidth:he}=p,Ne=re-1-p.padInfo.top,xe=ne-1-p.padInfo.left,ae=Se/le;for(let J=0;J<Y;++J)for(let D=0;D<le;++D)for(let P=0;P<j;++P){const Q=P-Ne,pe=Math.max(0,Math.ceil(Q/Ce)),Ee=Math.min(me,(re+Q)/Ce);for(let L=0;L<ge;++L){const q=L-xe,Z=Math.max(0,Math.ceil(q/he)),se=Math.min(ye,(ne+q)/he);let ie=0;for(let B=pe;B<Ee;++B){const R=B*Ce-Q;for(let k=Z;k<se;++k){const X=k*he-q,fe=w*J+C*B+N*k,Te=A*(re-1-R)+M*(ne-1-X)+z*D;for(let Be=0;Be<ae;++Be){const He=D*ae+Be,rt=S[fe+He],ct=E[Te+Be];ie+=rt*ct}}}I[v*J+b*P+y*L+D]=ie}}return t.makeTensorInfo(m.shape,m.dtype,m.values)}const fY={kernelName:Ib,backendName:"cpu",kernelFunc:uY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hY(n){const{inputs:e,backend:t}=n,{x:r}=e,s=Ye(r.shape),i=t.data.get(r.dataId).values,a=Xt([s,s],r.dtype),o=a.values;for(let l=0;l<i.length;l++)o[l*s+l]=i[l];const c=[...r.shape,...r.shape];return t.makeTensorInfo(c,a.dtype,a.values)}const dY={kernelName:rE,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY={kernelName:Ag,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s}=n,{strides:i,pad:a,dilations:o}=t,c=e,l=c.data.get(r.dataId).values,u=r.shape.length,f=c.data.get(s.dataId).values,d=s.shape.length,{batchSize:p,inHeight:m,inWidth:I,inChannels:v,outHeight:b,outWidth:y,padInfo:S,strideHeight:w,strideWidth:C,filterHeight:N,filterWidth:E,dilationHeight:A,dilationWidth:M,outShape:z}=Rh(r.shape,s.shape,i,a,"NHWC",o),Y=Ye(z),re=z.length,ne=nr(r.dtype,Y);for(let j=0;j<p;++j)for(let ge=0;ge<b;++ge){const Se=ge*w-S.top;for(let me=0;me<y;++me){const ye=me*C-S.left;for(let Ce=0;Ce<v;++Ce){let he=Number.MIN_SAFE_INTEGER;for(let xe=0;xe<N;++xe){const ae=Se+xe*A;if(ae>=0&&ae<m)for(let J=0;J<E;++J){const D=ye+J*M;if(D>=0&&D<I){const P=ga([j,ae,D,Ce],u,Rt(r.shape)),Q=ga([xe,J,Ce],d,Rt(s.shape)),pe=l[P]+f[Q];pe>he&&(he=pe)}}}const Ne=ga([j,ge,me,Ce],re,Rt(z));ne[Ne]=he}}}return{dataId:c.write(_c(ne,r.dtype),z,r.dtype),shape:z,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY={kernelName:Av,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:a,pad:o,dilations:c}=t,l=e,u=Li(r.shape,l.data.get(r.dataId).values),f=Li(s.shape,l.data.get(s.dataId).values),{batchSize:d,inHeight:p,inWidth:m,inChannels:I,outHeight:v,outWidth:b,padInfo:y,strideHeight:S,strideWidth:w,filterHeight:C,filterWidth:N,dilationHeight:E,dilationWidth:A,outShape:M}=Rh(r.shape,s.shape,a,o,"NHWC",c);ce(i.rank===M.length,()=>`Error in ${Av}, dy must have the same rank as output ${M.length}, but got ${i.rank}`);const z=Li(M,l.data.get(i.dataId).values),Y=Qk(s.shape,s.dtype);for(let ne=0;ne<d;++ne)for(let le=0;le<v;++le){const j=le*S-y.top;for(let ge=0;ge<b;++ge){const Se=ge*w-y.left;for(let me=0;me<I;++me){let ye=Number.MIN_SAFE_INTEGER,Ce=0,he=0;for(let Ne=0;Ne<C;++Ne){const xe=j+Ne*E;if(xe>=0&&xe<p)for(let ae=0;ae<N;++ae){const J=Se+ae*A;if(J>=0&&J<m){const D=u[ne][xe][J][me]+f[Ne][ae][me];D>ye&&(ye=D,Ce=Ne,he=ae)}}}Y[Ce][he][me]+=z[ne][le][ge][me]}}}return{dataId:l.write(_c(Y,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY={kernelName:Tv,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:r,filter:s,dy:i}=n,{strides:a,pad:o,dilations:c}=t,l=e,u=Li(r.shape,l.data.get(r.dataId).values),f=Li(s.shape,l.data.get(s.dataId).values),{batchSize:d,inHeight:p,inWidth:m,inChannels:I,outHeight:v,outWidth:b,padInfo:y,strideHeight:S,strideWidth:w,filterHeight:C,filterWidth:N,dilationHeight:E,dilationWidth:A,outShape:M}=Rh(r.shape,s.shape,a,o,"NHWC",c);ce(i.rank===M.length,()=>`Error in ${Tv}, dy must have the same rank as output ${M.length}, but got ${i.rank}`);const z=Li(M,l.data.get(i.dataId).values),Y=Qk(r.shape,r.dtype);for(let ne=0;ne<d;++ne)for(let le=0;le<v;++le){const j=le*S-y.top;for(let ge=0;ge<b;++ge){const Se=ge*w-y.left;for(let me=0;me<I;++me){let ye=Number.MIN_SAFE_INTEGER,Ce=j<0?0:j,he=Se<0?0:Se;for(let Ne=0;Ne<C;++Ne){const xe=j+Ne*E;if(xe>=0&&xe<p)for(let ae=0;ae<N;++ae){const J=Se+ae*A;if(J>=0&&J<m){const D=u[ne][xe][J][me]+f[Ne][ae][me];D>ye&&(ye=D,Ce=xe,he=J)}}}Y[ne][Ce][he][me]+=z[ne][le][ge][me]}}}return{dataId:l.write(_c(Y,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vY(n){const{inputs:e,backend:t,attrs:r}=n,{image:s}=e,{canvas:i,options:a}=r,{contextOptions:o,imageOptions:c}=a||{},l=(c==null?void 0:c.alpha)||1,u=(o==null?void 0:o.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const f=i.getContext(u,(o==null?void 0:o.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${u} type.`);const[d,p]=s.shape.slice(0,2),m=s.shape.length===2?1:s.shape[2],I=t.data.get(s.dataId).values,v=s.dtype==="float32"?255:1,b=new Uint8ClampedArray(p*d*4);for(let S=0;S<d*p;++S){const w=[0,0,0,255*l];for(let N=0;N<m;N++){const E=I[S*m+N];if(s.dtype==="float32"){if(E<0||E>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${E}.`)}else if(s.dtype==="int32"&&(E<0||E>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${E}.`);m===1?(w[0]=E*v,w[1]=E*v,w[2]=E*v):w[N]=E*v}const C=S*4;b[C+0]=Math.round(w[0]),b[C+1]=Math.round(w[1]),b[C+2]=Math.round(w[2]),b[C+3]=Math.round(w[3])}i.width=p,i.height=d;const y=new ImageData(b,p,d);return f.putImageData(y,0,0),s}const IY={kernelName:rU,backendName:"cpu",kernelFunc:vY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;bt(s,"sum");let o;s.dtype==="bool"?o=No({inputs:{x:s},backend:t,attrs:{dtype:"int32"}}):o=wa({inputs:{x:s},backend:t});const c=o.shape.length,l=Yt(i,o.shape),u=Kn(l,c);let f=l,d=o;u!=null&&(d=ps({inputs:{x:o},backend:t,attrs:{perm:u}}),f=ir(f.length,c)),Ur("sum",f,d.shape.length);const[p,m]=$r(d.shape,f),I=Ts(d.dtype,"int32");let v=Hp(t,p,I);const b=Ye(m),y=t.data.get(v.dataId).values,S=t.data.get(d.dataId).values;for(let w=0;w<y.length;++w){const C=w*b;let N=0;for(let E=0;E<b;++E)N+=S[C+E];y[w]=N}if(a){const w=mr(v.shape,l),C=v;v=Nn({inputs:{x:v},backend:t,attrs:{shape:w}}),t.disposeIntermediateTensorInfo(C)}return t.disposeIntermediateTensorInfo(o),u!=null&&t.disposeIntermediateTensorInfo(d),v}const bY={kernelName:cm,backendName:"cpu",kernelFunc:zh};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:a,summedDims:o,idDims:c}=jy(s,i.length);Xy(a.length,c,i);const{path:l,steps:u}=Yy(o,c),f=u.length;let d=null,p=a.length;const m=[];for(let I=0;I<f;++I){for(const v of u[I]){const{permutationIndices:b,expandDims:y}=Ky(p,c[v]);let S;Zy(b)?S=i[v]:(S=ps({inputs:{x:i[v]},backend:t,attrs:{perm:b}}),m.push(S));const w=S.shape.slice();for(let C=0;C<y.length;++C)w.splice(y[C],0,1);vn(S.shape,w)||(S=Nn({inputs:{x:S},backend:t,attrs:{shape:w}}),m.push(S)),d===null?d=S:(d=Pm({inputs:{a:S,b:d},backend:t}),m.push(d))}I<f-1&&(l[I]>=0&&(d=zh({inputs:{x:d},backend:t,attrs:{axis:l[I]-(a.length-p),keepDims:!1}}),m.push(d)),p--)}for(const I of m)I!==d&&t.disposeIntermediateTensorInfo(I);return d}const xY={kernelName:sE,backendName:"cpu",kernelFunc:yY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wY(n){const{inputs:e,backend:t}=n,{dy:r,y:s}=e;bt([r,s],"eluGrad");const i=new Float32Array(Ye(s.shape)),a=t.data.get(s.dataId).values,o=t.data.get(r.dataId).values;for(let c=0;c<a.length;++c){const l=a[c];l>=0?i[c]=o[c]:i[c]=o[c]*(l+1)}return t.makeTensorInfo(s.shape,"float32",i)}const SY={kernelName:bb,backendName:"cpu",kernelFunc:wY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CY=Uy,RY=zy,kY=Vy,EY=Wy,TY=Gy,AY=Hy,$Y=wn(Gf,n=>{const e=Math.sign(n),t=Math.abs(n),r=1/(1+CY*t);return e*(1-((((AY*r+TY)*r+EY)*r+kY)*r+RY)*r*Math.exp(-t*t))}),NY={kernelName:Gf,backendName:"cpu",kernelFunc:$Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(n){const{inputs:e,backend:t,attrs:r}=n,{input:s}=e,{dim:i}=r,a=s.shape.length,o=s.shape.slice();let c=i;return i<0&&(ce(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),c=a+i+1),o.splice(c,0,1),Nn({inputs:{x:s},backend:t,attrs:{shape:o}})}const OY={kernelName:Ng,backendName:"cpu",kernelFunc:Kp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Y=or((n,e)=>n/e),Ax=Sr(Vf,_Y),rI={kernelName:Vf,backendName:"cpu",kernelFunc:Ax};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BO(n,e,t){const r=n.shape,s=r[0],i=r[1],a=t.data.get(n.dataId),o=a.complexTensorInfos.real,c=a.complexTensorInfos.imag,l=[s,i],u=Ye(l),f=Hr("float32",u),d=Hr("float32",u);for(let v=0;v<s;v++){const b=$c({inputs:{x:o},backend:t,attrs:{begin:[v,0],size:[1,i]}}),y=$c({inputs:{x:c},backend:t,attrs:{begin:[v,0],size:[1,i]}}),S=Rs({inputs:{real:b,imag:y},backend:t}),{real:w,imag:C}=FY(S,e,t),N=Ha(w,C);for(let E=0;E<i;E++){const A=qy(N,E);f[v*i+E]=A.real,d[v*i+E]=A.imag}t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(S)}const p=t.makeTensorInfo(l,"float32",f),m=t.makeTensorInfo(l,"float32",d),I=Rs({inputs:{real:p,imag:m},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),I}function FY(n,e,t){const r=Ye(n.shape),s=t.data.get(n.dataId),i=t.data.get(s.complexTensorInfos.real.dataId).values,a=t.data.get(s.complexTensorInfos.imag.dataId).values;if(DY(r)){const o=sI(i,a,r,e,t),c=[n.shape[0],n.shape[1]];if(e){const l=t.makeTensorInfo(c,"float32",o.real),u=t.makeTensorInfo(c,"float32",o.imag),f=t.makeTensorInfo([],"float32",Fo(r,"float32")),d=wa({inputs:{x:f},backend:t}),p=rI.kernelFunc({inputs:{a:l,b:f},backend:t}),m=rI.kernelFunc({inputs:{a:u,b:d},backend:t}),I=t.data.get(p.dataId).values,v=t.data.get(m.dataId).values;return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),{real:I,imag:v}}return o}else{const o=Ha(i,a),c=BY(o,r,e);return ZT(c)}}function DY(n){return(n&n-1)===0}function sI(n,e,t,r,s){if(t===1)return{real:n,imag:e};const i=Ha(n,e),a=t/2,o=JT(i),c=o.real,l=o.imag,u=[c.length],f=s.makeTensorInfo(u,"float32",c),d=s.makeTensorInfo(u,"float32",l),p=Rs({inputs:{real:f,imag:d},backend:s}),m=QT(i),I=m.real,v=m.imag,b=[I.length],y=s.makeTensorInfo(b,"float32",I),S=s.makeTensorInfo(b,"float32",v),w=Rs({inputs:{real:y,imag:S},backend:s}),C=sI(c,l,a,r,s),N=C.real,E=C.imag,A=[N.length],M=s.makeTensorInfo(A,"float32",N),z=s.makeTensorInfo(A,"float32",E),Y=Rs({inputs:{real:M,imag:z},backend:s}),re=sI(I,v,a,r,s),ne=re.real,le=re.imag,j=[ne.length],ge=s.makeTensorInfo(j,"float32",ne),Se=s.makeTensorInfo(j,"float32",le),me=Rs({inputs:{real:ge,imag:Se},backend:s}),ye=tA(t,r),Ce=[ye.real.length],he=s.makeTensorInfo(Ce,"float32",ye.real),Ne=s.makeTensorInfo(Ce,"float32",ye.imag),xe=Rs({inputs:{real:he,imag:Ne},backend:s}),ae=Pm({inputs:{a:xe,b:me},backend:s}),J=Ul({inputs:{a:Y,b:ae},backend:s}),D=Ex({inputs:{a:Y,b:ae},backend:s}),P=Ac({inputs:{input:J},backend:s}),Q=Ac({inputs:{input:D},backend:s}),pe=zl({inputs:{input:J},backend:s}),Ee=zl({inputs:{input:D},backend:s}),L=Vl({inputs:[P,Q],backend:s,attrs:{axis:0}}),q=Vl({inputs:[pe,Ee],backend:s,attrs:{axis:0}}),Z=s.data.get(L.dataId).values,se=s.data.get(q.dataId).values;return s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(p),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(M),s.disposeIntermediateTensorInfo(z),s.disposeIntermediateTensorInfo(Y),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(Se),s.disposeIntermediateTensorInfo(me),s.disposeIntermediateTensorInfo(he),s.disposeIntermediateTensorInfo(Ne),s.disposeIntermediateTensorInfo(xe),s.disposeIntermediateTensorInfo(ae),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(D),s.disposeIntermediateTensorInfo(P),s.disposeIntermediateTensorInfo(pe),s.disposeIntermediateTensorInfo(Q),s.disposeIntermediateTensorInfo(Ee),s.disposeIntermediateTensorInfo(L),s.disposeIntermediateTensorInfo(q),{real:Z,imag:se}}function BY(n,e,t){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let i=0,a=0;for(let o=0;o<e;o++){const c=nA(s*o,e,t),l=qy(n,o);i+=l.real*c.real-l.imag*c.imag,a+=l.real*c.imag+l.imag*c.real}t&&(i/=e,a/=e),eA(r,i,a,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(n){const{inputs:e,backend:t}=n,{input:r}=e,s=Ye(r.shape),i=r.shape[r.shape.length-1],a=s/i,o=Nn({inputs:{x:r},backend:t,attrs:{shape:[a,i]}}),c=BO(o,!1,t),l=Nn({inputs:{x:c},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),l}const PY={kernelName:yb,backendName:"cpu",kernelFunc:MY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(n){const{backend:e,attrs:t}=n,{shape:r,value:s,dtype:i}=t,a=i||Kl(s),o=nr(a,Ye(r));return UY(o,s,a),e.makeTensorInfo(r,a,o)}const LY={kernelName:xb,backendName:"cpu",kernelFunc:$x};function UY(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY={kernelName:wb,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,s=t,i=Hr(r.dtype,Ye(r.shape)),[a,o,c,l]=r.shape,u=s.data.get(r.dataId).values;for(let d=0;d<a;d++){const p=d*c*o*l;for(let m=0;m<o;m++){const I=m*(c*l);for(let v=0;v<c;v++){const b=v*l;for(let y=0;y<l;y++){const S=Math.round(c-v-1),w=p+I+b+y;let C=u[w];if(S>=0&&S<c){const N=S*l,E=p+I+N+y;C=u[E]}i[w]=C}}}}return{dataId:s.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:c,pad:l,dataFormat:u,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r;let I=FO({inputs:{x:s,filter:i},backend:t,attrs:{strides:c,pad:l,dataFormat:u,dilations:f,dimRoundingMode:d}});if(a){const v=I;if(u==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const b=Nn({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});I=Ul({inputs:{a:I,b},backend:t}),t.disposeIntermediateTensorInfo(b)}else I=Ul({inputs:{a:I,b:a},backend:t});t.disposeIntermediateTensorInfo(v)}if(p){const v=I;if(u==="NCHW"&&p==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const b=Nn({inputs:{x:o},backend:t,attrs:{shape:[o.shape[0],1,1]}});I=jp(t,I,p,b,m),t.disposeIntermediateTensorInfo(b)}else I=jp(t,I,p,o,m);t.disposeIntermediateTensorInfo(v)}return I}const WY={kernelName:Ep,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:c,pad:l,dataFormat:u,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r;let I=DO({inputs:{x:s,filter:i},backend:t,attrs:{strides:c,pad:l,dataFormat:u,dilations:f,dimRoundingMode:d}});if(a){const v=I;I=Ul({inputs:{a:I,b:a},backend:t}),t.disposeIntermediateTensorInfo(v)}if(p){const v=I;I=jp(t,I,p,o,m),t.disposeIntermediateTensorInfo(v)}return I}const HY={kernelName:SE,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=Ye(r.shape),a=s.shape,o=a[a.length-1],[c,l,u,f]=Ay(r,s);if(l===0)return t.makeTensorInfo(c,r.dtype,[]);const d=t.data.get(s.dataId).values,p=t.bufferSync(r),m=qN(d,p,r.dtype,l,o,u,f,r.shape,i);return t.makeTensorInfo(c,r.dtype,m.values)}const jY={kernelName:iE,backendName:"cpu",kernelFunc:qY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KY(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:a,batchDims:o}=r;bt([s,i],"gatherV2");const c=Yt(a,s.shape)[0],l=t.data.get(i.dataId).values,u=s.shape[c];for(let w=0;w<l.length;++w){const C=l[w];ce(C<=u-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${u-1}]`)}let f=o;o==null&&(f=0);const d=Ye(i.shape),p=Qy(s,i,c,f),m=Nn({inputs:{x:s},backend:t,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),I=Nn({inputs:{x:i},backend:t,attrs:{shape:[p.batchSize,d/p.batchSize]}}),v=[p.batchSize,p.outerSize,d/p.batchSize,p.sliceSize],b=t.bufferSync(I),y=t.bufferSync(m),S=jN(y,b,v);return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(I),t.makeTensorInfo(p.outputShape,S.dtype,S.values)}const XY={kernelName:_g,backendName:"cpu",kernelFunc:KY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(n){const{inputs:e,backend:t}=n,{input:r}=e,s=Ye(r.shape),i=r.shape[r.shape.length-1],a=s/i,o=Nn({inputs:{x:r},backend:t,attrs:{shape:[a,i]}}),c=BO(o,!0,t),l=Nn({inputs:{x:c},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(c),l}const ZY={kernelName:Sb,backendName:"cpu",kernelFunc:YY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JY=wn(Zf,n=>Number.isFinite(n)?1:0,"bool"),QY={kernelName:Zf,backendName:"cpu",kernelFunc:JY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eZ=wn(Jf,n=>Math.abs(n)===1/0?1:0,"bool"),tZ={kernelName:Jf,backendName:"cpu",kernelFunc:eZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ=wn(Qf,n=>Number.isNaN(n)?1:0,"bool"),rZ={kernelName:Qf,backendName:"cpu",kernelFunc:nZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sZ(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,a=JN(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}const iZ={kernelName:aE,backendName:"cpu",kernelFunc:sZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZ=wn(th,n=>Math.log1p(n)),oZ={kernelName:th,backendName:"cpu",kernelFunc:aZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cZ=or((n,e)=>n&&e),lZ=Sr(Pg,cZ,null,"bool"),uZ={kernelName:Pg,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fZ=wn(Lg,n=>n?0:1,"bool"),hZ={kernelName:Lg,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dZ=or((n,e)=>n||e),pZ=Sr(Ug,dZ,null,"bool"),gZ={kernelName:Ug,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:a,alpha:o,beta:c}=r;bt(s,"LRN");const l=s.shape[3],u=l-1,f=t.data.get(s.dataId).values,d=Ye(s.shape),p=new Float32Array(d);function m(I){const v=I%l;let b=I-v+Math.max(0,v-i);const y=I-v+Math.min(v+i,u);let S=0;for(;b<=y;b++){const w=f[b];S+=w*w}return S}for(let I=0;I<d;I++){const v=m(I),b=f[I]*Math.pow(a+o*v,-c);p[I]=b}return t.makeTensorInfo(s.shape,s.dtype,p)}const vZ={kernelName:zg,backendName:"cpu",kernelFunc:mZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:a}=e,{depthRadius:o,bias:c,alpha:l,beta:u}=r;bt(a,"LRNGrad");const f=Ye(a.shape),d=a.shape[3],p=t.data.get(a.dataId).values,m=t.data.get(s.dataId).values,I=t.data.get(i.dataId).values,v=new Float32Array(f),b=f;for(let y=0;y<b;y++){const S=y%d,w=y-S+Math.max(0,S-o),C=y-S+Math.min(d,S+o+1);let N=0;for(let E=w;E<C;E++)N+=Math.pow(m[E],2);N=l*N+c;for(let E=w;E<C;E++){let A=-2*l*u*m[E]*I[y]/N;y===E&&(A+=Math.pow(N,-u)),A*=p[y],v[E]+=A}}return t.makeTensorInfo(a.shape,s.dtype,v)}const bZ={kernelName:Rb,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MO(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:a}=r,o=t;let c=s.shape;const l=c.length,u=Yt(i,c);let f=u;const d=Kn(f,l);let p=o.data.get(s.dataId).values;if(d!=null){const w=new Array(l);for(let C=0;C<w.length;C++)w[C]=c[d[C]];p=Rx(p,c,s.dtype,d,w),f=ir(f.length,l),c=w}bt(s,"max"),Ur("max",f,l);const[m,I]=$r(c,f),v=Ye(I),b=eO(p,v,m,s.dtype),y=o.write(b,m,s.dtype);let S=m;return a&&(S=mr(m,u)),{dataId:y,shape:S,dtype:s.dtype}}const yZ={kernelName:Vg,backendName:"cpu",kernelFunc:MO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;bt(s,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:c}=r,l=1;ce(jr(a,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);const u=xi(s.shape,i,a,l,o,c);let f;if(u.filterWidth===1&&u.filterHeight===1&&vn(u.inShape,u.outShape))f=wa({inputs:{x:s},backend:t});else{const d=t.data.get(s.dataId).values,p=Rt(s.shape),m=Tx(d,s.shape,s.dtype,p,u,"max");f=t.makeTensorInfo(u.outShape,s.dtype,m.values)}return f}const wZ={kernelName:Wg,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:c,dataFormat:l}=r;bt(s,"maxPool3d");const u=Xa(s.shape,i,a,1,o,c,l),f=t.data.get(s.dataId).values,d=_O(f,s.shape,s.dtype,Rt(s.shape),u,"max");return t.makeTensorInfo(d.shape,"float32",d.values)}const CZ={kernelName:Gg,backendName:"cpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,{filterSize:a,strides:o,pad:c,dimRoundingMode:l}=r;bt([s,i],"maxPool3DGrad");const u=Xa(i.shape,a,o,1,c,l),f=t.bufferSync(i),d=dX(f,u),p=u.strideDepth,m=u.strideHeight,I=u.strideWidth,v=u.dilationDepth,b=u.dilationHeight,y=u.dilationWidth,S=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,N=S-1-u.padInfo.front,E=C-1-u.padInfo.left,A=w-1-u.padInfo.top,M=Xt(i.shape,"float32"),z=t.bufferSync(s);for(let Y=0;Y<u.batchSize;++Y)for(let re=0;re<u.inChannels;++re)for(let ne=0;ne<u.inDepth;++ne)for(let le=0;le<u.inHeight;++le)for(let j=0;j<u.inWidth;++j){const ge=ne-N,Se=le-A,me=j-E;let ye=0;for(let Ce=0;Ce<S;Ce+=v){const he=(ge+Ce)/p;if(!(he<0||he>=u.outDepth||Math.floor(he)!==he))for(let Ne=0;Ne<w;Ne+=b){const xe=(Se+Ne)/m;if(!(xe<0||xe>=u.outHeight||Math.floor(xe)!==xe))for(let ae=0;ae<C;ae+=y){const J=(me+ae)/I;if(J<0||J>=u.outWidth||Math.floor(J)!==J)continue;const D=S*w*C-1-d.get(Y,he,xe,J,re),P=Ce*w*C+Ne*C+ae,Q=D===P?1:0;if(Q===0)continue;const pe=z.get(Y,he,xe,J,re);ye+=pe*Q}}}M.set(ye,Y,ne,le,j,re)}return t.makeTensorInfo(M.shape,M.dtype,M.values)}const kZ={kernelName:Eb,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:a}=e,o=i;bt([i,a],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:f}=r,d=xi(o.shape,c,l,1,u,f),p=t.data.get(o.dataId).values,m=Xt(d.outShape,o.dtype,OO(p,o.shape,o.dtype,d).values),I=d.strideHeight,v=d.strideWidth,b=d.dilationHeight,y=d.dilationWidth,S=d.effectiveFilterHeight,w=d.effectiveFilterWidth,C=w-1-d.padInfo.left,N=S-1-d.padInfo.top,E=Xt(o.shape,"float32"),A=t.data.get(s.dataId).values,M=Xt(s.shape,"float32",A);for(let z=0;z<d.batchSize;++z)for(let Y=0;Y<d.inChannels;++Y)for(let re=0;re<d.inHeight;++re)for(let ne=0;ne<d.inWidth;++ne){const le=re-N,j=ne-C;let ge=0;for(let Se=0;Se<S;Se+=b){const me=(le+Se)/I;if(!(me<0||me>=d.outHeight||Math.floor(me)!==me))for(let ye=0;ye<w;ye+=y){const Ce=(j+ye)/v;if(Ce<0||Ce>=d.outWidth||Math.floor(Ce)!==Ce)continue;const he=S*w-1-m.get(z,me,Ce,Y),Ne=Se*w+ye,xe=he===Ne?1:0;if(xe===0)continue;const ae=M.get(z,me,Ce,Y);ge+=ae*xe}}E.set(ge,z,re,ne,Y)}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const TZ={kernelName:kb,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(n,e,t,r,s){const i=Rt(e),a=Tx(n,e,t,i,s,"max"),o=OO(n,e,t,s,!0,r);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Z={kernelName:oE,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:a,includeBatchInIndex:o}=e,c=t;bt(r,"MaxPoolWithArgmax");const l=c.data.get(r.dataId).values,u=xi(r.shape,s,i,[1,1],a),[f,d]=AZ(l,r.shape,r.dtype,o,u),p=c.write(f,u.outShape,r.dtype),m=c.write(d,u.outShape,r.dtype);return[{dataId:p,shape:u.outShape,dtype:r.dtype},{dataId:m,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=Yt(i,s.shape),l=$r(s.shape,o)[1],u=Ye(l),f=[],d=t.makeTensorInfo([],"float32",new Float32Array([u]));f.push(d);const p=No({inputs:{x:s},backend:t,attrs:{dtype:"float32"}});f.push(p);const m=Ax({inputs:{a:p,b:d},backend:t});f.push(m);const I=zh({inputs:{x:m},backend:t,attrs:{axis:i,keepDims:a}});return f.forEach(v=>t.disposeIntermediateTensorInfo(v)),I}const OZ={kernelName:Hg,backendName:"cpu",kernelFunc:NZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;bt(s,"min");const o=Yt(i,s.shape);let c=o;const l=Kn(c,s.shape.length);let u=s;l!=null&&(u=ps({inputs:{x:s},backend:t,attrs:{perm:l}}),c=ir(c.length,s.shape.length)),Ur("min",c,u.shape.length);const[f,d]=$r(u.shape,c),p=Ye(d),m=qr(Ye(f),u.dtype),I=t.data.get(u.dataId).values;for(let b=0;b<m.length;++b){const y=b*p;let S=I[y];for(let w=0;w<p;++w){const C=I[y+w];(Number.isNaN(C)||C<S)&&(S=C)}m[b]=S}l!=null&&t.disposeIntermediateTensorInfo(u);const v=t.makeTensorInfo(f,u.dtype,m);if(a){const b=mr(f,o),y=Nn({inputs:{x:v},backend:t,attrs:{shape:b}});return t.disposeIntermediateTensorInfo(v),y}return v}const FZ={kernelName:qg,backendName:"cpu",kernelFunc:_Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,mode:a}=r;bt(s,"mirrorPad");const o=i.map((S,w)=>S[0]+s.shape[w]+S[1]),c=i.map(S=>S[0]),l=i.map((S,w)=>S[0]+s.shape[w]),u=a==="reflect"?0:1,f=t.data.get(s.dataId).values,d=s.shape.length,p=Rt(s.shape),m=Ye(o),I=o.length,v=Rt(o),b=Hr(s.dtype,m);for(let S=0;S<m;S++){let w=Xl(S,I,v);for(let N=0;N<I;N++)w[N]<c[N]?w[N]=c[N]*2-w[N]-u:w[N]>=l[N]&&(w[N]=(l[N]-1)*2-w[N]+u);w=w.map((N,E)=>N-c[E]);const C=ga(w,d,p);b[S]=f[C]}return{dataId:t.write(b,o,s.dtype),shape:o,dtype:s.dtype}}const BZ={kernelName:jg,backendName:"cpu",kernelFunc:DZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZ=or((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e}),PZ=Sr(sh,MZ),LZ={kernelName:sh,backendName:"cpu",kernelFunc:PZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PO(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,a=s.shape.length;let o=i;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const c=Yt([o],s.shape),l=MO({inputs:{x:s},backend:t,attrs:{reductionIndices:c,keepDims:!1}}),u=mr(l.shape,c),f=Nn({inputs:{x:l},backend:t,attrs:{shape:u}}),d=Ex({inputs:{a:s,b:f},backend:t}),p=VN({inputs:{x:d},backend:t}),m=zh({inputs:{x:p},backend:t,attrs:{axis:c,keepDims:!1}}),I=Nn({inputs:{x:m},backend:t,attrs:{shape:u}}),v=Ax({inputs:{a:p,b:I},backend:t});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(I),v}const UZ={kernelName:fm,backendName:"cpu",kernelFunc:PO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:a,normalized:o}=r;bt(s,"multinomial");const c=o?s:PO({inputs:{logits:s},backend:t,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],f=t.data.get(c.dataId).values,d=[l,i],p=qr(Ye(d),"int32");for(let m=0;m<l;++m){const I=m*u,v=new Float32Array(u-1);v[0]=f[I];for(let S=1;S<v.length;++S)v[S]=v[S-1]+f[I+S];const b=gy.alea(a.toString()),y=m*i;for(let S=0;S<i;++S){const w=b();p[y+S]=v.length;for(let C=0;C<v.length;C++)if(w<v[C]){p[y+S]=C;break}}}return o||t.disposeIntermediateTensorInfo(c),t.makeTensorInfo(d,"int32",p)}const VZ={kernelName:cE,backendName:"cpu",kernelFunc:zZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WZ=Cy;function GZ(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c}=r;bt(s,"NonMaxSuppression");const l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,{selectedIndices:f}=WZ(l,u,a,o,c);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const HZ={kernelName:Tb,backendName:"cpu",kernelFunc:GZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qZ=Ry;function jZ(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c,padToMaxOutputSize:l}=r;bt(s,"NonMaxSuppressionPadded");const u=t.data.get(s.dataId).values,f=t.data.get(i.dataId).values,{selectedIndices:d,validOutputs:p}=qZ(u,f,a,o,c,l);return[t.makeTensorInfo([d.length],"int32",new Int32Array(d)),t.makeTensorInfo([],"int32",new Int32Array([p]))]}const KZ={kernelName:Ab,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XZ=ky;function YZ(n){const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c,softNmsSigma:l}=r;bt(s,"NonMaxSuppressionWithScore");const u=t.data.get(s.dataId).values,f=t.data.get(i.dataId).values,d=a,p=o,m=c,I=l,{selectedIndices:v,selectedScores:b}=XZ(u,f,d,p,m,I);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const ZZ={kernelName:$b,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JZ(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:a,onValue:o,offValue:c}=r;bt(s,"oneHot");const l=Ye(s.shape),u=new Float32Array(l*a);u.fill(c);const f=t.data.get(s.dataId).values;for(let d=0;d<l;++d)f[d]>=0&&f[d]<a&&(u[d*a+f[d]]=o);return t.makeTensorInfo([...s.shape,a],i,u)}const QZ={kernelName:Zg,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Ac({inputs:{input:r},backend:t}),i=Xp({inputs:{x:s},backend:t}),a=zl({inputs:{input:r},backend:t}),o=Xp({inputs:{x:a},backend:t}),c=Rs({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),c}else return $x({backend:t,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const eJ={kernelName:pm,backendName:"cpu",kernelFunc:Xp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=Ac({inputs:{input:r},backend:t}),i=LO({inputs:{x:s},backend:t}),a=zl({inputs:{input:r},backend:t}),o=Xp({inputs:{x:a},backend:t}),c=Rs({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),c}else return $x({backend:t,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const tJ={kernelName:Yg,backendName:"cpu",kernelFunc:LO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return Kp({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,a=e[0].dtype;e.forEach(u=>{JI(i,u.shape,"All tensors passed to stack must have matching shapes"),ce(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],c=e.map(u=>{const f=Kp({inputs:{input:u},backend:t,attrs:{dim:s}});return o.push(f),f}),l=Vl({inputs:c,backend:t,attrs:{axis:s}});return o.forEach(u=>t.disposeIntermediateTensorInfo(u)),l}const nJ={kernelName:Jg,backendName:"cpu",kernelFunc:UO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:a}=r;bt(s,"pad");const o=i.map((y,S)=>y[0]+s.shape[S]+y[1]),c=i.map(y=>y[0]),l=t.data.get(s.dataId).values,u=Ye(s.shape),f=s.shape.length,d=Rt(s.shape),p=Ye(o),m=o.length,I=Rt(o),v=Hr(s.dtype,p);a!==0&&v.fill(a);for(let y=0;y<u;y++){const w=Xl(y,f,d).map((N,E)=>N+c[E]),C=ga(w,m,I);v[C]=l[y]}return{dataId:t.write(v,o,s.dtype),shape:o,dtype:s.dtype}}const zO={kernelName:Qg,backendName:"cpu",kernelFunc:rJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=or((n,e)=>Math.pow(n,e)),iJ=Sr(ah,sJ),aJ={kernelName:ah,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oJ(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:a}=e,o=s.map(v=>t.data.get(v.dataId).values),c=s.map(v=>v.shape),l=t.data.get(i.dataId).values,u=t.data.get(a.dataId).values,[f,d,p]=aO(o,c,l,i.shape,i.dtype,u,a.shape),m=f.map(v=>t.makeTensorInfo([v.length],"int32",v)),I=t.makeTensorInfo(p,i.dtype,d);return m.concat([I])}const cJ={kernelName:lE,backendName:"cpu",kernelFunc:oJ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lJ(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,[l,u]=oO(a,r.shape,r.dtype,o,s.shape,c,i.shape),f=t.makeTensorInfo([l.length],"int32",l),d=t.makeTensorInfo([u.length],r.dtype,u);return[f,d]}const uJ={kernelName:uE,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:c}=r,l=t.data.get(s.dataId).values,u=t.data.get(i.dataId).values,f=t.data.get(a.dataId).values,d=o.map(v=>t.data.get(v.dataId).values),p=o.map(v=>v.shape),[m,I]=cO(l,s.shape,u,i.shape,i.dtype,f,a.shape,d,p,c);return t.makeTensorInfo(m,i.dtype,I)}const hJ={kernelName:fE,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dJ(n){const{backend:e,attrs:t}=n,{start:r,stop:s,dtype:i,step:a}=t,o=lO(r,s,a,i);return e.makeTensorInfo([o.length],i,o)}const pJ={kernelName:Nb,backendName:"cpu",kernelFunc:dJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gJ=wn(oh,n=>1/n),mJ={kernelName:oh,backendName:"cpu",kernelFunc:gJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vJ(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r;bt(s,"resizeBilinear");const c=Rt(s.shape),[l,u]=o,[f,d,p,m]=s.shape,I=t.data.get(s.dataId).values,v=new Float32Array(Ye([f,l,u,m])),b=[i&&l>1?d-1:d,i&&u>1?p-1:p],y=[i&&l>1?l-1:l,i&&u>1?u-1:u];let S=0;const w=b[0]/y[0],C=b[1]/y[1];for(let N=0;N<f;N++)for(let E=0;E<l;E++){let A;a?A=w*(E+.5)-.5:A=w*E;const M=Math.max(0,Math.floor(A)),z=A-M,Y=Math.min(d-1,Math.ceil(A)),re=N*c[0]+M*c[1],ne=N*c[0]+Y*c[1];for(let le=0;le<u;le++){let j;a?j=C*(le+.5)-.5:j=C*le;const ge=Math.max(0,Math.floor(j)),Se=j-ge,me=Math.min(p-1,Math.ceil(j)),ye=re+ge*c[2],Ce=ne+ge*c[2],he=re+me*c[2],Ne=ne+me*c[2];for(let xe=0;xe<m;xe++){const ae=I[ye+xe],J=I[Ce+xe],D=I[he+xe],P=I[Ne+xe],Q=ae+(D-ae)*Se,pe=J+(P-J)*Se,Ee=Q+(pe-Q)*z;v[S++]=Ee}}}return t.makeTensorInfo([f,l,u,m],"float32",v)}const IJ={kernelName:sm,backendName:"cpu",kernelFunc:vJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bJ(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r;bt([i,s],"resizeBilinearGrad");const o=Rt(s.shape),[c,l,u,f]=s.shape,[,d,p]=i.shape,m=new Float32Array(c*l*u*f),I=[a&&d>1?l-1:l,a&&p>1?u-1:u],v=[a&&d>1?d-1:d,a&&p>1?p-1:p],b=I[0]/v[0],y=I[1]/v[1],S=t.data.get(i.dataId).values;let w=0;for(let C=0;C<c;C++){const N=C*o[0];for(let E=0;E<d;E++){const A=E*b,M=Math.floor(A),z=Math.min(Math.ceil(A),l-1),Y=N+M*o[1],re=N+z*o[1],ne=A-M,le=1-ne;for(let j=0;j<p;j++){const ge=j*y,Se=Math.floor(ge),me=Math.min(Math.ceil(ge),u-1),ye=ge-Se,Ce=1-ye,he=Y+Se*o[2],Ne=Y+me*o[2],xe=re+Se*o[2],ae=re+me*o[2],J=le*Ce,D=le*ye,P=ne*Ce,Q=ne*ye;for(let pe=0;pe<f;pe++){const Ee=S[w++];m[he+pe]+=Ee*J,m[Ne+pe]+=Ee*D,m[xe+pe]+=Ee*P,m[ae+pe]+=Ee*Q}}}}return t.makeTensorInfo([c,u,l,f],"float32",m)}const yJ={kernelName:Fb,backendName:"cpu",kernelFunc:bJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r;bt(s,"resizeNearestNeighbor");const c=Rt(s.shape),[l,u]=o,[f,d,p,m]=s.shape,I=t.data.get(s.dataId).values,v=new Float32Array(f*l*u*m),b=[i&&l>1?d-1:d,i&&u>1?p-1:p],y=[i&&l>1?l-1:l,i&&u>1?u-1:u],S=b[0]/y[0],w=b[1]/y[1];let C=0;for(let N=0;N<f;N++){const E=N*c[0];for(let A=0;A<l;A++){const M=a?S*(A+.5):S*A;let z=Math.min(d-1,i?Math.round(M):Math.floor(M));a&&(z=Math.max(0,z));const Y=E+z*c[1];for(let re=0;re<u;re++){const ne=a?w*(re+.5):w*re;let le=Math.min(p-1,i?Math.round(ne):Math.floor(ne));a&&(le=Math.max(0,le));const j=Y+le*c[2];for(let ge=0;ge<m;ge++){const Se=I[j+ge];v[C++]=Se}}}}return t.makeTensorInfo([f,l,u,m],s.dtype,v)}const wJ={kernelName:rm,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r;bt([i,s],"resizeNearestNeighborGrad");const o=Rt(s.shape),c=Rt(i.shape),[l,u,f,d]=s.shape,[,p,m]=i.shape,I=new Float32Array(l*u*f*d),v=t.data.get(i.dataId).values,b=[a&&p>1?u-1:u,a&&m>1?f-1:f],y=[a&&p>1?p-1:p,a&&m>1?m-1:m],S=b[0]/y[0],w=b[1]/y[1],C=1/S,N=1/w,E=Math.ceil(C)*2+2,A=Math.ceil(N)*2+2;for(let M=0;M<l;M++){const z=M*o[0];for(let Y=0;Y<u;Y++){const re=z+Y*o[1],ne=Math.floor(Y*C),le=Math.floor(ne-E/2);for(let j=0;j<f;j++){const ge=re+j*o[2],Se=Math.floor(j*N),me=Math.floor(Se-A/2);for(let ye=0;ye<d;ye++){let Ce=0;for(let he=0;he<E;he++){const Ne=he+le;if(Ne<0||Ne>=p)continue;const xe=z+Ne*c[1],ae=Ne*S,J=Math.min(u-1,a?Math.round(ae):Math.floor(ae));if(Y===J)for(let D=0;D<A;D++){const P=D+me;if(P<0||P>=m)continue;const Q=xe+P*c[2],pe=P*w,Ee=Math.min(f-1,a?Math.round(pe):Math.floor(pe));j===Ee&&(Ce+=v[Q+ye])}}I[ge+ye]=Ce}}}}return t.makeTensorInfo(s.shape,s.dtype,I)}const CJ={kernelName:_b,backendName:"cpu",kernelFunc:SJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r;bt(s,"reverse");const a=s.shape.length,o=Yt(i,s.shape);if(a===0)return wa({inputs:{x:s},backend:t});const c=new Pr(s.shape,s.dtype),l=t.bufferSync(s);for(let u=0;u<c.size;u++){const f=c.indexToLoc(u),d=f.slice();o.forEach(p=>d[p]=s.shape[p]-1-d[p]),c.set(l.get(...d),...f)}return t.makeTensorInfo(c.shape,c.dtype,c.values)}const kJ={kernelName:im,backendName:"cpu",kernelFunc:RJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ={kernelName:zb,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:a}=e,o=t,c=Hr(r.dtype,Ye(r.shape)),[l,u,f,d]=r.shape,[p,m]=My(a,u,f),I=255,v=Math.sin(s),b=Math.cos(s),y=o.data.get(r.dataId).values;for(let w=0;w<l;w++){const C=w*f*u*d;for(let N=0;N<u;N++){const E=N*(f*d);for(let A=0;A<f;A++){const M=A*d;for(let z=0;z<d;z++){const Y=[l,N,A,z],re=Y[2],ne=Y[1];let le=(re-p)*b-(ne-m)*v,j=(re-p)*v+(ne-m)*b;le=Math.round(le+p),j=Math.round(j+m);let ge=i;if(typeof i!="number"&&(z===3?ge=I:ge=i[z]),le>=0&&le<f&&j>=0&&j<u){const me=j*(f*d),ye=le*d,Ce=C+me+ye+z;ge=y[Ce]}const Se=C+E+M+z;c[Se]=ge}}}}return{dataId:o.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ=wn(uh,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),AJ={kernelName:uh,backendName:"cpu",kernelFunc:TJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $J(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:c,sliceSize:l,strides:u,outputSize:f}=Pc(i,s,a),d=!0,p=t.bufferSync(s),m=t.bufferSync(i),I=dc(p,m,a,f,l,c,o,u,0,d);return t.makeTensorInfo(a,I.dtype,I.values)}const NJ={kernelName:hE,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OJ(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<e?t=s+1:r=s;return r}function _J(n,e){let t=0,r=n.length,s=0;for(;t<r;)s=Math.floor((t+r)/2),n[s]<=e?t=s+1:r=s;return r}function FJ(n,e,t,r,s,i){const a=nr("int32",t*s);for(let o=0;o<t;++o){const c=n.slice(o*r,(o+1)*r),l=o*s;for(let u=0;u<s;++u)a[l+u]=i==="left"?OJ(c,e[u+l]):_J(c,e[u+l])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DJ(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:a}=r,o=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,l=FJ(o,c,s.shape[0],s.shape[1],i.shape[1],a);return t.makeTensorInfo(i.shape,"int32",l)}const BJ={kernelName:pE,backendName:"cpu",kernelFunc:DJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MJ(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e;bt([r,s,i],"select");const a=r.shape.length,o=t.data.get(r.dataId).values,c=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=Ts(s.dtype,i.dtype),f=qr(Ye(s.shape),u);let d=0;const p=a===0||a>1||s.shape.length===1?1:Ye(s.shape.slice(1));for(let m=0;m<o.length;m++)for(let I=0;I<p;I++)o[m]===1?f[d++]=c[m]:f[d++]=l[m];return t.makeTensorInfo(s.shape,u,f)}const PJ={kernelName:am,backendName:"cpu",kernelFunc:MJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ=Rm,UJ=km,zJ=wn(hh,n=>n>=0?UJ*n:LJ*(Math.exp(n)-1)),VJ={kernelName:hh,backendName:"cpu",kernelFunc:zJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ=wn(gh,n=>n<0?-1:n>0?1:0),GJ={kernelName:gh,backendName:"cpu",kernelFunc:WJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ=wn(dh,n=>Math.sin(n)),qJ={kernelName:dh,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jJ=wn(ph,n=>Math.sinh(n)),KJ={kernelName:ph,backendName:"cpu",kernelFunc:jJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJ=11920928955078125e-23,YC=Math.log(XJ)+2,YJ=wn(vh,n=>{const e=n>-YC,t=n<YC,r=Math.exp(n);let s;return t?s=r:e?s=n:s=Math.log(1+r),s}),ZJ={kernelName:vh,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:a}=r;bt([s],"spaceToBatchND");const o=Ye(i),c=[[0,0]];c.push(...a);for(let N=1+i.length;N<s.shape.length;++N)c.push([0,0]);const l=zO.kernelFunc({inputs:{x:s},backend:t,attrs:{paddings:c,constantValue:0}}),u=$h(l.shape,i,o,!1),f=Nh(u.length,i.length,!1),d=Oh(l.shape,i,o,!1),I=Nn({inputs:{x:l},backend:t,attrs:{shape:u}}),y=ps({inputs:{x:I},backend:t,attrs:{perm:f}}),C=Nn({inputs:{x:y},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(y),C}const QJ={kernelName:lm,backendName:"cpu",kernelFunc:JJ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.data.get(r.dataId).values,c=t.data.get(s.dataId).values,l=t.data.get(i.dataId).values,u=t.data.get(a.dataId).values[0],[f,d,p,m,I]=dO(o,r.shape,r.dtype,c,s.dtype,l,u);return[t.makeTensorInfo(d,r.dtype,f),t.makeTensorInfo([d[0]],s.dtype,p),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),t.makeTensorInfo([I.length],r.dtype,new Int32Array(I))]}const tQ={kernelName:gE,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.data.get(s.dataId).values),o=t.data.get(r.dataId).values,c=Array.from(t.data.get(i.dataId).values),[l,u,f]=pO(o,r.shape,r.dtype,a,c);return[t.makeTensorInfo(u,r.dtype,l),t.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const rQ={kernelName:mE,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,[l,u]=kx(a,r.shape,r.dtype,o,c,!0);return t.makeTensorInfo(u,r.dtype,l)}const iQ={kernelName:vE,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(s.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const a=t.data.get(r.dataId).values,o=t.data.get(s.dataId).values,c=t.data.get(i.dataId).values,[l,u]=kx(a,r.shape,r.dtype,o,c);return t.makeTensorInfo(u,r.dtype,l)}const oQ={kernelName:IE,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:f,outputSize:d}=Pc(i,s,o),p=!1,m=t.bufferSync(s);let I;switch(i.dtype){case"bool":{const v=t.bufferSync(i),b=!!t.data.get(a.dataId).values[0];I=dc(m,v,o,d,u,l,c,f,b,p);break}case"float32":{const v=t.bufferSync(i),b=t.data.get(a.dataId).values[0];I=dc(m,v,o,d,u,l,c,f,b,p);break}case"int32":{const v=t.bufferSync(i),b=t.data.get(a.dataId).values[0];I=dc(m,v,o,d,u,l,c,f,b,p);break}case"string":{const v=t.bufferSync(i),b=Ro(t.data.get(a.dataId).values[0]);I=dc(m,v,o,d,u,l,c,f,b,p);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return t.makeTensorInfo(o,I.dtype,I.values)}const lQ={kernelName:bE,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:a}=r,o=Yt(a,s.shape)[0],c=Jy(s,i,o),l=new Array(s.shape.length).fill(0),u=s.shape.slice();return c.map(f=>{const d=[...u];d[o]=f;const p=$c({inputs:{x:s},backend:t,attrs:{begin:l,size:d}});return l[o]+=f,p})}const fQ={kernelName:um,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ={kernelName:Db,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,r=e;bt(t,"square");const s=r.data.get(t.dataId).values,i=new Float32Array(s.length);for(let o=0;o<s.length;++o){const c=s[o];i[o]=c*c}return{dataId:r.write(i,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ=wn(Ch,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),pQ={kernelName:Ch,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:a,strides:o,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:f,shrinkAxisMask:d}=r;bt(s,"stridedSlice");const{finalShapeSparse:p,finalShape:m,isIdentity:I,sliceDim0:v,isSimpleSlice:b,begin:y,end:S,strides:w}=Fy(s.shape,i,a,o,c,l,u,f,d);let C;if(I)C=Nn({inputs:{x:s},backend:t,attrs:{shape:m}});else if(v||b){ce(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const N=Ny(y,S,w),E=$c({inputs:{x:s},backend:t,attrs:{begin:y,size:N}});C=Nn({inputs:{x:E},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(E)}else{const N=t.bufferSync(s),E=vO(p,N,w,y);C=t.makeTensorInfo(m,E.dtype,E.values)}return C}const mQ={kernelName:Mb,backendName:"cpu",kernelFunc:gQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vQ(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:a,rightPad:o,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:f}=e,d=t.data.get(u.dataId).values,p=t.data.get(f.dataId).values,[m,I]=IO(d,p,s,i,a,o,c,l);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(f.shape,"int32",I)]}const IQ={kernelName:yE,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQ(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.data.get(i.dataId).values,c=t.data.get(a.dataId).values[0],[l,u,f]=bO(o,c,s),d=u.length;return[t.makeTensorInfo([d,2],"int32",l),t.makeTensorInfo([d],"string",u),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const yQ={kernelName:xE,backendName:"cpu",kernelFunc:bQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.data.get(i.dataId).values,o=yO(a,s);return t.makeTensorInfo(i.shape,"int32",o)}const wQ={kernelName:wE,backendName:"cpu",kernelFunc:xQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ=wn(xh,n=>Math.tan(n)),CQ={kernelName:xh,backendName:"cpu",kernelFunc:SQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQ=wn(wh,n=>Math.tanh(n)),kQ={kernelName:wh,backendName:"cpu",kernelFunc:RQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(n){const{inputs:e,backend:t}=n,{tensor:r,indices:s,updates:i}=e,{sliceRank:a,numUpdates:o,sliceSize:c,strides:l,outputSize:u}=Pc(i,s,r.shape),f=!1,d=t.bufferSync(s),p=t.bufferSync(i),m=t.bufferSync(r),I=dc(d,p,r.shape,u,c,o,a,l,m,f);return t.makeTensorInfo(r.shape,I.dtype,I.values)}const TQ={kernelName:dE,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;bt(s,"tile");const a=wO(t.bufferSync(s),i);return t.makeTensorInfo(a.shape,a.dtype,a.values)}const $Q={kernelName:Sh,backendName:"cpu",kernelFunc:AQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NQ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:a}=r;bt(s,"topk");const o=t.data.get(s.dataId).values,[c,l]=CO(o,s.shape,s.dtype,i,a);return[t.makeTensorInfo(c.shape,c.dtype,c.values),t.makeTensorInfo(l.shape,l.dtype,l.values)]}const OQ={kernelName:Pb,backendName:"cpu",kernelFunc:NQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(n){const{inputs:e,attrs:t,backend:r}=n,{image:s,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:c,outputShape:l}=t,[u,f,d,p]=s.shape,[m,I]=l??[f,d],v=[u,m,I,p],b=Rt(s.shape),y=b[0],S=b[1],w=b[2],C=Rt(v),N=C[0],E=C[1],A=C[2],M=Hr(s.dtype,Ye(v));M.fill(c);const z=r.data.get(s.dataId).values,Y=r.data.get(i.dataId).values;for(let ne=0;ne<u;++ne){const le=i.shape[0]===1?Y:Y.subarray(ne*8,ne*8+8);for(let j=0;j<m;++j)for(let ge=0;ge<I;++ge)for(let Se=0;Se<p;++Se){let me;const ye=le[6]*ge+le[7]*j+1;if(ye===0)continue;const Ce=(le[0]*ge+le[1]*j+le[2])/ye,he=(le[3]*ge+le[4]*j+le[5])/ye,Ne=ZC(Ce,d,o),xe=ZC(he,f,o);switch(a){case"nearest":me=LQ(z,f,d,y,S,w,ne,xe,Ne,Se,c);break;case"bilinear":me=UQ(z,f,d,y,S,w,ne,xe,Ne,Se,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const ae=ne*N+j*E+ge*A+Se;M[ae]=me}return r.makeTensorInfo(v,s.dtype,M)}return{dataId:r.write(M,v,s.dtype),shape:s.shape,dtype:s.dtype}}const FQ={kernelName:Lb,backendName:"cpu",kernelFunc:_Q};function ZC(n,e,t){switch(t){case"reflect":return DQ(n,e);case"wrap":return BQ(n,e);case"nearest":return PQ(n,e);case"constant":default:return MQ(n)}}function DQ(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=2*e;t<r&&(t=r*Math.trunc(-t/r)+t),t=t<-e?t+r:-t-1}else if(t>e-1)if(e<=1)t=0;else{const r=2*e;t-=r*Math.trunc(t/r),t>=e&&(t=r-t-1)}return Ic(0,t,e-1)}function BQ(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const r=e-1;t+=e*(Math.trunc(-t/r)+1)}else if(t>e-1)if(e<=1)t=0;else{const r=e-1;t-=e*Math.trunc(t/r)}return Ic(0,t,e-1)}function MQ(n,e){return n}function PQ(n,e){return Ic(0,n,e-1)}function nf(n,e,t,r,s,i,a,o,c,l,u){const f=a*r+o*s+c*i+l;return 0<=o&&o<e&&0<=c&&c<t?n[f]:u}function LQ(n,e,t,r,s,i,a,o,c,l,u){const f=Math.round(o),d=Math.round(c);return nf(n,e,t,r,s,i,a,f,d,l,u)}function UQ(n,e,t,r,s,i,a,o,c,l,u){const f=Math.floor(o),d=Math.floor(c),p=f+1,m=d+1,I=(m-c)*nf(n,e,t,r,s,i,a,f,d,l,u)+(c-d)*nf(n,e,t,r,s,i,a,f,m,l,u),v=(m-c)*nf(n,e,t,r,s,i,a,p,d,l,u)+(c-d)*nf(n,e,t,r,s,i,a,p,m,l,u);return(p-o)*I+(o-f)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;bt(i,"unique");const a=r.data.get(i.dataId).values,{outputValues:o,outputShape:c,indices:l}=RO(a,s,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,o),r.makeTensorInfo([l.length],"int32",l)]}const VQ={kernelName:Ub,backendName:"cpu",kernelFunc:zQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s.shape.length,o=s.shape[i],c=new Array(a-1);let l=0;for(let p=0;p<a;p++)p!==i&&(c[l++]=s.shape[p]);const u=new Array(a).fill(0),f=s.shape.slice();f[i]=1;const d=new Array(o);for(let p=0;p<d.length;p++){u[i]=p;const m=$c({inputs:{x:s},backend:t,attrs:{begin:u,size:f}});d[p]=Nn({inputs:{x:m},backend:t,attrs:{shape:c}}),t.disposeIntermediateTensorInfo(m)}return d}const GQ={kernelName:hm,backendName:"cpu",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:a}=r;bt(s,"unsortedSegmentSum");const o=s.shape.length,c=i.shape.length,l=[],u=[],f=o-c;let d=i;for(let m=0;m<f;++m){const I=Kp({inputs:{input:d},backend:t,attrs:{dim:m+1}});d=I,u.push(I)}for(let m=0;m<a;++m){const I=Fo(m,"int32"),v=t.makeTensorInfo([],"int32",I),b=UN({inputs:{a:v,b:d},backend:t}),y=No({inputs:{x:b},backend:t,attrs:{dtype:"float32"}}),S=Pm({inputs:{a:y,b:s},backend:t}),w=zh({inputs:{x:S},backend:t,attrs:{axis:0,keepDims:!1}});l.push(w),u.push(v),u.push(b),u.push(y),u.push(S),u.push(w)}const p=UO({inputs:l,backend:t,attrs:{axis:0}});return u.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const qQ={kernelName:dm,backendName:"cpu",kernelFunc:HQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ=[zK,xj,WK,HK,Ej,jK,XK,ZK,QK,tX,rX,iX,oX,uX,hX,gX,vX,bX,xX,LK,SX,RX,EX,Aj,AX,Rj,Nj,NX,wj,_X,DX,BX,PX,UX,VX,GX,qX,KX,YX,JX,eY,nY,sY,aY,oY,lY,fY,dY,pY,gY,mY,IY,xY,OK,SY,Oj,NY,_j,OY,Dj,PY,LY,zY,Mj,Lj,WY,HY,jY,XY,zj,Wj,Sj,ZY,FX,QY,tZ,rZ,_K,Hj,jj,iZ,Xj,oZ,uZ,hZ,gZ,vZ,bZ,yZ,Zj,wZ,CZ,kZ,TZ,$Z,OZ,FZ,Qj,BZ,LZ,VZ,tK,rK,HZ,KZ,ZZ,iK,QZ,tJ,nJ,zO,aJ,DK,cK,cJ,uJ,hJ,pJ,Cj,rI,mJ,BK,MK,PK,IJ,yJ,wJ,CJ,kJ,EJ,AJ,mK,NJ,BJ,PJ,VJ,IK,GJ,qJ,KJ,bK,UZ,ZJ,QJ,tQ,rQ,iQ,oQ,lQ,fQ,wK,hQ,CK,kK,pQ,mQ,IQ,yQ,wQ,$K,bY,CQ,kQ,TQ,$Q,OQ,FQ,aK,VQ,GQ,qQ,eJ];for(const n of jQ)CE(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uc={},Jd={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function KQ(n,e){uc[n]=e}function Gi(n,e){if(!(n in uc)||e!=null){const r=YQ(n,e);if(r!==null)uc[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=uc[n];return t==null||t.isContextLost()?(delete uc[n],Gi(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),uc[n])}function XQ(n){if(!Ge().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function YQ(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??XQ(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete uc[n]},!1),Ge().getBool("SOFTWARE_WEBGL_ENABLED")&&(Jd.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Jd)||t.getContext("experimental-webgl",Jd):t.getContext("webgl2",Jd)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xf;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(xf||(xf={}));var Vs;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Vs||(Vs={}));var Mr;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Mr||(Mr={}));function Vh(n,e){return[e,n]}function ZQ(n,e){return n*e}function Qd(n){const e=Ye(n),t=Math.ceil(e/4);return Cv(t)}function ru(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function JQ(n,e){const[t,r]=ru(n,e);return t*r*4}function Nx(n,e){const t=n;let r,s,i,a,o,c,l,u,f,d;return Ge().getNumber("WEBGL_VERSION")===2?(r=t.R32F,s=t.R16F,i=t.RGBA16F,a=t.RGBA32F,o=t.RED,l=4,u=1,f=t.HALF_FLOAT,d=t.FLOAT,c=t.RGBA8):(r=n.RGBA,s=n.RGBA,i=n.RGBA,a=t.RGBA,o=n.RGBA,l=4,u=4,f=e!=null?e.HALF_FLOAT_OES:null,d=n.FLOAT,c=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:f,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dt(n,e){const t=e();return Ge().getBool("DEBUG")&&QQ(n),t}function QQ(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+ree(n,e))}const eee=596e-10,tee=65504;function nee(n){return!!(Ge().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||eee<Math.abs(n)&&Math.abs(n)<tee)}function ree(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function ep(n,e){return Za(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function see(n,e){const t=Za(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(dt(n,()=>n.shaderSource(t,e)),dt(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function iee(n,e){const t=Za(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(dt(n,()=>n.shaderSource(t,e)),dt(n,()=>n.compileShader(t)),Ge().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw VO(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const aee=/ERROR: [0-9]+:([0-9]+):/g;function VO(n,e){const t=aee.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],s=n.split(`
`),i=s.length.toString().length+2,a=s.map((f,d)=>kl((d+1).toString(),i)+f);let o=0;for(let f=0;f<a.length;f++)o=Math.max(a[f].length,o);const c=a.slice(0,r-1),l=a.slice(r-1,r),u=a.slice(r);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${kl(l[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function oee(n){return Za(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function cee(n,e){if(dt(n,()=>n.linkProgram(e)),!Ge().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function M1(n,e){if(dt(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function lee(n,e){const t=Za(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return dt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),dt(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function uee(n,e){const t=Za(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return dt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),dt(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function fee(n){return Za(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function hee(n,e){const t=Ge().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function dee(n){return Za(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function JC(n,e,t,r,s,i,a){const o=n.getAttribLocation(e,t);return o===-1?!1:(dt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),dt(n,()=>n.vertexAttribPointer(o,s,n.FLOAT,!1,i,a)),dt(n,()=>n.enableVertexAttribArray(o)),!0)}function pee(n,e,t){bee(n,t),dt(n,()=>n.activeTexture(n.TEXTURE0+t)),dt(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function gee(n,e,t){return Za(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function mee(n,e,t){return n.getUniformLocation(e,t)}function vee(n,e,t,r){dt(n,()=>pee(n,e,r)),dt(n,()=>n.uniform1i(t,r))}function P1(n,e,t){dt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),dt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function QC(n,e){dt(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),dt(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function tp(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Iee(n,e))}function Iee(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Za(n,e,t){const r=dt(n,()=>e());if(r==null)throw new Error(t);return r}function bee(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Wl(n,e=2){return Ye(n.slice(0,n.length-e))}function Gl(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function np(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Wl(n),...Gl(n)]),e}function yee(n,e=!1){let t=Ge().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Ge().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Ge().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((o,c)=>c>=n.length-2?ZI(n[c]):n[c]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=_o(n).newShape);let s=Ye(n),i=null;n.length<=1&&s<=t?i=[1,s]:n.length===2&&n[0]<=t&&n[1]<=t?i=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?i=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?i=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?i=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(i=[n[0],n[1]*n[2]*n[3]]);const a=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||a)if(e){const o=Wl(n);let c=2,l=2;n.length&&([c,l]=Gl(n)),s=o*(c/2)*(l/2),i=Cv(s).map(u=>u*2)}else i=Cv(s);return i}function rp(n){return n%2===0}function Yp(n,e){if(n=n.slice(-2),e=e.slice(-2),vn(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],r=e[e.length-1];if(t===r||rp(t)&&rp(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&rp(n[0])&&rp(e[0])}let L1,U1;function xee(n){if(L1==null){const e=Gi(n);L1=e.getParameter(e.MAX_TEXTURE_SIZE)}return L1}function wee(n){if(U1==null){const e=Gi(n);U1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,U1)}function See(n){if(n===0)return 0;let e;const t=Gi(n);return pi(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:pi(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function pi(n,e){return n.getExtension(e)!=null}function eR(n){try{if(Gi(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Cee(n){if(n===0)return!1;const e=Gi(n);if(n===1){if(!pi(e,"OES_texture_float"))return!1}else if(!pi(e,"EXT_color_buffer_float"))return!1;return iI(e)}function Ree(n){if(n===0)return!1;const e=Gi(n);if(n===1){if(!pi(e,"OES_texture_float")||!pi(e,"WEBGL_color_buffer_float"))return!1}else{if(pi(e,"EXT_color_buffer_float"))return iI(e);const r="EXT_color_buffer_half_float";if(pi(e,r)){const s=e.getExtension(r);return kee(e,s)}return!1}return iI(e)}function iI(n){const e=Nx(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const r=1,s=1;n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(i),a}function kee(n,e){const t=Nx(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);const s=1,i=1;n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,s,i,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(a),o}function Eee(n){return n!==2?!1:Gi(n).fenceSync!=null}function Wh(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&ce(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xt=Ge();xt.registerFlag("HAS_WEBGL",()=>xt.getNumber("WEBGL_VERSION")>0);xt.registerFlag("WEBGL_VERSION",()=>eR(2)?2:eR(1)?1:0);xt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);xt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>xt.get("WEBGL_VERSION")===2);xt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);xt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);xt.registerFlag("WEBGL_PACK",()=>xt.getBool("HAS_WEBGL"));xt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_CLIP",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_PACK_REDUCE",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_LAZILY_UNPACK",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_CONV_IM2COL",()=>xt.getBool("WEBGL_PACK"));xt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>xee(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>wee(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=xt.getNumber("WEBGL_VERSION");return n===0?0:See(n)});xt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>xt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!VE());xt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Cee(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>xt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:xt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));xt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Ree(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Eee(xt.getNumber("WEBGL_VERSION")));xt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>xt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);xt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});xt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>VE()?1:-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});xt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);xt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);xt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);xt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);xt.registerFlag("WEBGL_EXP_CONV",()=>!1);xt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>xt.getBool("IS_TEST"));xt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);xt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);xt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);xt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function is(){let n,e,t,r,s,i,a,o,c,l;return Ge().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",s="texture",i="outputColor",a="out vec4 outputColor;",o=Ge().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",s="texture2D",i="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:s,output:i,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:c,defineRound:l}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(n,e,t="index"){const r=Rt(e);return r.map((s,i)=>{const a=`int ${n[i]} = ${t} / ${s}`,o=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${s}`:`index -= ${n[i]} * ${s}`;return`${a}; ${o};`}).join("")}function Lm(n,e,t="index"){const r=Rt(e);return r.map((s,i)=>{const a=`int ${n[i]} = ${t} / outShapeStrides[${i}]`,o=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * outShapeStrides[${i}]`:`index -= ${n[i]} * outShapeStrides[${i}]`;return`${a}; ${o};`}).join("")}function Tee(n,e){const t=n.length,r=n.map(i=>`${e}[${i}]`),s=new Array(t-1);s[t-2]=r[t-1];for(let i=t-3;i>=0;--i)s[i]=`(${s[i+1]} * ${r[i+1]})`;return s}function Aee(n,e,t="index"){const r=n.map((i,a)=>a),s=Tee(r,e);return s.map((i,a)=>{const o=`int ${n[a]} = ${t} / ${s[a]}`,c=a===s.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${s[a]}`:`index -= ${n[a]} * ${s[a]}`;return`${o}; ${c};`}).join("")}function Ox(n){const e=Rt(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function _x(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const WO=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:GO}=w7;function $ee(n,e,t){const r=[];if(n.forEach(p=>{const m=Ye(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${m>1?`[${m}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),t.enableShapeUniforms){const{uniformShape:I}=Fx(t.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(I.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const s=r.join(`
`),i=n.map(p=>Nee(p,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),a=e.texShape,o=is(),c=Fee(o);let l,u,f=Mee(o);return e.isPacked?(l=Oee(e.logicalShape,a,t.enableShapeUniforms),u=Bee(o)):(l=_ee(e.logicalShape,a,t.enableShapeUniforms),u=Dee(o)),t.packedInputs&&(f+=zee),[f,c,u,s,l,i,t.userCode].join(`
`)}function su(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return Qee(n,e);case 1:return tte(n,e);case 2:return rte(n,e);case 3:return ite(n,e);case 4:return ote(n,e);case 5:return cte(n);case 6:return lte(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function HO(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return Jee(n);case 1:return ete(n,e);case 2:return nte(n,e);case 3:return ste(n,e);default:return ate(n,e)}}function Nee(n,e,t=!1,r){let s="";t?s+=HO(n,r):s+=su(n,r);const i=n.shapeInfo.logicalShape,a=e.logicalShape;return i.length<=a.length&&(t?s+=ute(n,e):s+=fte(n,e)),s}function Oee(n,e,t){switch(n.length){case 0:return qO();case 1:return Vee(n,e,t);case 2:return Yee(n,e,t);case 3:return Gee(n,e,t);default:return qee(n,e,t)}}function _ee(n,e,t){switch(n.length){case 0:return qO();case 1:return Wee(n,e,t);case 2:return Zee(n,e,t);case 3:return Hee(n,e,t);case 4:return jee(n,e,t);case 5:return Kee(n,e);case 6:return Xee(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function Fee(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Dee(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Bee(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Mee(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Pee}
    ${Lee}
    ${Uee}
  `}const Pee=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Lee=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Uee=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,zee=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function qO(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Vee(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Wee(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Gee(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[2]/2),i=s*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Hee(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Lm(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=zc(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function qee(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[n.length-1]/2),i=s*Math.ceil(n[n.length-2]/2);let a=i,o="",c="b, r, c";for(let l=2;l<n.length-1;l++)a*=n[n.length-l-1],o=`
      int b${l} = index / ${a};
      index -= b${l} * ${a};
    `+o,c=`b${l}, `+c;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${n.length}(${c});
    }
  `}function jee(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Lm(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=zc(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Kee(n,e){const t=zc(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Xee(n,e){const t=zc(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Yee(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(vn(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function Zee(n,e,t){return vn(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Vc(n){return`offset${n}`}function Jee(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=is();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Qee(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[s,i]=n.shapeInfo.texShape;if(s===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Vc(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${a});
      return sampleTexture(${t}, uv);
    }
  `;const[o,c]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${c}, ${a});
      return sampleTexture(${t}, uv);
    }
  `}function ete(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=n.shapeInfo.texShape,i=is();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${t}, uv);
    }
  `;const a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${i.texture2D}(${t}, uv);
    }
  `}function tte(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${iu(n)}
      }
    `;const s=n.shapeInfo.texShape,i=s[0],a=s[1];if(a===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=Vc(t);return a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${i}.0);
        return sampleTexture(${t}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${a}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function nte(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,a=i[0],o=i[1],c=is();if(i!=null&&vn(t,i))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${c.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${c.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `;const l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${l[0]}, ${l[1]}, row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `}function rte(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape;if(i!=null&&vn(t,i)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=i[0],p=i[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:o}=_o(t),c=a;if(c.length<t.length){const d=au(n,c),p=["row","col"];return`
      ${su(d,e)}
      float ${s}(int row, int col) {
        return ${s}(${ou(p,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${iu(n)}
      }
    `;const l=i[0],u=i[1],f=Vc(r);return u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${f};
    vec2 uv = uvFromFlat(${l}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function ste(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(t[0]===1){const d=t.slice(1),p=[1,2],m=au(n,d),I=["b","row","col"];return`
        ${HO(m,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${ou(I,p)});
        }
      `}const o=is();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const c=a[0],l=a[1],u=Math.ceil(t[2]/2),f=u*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${l}, ${f}, ${u}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function ite(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[1]*t[2],a=t[2],{newShape:o,keptDims:c}=_o(t),l=o;if(l.length<t.length){const I=au(n,l),v=["row","col","depth"];return`
        ${su(I,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${ou(v,c)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${a}, 1)));
        ${iu(n)}
      }
    `;const u=n.shapeInfo.texShape,f=u[0],d=u[1],p=n.shapeInfo.flatOffset;if(d===i&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===a&&p==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=Vc(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${a} + depth + ${m};
        vec2 uv = uvFromFlat(${f}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function ate(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=is();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const i=n.shapeInfo.logicalShape,a=i.length,o=n.shapeInfo.texShape,c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],l=c[0],u=c[1],f=Math.ceil(i[a-1]/2);let d=f*Math.ceil(i[a-2]/2),p="int b, int row, int col",m=`b * ${d} + (row / 2) * ${f} + (col / 2)`;for(let I=2;I<a-1;I++)p=`int b${I}, `+p,d*=i[a-I-1],m=`b${I} * ${d} + `+m;return`
    vec4 ${r}(${p}) {
      int index = ${m};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${l});
      return ${s.texture2D}(${t}, uv);
    }
  `}function ote(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t[3],a=t[2]*i,o=t[1]*a,{newShape:c,keptDims:l}=_o(t);if(c.length<t.length){const y=au(n,c),S=["row","col","depth","depth2"];return`
      ${su(y,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${ou(S,l)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${i}, 1)));
        ${iu(n)}
      }
    `;const u=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,d=f[0],p=f[1],m=`int stride2 = ${r}Shape[3];`,I=`int stride1 = ${r}Shape[2] * stride2;`,v=`int stride0 = ${r}Shape[1] * stride1;`;if(p===o&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${m}
        ${I}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===i&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=Vc(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${I}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${d}, ${p}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function cte(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],i=e[3]*s,a=e[2]*i,o=e[1]*a,{newShape:c,keptDims:l}=_o(e);if(c.length<e.length){const I=au(n,c),v=["row","col","depth","depth2","depth3"];return`
      ${su(I)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${ou(v,l)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${i}, ${s})) +
          depth3;
        ${iu(n)}
      }
    `;const u=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,d=f[0],p=f[1];if(p===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${i}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(p===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;const m=Vc(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${i} +
          depth2 * ${s} + depth3 + ${m};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${t}, uv);
    }
  `}function lte(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:i}=_o(e);if(s.length<e.length){const v=au(n,s),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${su(v)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${ou(b,i)});
      }
    `}const a=e[5],o=e[4]*a,c=e[3]*o,l=e[2]*c,u=e[1]*l;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${l}, ${c}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${iu(n)}
      }
    `;const f=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,p=d[0],m=d[1];if(m===u&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${c}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(m===a&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const I=Vc(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${l} + depth * ${c} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${I};
      vec2 uv = uvFromFlat(${p}, ${m}, index);
      return sampleTexture(${t}, uv);
    }
  `}function iu(n){const e=n.name,t=Ye(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function ute(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=n.shapeInfo.logicalShape.length,a=e.logicalShape.length,o=GO(n.shapeInfo.logicalShape,e.logicalShape),c=Rn(a),l=a-i;let u;const f=["x","y","z","w","u","v"];i===0?u="":a<2&&o.length>=1?u="coords = 0;":u=o.map(y=>`coords.${f[y+l]} = 0;`).join(`
`);let d="";a<2&&i>0?d="coords":d=n.shapeInfo.logicalShape.map((y,S)=>`coords.${f[S+l]}`).join(", ");let p="return outputValue;";const I=Ye(n.shapeInfo.logicalShape)===1,b=Ye(e.logicalShape)===1;if(i===1&&!I&&!b)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(I&&!b)a===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(o.length){const y=i-2,S=i-1;o.indexOf(y)>-1&&o.indexOf(S)>-1?p="return vec4(outputValue.x);":o.indexOf(y)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(S)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${c} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${d});
      ${p}
    }
  `}function fte(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",i=e.texShape,a=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===c&&n.shapeInfo.flatOffset==null&&vn(a,i))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const l=Rn(c),u=GO(n.shapeInfo.logicalShape,e.logicalShape),f=c-o;let d;const p=["x","y","z","w","u","v"];o===0?d="":c<2&&u.length>=1?d="coords = 0;":d=u.map(I=>`coords.${p[I+f]} = 0;`).join(`
`);let m="";return c<2&&o>0?m="coords":m=n.shapeInfo.logicalShape.map((I,v)=>`coords.${p[v+f]}`).join(", "),`
    float ${s}() {
      ${l} coords = getOutputCoords();
      ${d}
      return get${r}(${m});
    }
  `}function Rn(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function Fx(n,e,t){const{newShape:r,keptDims:s}=_o(e),i=e.length,a=n&&i===3&&e[0]===1,o=a?e.slice(1):r,c=!n&&i>1&&!vn(e,t)&&r.length<i||a;return{useSqueezeShape:c,uniformShape:c?o:e,keptDims:s}}function au(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function ou(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(n,e,t,r){const s=t.map((u,f)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:d}}),i=s.map(u=>u.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=$ee(s,a,e),c=iee(n.gl,o),l=n.createProgram(c);return Ge().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:o,webGLProgram:l,inShapeInfos:i,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(l),Object.assign({program:e,fragmentShader:c,source:o,webGLProgram:l,inShapeInfos:i,outShapeInfo:a},jO(n,e,l)))}function jO(n,e,t){const r=[],s=[];let i,a,o,c=null,l=null;l=n.getUniformLocation(t,"NAN",!1),Ge().getNumber("WEBGL_VERSION")===1&&(c=n.getUniformLocation(t,"INFINITY",!1));const u=!1;for(const f of e.variableNames){const d={name:f,uniform:n.getUniformLocation(t,f,u),offset:n.getUniformLocation(t,`offset${f}`,u)};e.enableShapeUniforms&&(d.shape=n.getUniformLocation(t,`${f}Shape`,u),d.texShape=n.getUniformLocation(t,`${f}TexShape`,u)),r.push(d)}if(e.enableShapeUniforms&&(i=n.getUniformLocation(t,"outShape",u),o=n.getUniformLocation(t,"outShapeStrides",u),a=n.getUniformLocation(t,"outTexShape",u)),e.customUniforms)for(const f of e.customUniforms)s.push(n.getUniformLocation(t,f.name,u));return{variablesLocations:r,customUniformLocations:s,infLoc:c,nanLoc:l,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:a}}function tR(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const s=t.logicalShape,i=e[r],a=i.shape;if(!vn(s,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${a} must match`);if(t.isUniform&&i.isUniform)return;const o=t.texShape,c=i.isUniform?null:i.texData.texShape;if(!vn(o,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${c} must match`)})}function dte(n,e,t,r,s){e.program.enableShapeUniforms||(tR(e.inShapeInfos,t),tR([e.outShapeInfo],[r]));const i=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(i.texture,a[0],a[1]):n.setOutputMatrixTexture(i.texture,a[0],a[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),Ge().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<t.length;++c){const l=t[c],{uniform:u,offset:f,shape:d,texShape:p}=e.variablesLocations[c];if(d){const{uniformShape:m}=Fx(e.program.packedInputs,l.shape,l.texData.texShape);switch(m.length){case 1:n.gl.uniform1iv(d,new Int32Array(m));break;case 2:n.gl.uniform2iv(d,new Int32Array(m));break;case 3:n.gl.uniform3iv(d,new Int32Array(m));break;case 4:n.gl.uniform4iv(d,new Int32Array(m));break}}if(p&&n.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),u!=null){if(l.isUniform){if(Ye(l.shape)<2)n.gl.uniform1f(u,l.uniformValues[0]);else{let m=l.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),n.gl.uniform1fv(u,m)}continue}l.texData.slice!=null&&f!=null&&n.gl.uniform1i(f,l.texData.slice.flatOffset),n.setInputMatrixTexture(l.texData.texture.texture,u,c)}}const o=e.outShapeLocation;if(o)switch(r.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const c=Rt(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let c=0;c<e.program.customUniforms.length;++c){const l=e.program.customUniforms[c],u=e.customUniformLocations[c],f=s[c];if(l.type==="float")n.gl.uniform1fv(u,f);else if(l.type==="vec2")n.gl.uniform2fv(u,f);else if(l.type==="vec3")n.gl.uniform3fv(u,f);else if(l.type==="vec4")n.gl.uniform4fv(u,f);else if(l.type==="int")n.gl.uniform1iv(u,f);else if(l.type==="ivec2")n.gl.uniform2iv(u,f);else if(l.type==="ivec3")n.gl.uniform3iv(u,f);else if(l.type==="ivec4")n.gl.uniform4iv(u,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}n.executeProgram()}function pte(n,e,t){let r="";e.concat(t).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!a.isUniform){const c=a.texData.texShape,{useSqueezeShape:l,uniformShape:u,keptDims:f}=Fx(n.packedInputs,a.shape,c);let d="",p="",m="";if(u.length===1&&n.packedInputs){const C=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];d=`${C[0]>1}_${C[1]>1}`}else if(u.length===2&&!n.packedInputs)p=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!n.packedInputs){const C=Rt(u);m=`${C[0]===c[1]}_${C[C.length-1]===c[1]}`}const I=a.shape.length,v=u.length===2&&vn(a.shape,c),b=Ye(a.shape)===1,y=Bl(a.shape,t.shape),S=!n.packedInputs&&I===t.shape.length&&vn(c,t.texData.texShape),w=n.packedInputs||u.length>2?"":`${c[0]>1}_${c[1]>1}`;r+=`${I}_${S}_${l?f:""}_${u.length}_${b}_${y}_${v}_${d}_${p}_${m}_${w}_${o}`}else{const c=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${c}_${o}`}});const s=n.userCode;let i=n.constructor.name;return i+="_"+r+"_"+s+`${Ge().getNumber("WEBGL_VERSION")}`,i}function Kr(n){return Ge().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gte{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=xf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=is();this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Lm(["r","c","d"],e):zc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mte{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=xf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=is();this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Lm(["r","c","d"],e):zc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vte{constructor(e){this.variableNames=["A"],this.outTexUsage=Vs.DOWNLOAD;const t=is();this.outputShape=e,this.userCode=`
      ${WO}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ite{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Vs.DOWNLOAD;const t=is();this.outputShape=e,this.userCode=`
      ${WO}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bte={R:0,G:1,B:2,A:3};class nR{constructor(e,t=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=is();this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)");let a="";for(let o=0;o<r.length;o++){const c=r[o];a+=`
          if(offset == ${o}) {
            result = values[${bte[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?_x():Ox(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${a}
        }
        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yte{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=is();this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length);let s="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const c=a*2+o;s+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?_x():Ox(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${i};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xte(n){const e=is(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return see(n,t)}function wte(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return lee(n,e)}function Ste(n){const e=new Uint16Array([0,1,2,2,1,3]);return uee(n,e)}function Gh(n,e,t,r,s,i){hee(e,t);const a=fee(n),o=n.TEXTURE_2D;return dt(n,()=>n.bindTexture(o,a)),dt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),dt(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),dt(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),dt(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),Ge().getNumber("WEBGL_VERSION")===1?dt(n,()=>n.texImage2D(o,0,r,e,t,0,s,i,null)):dt(n,()=>n.texStorage2D(o,1,r,e,t)),dt(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:a,texShape:[t,e]}}function KO(n){return n.internalFormatFloat}function Cte(n,e,t,r){const[s,i]=Vh(e,t);return Gh(n,s,i,KO(r),r.textureFormatFloat,n.FLOAT)}function XO(n){return n.internalFormatHalfFloat}function Rte(n,e,t,r){const[s,i]=Vh(e,t);return Gh(n,s,i,XO(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function YO(n){return n.downloadTextureFormat}function kte(n,e,t,r){const[s,i]=Vh(e,t);return Gh(n,s,i,YO(r),n.RGBA,n.UNSIGNED_BYTE)}function ZO(n){return n.internalFormatPackedFloat}function Ete(n,e,t,r){const[s,i]=ru(e,t);return Gh(n,s,i,ZO(r),n.RGBA,n.FLOAT)}function JO(n){return n.internalFormatPackedHalfFloat}function Tte(n,e,t,r){const[s,i]=ru(e,t);return Gh(n,s,i,JO(r),n.RGBA,r.textureTypeHalfFloat)}function Ate(n,e,t){return dt(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),JC(n,e,"clipSpacePos",t,3,20,0)&&JC(n,e,"uv",t,2,20,12)}function $te(n,e,t,r,s,i){dt(n,()=>n.bindTexture(n.TEXTURE_2D,e));let a,o,c;s instanceof Uint8Array?(a=new Uint8Array(t*r*4),o=n.UNSIGNED_BYTE,c=n.RGBA):(a=new Float32Array(t*r*4),o=n.FLOAT,c=i.internalFormatPackedFloat),a.set(s),Ge().getNumber("WEBGL_VERSION")===2?dt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,o,a)):dt(n,()=>n.texImage2D(n.TEXTURE_2D,0,c,t,r,0,n.RGBA,o,a)),dt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Nte(n,e,t){dt(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?Ge().getNumber("WEBGL_VERSION")===2?dt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):dt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):Ge().getNumber("WEBGL_VERSION")===2?dt(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):dt(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),dt(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Ote(n,e,t,r){const s=n.createBuffer();dt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const o=4*4*e*t;return dt(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),dt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),dt(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}function _te(n,e,t){const r=n,s=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Fte(n,e,t,r){const[s,i]=Vh(e,t),a=4,o=new Uint8Array(ZQ(e*t,a));return dt(n,()=>n.readPixels(0,0,s,i,r.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function Dte(n,e,t,r,s,i,a,o){const c=n,l=new Float32Array(JQ(i,a));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}function Bte(n,e,t){const r=new Float32Array(e*t*4);return dt(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=Ge().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,KQ(t,e)):this.gl=Gi(t),e=this.gl,Ge().getNumber("WEBGL_VERSION")===2){const i=e;this.createVertexArray=()=>dt(i,()=>i.createVertexArray()),this.bindVertexArray=a=>dt(i,()=>i.bindVertexArray(a)),this.deleteVertexArray=a=>dt(i,()=>i.deleteVertexArray(a)),this.getVertexArray=()=>dt(i,()=>i.getParameter(i.VERTEX_ARRAY_BINDING))}else if(e!=null){const i=e.getExtension("OES_vertex_array_object");if(i==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>dt(e,()=>i.createVertexArrayOES()),this.bindVertexArray=a=>dt(e,()=>i.bindVertexArrayOES(a)),this.deleteVertexArray=a=>dt(e,()=>i.deleteVertexArrayOES(a)),this.getVertexArray=()=>dt(e,()=>e.getParameter(i.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Ge().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=ep(this.gl,i),pi(this.gl,a))this.textureHalfFloatExtension=ep(this.gl,a);else if(Ge().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),pi(this.gl,s))this.colorBufferHalfFloatExtension=ep(this.gl,s);else if(Ge().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",pi(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(pi(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=wte(this.gl),this.indexBuffer=Ste(this.gl),this.framebuffer=dee(this.gl),this.textureConfig=Nx(this.gl,this.textureHalfFloatExtension)}get debug(){return Ge().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;dt(e,()=>e.finish()),dt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),dt(e,()=>e.deleteFramebuffer(this.framebuffer)),dt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),dt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),dt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Cte(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Rte(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),kte(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Nte(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,s){this.throwIfDisposed(),$te(this.gl,e,t,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Tte(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),Ete(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(QC(this.gl,this.framebuffer),this.outputTexture=null),dt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>Fte(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,s,i,a){return Dte(this.gl,e,t,r,s,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return _te(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const s=Ote(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(Ge().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,i=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const a=s.clientWaitSync(i,0,0);return a===s.ALREADY_SIGNALED||a===s.CONDITION_SATISFIED},t=i}else Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>Bte(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=xte(t));const r=oee(t);dt(t,()=>t.attachShader(r,this.vertexShader)),dt(t,()=>t.attachShader(r,e)),cee(t,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&M1(t,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;dt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Ate(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(dt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&M1(this.gl,this.program),dt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?gee(this.gl,e,t):mee(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),dt(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),vee(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[s,i]=ru(t,r);this.setOutputMatrixTextureDriver(e,s,i)}setOutputMatrixWriteRegion(e,t,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&M1(this.gl,this.program),tp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}dt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),dt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=ep(this.gl,Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await WS(()=>this.disposed||this.isQueryAvailable(e,Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Mte(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Ge().platform&&(r=Ge().platform.setTimeoutCustom.bind(Ge().platform)),WS(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),P1(this.gl,e,this.framebuffer),this.debug&&tp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(P1(this.gl,this.outputTexture,this.framebuffer),this.debug&&tp(this.gl)):QC(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const s=this.gl;P1(s,e,this.framebuffer),this.debug&&tp(s),this.outputTexture=e,dt(s,()=>s.viewport(0,0,t,r)),dt(s,()=>s.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,s){this.throwIfDisposed(),dt(this.gl,()=>this.gl.scissor(e,t,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Mte(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Pte,bincountImpl:QO,bincountReduceImpl:Lte,bitwiseAndImpl:Ute,castImpl:zte,ceilImpl:Vte,concatImpl:Wte,equalImpl:Gte,expImpl:Hte,expm1Impl:qte,floorImpl:jte,gatherNdImpl:Kte,gatherV2Impl:Xte,greaterImpl:Yte,greaterEqualImpl:Zte,lessImpl:Jte,lessEqualImpl:Qte,linSpaceImpl:ene,logImpl:tne,maxImpl:nne,maximumImpl:rne,minimumImpl:sne,multiplyImpl:ine,negImpl:ane,notEqualImpl:one,prodImpl:cne,raggedGatherImpl:lne,raggedRangeImpl:une,raggedTensorToTensorImpl:fne,rangeImpl:hne,rsqrtImpl:dne,scatterImpl:pne,sigmoidImpl:gne,simpleAbsImpl:e_,sliceImpl:mne,sparseFillEmptyRowsImpl:vne,sparseReshapeImpl:Ine,sparseSegmentReductionImpl:t_,sqrtImpl:bne,staticRegexReplaceImpl:yne,stridedSliceImpl:xne,stringNGramsImpl:wne,stringSplitImpl:Sne,stringToHashBucketFastImpl:Cne,subImpl:Rne,tileImpl:kne,topKImpl:Ene,transposeImpl:Dx,uniqueImpl:Tne}=NK;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function es(n,e){return e===1?[n]:n_(n,e)}function Ane(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ne{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Kr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=es("rc",this.rank),r=Rn(this.rank),s=this.getOutOfBoundsCondition(t),i=this.getSetup(t),a=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let i=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)i=`${e[e.length-1-a]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r_{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length);let r="";for(let s=0;s<4;s++){let i="thisRC = rc;";s%2===1&&(i+="thisRC.z += 1;"),s>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Nne(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?_x():Ox(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Nne(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Aee(["r","c","d"],"inputShape"):zc(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class One{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,r){const s=sR(t,r),i=iR(e,s,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const a=rR(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const c=this.freeTextures[i].pop();return this.usedTextures[i].push(c),c}let o;return s===Mr.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Mr.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Mr.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Mr.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Mr.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,t,r,s){if(this.freeTextures==null)return;const i=sR(r,s),a=iR(t,i,s);a in this.freeTextures||(this.freeTextures[a]=[]);const o=rR(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,s),c=Ge().get("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const l=this.usedTextures[a],u=l&&l.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l[u]=l[l.length-1],l.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function _ne(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function rR(n,e,t,r,s){const i=Fne(e,r);let a;if(s){const[c,l]=ru(n[0],n[1]);a=c*l}else{const[c,l]=Vh(n[0],n[1]);a=c*l}const o=_ne(t,i);return a*o}function Fne(n,e){switch(n){case Mr.PACKED_2X2_FLOAT32:return ZO(e);case Mr.PACKED_2X2_FLOAT16:return JO(e);case Mr.UNPACKED_FLOAT32:return KO(e);case Mr.UNPACKED_FLOAT16:return XO(e);case Mr.PACKED_4X1_UNSIGNED_BYTE:return YO(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function Dne(n){return Ge().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Mr.PACKED_2X2_FLOAT32:Mr.UNPACKED_FLOAT32:n?Mr.PACKED_2X2_FLOAT16:Mr.UNPACKED_FLOAT16}function sR(n,e){if(n===Vs.UPLOAD)return Mr.PACKED_2X2_FLOAT32;if(n===Vs.RENDER||n==null)return Dne(e);if(n===Vs.DOWNLOAD||n===Vs.PIXELS)return Mr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function iR(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pa{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Si="if (isnan(x)) return x;",Bne="return x;",aR="return abs(x);",Mne="return (x >= 0.0) ? x : (exp(x) - 1.0);",Pne=Si+`
  return (x < 0.0) ? 0.0 : x;
`,Lne=Si+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,go="return x;",Une="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zne="return x;",Vne=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Wne=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Gne=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Hne="return 1.0 / (1.0 + exp(-1.0 * x));";class Io{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length);const t=e.length,r=es("rc",t),s=Rn(t),i=Ane(t,r),a=r.slice(-2),o=t<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jne=AT,Kne=1e-7,Xne=1e-4,sp={};function Yne(n){return n in sp||(sp[n]={}),sp[n]}const Zne=Ge().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Jne=600;function Qne(){return Ge().global.screen==null?1024:Ge().global.screen.height*Ge().global.screen.width*window.devicePixelRatio*Jne/1024/1024}class Um extends YI{nextDataId(){return Um.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Ge().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof z1)t=e;else{const r=Gi(Ge().getNumber("WEBGL_VERSION"),e);t=new z1(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Gi(Ge().getNumber("WEBGL_VERSION"));t=new z1(r),this.binaryCache=Yne(Ge().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new One(this.gpgpu),this.numMBBeforeWarning=Qne(),this.texData=new Kk(this,oa())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,r,s,i,a){const o=this.makeTensorInfo(t,r),c=this.texData.get(o.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[s,i]},c.texShape=[s,i];const l=np(t),u=new nR(l,!1,a),f=this.runWebGLProgram(u,[o],r,[[s,i]]);return f.shape=t,c.texture=null,this.disposeIntermediateTensorInfo(o),f.dataId}write(e,t,r){if((Ge().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ge().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:r,values:e,usage:Vs.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,s,i){if(Ge().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:t,usage:Vs.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:i,slice:a,shape:o,isPacked:c}=t;if(a!=null){let d;c?d=new Io(o,go):d=new pa(o,go);const p=this.runWebGLProgram(d,[{dataId:e,shape:o,dtype:s}],s),m=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const l=this.activeTimers!=null;let u;l&&(u=ls());let f;if(s==="complex64"){const d=this.readSync(i.real.dataId),p=this.readSync(i.imag.dataId);f=Ha(d,p)}else f=this.getValuesFromTexture(e);return l&&(this.downloadWaitMs+=ls()-u),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(I=>m.push(I))}const t=this.texData.get(e),{values:r,shape:s,slice:i,dtype:a,complexTensorInfos:o,isPacked:c}=t;if(i!=null){let m;c?m=new Io(s,go):m=new pa(s,go);const I=this.runWebGLProgram(m,[{dataId:e,shape:s,dtype:a}],a),v=this.read(I.dataId);return this.disposeIntermediateTensorInfo(I),v}if(r!=null)return this.convertAndCacheOnCPU(e);if(Ge().getBool("DEBUG")&&!Ge().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ge().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l=null,u;if(a!=="complex64"&&Ge().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const m=this.texData.get(u.dataId);l=this.gpgpu.createBufferFromTexture(m.texture.texture,...Qd(s))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(a==="complex64"){const m=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),I=m[0],v=m[1];f=Ha(I,v)}else if(l==null)f=this.getValuesFromTexture(e);else{const m=Ye(s);f=this.gpgpu.downloadFloat32MatrixFromBuffer(l,m)}if(u!=null&&this.disposeIntermediateTensorInfo(u),l!=null){const m=this.gpgpu.gl;dt(m,()=>m.deleteBuffer(l))}const d=this.convertAndCacheOnCPU(e,f),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(m=>m(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&oa().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){const r=this.texData.get(e),{values:s,shape:i,slice:a,dtype:o,isPacked:c,texture:l}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let p;c?p=new Io(i,go):p=new pa(i,go);const m=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:o}],o),I=this.readToGPU(m,t);return this.disposeIntermediateTensorInfo(m),I}if(l==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),f=oa().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:f},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>Ro(s));return Xt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Xt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!nee(r))throw Ge().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:s}=this.texData.get(e),i=Ye(t);if(Ge().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),p=this.texData.get(d.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Qd(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(d),m}const a=Ge().getBool("WEBGL_PACK")&&s===!0,o=a?np(t):t,c=a?new Ite(o):new vte(o),l=this.runWebGLProgram(c,[{shape:o,dtype:r,dataId:e}],"float32"),u=this.texData.get(l.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(l),f}timerAvailable(){return Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=bc(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),a=bc(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(i);o.kernelMs=G6(c),o.getExtraProfileInfo=()=>c.map((l,u)=>({name:a[u],ms:l})).map(l=>`${l.name}: ${l.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ls(),endMs:null}}endTimer(e){return Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ls(),e)}async getQueryTime(e){if(Ge().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:s,usage:i,isPacked:a,slice:o}=this.texData.get(e),c=o&&o.origDataId||e,l=this.dataRefCount.get(c);l>1?this.dataRefCount.set(c,l-1):(this.dataRefCount.delete(c),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(t,s,i,a)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Zne){return Ge().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Ye(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Ls("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return jne(e.shape,t)}packedUnaryOp(e,t,r){const s=new Io(e.shape,t),i=this.compileAndRun(s,[e],r);return oa().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=e_(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Ge().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,aR,e.dtype);const t=new pa(e.shape,aR),r=this.compileAndRun(t,[e]);return oa().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&Af(r[0])){const i=r.map(a=>yo(a));s=this.write(i,e,t)}else s=this.write(r,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,r){return oa().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new qne(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new $ne(e.shape),r=!0;return this.runWebGLProgram(t,[e],e.dtype,null,r)}packedReshape(e,t){const r=[Wl(e.shape),...Gl(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Wl(t),...Gl(t)],a=new r_(i,r),o=!0,c=[r],l=this.runWebGLProgram(a,[s],e.dtype,c,o);return{dataId:l.dataId,shape:t,dtype:l.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:s,shape:i,dtype:a}=r;if(t!=null){const d=Ye(i),p=t[0]*t[1]*4;ce(d<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=np(i);let c;s?c=new mte(o):c=new gte(o);const l=!0,u=[t??Qd(o)],f=this.runWebGLProgram(c,[{shape:o,dtype:a,dataId:e}],a,u,l,t);return{dtype:a,shape:i,dataId:f.dataId}}runWebGLProgram(e,t,r,s,i=!1,a){const o=this.makeTensorInfo(e.outputShape,r),c=this.texData.get(o.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===xf.DENSE){const b=a??Qd(e.outputShape);c.texShape=b.map(y=>y*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),Ye(o.shape)===0)return c.values=Hr(o.dtype,0),o;const l=[],u=t.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(b.dataId);if(y.texture==null){if(!e.packedInputs&&Ye(b.shape)<=Ge().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!y.isPacked!=!!e.packedInputs)b=y.isPacked?this.unpackTensor(b):this.packTensor(b),l.push(b),y=this.texData.get(b.dataId);else if(y.isPacked&&!Yp(y.shape,b.shape)){const S=b,w=b.shape;b.shape=y.shape,b=this.packedReshape(b,w),l.push(b),y=this.texData.get(b.dataId),S.shape=w}return{shape:b.shape,texData:y,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:c,isUniform:!1},d=pte(e,u,f),p=this.getAndSaveBinary(d,()=>hte(this.gpgpu,e,u,f)),m=this.activeTimers!=null;let I;m&&(I=this.startTimer()),Ge().get("ENGINE_COMPILE_ONLY")||dte(this.gpgpu,p,u,f,s),l.forEach(b=>this.disposeIntermediateTensorInfo(b)),m&&(I=this.endTimer(I),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(I)}));const v=Ge().get("WEBGL_FLUSH_THRESHOLD");if(v>0){const b=ls();b-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!Ge().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&i===!1){const b=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),b}return o}compileAndRun(e,t,r,s,i=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,s,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Ge().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ve(()=>{if(!Ge().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Ge().getBool("DEBUG");Ge().set("DEBUG",!1);const t=this.abs(bn(1e-8)).dataSync()[0];if(Ge().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Kne:Xne}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:s,values:i,texture:a,usage:o,isPacked:c}=t;if(a!=null)return;const l=this.activeTimers!=null;let u;l&&(u=ls());let f=t.texShape;if(f==null&&(f=yee(r,c),t.texShape=f),i!=null){const d=np(r);let p,m=f[1],I=f[0];const v=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(c||!v)&&([m,I]=ru(f[0],f[1])),c?p=new yte(d,v):p=new nR(d,v);const b=v?[I,m]:f,y=this.makeTensorInfo(b,s),S=this.texData.get(y.dataId);v?S.usage=Vs.PIXELS:S.usage=Vs.UPLOAD,S.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),m,I,i);const w=[[I,m]],C=!0,N=this.runWebGLProgram(p,[y],s,w,C),E=this.texData.get(N.dataId);t.texShape=E.texShape,t.isPacked=E.isPacked,t.usage=E.usage,Ge().get("ENGINE_COMPILE_ONLY")?this.disposeData(N.dataId):(t.texture=E.texture,t.values=null,this.texData.delete(N.dataId)),this.disposeIntermediateTensorInfo(y),l&&(this.uploadWaitMs+=ls()-u)}else{const d=this.acquireTexture(f,o,s,c);t.texture=d}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:s}=r;return t!=null&&(r.values=ere(t,s)),r.values}acquireTexture(e,t,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*Rp(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await qT(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(VO(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:r,infLoc:s,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:c}=jO(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=c}}createTensorFromGPUData(e,t,r){e.channels=e.channels||"RGBA";const{texture:s,height:i,width:a,channels:o}=e,c=oa().backend;if(!c.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const l=c.writeTexture(s,t,r,i,a,o);return oa().makeTensorFromDataId(l,t,r,c)}}Um.nextDataId=0;function ere(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */WE()&&eT("webgl",()=>new Um,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bx=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Nc{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=Ut(t,r),this.enableShapeUniforms=Kr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wc=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class cu{constructor(e,t,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ut(t,r);const i=this.outputShape.length;this.enableShapeUniforms=Kr(i);let a="";if(s)if(i===0||Ye(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${Rn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=es("coords",i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${c[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${c[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const tre={kernelName:Yf,backendName:"webgl",kernelFunc:$s};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,i=t.makeTensorInfo(r.shape,"complex64"),a=t.texData.get(i.dataId),o=$s({inputs:{x:r},backend:t}),c=$s({inputs:{x:s},backend:t});return a.complexTensorInfos={real:o,imag:c},i}const nre={kernelName:lb,backendName:"webgl",kernelFunc:zo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_="return (a < 0.) ? b * a : a;",i_=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function rre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:i}=r,a=t.makeTensorInfo([],"float32",Fo(i,"float32")),o=Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cu(i_,s.shape,a.shape):new Nc(s_,s.shape,a.shape),c=t.runWebGLProgram(o,[s,a],"float32");return t.disposeIntermediateTensorInfo(a),c}const sre={kernelName:Dg,backendName:"webgl",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_="return (a < 0.) ? b * a : a;",o_=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function ire(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e,i=Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cu(o_,r.shape,s.shape):new Nc(a_,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],"float32")}const are={kernelName:em,backendName:"webgl",kernelFunc:ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lu="if (isnan(x)) return x;";function fn({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:s,backend:i})=>{const{x:a}=s,o=i,c=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&t!=null){const f=o.texData.get(a.dataId),d=t(f.values,c);return o.makeTensorInfo(a.shape,c,d)}const l=Ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return l?u=new Io(a.shape,e):u=new pa(a.shape,n),o.runWebGLProgram(u,[a],c)}}function zr({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:i}){return({inputs:a,backend:o})=>{const{a:c,b:l}=a,u=o;if(r&&c.dtype==="complex64"){const m=u.texData.get(c.dataId),I=u.texData.get(l.dataId),[v,b]=[[m.complexTensorInfos.real,I.complexTensorInfos.real],[m.complexTensorInfos.imag,I.complexTensorInfos.imag]].map(S=>{const[w,C]=S,N={dataId:w.dataId,dtype:w.dtype,shape:c.shape},E={dataId:C.dataId,dtype:C.dtype,shape:l.shape},A=new Nc(n,c.shape,l.shape);return u.runWebGLProgram(A,[N,E],Ts(w.dtype,C.dtype))}),y=zo({inputs:{real:v,imag:b},backend:u});return u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(b),y}const f=i||Ts(c.dtype,l.dtype);if((c.dtype==="string"||l.dtype==="string"||u.shouldExecuteOnCPU([c,l]))&&s!=null){const m=u.texData.get(c.dataId).values,I=u.texData.get(l.dataId).values,v=c.dtype==="string"?qa(m):m,b=c.dtype==="string"?qa(I):I,[y,S]=s(c.shape,l.shape,v,b,f),w=u.makeTensorInfo(S,f),C=u.texData.get(w.dataId);return C.values=y,w}const d=Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return d?p=new cu(e,c.shape,l.shape,t):p=new Nc(n,c.shape,l.shape),u.runWebGLProgram(p,[c,l],f)}}function wf(n,e=!1){if(n==="linear")return e?zne:Bne;if(n==="relu")return e?Wne:Pne;if(n==="elu")return e?Vne:Mne;if(n==="relu6")return e?Gne:Lne;if(n==="prelu")return e?o_:a_;if(n==="leakyrelu")return e?i_:s_;if(n==="sigmoid")return e?Hne:Une;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c_{constructor(e,t,r,s=!1,i=!1,a=!1,o=null,c=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Kr(this.outputShape.length);const u=s?e[1]:e[2],f=Math.ceil(u/2),d=s?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",m=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],I=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",b="";o&&(c?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:l?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:v=`vec4 activation(vec4 x) {
          ${o}
        }`,b="result = activation(result);");const y=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let S="rc.x",w="rc.x";e[0]<t[0]?S=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(w=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${S};
        int batchB = ${w};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${I[0]});
          result += (${m[1]} * ${I[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${b}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class cR{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ut(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lR="return a * b;";function Mx(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=Ts(r.dtype,s.dtype);if(r.dtype==="complex64"){const o=t.texData.get(r.dataId),c=t.texData.get(s.dataId),l=new cR(oR.REAL,r.shape,s.shape),u=new cR(oR.IMAG,r.shape,s.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:s.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:s.shape}],d=t.runWebGLProgram(l,f,"float32"),p=t.runWebGLProgram(u,f,"float32"),m=zo({inputs:{real:d,imag:p},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),m}if(t.shouldExecuteOnCPU([r,s])){const o=t.texData.get(r.dataId),c=t.texData.get(s.dataId),[l,u]=ine(r.shape,s.shape,o.values,c.values,i),f=t.makeTensorInfo(u,i),d=t.texData.get(f.dataId);return d.values=l,f}let a;return Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new cu(lR,r.shape,s.shape):a=new Nc(lR,r.shape,s.shape),t.runWebGLProgram(a,[r,s],i)}const ore={kernelName:ih,backendName:"webgl",kernelFunc:Mx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(n,e,t){const r=[Wl(n.shape),...Gl(n.shape)],s={dtype:n.dtype,shape:r,dataId:n.dataId},i=[Wl(e),...Gl(e)],a=new r_(i,r),o=!0,c=[r],l=t.runWebGLProgram(a,[s],n.dtype,c,o);return{dataId:l.dataId,shape:e,dtype:l.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:i}=r,a=t,o=Ye(s.shape),c=Yk(i,o),l=Ye(c);ce(o===l,()=>`The new shape (${c}) has ${l} elements and the old shape (${s.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const u=a.texData.get(s.dataId);return u.isPacked&&!Yp(s.shape,c)&&!(u.texture!==null&&Yp(u.shape,c))?cre(s,c,a):(a.incRef(s.dataId),{dataId:s.dataId,shape:c,dtype:s.dtype})}const lre={kernelName:nm,backendName:"webgl",kernelFunc:ut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uR{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:a}=e;this.outputShape=[s,a];const o=Math.floor(r/4)*4,c=r%4;let l="sumValue += dot(values, ones);";if(t!=null){const f=1/t;l=`sumValue += dot(values * ${Ol(f)?f.toPrecision(2):f}, ones);`}let u="";i%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${l}
        }

        int inIdx = inOffset + ${o};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${l}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${l}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${l}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ure{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:i,outSize:a}=e;this.outputShape=[s,a];let o="0.0",c="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",c="min"):t==="max"&&(o="-1.0 / 1e-20",c="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?l="sumValue":t==="prod"?l="prodValue":t==="all"?l="allValue":t==="any"&&(l="anyValue");const u=Math.floor(r/4)*4,f=r%4;let d=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";t==="all"?(o="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):t==="any"&&(o="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${f===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${f===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fre(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=Cm(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function Gc(n,e,t,r){const s=fre(n.shape);let i=n;for(let a=0;a<s.length;a++){const{inSize:o,windowSize:c,outSize:l}=s[a];let u,f;t==="mean"?u=a===0?new uR({windowSize:c,inSize:o,batchSize:n.shape[0],outSize:l},o):new uR({windowSize:c,inSize:o,batchSize:n.shape[0],outSize:l}):u=new ure({windowSize:c,inSize:o,batchSize:n.shape[0],outSize:l},t),f=i,i=r.runWebGLProgram(u,[i],e),f.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(f)}return i}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hre{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[t[a]];this.outputShape=r,this.rank=r.length;const s=Rn(this.rank),i=dre(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function dre(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<n.length;s++)r[n[s]]=t[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pre{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[t[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Rn(this.rank),i=n_("rc",this.rank),a=new Array(this.rank);for(let u=0;u<t.length;u++)a[t[u]]=i[u];const o=`vec2(${a.slice(-2).join()})`,c=`++${i[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${l};
      if(${c}) {
        result[1] = ${l};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${l};
        if(${c}) {
          result[3] = ${l};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zm(n,e,t){const r=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pre(n.shape,e):new hre(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(n,e,t,r){const s=e,i=n.shape.length,a=Yt(s,n.shape);let o=a;const c=Kn(o,i),l=c!=null;let u=n;l&&(u=zm(n,c,r),o=ir(o.length,i)),Ur("sum",o,i);const[f,d]=$r(u.shape,o);let p=f;t&&(p=mr(f,a));const m=Ye(d),v=Ye(n.shape)/m,b=ut({inputs:{x:u},attrs:{shape:[v,m]},backend:r}),y=Wb(n.dtype),S=Gc(b,y,"sum",r),w=ut({inputs:{x:S},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(S),l&&r.disposeIntermediateTensorInfo(u),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vm(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r;return gre(s,i,a,t)}const mre={kernelName:cm,backendName:"webgl",kernelFunc:Vm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ss(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{perm:i}=r,a=t,o=s.shape.length,c=new Array(o);for(let u=0;u<c.length;u++)c[u]=s.shape[i[u]];let l;if(a.shouldExecuteOnCPU([s])){const f=a.texData.get(s.dataId).values,d=Dx(f,s.shape,s.dtype,i,c);l=a.makeTensorInfo(c,s.dtype);const p=a.texData.get(l.dataId);p.values=d}else l=zm(s,i,a);return l}const vre={kernelName:El,backendName:"webgl",kernelFunc:ss};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_=1e3;function Zp({a:n,b:e,transposeA:t,transposeB:r,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:c=null}){const l=n.shape.length,u=e.shape.length,f=t?n.shape[l-2]:n.shape[l-1],d=r?e.shape[u-1]:e.shape[u-2],p=t?n.shape[l-1]:n.shape[l-2],m=r?e.shape[u-2]:e.shape[u-1],I=n.shape.slice(0,-2),v=e.shape.slice(0,-2),b=Ye(I),y=Ye(v),w=Ut(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,m]);ce(f===d,()=>`Error in matMul: inner shapes (${f}) and (${d}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const C=t?[b,f,p]:[b,p,f],N=r?[y,m,d]:[y,d,m],E=ut({inputs:{x:n},backend:s,attrs:{shape:C}}),A=ut({inputs:{x:e},backend:s,attrs:{shape:N}}),M=[E,A],z=Math.max(b,y),Y=t?E.shape[1]:E.shape[2],re=i!=null,ne=a!=null,le=c==="leakyrelu",j=c!=null?wf(c,!0):null,ge=re||ne||le||j!=null;let Se;if((p===1||m===1)&&Y>l_&&ge===!1){let ye=E,Ce=A;t&&(ye=ss({inputs:{x:E},backend:s,attrs:{perm:[0,2,1]}}),M.push(ye)),r&&(Ce=ss({inputs:{x:A},backend:s,attrs:{perm:[0,2,1]}}),M.push(Ce));const he=m!==1,Ne=m===1;let xe=ye;he&&(xe=ut({inputs:{x:ye},backend:s,attrs:{shape:[z,Y,1]}}),M.push(xe));const ae=m===1?2:1;let J=Ce;Ne&&(J=ut({inputs:{x:Ce},backend:s,attrs:{shape:[z,1,Y]}}),M.push(J));const D=Mx({inputs:{a:xe,b:J},backend:s});Se=Vm({inputs:{x:D},backend:s,attrs:{axis:ae,keepDims:!0}}),M.push(D)}else{const ye=Ts(n.dtype,e.dtype),Ce=new c_(C,N,[z,p,m],t,r,re,j,ne,le),he=[E,A];if(i!=null&&he.push(i),ne&&he.push(a),le){const Ne=s.makeTensorInfo([],"float32",Fo(o,"float32"));he.push(Ne),M.push(Ne)}Se=s.runWebGLProgram(Ce,he,ye)}const me=ut({inputs:{x:Se},backend:s,attrs:{shape:w}});M.push(Se);for(const ye of M)s.disposeIntermediateTensorInfo(ye);return me}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i,bias:a,preluActivationWeights:o}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:f}=r;return Zp({a:s,b:i,transposeA:c,transposeB:l,backend:t,bias:a,preluActivationWeights:o,leakyreluAlpha:f,activation:u})}const bre={kernelName:kp,backendName:"webgl",kernelFunc:Ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fR="return abs(x);";function yre(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=t.texData.get(r.dataId),a=e_(i.values);return t.makeTensorInfo(r.shape,r.dtype,a)}let s;return Ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Io(r.shape,fR):s=new pa(r.shape,fR),t.runWebGLProgram(s,[r],r.dtype)}const xre={kernelName:gg,backendName:"webgl",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wre=Si+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Sre=fn({opSnippet:wre}),Cre={kernelName:$f,backendName:"webgl",kernelFunc:Sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rre=Si+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,kre=fn({opSnippet:Rre}),Ere={kernelName:Nf,backendName:"webgl",kernelFunc:kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hR="return a + b;",Tre=zr({opSnippet:hR,packedOpSnippet:hR,supportsComplex:!0,cpuKernelImpl:Pte}),Are={kernelName:Yl,backendName:"webgl",kernelFunc:Tre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $re{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nre{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((i,a)=>`T${a}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const s=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return $s({inputs:{x:r[0]},backend:t});if(r.length>Ge().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(r.length/2),l=vp({inputs:r.slice(0,c),backend:t}),u=vp({inputs:r.slice(c),backend:t});return vp({inputs:[l,u],backend:t})}const s=r.map(c=>c.dtype).reduce((c,l)=>Ts(c,l)),i=r.map(c=>c.shape),o=Ge().getBool("WEBGL_PACK")?new Nre(r[0].shape,i):new $re(r[0].shape,i);return t.runWebGLProgram(o,r,s)}const Ore={kernelName:nb,backendName:"webgl",kernelFunc:vp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,c=Yt(i,s.shape);let l=c;const u=Kn(l,o);let f=s;u!=null&&(f=ss({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ir(l.length,o)),Ur("all",l,o);const[d,p]=$r(f.shape,l),m=Ye(p),I=ut({inputs:{x:f},backend:t,attrs:{shape:[-1,m]}}),v=Gc(I,I.dtype,"all",t);let b;if(a){const y=mr(d,c);b=ut({inputs:{x:v},backend:t,attrs:{shape:y}})}else b=ut({inputs:{x:v},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(v),u!=null&&t.disposeIntermediateTensorInfo(f),b}const Fre={kernelName:rb,backendName:"webgl",kernelFunc:_re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,c=Yt(i,s.shape);let l=c;const u=Kn(l,o);let f=s;u!=null&&(f=ss({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ir(l.length,o)),Ur("any",l,o);const[d,p]=$r(f.shape,l),m=Ye(p),I=ut({inputs:{x:f},backend:t,attrs:{shape:[-1,m]}}),v=Gc(I,I.dtype,"any",t);let b;if(a){const y=mr(d,c);b=ut({inputs:{x:v},backend:t,attrs:{shape:y}})}else b=ut({inputs:{x:v},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(v),u!=null&&t.disposeIntermediateTensorInfo(f),b}const Bre={kernelName:sb,backendName:"webgl",kernelFunc:Dre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mre{constructor(e,t,r){this.variableNames=["A"];const{windowSize:s,batchSize:i,outSize:a}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];const o=t==="max"?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pre{constructor(e,t,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ce(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),s||this.variableNames.push("bestIndicesA");const o=this.outputShape,c=o.length,l=Rn(c),u=es("coords",c);let f,d;if(a===1){d=c+1;const A=Rn(d);f=`
        ${A} sourceLocR = ${A}(${u.join()}, 0);
        ++${u[c-1]};
        ${A} sourceLocG = ${A}(${u.join()}, 0);
        ++${u[c-2]};
        ${A} sourceLocA = ${A}(${u.join()}, 0);
        --${u[c-1]};
        ${A} sourceLocB = ${A}(${u.join()}, 0);
        --${u[c-2]};`}else d=c,f=`
        ${l} sourceLocR = coords;
        ++${u[c-1]};
        ${l} sourceLocG = coords;
        ++${u[c-2]};
        ${l} sourceLocA = coords;
        --${u[c-1]};
        ${l} sourceLocB = coords;
        --${u[c-2]};`;const p=["x","y","z","w","u","v"].slice(0,d),m="."+p[d-1],I=p.map(A=>"int "+A),v=es("sourceLocR",d-1).concat("inIdx.r"),b=es("sourceLocG",d-1).concat("inIdx.g"),y=es("sourceLocB",d-1).concat("inIdx.b"),S=es("sourceLocA",d-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",C=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${S.join()})));`,N=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${S.join()}) : 0.)`,E=s?"":`
      float getBestIndicesAChannel(${I.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${I.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${E}
      void main() {
        ${l} coords = getOutputCoords();
        bool hasNextCol = ${u[c-1]} < ${o[c-1]-1};
        bool hasNextRow = ${u[c-2]} < ${o[c-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${N};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${N};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_(n,e,t,r=null){let s=e.shape[0],i=e.shape[1];r!=null&&(s=r.shape[0],i=r.shape[1]);const a=Cm(i),o={windowSize:a,inSize:i,batchSize:s,outSize:Math.ceil(i/a)},c=new Mre(o,t,r==null),l=[e];r!=null&&l.push(r);const u=n.runWebGLProgram(c,l,"int32");if(u.shape[1]===1)return u;const f=u_(n,e,t,u);return n.disposeIntermediateTensorInfo(u),f}function f_(n,e,t,r=null){const s=r!=null?r.shape:e.shape,i=s[s.length-1],a=Cm(i),o=new Pre(s,a,t,r==null),c=r==null?[e]:[e,r],l=n.runWebGLProgram(o,c,"int32");if(l.shape.length===e.shape.length){const u=f_(n,e,t,l);return n.disposeIntermediateTensorInfo(l),u}return l}function h_(n,e,t,r){const s=[t];if(Ur("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!Ge().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],a=n.texData.get(e.dataId),o=a!==null&&a.isPacked;let c=e;o&&(c=n.unpackTensor(e),i.push(c));const[l,u]=$r(c.shape,s),f=Ye(u),d=ut({inputs:{x:c},backend:n,attrs:{shape:[-1,f]}});i.push(d);const p=u_(n,d,r);i.push(p);const m=ut({inputs:{x:p},backend:n,attrs:{shape:l}});return i.forEach(I=>n.disposeIntermediateTensorInfo(I)),m}return f_(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let a=Yt(i,s.shape);const o=Kn(a,s.shape.length);let c=s;const l=[];o!=null&&(c=ss({inputs:{x:s},backend:t,attrs:{perm:o}}),l.push(c),a=ir(a.length,c.shape.length)),Ur("argMax",[a[0]],c.shape.length);const u=h_(t,c,a[0],"max");return l.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const Ure={kernelName:mg,backendName:"webgl",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i}=r;let a=Yt(i,s.shape);const o=Kn(a,s.shape.length);let c=s;const l=[];o!=null&&(c=ss({inputs:{x:s},backend:t,attrs:{perm:o}}),l.push(c),a=ir(a.length,c.shape.length)),Ur("argMin",[a[0]],c.shape.length);const u=h_(t,c,a[0],"min");return l.forEach(f=>t.disposeIntermediateTensorInfo(f)),u}const Vre={kernelName:vg,backendName:"webgl",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre=Si+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Gre=fn({opSnippet:Wre}),Hre={kernelName:Of,backendName:"webgl",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qre=Si+"return log(x + sqrt(x * x + 1.0));",jre=fn({opSnippet:qre}),Kre={kernelName:_f,backendName:"webgl",kernelFunc:jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xre=Si+`
  return atan(x);
`,Yre=fn({opSnippet:Xre}),Zre={kernelName:Ff,backendName:"webgl",kernelFunc:Yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre=Bx+`
  return atan(a, b);
`,Qre=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,ese=zr({opSnippet:Jre,packedOpSnippet:Qre}),tse={kernelName:Bf,backendName:"webgl",kernelFunc:ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nse=Si+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,rse=fn({opSnippet:nse}),sse={kernelName:Df,backendName:"webgl",kernelFunc:rse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sf{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const I=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,b=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(I||(y="-1.0 / 1e-20"),r){const A=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${c});
        const ivec2 pads = ivec2(${p}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${l}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?i?v:b:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let w=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(w="avgValue / max(count, 1.0)");const C=Math.floor(a/4)*4,N=a%4,E=`
      if (${I}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${c});
      const ivec2 pads = ivec2(${p}, ${m});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${l}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${E}
          }

          int xC = xCCorner + ${C};
          if (${N===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${N===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${E}
          } else if (${N===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${E}
          }
        }
        setOutput(${w});
      }
    `}}class Px{constructor(e,t,r,s=!1,i=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideDepth,c=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,f=e.dilationHeight,d=e.dilationWidth,p=e.effectiveFilterDepth,m=e.effectiveFilterHeight,I=e.effectiveFilterWidth,v=e.padInfo.front,b=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const S=t==="avg";let w="0.0";if(S||(w="-1.0 / 1e-20"),r){const z=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${c}, ${l});
        const ivec3 pads = ivec3(${v}, ${b}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${I};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${z} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${I} +
                      wR * ${I} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let N=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(N="avgValue / max(count, 1.0)");const E=Math.floor(a/4)*4,A=a%4,M=`
      if (${S}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${c}, ${l});
      const ivec3 pads = ivec3(${v}, ${b}, ${y});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${E}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${M}
            }

            int xC = xCCorner + ${E};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${M}
            }
          }
        }
        setOutput(${N});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Wh(s,"avgPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:c}=r,l=1;ce(jr(a,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);const u=xi(s.shape,i,a,l,o,c);if(u.filterWidth===1&&u.filterHeight===1&&vn(u.inShape,u.outShape))return $s({inputs:{x:s},backend:t});const f=new Sf(u,"avg",!1);return t.runWebGLProgram(f,[s],"float32")}const ase={kernelName:Ig,backendName:"webgl",kernelFunc:ise};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dimRoundingMode:c,dataFormat:l}=r,u=[1,1,1],f=Xa(s.shape,i,a,u,o,c,l),d=new Px(f,"avg",!1);return t.runWebGLProgram(d,[s],"float32")}const cse={kernelName:bg,backendName:"webgl",kernelFunc:ose};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lse{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=c-1-e.padInfo.top,f=l-1-e.padInfo.left,d=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${f});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${l};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class use{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,f=e.effectiveFilterDepth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,m=f-1-e.padInfo.front,I=d-1-e.padInfo.top,v=p-1-e.padInfo.left,b=1/(t*r*s);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${I}, ${v});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${l}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i,{filterSize:o,strides:c,pad:l,dimRoundingMode:u}=r,f=[1,1,1],d=Xa(a.shape,o,c,f,l,u),p=new use(d);return t.runWebGLProgram(p,[s],a.dtype)}const hse={kernelName:ab,backendName:"webgl",kernelFunc:fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i;Wh([s,i],"avgPoolGrad");const{filterSize:o,strides:c,pad:l}=r,u=xi(a.shape,o,c,1,l),f=new lse(u);return t.runWebGLProgram(f,[s],a.dtype)}const pse={kernelName:ib,backendName:"webgl",kernelFunc:dse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:i}=e,{transposeA:a,transposeB:o}=r;return Zp({a:s,b:i,transposeA:a,transposeB:o,backend:t})}const mse={kernelName:yg,backendName:"webgl",kernelFunc:gse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vse{constructor(e,t,r,s,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Ut(e,t),Ut(e,r);let o="0.0";s!=null&&(Ut(e,s),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let c="1.0";i!=null&&(Ut(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ise{constructor(e,t,r,s,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ut(e,t),Ut(e,r);let o="vec4(0.0)";s!=null&&(Ut(e,s),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let c="vec4(1.0)";i!=null&&(Ut(e,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bse=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:s,variance:i,offset:a,scale:o}=n;ce(s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ce(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ce(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=t;c==null&&(c=.001);const l=[r,s,i];let u=null;a!=null&&(u=a.shape,l.push(a));let f=null;o!=null&&(f=o.shape,l.push(o));const d=Ge().getBool("WEBGL_PACK_NORMALIZATION")?new Ise(r.shape,s.shape,i.shape,u,f,c):new vse(r.shape,s.shape,i.shape,u,f,c);return e.runWebGLProgram(d,l,l[0].dtype)},yse={kernelName:Og,backendName:"webgl",kernelFunc:bse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xse{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Rn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=wse(this.rank);let s;const i=e.map((a,o)=>`sourceLoc.${aI[o]} = start[${o}] + coords.${aI[o]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const aI=["x","y","z","w","u","v"];function wse(n){if(n===1)return"sourceLoc";if(n<=6)return aI.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sse{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Rn(this.rank),r=es("coords",this.rank),s=es("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,a=`getChannel(getSource(${s.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${a};
        --${s[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${a};
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((u,f)=>`start[${f}]`).join()});`:e.map((u,f)=>`${s[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${l}
        vec4 result = vec4(0.);
        ${o}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(n,e,t,r){const s=r.texData.get(n.dataId),i=r.makeTensorInfo(t,n.dtype),a=r.texData.get(i.dataId);Object.assign(a,s),a.refCount=1,a.shape=t,a.dtype=n.dtype;let o=_y(e,Rt(n.shape));s.slice&&(o+=s.slice.flatOffset),a.slice={flatOffset:o,origDataId:s.slice&&s.slice.origDataId||n.dataId};const c=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,c+1),i}function uu(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,size:a}=r,[o,c]=Sm(s,i,a);if($y(s,o,c),Ye(c)===0)return t.makeTensorInfo(c,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const f=t.texData.get(s.dataId),d=mne(f.values,o,c,s.shape,s.dtype);return t.makeTensorInfo(c,s.dtype,d)}const{isPacked:l}=t.texData.get(s.dataId),u=Oy(s.shape,o,c);if(l||!u){const f=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sse(c):new xse(c),d=[o];return t.runWebGLProgram(f,[s],s.dtype,d)}return t.uploadToGPU(s.dataId),Cse(s,o,c,t)}const Rse={kernelName:om,backendName:"webgl",kernelFunc:uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kse=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,crops:a}=r;ce(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((y,S)=>y*S),c=$h(s.shape,i,o),l=Nh(c.length,i.length),u=Oh(s.shape,i,o),f=Py(a,i.length),d=Ly(u,a,i.length),p=[],m=ut({inputs:{x:s},backend:t,attrs:{shape:c}}),I=ss({inputs:{x:m},backend:t,attrs:{perm:l}}),v=ut({inputs:{x:I},backend:t,attrs:{shape:u}}),b=uu({inputs:{x:v},backend:t,attrs:{begin:f,size:d}});return p.push(m),p.push(I),p.push(v),p.forEach(y=>t.disposeIntermediateTensorInfo(y)),b},Ese={kernelName:xg,backendName:"webgl",kernelFunc:kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a}=r,o=t.readSync(s.dataId),c=t.readSync(i.dataId),l=QO(o,c,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,l)}const Ase={kernelName:ob,backendName:"webgl",kernelFunc:Tse};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $se=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Nse=`
  return float(int(a.r) & int(b.r));
`;function Ose(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,i=Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=Ge().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([r,s])||a===1){const c=t.texData.get(r.dataId).values,l=t.texData.get(s.dataId).values,[u,f]=Ute(r.shape,s.shape,c,l,r.dtype),d=t.makeTensorInfo(f,r.dtype),p=t.texData.get(d.dataId);return p.values=u,d}let o;return i?o=new cu($se,r.shape,s.shape,!1):o=new Nc(Nse,r.shape,s.shape),t.runWebGLProgram(o,[r,s],r.dtype)}const _se={kernelName:cb,backendName:"webgl",kernelFunc:Ose};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,i=t.readSync(r.dataId),a=t.readSync(s.dataId),o=Ut(Array.from(i),Array.from(a));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const Dse={kernelName:nE,backendName:"webgl",kernelFunc:Fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bse="return float(a != b);",d_=zr({opSnippet:Bse,cpuKernelImpl:one,dtype:"bool"}),Mse={kernelName:Xg,backendName:"webgl",kernelFunc:d_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hh(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return $s({inputs:{x:s.complexTensorInfos.real},backend:t})}const Pse={kernelName:Ob,backendName:"webgl",kernelFunc:Hh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lse="return float(int(x));";function Use(n,e){const t=new pa(n.shape,Lse),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oI(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:i}=r;if(i==="complex64"){if(s.dtype==="complex64")return $s({inputs:{x:s},backend:t});const a=Tr(s.shape),o=oI({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),c=zo({inputs:{real:o,imag:a},backend:t});return a.dispose(),t.disposeIntermediateTensorInfo(o),c}if(s.dtype==="complex64"){const a=Hh({inputs:{input:s},backend:t}),o=oI({inputs:{x:a},backend:t,attrs:{dtype:i}});return t.disposeIntermediateTensorInfo(a),o}if(!Zk(s.dtype,i)){const a=$s({inputs:{x:s},backend:t});return{dataId:a.dataId,shape:a.shape,dtype:i}}if(t.shouldExecuteOnCPU([s])){const a=t.texData.get(s.dataId).values,[o,c,l]=zte(a,s.shape,s.dtype,i);return t.makeTensorInfo(o,c,l)}if(i==="int32")return Use(s,t);if(i==="bool"){const a=t.makeTensorInfo([],"bool",Hr("bool",1)),c=d_({inputs:{a:s,b:a},backend:t});return t.disposeIntermediateTensorInfo(a),c}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${i}`)}const zse={kernelName:Mf,backendName:"webgl",kernelFunc:oI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dR="return ceil(x);",Vse=fn({opSnippet:dR,packedOpSnippet:dR,cpuKernelImpl:Vte}),Wse={kernelName:Pf,backendName:"webgl",kernelFunc:Vse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gse{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{clipValueMin:i,clipValueMax:a}=r;let o;Ge().getBool("WEBGL_PACK_CLIP")?o=new Hse(s.shape):o=new Gse(s.shape);const c=[[i],[a]];return t.runWebGLProgram(o,[s],s.dtype,c)}const jse={kernelName:Lf,backendName:"webgl",kernelFunc:qse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kse{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pR(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function Xse(n){const{inputs:e,backend:t}=n,{x:r}=e,s=t.texData.get(r.dataId),i=new Kse(r.shape),a=[pR(r,s.complexTensorInfos.real),pR(r,s.complexTensorInfos.imag)];return t.runWebGLProgram(i,a,a[0].dtype)}const Yse={kernelName:wg,backendName:"webgl",kernelFunc:Xse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zse{constructor(e){this.outputShape=[],this.outputShape=va(e,1),this.variableNames=e.map((a,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let a=1;a<t.length;a++)t[a]=t[a-1]+e[a][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<t.length;a++){const o=t[a-1];r.push(`else if (yC < ${t[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const s=t.length,i=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jse{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=va(e,t);const r=this.outputShape,s=r.length,i=Rn(s),a=es("coords",s),o=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((I,v)=>`T${v}`);const c=new Array(e.length-1);c[0]=e[0][t];for(let I=1;I<c.length;I++)c[I]=c[I-1]+e[I][t];const l=o[t],u=o.slice(-2),f=o.join();let d=`if (${l} < ${c[0]}) {
        return getChannel(
            getT0(${f}), vec2(${u.join()}));
        }`;for(let I=1;I<c.length;I++){const v=c[I-1];d+=`
        if (${l} < ${c[I]}  && ${l} >= ${c[I-1]}) {
          return getChannel(
            getT${I}(${ip(o,l,v)}),
            vec2(${ip(u,l,v)}));
        }`}const p=c.length,m=c[c.length-1];d+=`
        return getChannel(
          getT${p}(${ip(o,l,m)}),
          vec2(${ip(u,l,m)}));`,this.userCode=`
      float getValue(${o.map(I=>"int "+I)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[s-1]} = ${a[s-1]} + 1;
        if (${a[s-1]} < ${r[s-1]}) {
          result.g = getValue(${a});
        }

        ${a[s-2]} = ${a[s-2]} + 1;
        if (${a[s-2]} < ${r[s-2]}) {
          result.a = getValue(${a});
        }

        ${a[s-1]} = ${a[s-1]} - 1;
        if (${a[s-2]} < ${r[s-2]} &&
            ${a[s-1]} < ${r[s-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function ip(n,e,t){const r=n.indexOf(e);return n.map((i,a)=>a===r?`${i} - ${t}`:i).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wm(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return $s({inputs:{x:s.complexTensorInfos.imag},backend:t})}const Qse={kernelName:Cb,backendName:"webgl",kernelFunc:Wm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(n,e,t){const r=n[0].dtype;if(r==="complex64"){const p=n.map(y=>Hh({inputs:{input:y},backend:t})),m=n.map(y=>Wm({inputs:{input:y},backend:t})),I=rf(p,e,t),v=rf(m,e,t),b=zo({inputs:{real:I,imag:v},backend:t});return p.forEach(y=>t.disposeIntermediateTensorInfo(y)),m.forEach(y=>t.disposeIntermediateTensorInfo(y)),t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(v),b}let s=t.shouldExecuteOnCPU(n);if(r==="string"&&(s=!0),s){const p=n.map(w=>{const N=[-1,Ye(w.shape.slice(e))];return ut({inputs:{x:w},backend:t,attrs:{shape:N}})}),m=p.map(w=>({vals:t.readSync(w.dataId),shape:w.shape})),I=va(p.map(w=>w.shape),1),v=p[0].shape[0]===1,b=Wte(m,I,r,v),y=va(n.map(w=>w.shape),e),S=t.makeTensorInfo(y,r,b);return p.forEach(w=>t.disposeIntermediateTensorInfo(w)),S}const i=n.filter(p=>Ye(p.shape)>0),a=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&i[0].shape.length>1;if(i.length===1){const p=a?new pa(n[0].shape,go):new Io(n[0].shape,go);return t.runWebGLProgram(p,n,r)}const o=Ge().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(i.length>o){const p=[];for(let I=0;I<i.length;I+=o){const v=i.slice(I,I+o);p.push(rf(v,e,t))}const m=rf(p,e,t);for(const I of p)t.disposeIntermediateTensorInfo(I);return m}if(a){const p=new Jse(i.map(m=>m.shape),e);return t.runWebGLProgram(p,i,r)}const{tensors2D:c,outShape:l}=eie(i,e,t),u=new Zse(c.map(p=>p.shape)),f=t.runWebGLProgram(u,c,r);c.forEach(p=>t.disposeIntermediateTensorInfo(p));const d=ut({inputs:{x:f},attrs:{shape:l},backend:t});return t.disposeIntermediateTensorInfo(f),d}function eie(n,e,t){const r=va(n.map(i=>i.shape),e);return{tensors2D:n.map(i=>ut({inputs:{x:i},attrs:{shape:[-1,Ye(i.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,i=Yt(s,e[0].shape)[0],a=e.map(l=>l.shape);Dy(a,i);const o=va(e.map(l=>l.shape),i);if(Ye(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const c=e.filter(l=>Ye(l.shape)>0);return c.length===1?$s({inputs:{x:c[0]},backend:t}):rf(c,i,t)}const tie={kernelName:Sg,backendName:"webgl",kernelFunc:p_};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g_{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,o=e.padInfo.left,c=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,p=e.filterWidth,m=Math.floor(e.inChannels/4)*4,I=e.inChannels%4,v=e.dataFormat==="channelsLast",b=v?1:2,y=v?2:3,S=v?3:1;let w="",C="";r&&(s?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const N=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${c}, ${l});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${S}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${I===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${I===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${I===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${N}
        ${C}
        setOutput(result);
      }
    `}}class nie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,f=e.filterDepth,d=e.filterHeight,p=e.filterWidth,m=Math.floor(e.inChannels/4)*4,I=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${l};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${I===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${I===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${I===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m_{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kr(this.outputShape.length);const a=e.padInfo.left,o=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,f=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<u;v++)d+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;d+=`
     for (int r = 0; r < ${l}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<u;v++)d+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(f+1)/2;v++){const b=v*2;if(d+=`
           xC = xCCorner + ${b*c};
           `,o===1){if(b<u&&(a%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,c===1&&b>0?d+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<u)){const y=a%2===0?ZI(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,c>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:d+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):y===1?d+=`
                     xC${b+1} = xTexelC${b};
                     `:d+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<u&&(a%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<u&&(d+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<u&&(d+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<u&&(d+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let p="",m="";r&&(s?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:p=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const I=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${I}
         ${m}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rie{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Kr(this.outputShape.length);const{dataFormat:r}=t,s=is(),i=r==="channelsLast",a=i?1:2,o=i?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let u=0;u<=1;u++)for(let f=0;f<=1;f++)l+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${u};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${l}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jp(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function v_({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const c=n.shape,l=r.texData.get(n.dataId),u=t.inChannels,f=c[0]*c[1]*c[2],d=t.outChannels,p=t.dataFormat==="channelsLast",m=!1,I=!1;let v;const b=[];if(i!=null){const w=Jp(i.shape,p);w!=null&&(i=ut({inputs:{x:i},backend:r,attrs:{shape:w}}),b.push(i))}if(s!=null){const w=Jp(s.shape,p);w!=null&&(s=ut({inputs:{x:s},backend:r,attrs:{shape:w}}),b.push(s))}if(!((f===1||d===1)&&u>l_)&&l.isPacked&&p&&l.texture!=null&&c[2]%2!==0&&vn(l.shape.slice(-3),c.slice(-3))){const w=c[0]*c[1]*(c[2]+1),C={dataId:n.dataId,shape:[1,w,t.inChannels],dtype:n.dtype},N=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,ce(Yp(l.shape,C.shape),()=>`packed reshape ${l.shape} to ${C.shape} isn't free`);const E=ut({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});b.push(E);const A=Zp({a:C,b:E,backend:r,transposeA:m,transposeB:I,bias:s,activation:o,preluActivationWeights:i,leakyreluAlpha:a}),M=r.texData.get(A.dataId);ce(M.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=N,M.shape=t.outShape,v=$s({inputs:{x:A},backend:r}),v.shape=t.outShape,b.push(A)}else{const w=t.outHeight*t.outWidth,C=ut({inputs:{x:n},backend:r,attrs:{shape:p?[t.batchSize,w,t.inChannels]:[t.batchSize,t.inChannels,w]}}),N=ut({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),E=Zp({a:p?C:N,b:p?N:C,transposeA:!p,transposeB:I,backend:r,bias:s,activation:o,preluActivationWeights:i,leakyreluAlpha:a});v=ut({inputs:{x:E},backend:r,attrs:{shape:t.outShape}}),b.push(C),b.push(N),b.push(E)}for(const w of b)r.disposeIntermediateTensorInfo(w);return v}function I_({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:c,filterHeight:l,inChannels:u,outWidth:f,outHeight:d,dataFormat:p}=t,m=p==="channelsLast",I=c*l*u,v=d*f,b=[t.batchSize,I,v],y=!0,S=!1,w=[];if(i!=null){const me=Jp(i.shape,m);me!=null&&(i=ut({inputs:{x:i},backend:r,attrs:{shape:me}}),w.push(i))}if(s!=null){const me=Jp(s.shape,m);me!=null&&(s=ut({inputs:{x:s},backend:r,attrs:{shape:me}}),w.push(s))}const C=ut({inputs:{x:e},backend:r,attrs:{shape:[1,I,Ye(e.shape)/I]}});w.push(C);const N=new rie(b,t),E=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],A=r.runWebGLProgram(N,[n],"float32",E),M=ut({inputs:{x:A},backend:r,attrs:{shape:b}});w.push(A),w.push(M);const z=s!=null,Y=i!=null,re=o==="leakyrelu",ne=o?wf(o,!0):null,le=new c_(m?M.shape:C.shape,m?C.shape:M.shape,m?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],y,S,z,ne,Y,re),j=m?[M,C]:[C,M];if(s&&j.push(s),Y&&j.push(i),re){const me=r.makeTensorInfo([],"float32",Fo(a,"float32"));j.push(me),w.push(me)}const ge=r.runWebGLProgram(le,j,"float32"),Se=ut({inputs:{x:ge},backend:r,attrs:{shape:t.outShape}});w.push(ge);for(const me of w)r.disposeIntermediateTensorInfo(me);return Se}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dataFormat:c,dilations:l,dimRoundingMode:u}=r,f=Ya(c),d=Lr(s.shape,i.shape,a,l,o,u,!1,f);let p;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))p=v_({x:s,filter:i,convInfo:d,backend:t});else if(d.strideWidth<=2&&f==="channelsLast"&&Ge().getBool("WEBGL_EXP_CONV")){const I=new m_(d),v=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];p=t.runWebGLProgram(I,[s,i],"float32",v)}else if(Ge().getBool("WEBGL_CONV_IM2COL"))p=I_({x:s,filter:i,convInfo:d,backend:t});else{const I=new g_(d);p=t.runWebGLProgram(I,[s,i],"float32")}const m=ut({inputs:{x:p},backend:t,attrs:{shape:d.outShape}});return t.disposeIntermediateTensorInfo(p),m}const iie={kernelName:Cg,backendName:"webgl",kernelFunc:sie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class oie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,c=r-1-e.padInfo.left,l=a?1:2,u=a?2:3,f=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class cie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,c=t-1-e.padInfo.front,l=r-1-e.padInfo.top,u=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${l}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,f=Ya(c),d=Lr(s.shape,u,a,1,o,l,!1,f),p=new aie(d);return t.runWebGLProgram(p,[s,i],"float32")}const fie={kernelName:ub,backendName:"webgl",kernelFunc:uie};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hie{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Kr(this.outputShape.length);const t=e.filterHeight,r=e.filterWidth,s=t-1-e.padInfo.top,i=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{inputShape:a,strides:o,pad:c,dataFormat:l,dimRoundingMode:u}=r,f=Ya(l),d=Lr(a,i.shape,o,1,c,u,!1,f);if(Ge().getBool("WEBGL_PACK")&&f==="channelsLast"){const p=[[d.strideHeight,d.strideWidth]],m=new hie(d);return t.runWebGLProgram(m,[s,i],"float32",p)}else{const p=new oie(d);return t.runWebGLProgram(p,[s,i],"float32")}}const pie={kernelName:Rg,backendName:"webgl",kernelFunc:die};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:c}=r,l=Do(s.shape,i.shape,a,c,o),u=new nie(l);return t.runWebGLProgram(u,[s,i],"float32")}const mie={kernelName:kg,backendName:"webgl",kernelFunc:gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,pad:o,filterShape:c}=r,l=Do(s.shape,c,a,1,o),u=new cie(l);return t.runWebGLProgram(u,[s,i],"float32")}const Iie={kernelName:fb,backendName:"webgl",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{pad:a,strides:o,inputShape:c}=r,l=Do(c,i.shape,o,1,a),u=new lie(l);return t.runWebGLProgram(u,[s,i],"float32")}const yie={kernelName:hb,backendName:"webgl",kernelFunc:bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie=lu+`
  return cos(x);
`,wie=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Wc}
  return result;
`,Sie=fn({opSnippet:xie,packedOpSnippet:wie}),Cie={kernelName:Uf,backendName:"webgl",kernelFunc:Sie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rie=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,kie=fn({opSnippet:Rie}),Eie={kernelName:zf,backendName:"webgl",kernelFunc:kie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tie{constructor(e,t,r,s,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,c,l]=e,[u]=t,[f,d]=r;this.outputShape=[u,f,d,l];const p=s==="bilinear"?1:0,[m,I]=[`${o-1}.0`,`${c-1}.0`],[v,b,y]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[S,w,C]=d>1?[`${(c-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${I} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${I}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${S});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${w};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${I} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:i,boxInd:a}=e,{cropSize:o,method:c,extrapolationValue:l}=r,u=new Tie(s.shape,i.shape,o,c,l);return t.runWebGLProgram(u,[s,i,a],"float32")},$ie={kernelName:pb,backendName:"webgl",kernelFunc:Aie};var Cf;(function(n){n.Prod="*",n.Sum="+"})(Cf||(Cf={}));class gR{constructor(e,t,r,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,a=this.op===Cf.Prod?"1.0":"0.0",o=r?a:`getX(${mR(i,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let l="",u="";r?(l=s?`end != ${c-1}`:"end != 0",u=s?"end + 1":"end - 1"):(l=s?`end + pow2 < ${c}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Rn(i)} coords = getOutputCoords();
        int end = ${vR(i,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${l}) {
          int idx = ${u};
          ${vR(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${mR(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function mR(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function vR(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_(n,e,t,r,s,i){const a=e.shape.length,o=Kn([r],a);let c=e;o!=null&&(c=ss({inputs:{x:e},backend:t,attrs:{perm:o}}));const l=ir(1,a)[0];if(l!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=c.shape[l];let f=$s({inputs:{x:c},backend:t});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const p=new gR(n,c.shape,!1,i),m=[[d]],I=f;f=t.runWebGLProgram(p,[f],f.dtype,m),t.disposeIntermediateTensorInfo(I)}if(s){const d=new gR(n,c.shape,s,i),p=f;f=t.runWebGLProgram(d,[f],f.dtype),t.disposeIntermediateTensorInfo(p)}if(o!=null){const d=Bo(o),p=ss({inputs:{x:f},backend:t,attrs:{perm:d}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(c),p}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;return b_(Cf.Prod,s,t,i,a,o)}const Oie={kernelName:db,backendName:"webgl",kernelFunc:Nie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,exclusive:a,reverse:o}=r;return b_(Cf.Sum,s,t,i,a,o)}const Fie={kernelName:Eg,backendName:"webgl",kernelFunc:_ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:i}=e,{size:a,binaryOutput:o}=r;if(s.shape.length===1){const c=t.readSync(s.dataId),l=t.readSync(i.dataId),u=QO(c,l,i.dtype,i.shape,a);return t.makeTensorInfo([a],i.dtype,u)}else if(s.shape.length===2){const c=t.bufferSync(s),l=t.bufferSync(i),u=Lte(c,l,a,o);return t.makeTensorInfo(u.shape,i.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Bie={kernelName:gb,backendName:"webgl",kernelFunc:Die};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mie{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:i,dataFormat:a}=r,o=s.shape[0],c=a==="NHWC"?s.shape[1]:s.shape[2],l=a==="NHWC"?s.shape[2]:s.shape[3],u=a==="NHWC"?s.shape[3]:s.shape[1],f=c*i,d=l*i,p=u/(i*i),m=a==="NHWC"?[o,f,d,p]:[o,p,f,d],I=new Mie(m,i,a);return t.runWebGLProgram(I,[s],s.dtype)}const Lie={kernelName:mb,backendName:"webgl",kernelFunc:Pie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y_{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kr(this.outputShape.length);const a=e.filterHeight,o=e.filterWidth,c=e.outChannels/e.inChannels;let l="",u="";r&&(s?l=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?l=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:l=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${l}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x_{constructor(e,t=!1,r=null,s=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Kr(this.outputShape.length);const a=e.outChannels/e.inChannels,o=e.padInfo.left,c=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,f=e.filterWidth,d=f;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<f;b++)p+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;p+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let b=0;b<f;b++)p+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(d+1)/2;b++){const y=b*2;if(p+=`
          xC = xCCorner + ${y*l};
          `,c===1){if(y<f&&(o%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,l===1&&y>0?p+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<f)){const S=o%2===0?ZI(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${S};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,l>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:p+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):S===1?p+=`
                    xC${y+1} = xTexelC${y};
                    `:p+=`
                    xCOffset = xC + ${S};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<f&&(o%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<f&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<f&&(p+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<f&&(p+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<f&&(p+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let m="",I="";r&&(s?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,I="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${I}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:c,dimRoundingMode:l}=r;let u=c;u==null&&(u=[1,1]),ce(jr(a,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const f=Lr(s.shape,i.shape,a,u,o,l,!0);let d;Ge().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?d=new x_(f):d=new y_(f);const p=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(d,[s,i],"float32",p)}const zie={kernelName:Tg,backendName:"webgl",kernelFunc:Uie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Wie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=r-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:i}=e,{strides:a,dilations:o,pad:c,dimRoundingMode:l,filterShape:u}=r,f=Lr(s.shape,u,a,o,c,l,!0),d=new Vie(f);return t.runWebGLProgram(d,[s,i],"float32")}const Hie={kernelName:vb,backendName:"webgl",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qie(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:i}=e,{strides:a,dilations:o,pad:c,dimRoundingMode:l,inputShape:u}=r,f=Lr(u,i.shape,a,o,c,l,!0),d=new Wie(f);return t.runWebGLProgram(d,[s,i],"float32")}const jie={kernelName:Ib,backendName:"webgl",kernelFunc:qie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kie{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(n){const{inputs:e,backend:t}=n,{x:r}=e,s=[...r.shape,...r.shape],i=Ye(r.shape),a=ut({inputs:{x:r},backend:t,attrs:{shape:[i]}}),o=new Kie(i),c=t.runWebGLProgram(o,[a],a.dtype),l=ut({inputs:{x:c},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(c),l}const Yie={kernelName:rE,backendName:"webgl",kernelFunc:Xie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:s,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:c,dilationHeight:l,dilationWidth:u}=e,{top:f,left:d}=s;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${f}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${l};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i}=e,{strides:a,pad:o,dilations:c}=r,l=Rh(s.shape,i.shape,a,o,"NHWC",c);let u;const f=new Zie(l);u=t.runWebGLProgram(f,[s,i],"float32");const d=ut({inputs:{x:u},backend:t,attrs:{shape:l.outShape}});return t.disposeIntermediateTensorInfo(u),d}const Qie={kernelName:Ag,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eae(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,i=e,{allDims:a,summedDims:o,idDims:c}=jy(s,i.length);Xy(a.length,c,i);const{path:l,steps:u}=Yy(o,c),f=u.length;let d=null,p=a.length;const m=[];for(let I=0;I<f;++I){for(const v of u[I]){const{permutationIndices:b,expandDims:y}=Ky(p,c[v]);let S;Zy(b)?S=i[v]:(S=ss({inputs:{x:i[v]},backend:t,attrs:{perm:b}}),m.push(S));const w=S.shape.slice();for(let C=0;C<y.length;++C)w.splice(y[C],0,1);vn(S.shape,w)||(S=ut({inputs:{x:S},backend:t,attrs:{shape:w}}),m.push(S)),d===null?d=S:(d=Mx({inputs:{a:S,b:d},backend:t}),m.push(d))}I<f-1&&(l[I]>=0&&(d=Vm({inputs:{x:d},backend:t,attrs:{axis:l[I]-(a.length-p),keepDims:!1}}),m.push(d)),p--)}for(const I of m)I!==d&&t.disposeIntermediateTensorInfo(I);return d}const tae={kernelName:sE,backendName:"webgl",kernelFunc:eae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae="return (x >= 0.0) ? x : (exp(x) - 1.0);",rae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,sae=fn({opSnippet:nae,packedOpSnippet:rae}),iae={kernelName:Wf,backendName:"webgl",kernelFunc:sae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae="return (b >= 0.0) ? a : a * (b + 1.0);",oae=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,cae=n=>{const{inputs:e,backend:t}=n,{dy:r,y:s}=e,i=Ge().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new cu(oae,r.shape,s.shape):new Nc(aae,r.shape,s.shape);return t.runWebGLProgram(i,[r,s],r.dtype)},lae={kernelName:bb,backendName:"webgl",kernelFunc:cae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae=`
  return vec4(equal(a, b));
`,fae="return float(a == b);",hae=zr({opSnippet:fae,packedOpSnippet:uae,dtype:"bool",cpuKernelImpl:Gte}),dae={kernelName:$g,backendName:"webgl",kernelFunc:hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Uy};
  float a1 = ${zy};
  float a2 = ${Vy};
  float a3 = ${Wy};
  float a4 = ${Gy};
  float a5 = ${Hy};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,gae=fn({opSnippet:pae}),mae={kernelName:Gf,backendName:"webgl",kernelFunc:gae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae=lu+`
  return exp(x);
`,Iae=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,w_=fn({opSnippet:vae,packedOpSnippet:Iae,cpuKernelImpl:Hte,dtype:"float32"}),bae={kernelName:Hf,backendName:"webgl",kernelFunc:w_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cI(n){const{inputs:e,attrs:t,backend:r}=n,{dim:s}=t,{input:i}=e,a=i.shape.length,o=i.shape.slice();let c=s;return s<0&&(ce(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),c=a+s+1),o.splice(c,0,1),ut({inputs:{x:i},backend:r,attrs:{shape:o}})}const yae={kernelName:Ng,backendName:"webgl",kernelFunc:cI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IR="return exp(x) - 1.0;",xae=fn({opSnippet:IR,packedOpSnippet:IR,cpuKernelImpl:qte}),wae={kernelName:qf,backendName:"webgl",kernelFunc:xae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bR{constructor(e,t,r){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${s}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_(n,e,t){const r=t.texData.get(n.dataId),s=Ye(n.shape),i=n.shape[n.shape.length-1],a=s/i,o=ut({inputs:{x:n},backend:t,attrs:{shape:[a,i]}}),c=o.shape,l=new bR("real",c,e),u=new bR("imag",c,e),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],d=t.runWebGLProgram(l,f,"float32"),p=t.runWebGLProgram(u,f,"float32"),m=zo({inputs:{real:d,imag:p},backend:t});t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p);const I=ut({inputs:{x:m},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(m),I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sae(n){const{inputs:e,backend:t}=n,{input:r}=e;return S_(r,!1,t)}const Cae={kernelName:yb,backendName:"webgl",kernelFunc:Sae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rae{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(n){const{backend:e,attrs:t}=n,{shape:r,value:s}=t;let{dtype:i}=t;if(i=i||Kl(s),i==="string"){const a=nr(i,Ye(r));return a.fill(s),e.makeTensorInfo(r,i,a)}else{const a=new Rae(r,s),o=[[s]];return e.runWebGLProgram(a,[],i,o)}}const kae={kernelName:xb,backendName:"webgl",kernelFunc:qh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eae{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tae={kernelName:wb,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,s=new Eae(t.shape);return r.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yR="return floor(x);",Aae=fn({opSnippet:yR,packedOpSnippet:yR,cpuKernelImpl:jte}),$ae={kernelName:jf,backendName:"webgl",kernelFunc:Aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Oae=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,_ae=zr({opSnippet:Nae,packedOpSnippet:Oae,dtype:"int32"}),Fae={kernelName:Kf,backendName:"webgl",kernelFunc:_ae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dae{constructor(e){this.variableNames=["A"];const t=is(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=is(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae={kernelName:iU,backendName:"webgl",kernelFunc:Pae};let dl,V1=Ge().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Pae(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:s}=e;const{numChannels:i}=r,a=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[c,l]=a?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[l,c],f=[l,c,i];if(o||a){const I=Ge().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(dl==null||I!==V1)&&(V1=I,dl=document.createElement("canvas").getContext("2d",{willReadFrequently:V1})),dl.canvas.width=c,dl.canvas.height=l,dl.drawImage(s,0,0,c,l),s=dl.canvas}const d=t.makeTensorInfo(u,"int32");t.texData.get(d.dataId).usage=Vs.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(d.dataId),s);const p=Ge().getBool("WEBGL_PACK")?new Bae(f):new Dae(f),m=t.runWebGLProgram(p,[d],"int32");return t.disposeData(d.dataId),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:c,pad:l,dataFormat:u,dilations:f,dimRoundingMode:d,activation:p,leakyreluAlpha:m}=r,I=Ya(u),v=Lr(s.shape,i.shape,c,f,l,d,!1,I);let b;const y=[],S=a!=null,w=o!=null,C=p==="leakyrelu",N=()=>{const A=[s,i],M=(z,Y)=>{if(Y==="NCHW"&&z.shape.length===1&&z.shape[0]!==1){const re=ut({inputs:{x:z},backend:t,attrs:{shape:[z.shape[0],1,1]}});return y.push(re),re}return z};if(S&&A.push(M(a,u)),w&&A.push(M(o,u)),C){const z=t.makeTensorInfo([],"float32",Fo(m,"float32"));A.push(z),y.push(z)}return A};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))b=v_({x:s,filter:i,convInfo:v,backend:t,bias:a,activation:p,preluActivationWeights:o,leakyreluAlpha:m});else if(v.strideWidth<=2&&I==="channelsLast"&&Ge().getBool("WEBGL_EXP_CONV")){const A=p?wf(p,!0):null,M=new m_(v,S,A,w,C),z=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],Y=N();b=t.runWebGLProgram(M,Y,"float32",z)}else if(Ge().getBool("WEBGL_CONV_IM2COL"))b=I_({x:s,filter:i,convInfo:v,backend:t,bias:a,activation:p,preluActivationWeights:o,leakyreluAlpha:m});else{const A=p?wf(p,!1):null,M=new g_(v,S,A,w,C),z=N();b=t.runWebGLProgram(M,z,"float32")}const E=ut({inputs:{x:b},backend:t,attrs:{shape:v.outShape}});return y.push(b),y.forEach(A=>t.disposeIntermediateTensorInfo(A)),E}const Uae={kernelName:Ep,backendName:"webgl",kernelFunc:Lae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:i,bias:a,preluActivationWeights:o}=e,{strides:c,pad:l,dilations:u,dimRoundingMode:f,activation:d,leakyreluAlpha:p}=r,m=[];let I=u;I==null&&(I=[1,1]),ce(jr(c,I),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${I}'`);const v=Lr(s.shape,i.shape,c,I,l,f,!0),b=Ge().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,y=d?wf(d,b):null,S=[s,i],w=a!=null,C=o!=null,N=d==="leakyrelu";if(w&&S.push(a),C&&S.push(o),N){const z=t.makeTensorInfo([],"float32",Fo(p,"float32"));S.push(z),m.push(z)}let E;b?E=new x_(v,w,y,C,N):E=new y_(v,w,y,C,N);const A=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],M=t.runWebGLProgram(E,S,"float32",A);return m.forEach(z=>t.disposeIntermediateTensorInfo(z)),M}const Vae={kernelName:SE,backendName:"webgl",kernelFunc:zae};class Wae{constructor(e,t,r,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const i=Rn(r.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gae(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,i=s.shape,a=i[i.length-1],o=Ye(r.shape),[c,l,u,f]=Ay(r,s),d=ut({inputs:{x:s},backend:t,attrs:{shape:[l,a]}}),p=ut({inputs:{x:r},backend:t,attrs:{shape:[Ye(r.shape)/u,u]}});if(t.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const b=t.readSync(s.dataId),y=t.bufferSync(r),S=Kte(b,y,r.dtype,l,a,u,f,r.shape,o);return t.makeTensorInfo(c,r.dtype,S.values)}const m=new Wae(a,f,[l,u],r.shape),I=t.runWebGLProgram(m,[p,d],p.dtype),v=ut({inputs:{x:I},backend:t,attrs:{shape:c}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(I),v}const Hae={kernelName:iE,backendName:"webgl",kernelFunc:Gae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qae{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=Rn(this.rank),s=jae(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function jae(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<n.length;s++)s===2?r.push("index"):r.push(`${t[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:i}=e,{axis:a,batchDims:o}=r,c=Yt(a,s.shape)[0];if(Ge().get("DEBUG")){const y=t.readSync(i.dataId),S=s.shape[c];for(let w=0;w<y.length;++w){const C=y[w];ce(C<=S-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${S-1}]`)}}const l=Qy(s,i,c,o),u=Ye(i.shape),f=[],d=ut({inputs:{x:s},backend:t,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=ut({inputs:{x:i},backend:t,attrs:{shape:[l.batchSize,u/l.batchSize]}});f.push(d),f.push(p);const m=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(t.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const y=t.bufferSync(p),S=t.bufferSync(d),w=Xte(S,y,m);return f.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(l.outputShape,w.dtype,w.values)}const I=new qae(d.shape,m),v=t.runWebGLProgram(I,[d,p],d.dtype);f.push(v);const b=ut({inputs:{x:v},backend:t,attrs:{shape:l.outputShape}});return f.forEach(y=>t.disposeIntermediateTensorInfo(y)),b}const Kae={kernelName:_g,backendName:"webgl",kernelFunc:C_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xae="return float(a > b);",Yae=`
  return vec4(greaterThan(a, b));
`,Zae=zr({opSnippet:Xae,packedOpSnippet:Yae,cpuKernelImpl:Yte,dtype:"bool"}),Jae={kernelName:Fg,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae="return float(a >= b);",eoe=`
  return vec4(greaterThanEqual(a, b));
`,toe=zr({opSnippet:Qae,packedOpSnippet:eoe,dtype:"bool",cpuKernelImpl:Zte}),noe={kernelName:Xf,backendName:"webgl",kernelFunc:toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(n){const{inputs:e,backend:t}=n,{input:r}=e;return S_(r,!0,t)}const soe={kernelName:Sb,backendName:"webgl",kernelFunc:roe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe="return float(!isnan(x) && !isinf(x));",aoe=fn({opSnippet:ioe,dtype:"bool"}),ooe={kernelName:Zf,backendName:"webgl",kernelFunc:aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe="return float(isinf(x));",loe=fn({opSnippet:coe,dtype:"bool"}),uoe={kernelName:Jf,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const foe="return float(isnan(x));",hoe=fn({opSnippet:foe,dtype:"bool"}),doe={kernelName:Qf,backendName:"webgl",kernelFunc:hoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const poe="return float(a < b);",goe=`
  return vec4(lessThan(a, b));
`,moe=zr({opSnippet:poe,packedOpSnippet:goe,cpuKernelImpl:Jte,dtype:"bool"}),voe={kernelName:Bg,backendName:"webgl",kernelFunc:moe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe="return float(a <= b);",boe=`
  return vec4(lessThanEqual(a, b));
`,yoe=zr({opSnippet:Ioe,packedOpSnippet:boe,cpuKernelImpl:Qte,dtype:"bool"}),xoe={kernelName:Mg,backendName:"webgl",kernelFunc:yoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:i}=t,a=ene(r,s,i);return e.makeTensorInfo([a.length],"float32",a)}const Soe={kernelName:aE,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe=lu+`
  return x < 0.0 ? 0./0. : log(x);
`,Roe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,koe=fn({opSnippet:Coe,packedOpSnippet:Roe,cpuKernelImpl:tne}),Eoe={kernelName:eh,backendName:"webgl",kernelFunc:koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Toe=lu+`
  return log(1.0 + x);
`,Aoe=fn({opSnippet:Toe}),$oe={kernelName:th,backendName:"webgl",kernelFunc:Aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe="return float(a >= 1.0 && b >= 1.0);",Ooe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,_oe=zr({opSnippet:Noe,packedOpSnippet:Ooe,dtype:"bool"}),Foe={kernelName:Pg,backendName:"webgl",kernelFunc:_oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Doe="return float(!(x >= 1.0));",Boe=fn({opSnippet:Doe}),Moe={kernelName:Lg,backendName:"webgl",kernelFunc:Boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Poe="return float(a >= 1.0 || b >= 1.0);",Loe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Uoe=zr({opSnippet:Poe,packedOpSnippet:Loe,dtype:"bool"}),zoe={kernelName:Ug,backendName:"webgl",kernelFunc:Uoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[];const a=t,o=e[3]-1;this.outputShape=e;let c;const l=`float(${r}) + float(${s}) * sum`;i===.5?c=`inversesqrt(${l})`:i===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Woe{constructor(e,t,r,s,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=t,o=e[3]-1;this.outputShape=e;let c;const l=`float(${r}) + float(${s}) * sum`;i===.5?c=`inversesqrt(${l})`:i===1?c=`1.0/(${l})`:c=`exp(log(${l}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:i,bias:a,alpha:o,beta:c}=r,l=Ge().getBool("WEBGL_PACK_NORMALIZATION")?new Woe(s.shape,i,a,o,c):new Voe(s.shape,i,a,o,c);return t.runWebGLProgram(l,[s],s.dtype)},Hoe={kernelName:zg,backendName:"webgl",kernelFunc:Goe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qoe{constructor(e,t,r,s,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=s,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s,y:i,dy:a}=e,{depthRadius:o,bias:c,alpha:l,beta:u}=r,f=new qoe(s.shape,o,c,l,u);return t.runWebGLProgram(f,[s,i,a],s.dtype)},Koe={kernelName:Rb,backendName:"webgl",kernelFunc:joe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(n,e,t,r){const s=Ye(e),a=Ye(n.shape)/s,o=ut({inputs:{x:n},attrs:{shape:[a,s]},backend:r}),c=Gc(o,n.dtype,"max",r),l=ut({inputs:{x:c},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(c),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:i,keepDims:a}=r,o=s.shape.length,c=Yt(i,s.shape);let l=c;const u=Kn(l,o),f=u!=null,d=t.shouldExecuteOnCPU([s]);let p=s;if(f){if(d){const S=t.texData.get(p.dataId).values,w=new Array(o);for(let E=0;E<w.length;E++)w[E]=s.shape[u[E]];const C=Dx(S,s.shape,s.dtype,u,w);p=t.makeTensorInfo(w,s.dtype);const N=t.texData.get(p.dataId);N.values=C}else p=zm(s,u,t);l=ir(l.length,o)}Ur("max",l,o);const[m,I]=$r(p.shape,l);let v=m;a&&(v=mr(m,c));let b;if(d){const S=t.texData.get(p.dataId).values,w=nne(S,Ye(I),v,s.dtype);b=t.makeTensorInfo(v,s.dtype);const C=t.texData.get(b.dataId);C.values=w}else b=Xoe(p,I,v,t);return f&&t.disposeIntermediateTensorInfo(p),b}const Yoe={kernelName:Vg,backendName:"webgl",kernelFunc:R_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zoe=Bx+`
  return max(a, b);
`,Joe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,Qoe=zr({opSnippet:Zoe,packedOpSnippet:Joe,cpuKernelImpl:rne}),ece={kernelName:nh,backendName:"webgl",kernelFunc:Qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;Wh(s,"maxPool");const{filterSize:i,strides:a,pad:o,dimRoundingMode:c}=r,l=1;ce(jr(a,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);const u=xi(s.shape,i,a,l,o,c);if(u.filterWidth===1&&u.filterHeight===1&&vn(u.inShape,u.outShape))return $s({inputs:{x:s},backend:t});const f=new Sf(u,"max",!1);return t.runWebGLProgram(f,[s],s.dtype)}const nce={kernelName:Wg,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:i,strides:a,pad:o,dataFormat:c,dimRoundingMode:l}=r,u=[1,1,1],f=Xa(s.shape,i,a,u,o,l,c),d=new Px(f,"max",!1);return t.runWebGLProgram(d,[s],s.dtype)}const sce={kernelName:Gg,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ice{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,c=a-1-e.padInfo.left,l=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class ace{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,f=c-1-e.padInfo.front,d=l-1-e.padInfo.top,p=u-1-e.padInfo.left,m=c*l*u-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${d}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${l};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${l} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i}=e,a=i,{filterSize:o,strides:c,pad:l,dimRoundingMode:u}=r,f=[1,1,1],d=Xa(a.shape,o,c,f,l,u),p=new Px(d,"max",!0),m=t.runWebGLProgram(p,[a],a.dtype),I=new ace(d),v=t.runWebGLProgram(I,[s,m],a.dtype);return t.disposeIntermediateTensorInfo(m),v}const cce={kernelName:Eb,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:i,output:a}=e,o=i;Wh([i,a],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:f}=r,d=xi(o.shape,c,l,1,u,f),p=!0,m=new Sf(d,"max",p),I=t.runWebGLProgram(m,[o],o.dtype),v=new ice(d),b=t.runWebGLProgram(v,[s,I],o.dtype);return t.disposeIntermediateTensorInfo(I),b}const uce={kernelName:kb,backendName:"webgl",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(n,e,t,r){let s=new Sf(t,"max",!1);const i=r.runWebGLProgram(s,[n],"float32");s=new Sf(t,"max",!0,!0,e);const a=r.runWebGLProgram(s,[n],"float32");return[i,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce={kernelName:oE,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:i,pad:a,includeBatchInIndex:o}=e,c=t;ce(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];ce(jr(i,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const u=xi(r.shape,s,i,l,a),[f,d]=fce(r,o,u,c);return[f,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n,e,t,r){const s=Ye(e),a=Ye(n.shape)/s,o=ut({inputs:{x:n},attrs:{shape:[a,s]},backend:r}),c=Gc(o,"float32","mean",r),l=ut({inputs:{x:c},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(c),l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pce={kernelName:Hg,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:s,axis:i}=e,a=t,o=r.shape.length,c=Yt(i,r.shape);let l=c;const u=Kn(l,o),f=u!=null,d=a.shouldExecuteOnCPU([r]),p=[];let m=r;if(f){if(d){const w=a.texData.get(m.dataId).values,C=new Array(o);for(let A=0;A<C.length;A++)C[A]=r.shape[u[A]];const N=Dx(w,r.shape,r.dtype,u,C);m=a.makeTensorInfo(C,r.dtype);const E=a.texData.get(m.dataId);E.values=N}else m=zm(r,u,a);p.push(m),l=ir(l.length,o)}Ur("sum",l,o);const[I,v]=$r(m.shape,l);let b=I;s&&(b=mr(I,c));const y=dce(m,v,b,a);for(const S of p)a.disposeIntermediateTensorInfo(S);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,c=Yt(i,s.shape);let l=c;const u=Kn(l,o);let f=s;u!=null&&(f=ss({inputs:{x:s},backend:t,attrs:{perm:u}}),l=ir(l.length,s.shape.length)),Ur("min",l,o);const[d,p]=$r(f.shape,l),m=Ye(p),I=ut({inputs:{x:f},backend:t,attrs:{shape:[-1,m]}}),v=Gc(I,I.dtype,"min",t);let b;if(a){const y=mr(d,c);b=ut({inputs:{x:v},backend:t,attrs:{shape:y}})}else b=ut({inputs:{x:v},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(v),u!=null&&t.disposeIntermediateTensorInfo(f),b}const mce={kernelName:qg,backendName:"webgl",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vce=Bx+`
  return min(a, b);
`,Ice=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Wc+`
  return result;
`,bce=zr({opSnippet:vce,packedOpSnippet:Ice,cpuKernelImpl:sne}),yce={kernelName:rh,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xce{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((u,f)=>u[0]+e[f]+u[1]);const s=e.length,i=Rn(s),a=t.map(u=>u[0]).join(","),o=t.map((u,f)=>u[0]+e[f]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),l=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${l};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${l};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${l};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wce{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((m,I)=>m[0]+e[I]+m[1]);const s=e.length,i=Rn(s),a=t.map(m=>m[0]).join(","),o=t.map((m,I)=>m[0]+e[I]).join(","),c=es("rc",s),l=es("source",s),u=`${c[s-1]} < ${this.outputShape[s-1]}`,f=s===1?"source":`vec2(${l.slice(-2).join()})`,d=r==="reflect"?0:1;let p="";if(s===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${c[s-1]} += 1;
        if(${u}) {
          ${m}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;p=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${l.join()}), ${f});
        ${c[s-1]} += 1;
        if(${u}) {
          ${m}
          result[1] = getChannel(getX(${l.join()}), ${f});
        }
        rc = outputLoc;
        ${c[s-2]} += 1;
        if(${c[s-2]} < ${this.outputShape[s-2]}) {
          ${m}
          result[2] = getChannel(getX(${l.join()}), ${f});
          ${c[s-1]} += 1;
          if(${u}) {
            ${m}
            result[3] = getChannel(getX(${l.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:s,mode:i}=t,a=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wce(r.shape,s,i):new xce(r.shape,s,i);return e.runWebGLProgram(a,[r],r.dtype)},Cce={kernelName:jg,backendName:"webgl",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce=`if (b == 0.0) return NAN;
  return mod(a, b);`,kce=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Wc+`
  return result;
`,Ece=zr({opSnippet:Rce,packedOpSnippet:kce}),Tce={kernelName:sh,backendName:"webgl",kernelFunc:Ece};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ace{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ce=`
if (a == b) {
  return 1.0;
};
return a / b;`,Nce=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,k_=zr({opSnippet:$ce,packedOpSnippet:Nce,checkOutOfBounds:!0}),Oce={kernelName:Vf,backendName:"webgl",kernelFunc:k_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xR="return a - b;",E_=zr({opSnippet:xR,packedOpSnippet:xR,supportsComplex:!0,cpuKernelImpl:Rne}),_ce={kernelName:yh,backendName:"webgl",kernelFunc:E_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:i}=r,a=Yt([i],s.shape),o=R_({inputs:{x:s},backend:t,attrs:{reductionIndices:a,keepDims:!1}}),c=mr(o.shape,a),l=ut({inputs:{x:o},backend:t,attrs:{shape:c}}),u=E_({inputs:{a:s,b:l},backend:t}),f=w_({inputs:{x:u},backend:t}),d=Vm({inputs:{x:f},backend:t,attrs:{axis:a,keepDims:!1}}),p=ut({inputs:{x:d},backend:t,attrs:{shape:c}}),m=k_({inputs:{a:f,b:p},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),m}const Fce={kernelName:fm,backendName:"webgl",kernelFunc:T_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:i,seed:a,normalized:o}=r,c=o?s:T_({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),l=c.shape[0],u=c.shape[1],f=new Ace(l,u,i),d=[[a]],p=t.runWebGLProgram(f,[c],"int32",d);return o||t.disposeIntermediateTensorInfo(c),p}const Bce={kernelName:cE,backendName:"webgl",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mce=Si+`
  return -x;
`,Pce=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Lce(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId),[a,o]=ane(i.values,r.shape,r.dtype);return t.makeTensorInfo(o,r.dtype,a)}let s;return Ge().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Io(r.shape,Pce):s=new pa(r.shape,Mce),t.runWebGLProgram(s,[r],r.dtype)}const Uce={kernelName:Kg,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce=Cy;function Vce(n){Ls("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c}=r,l=t.readSync(s.dataId),u=t.readSync(i.dataId),{selectedIndices:f}=zce(l,u,a,o,c);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Wce={kernelName:Tb,backendName:"webgl",kernelFunc:Vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=Ry;function Hce(n){Ls("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c,padToMaxOutputSize:l}=r,u=t.readSync(s.dataId),f=t.readSync(i.dataId),{selectedIndices:d,validOutputs:p}=Gce(u,f,a,o,c,l);return[t.makeTensorInfo([d.length],"int32",new Int32Array(d)),t.makeTensorInfo([],"int32",new Int32Array([p]))]}const qce={kernelName:Ab,backendName:"webgl",kernelFunc:Hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jce=ky;function Kce(n){Ls("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:i}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:c,softNmsSigma:l}=r,u=t.readSync(s.dataId),f=t.readSync(i.dataId),d=a,p=o,m=c,I=l,{selectedIndices:v,selectedScores:b}=jce(u,f,d,p,m,I);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const Xce={kernelName:$b,backendName:"webgl",kernelFunc:Kce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yce{constructor(e,t,r,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:i,depth:a,onValue:o,offValue:c}=r,l=Ye(s.shape),u=new Yce(l,a,o,c),f=ut({inputs:{x:s},backend:t,attrs:{shape:[l]}}),d=t.runWebGLProgram(u,[f],i);t.disposeIntermediateTensorInfo(f);const p=[...s.shape,a],m=ut({inputs:{x:d},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(d),m},Jce={kernelName:Zg,backendName:"webgl",kernelFunc:Zce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const s=Hh({inputs:{input:r},backend:t}),i=Qp({inputs:{x:s},backend:t}),a=Wm({inputs:{input:r},backend:t}),o=Qp({inputs:{x:a},backend:t}),c=zo({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),c}else return qh({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const Qce={kernelName:pm,backendName:"webgl",kernelFunc:Qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Hh({inputs:{input:r},backend:t}),i=A_({inputs:{x:s},backend:t}),a=Wm({inputs:{input:r},backend:t}),o=Qp({inputs:{x:a},backend:t}),c=zo({inputs:{real:i,imag:o},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(o),c}else return qh({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const ele={kernelName:Yg,backendName:"webgl",kernelFunc:A_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return cI({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const i=e[0].shape,a=e[0].dtype;e.forEach(u=>{JI(i,u.shape,"All tensors passed to stack must have matching shapes"),ce(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],c=e.map(u=>{const f=cI({inputs:{input:u},backend:t,attrs:{dim:s}});return o.push(f),f}),l=p_({inputs:c,backend:t,attrs:{axis:s}});return o.forEach(u=>t.disposeIntermediateTensorInfo(u)),l}const nle={kernelName:Jg,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rle{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((l,u)=>l[0]+e[u]+l[1]);const s=e.length,i=Rn(s),a=t.map(l=>l[0]).join(","),o=t.map((l,u)=>l[0]+e[u]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sle{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((I,v)=>I[0]+e[v]+I[1]);const s=e.length,i=Rn(s),a=t.map(I=>I[0]).join(","),o=t.map((I,v)=>I[0]+e[v]).join(","),c=es("rc",s),l=es("source",s),u=`${c[s-1]} < ${this.outputShape[s-1]}`,f=s===1?"source":`vec2(${l.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${c[s-1]} += 1;
       if(${u}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${c[s-2]} += 1;
       if(${c[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${c[s-1]} += 1;
         if(${u}) {`],p=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let I=0,v=s===1?2:4;I<v;I++)m+=`
        ${d[I]}
        if (${p}) {
          result[${I}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${I}] = getChannel(getX(${l.join()}), ${f});
        }
      `;m+=s===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:i,constantValue:a}=r;if(Ye(s.shape)===0){const l=i.map((u,f)=>u[0]+s.shape[f]+u[1]);return qh({backend:t,attrs:{shape:l,value:a,dtype:s.dtype}})}const o=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sle(s.shape,i,a):new rle(s.shape,i,a),c=[[a]];return t.runWebGLProgram(o,[s],s.dtype,c)},ile={kernelName:Qg,backendName:"webgl",kernelFunc:$_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,ole=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Wc+`
  return result;
`,cle=zr({opSnippet:ale,packedOpSnippet:ole}),lle={kernelName:ah,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:i,keepDims:a}=r,o=s.shape.length,c=[],l=Yt(i,s.shape);let u=l;const f=Kn(u,o);let d=s;f!=null&&(d=ss({inputs:{x:s},backend:t,attrs:{perm:f}}),u=ir(u.length,o),c.push(d)),Ur("prod",u,o);let p;if(t.shouldExecuteOnCPU([d])){const m=t.texData.get(d.dataId).values,{outVals:I,outShape:v,outDtype:b}=cne(d.shape,d.dtype,m,u);p=t.makeTensorInfo(v,b,I)}else{const[m,I]=$r(d.shape,u),v=Ye(I),b=ut({inputs:{x:d},backend:t,attrs:{shape:[-1,v]}}),y=Wb(s.dtype),S=Gc(b,y,"prod",t);p=ut({inputs:{x:S},backend:t,attrs:{shape:m}}),c.push(b),c.push(S)}if(a){c.push(p);const m=mr(p.shape,l);p=ut({inputs:{x:p},backend:t,attrs:{shape:m}})}return c.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const fle={kernelName:tm,backendName:"webgl",kernelFunc:ule};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:i,indices:a}=e,{outputRaggedRank:o}=r,c=s.map(b=>t.readSync(b.dataId)),l=s.map(b=>b.shape),u=t.readSync(i.dataId),f=t.readSync(a.dataId),[d,p,m]=lne(c,l,u,i.shape,i.dtype,f,a.shape,o),I=d.map(b=>t.makeTensorInfo([b.length],"int32",b)),v=t.makeTensorInfo(m,i.dtype,p);return I.concat([v])}const dle={kernelName:lE,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(n){const{inputs:e,backend:t}=n,{starts:r,limits:s,deltas:i}=e,a=t.readSync(r.dataId),o=t.readSync(s.dataId),c=t.readSync(i.dataId),[l,u]=une(a,r.shape,r.dtype,o,s.shape,c,i.shape),f=t.makeTensorInfo([l.length],"int32",l),d=t.makeTensorInfo([u.length],r.dtype,u);return[f,d]}const gle={kernelName:uE,backendName:"webgl",kernelFunc:ple};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:i,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:c}=r,l=t.readSync(s.dataId),u=t.readSync(i.dataId),f=t.readSync(a.dataId),d=o.map(v=>t.readSync(v.dataId)),p=o.map(v=>v.shape),[m,I]=fne(l,s.shape,u,i.shape,i.dtype,f,a.shape,d,p,c);return t.makeTensorInfo(m,i.dtype,I)}const vle={kernelName:fE,backendName:"webgl",kernelFunc:mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N_=n=>{const{backend:e,attrs:t}=n,{start:r,stop:s,step:i,dtype:a}=t,o=hne(r,s,i,a);return e.makeTensorInfo([o.length],a,o)},Ile={kernelName:Nb,backendName:"webgl",kernelFunc:N_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble="return 1.0 / x;",yle=fn({opSnippet:ble}),xle={kernelName:oh,backendName:"webgl",kernelFunc:yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wle=Si+`
  return (x < 0.0) ? 0.0 : x;
`,Sle=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Cle=fn({opSnippet:wle,packedOpSnippet:Sle}),Rle={kernelName:ch,backendName:"webgl",kernelFunc:Cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle=Si+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ele=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Tle=fn({opSnippet:kle,packedOpSnippet:Ele}),Ale={kernelName:lh,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $le{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[a,o,c,l]=e;this.outputShape=[a,t,r,l];const u=[s&&t>1?o-1:o,s&&r>1?c-1:c],f=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;i?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/f[0]},
          ${u[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nle{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,c,l]=e;this.outputShape=[a,t,r,l];const u=[s&&t>1?o-1:o,s&&r>1?c-1:c],f=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;i?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/f[0]},
          ${u[1]/f[1]},
          ${u[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[c,l]=o,u=Ge().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Nle(s.shape,c,l,i,a):new $le(s.shape,c,l,i,a);return t.runWebGLProgram(u,[s],"float32")}const _le={kernelName:sm,backendName:"webgl",kernelFunc:Ole};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fle{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,a,o]=e,c=[r&&a>1?s-1:s,r&&o>1?i-1:i],l=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=c[0]/l[0],f=c[1]/l[1],d=1/u,p=1/f,m=Math.ceil(d)*2+2,I=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${I});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r,o=new Fle(i.shape,s.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const Ble={kernelName:Fb,backendName:"webgl",kernelFunc:Dle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mle{constructor(e,t,r,s,i){this.variableNames=["A"],this.outputShape=[];const[a,o,c,l]=e;this.outputShape=[a,t,r,l];const u=[s&&t>1?o-1:o,s&&r>1?c-1:c],f=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let p;i?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/f[0]},
          ${u[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ple{constructor(e,t,r,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,c,l]=e;this.outputShape=[a,t,r,l];const u=[s&&t>1?o-1:o,s&&r>1?c-1:c],f=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let p;i?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/f[0]},
          ${u[1]/f[1]},
          ${u[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${l-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:i,halfPixelCenters:a,size:o}=r,[c,l]=o,u=Ge().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ple(s.shape,c,l,i,a):new Mle(s.shape,c,l,i,a);return t.runWebGLProgram(u,[s],s.dtype)}const Ule={kernelName:rm,backendName:"webgl",kernelFunc:Lle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zle{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,i]=t,[,a,o]=e,c=[r&&a>1?s-1:s,r&&o>1?i-1:i],l=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=c[0]/l[0],f=c[1]/l[1],d=1/u,p=1/f,m=Math.ceil(d)*2+2,I=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${f});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${p});

        const int winHeight = int(${m});
        const int winWidth = int(${I});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${l[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${l[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:i}=e,{alignCorners:a}=r,o=new zle(i.shape,s.shape,a);return t.runWebGLProgram(o,[i],i.dtype)}const Wle={kernelName:_b,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gle{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,i=e.map((o,c)=>s(c)).join(","),a=Rn(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hle{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=es("rc",r),i=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,o=Rn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(s.slice())};
          if(${i}){
            result.g = ${l(s.slice())};
          }
          if(${a}) {
            result.b = ${u(s.slice())};
            if(${i}) {
              result.a = ${f(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(m){return d(m)}function l(m){return m[r-1]="("+m[r-1]+" + 1)",d(m)}function u(m){return m[r-2]="("+m[r-2]+" + 1)",d(m)}function f(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",d(m)}function d(m){const I=e.map((y,S)=>p(S,m)),v=I.join(","),b=I.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${b}))`}function p(m,I){return t.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${I[m]} - 1`:`${I[m]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:i}=r,a=s.shape.length,o=Yt(i,s.shape);if(a===0)return $s({inputs:{x:s},backend:t});const c=Ge().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hle(s.shape,o):new Gle(s.shape,o);return t.runWebGLProgram(c,[s],s.dtype)}const jle={kernelName:im,backendName:"webgl",kernelFunc:qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kle{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let i="";typeof t=="number"?i=`float outputValue = ${t.toFixed(2)};`:i=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xle={kernelName:zb,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:i,center:a}=e,o=t,c=new Kle(r.shape,i),[l,u]=My(a,r.shape[1],r.shape[2]),f=[[l,u,Math.sin(s),Math.cos(s)]];return o.runWebGLProgram(c,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Zle=fn({opSnippet:Yle}),Jle={kernelName:uh,backendName:"webgl",kernelFunc:Zle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qle="return inversesqrt(x);",eue=fn({opSnippet:Qle,cpuKernelImpl:dne}),tue={kernelName:fh,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lx{constructor(e,t,r,s,i,a,o=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const l=Rn(i.length),u=Rn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const m=`getUpdates(${p})`;let I="";c&&(I="coords[0], coords[1]");const v=`getDefaultValue(${I})`,b=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${b};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nue{constructor(e,t,r,s,i,a,o=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const l=Rn(i.length),u=Rn(a.length);let f="";r===1?f="i":r===2&&(f="i, j");const d=`getIndices(${f})`;let p="";s===1?p="i":s===2&&(p="i, coords[1]");const m=`getUpdates(${p})`;let I="";c&&(I="coords[0], coords[1]");const v=`getDefaultValue(${I})`,b=t>1?"strides[j]":"strides",y=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${b};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${m};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:i}=e,{shape:a}=r,{sliceRank:o,numUpdates:c,sliceSize:l,strides:u,outputSize:f}=Pc(i,s,a),d=[f/l,l];if(f===0)return t.makeTensorInfo(a,s.dtype);const p=ut({inputs:{x:s},backend:t,attrs:{shape:[c,o]}}),m=ut({inputs:{x:i},backend:t,attrs:{shape:[c,l]}}),I=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;Ge().getBool("WEBGL_PACK")?v=new nue(c,o,p.shape.length,m.shape.length,u,d):v=new Lx(c,o,p.shape.length,m.shape.length,u,d);const b=t.runWebGLProgram(v,[m,p,I],m.dtype),y=ut({inputs:{x:b},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(I),y}const sue={kernelName:hE,backendName:"webgl",kernelFunc:rue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iue{constructor(e,t,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=Ge().getNumber("WEBGL_VERSION")===2?i:a,c=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:i}=e,{side:a}=r,o=new iue(s.shape[0],s.shape[1],i.shape[1],a),c=[[s.shape[1]]];return t.runWebGLProgram(o,[s,i],"int32",c)}const oue={kernelName:pE,backendName:"webgl",kernelFunc:aue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cue{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let s,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",s="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],l=[];for(let u=0;u<t.length;u++)l.push(`${o[u]}`),u<e&&c.push(`${o[u]}`);s=c.join(),i=l.join()}const a=Rn(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:i}=e,a=new cue(r.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(a,[r,s,i],Ts(s.dtype,i.dtype))}const uue={kernelName:am,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Rm};
  float scale = ${km};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,hue=fn({opSnippet:fue}),due={kernelName:hh,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pue=lu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,gue=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,mue=fn({opSnippet:pue,packedOpSnippet:gue,cpuKernelImpl:gne}),vue={kernelName:mh,backendName:"webgl",kernelFunc:mue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,bue=fn({opSnippet:Iue}),yue={kernelName:gh,backendName:"webgl",kernelFunc:bue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xue=lu+`
  return sin(x);
`,wue=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Wc}
  return result;
`,Sue=fn({opSnippet:xue,packedOpSnippet:wue}),Cue={kernelName:dh,backendName:"webgl",kernelFunc:Sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,kue=fn({opSnippet:Rue}),Eue={kernelName:ph,backendName:"webgl",kernelFunc:kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Aue=fn({opSnippet:Tue}),$ue={kernelName:vh,backendName:"webgl",kernelFunc:Aue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nue=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:i,paddings:a}=r;ce(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=i.reduce((b,y)=>b*y),c=[[0,0]];c.push(...a);for(let b=1+i.length;b<s.shape.length;++b)c.push([0,0]);const l=[],u=$_({inputs:{x:s},backend:t,attrs:{paddings:c,constantValue:0}}),f=$h(u.shape,i,o,!1),d=Nh(f.length,i.length,!1),p=Oh(u.shape,i,o,!1),m=ut({inputs:{x:u},backend:t,attrs:{shape:f}}),I=ss({inputs:{x:m},backend:t,attrs:{perm:d}}),v=ut({inputs:{x:I},backend:t,attrs:{shape:p}});return l.push(u),l.push(m),l.push(I),l.forEach(b=>t.disposeIntermediateTensorInfo(b)),v},Oue={kernelName:lm,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:i,defaultValue:a}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=t.readSync(r.dataId),c=t.readSync(s.dataId),l=t.readSync(i.dataId),u=t.readSync(a.dataId)[0],[f,d,p,m,I]=vne(o,r.shape,r.dtype,c,s.dtype,l,u);return[t.makeTensorInfo(d,r.dtype,f),t.makeTensorInfo([d[0]],s.dtype,p),t.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(v=>Number(v)))),t.makeTensorInfo([I.length],r.dtype,new Int32Array(I))]}const Fue={kernelName:gE,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const a=Array.from(t.readSync(s.dataId)),o=t.readSync(r.dataId),c=Array.from(t.readSync(i.dataId)),[l,u,f]=Ine(o,r.shape,r.dtype,a,c);return[t.makeTensorInfo(u,r.dtype,l),t.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}const Bue={kernelName:mE,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mue(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const a=t.readSync(r.dataId),o=t.readSync(s.dataId),c=t.readSync(i.dataId),[l,u]=t_(a,r.shape,r.dtype,o,c,!0);return t.makeTensorInfo(u,r.dtype,l)}const Pue={kernelName:vE,backendName:"webgl",kernelFunc:Mue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const a=t.readSync(r.dataId),o=t.readSync(s.dataId),c=t.readSync(i.dataId),[l,u]=t_(a,r.shape,r.dtype,o,c);return t.makeTensorInfo(u,r.dtype,l)}const Uue={kernelName:IE,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zue(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:i,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:f,outputSize:d}=Pc(i,s,o),p=!1;if(i.dtype==="string"){const b=t.bufferSync(s),y=t.bufferSync(i),S=Ro(t.readSync(a.dataId)[0]),w=pne(b,y,o,d,u,l,c,f,S,p);return t.makeTensorInfo(o,w.dtype,w.values)}const m=new Lx(l,c,s.shape.length,i.shape.length,f,[d,1],p),I=t.runWebGLProgram(m,[i,s,a],i.dtype),v=ut({inputs:{x:I},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(I),v}const Vue={kernelName:bE,backendName:"webgl",kernelFunc:zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:i,axis:a}=r,o=Yt(a,s.shape)[0],c=Jy(s,i,o),l=s.shape.length,u=new Array(l).fill(0),f=s.shape.slice();return c.map(d=>{const p=[...f];p[o]=d;const m=uu({inputs:{x:s},backend:t,attrs:{begin:u,size:p}});return u[o]+=d,m})}const Gue={kernelName:um,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wR="return sqrt(x);",Hue=fn({opSnippet:wR,packedOpSnippet:wR,cpuKernelImpl:bne}),que={kernelName:Ih,backendName:"webgl",kernelFunc:Hue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jue="return x * x;",Kue=fn({opSnippet:jue}),Xue={kernelName:Db,backendName:"webgl",kernelFunc:Kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SR="return (a - b) * (a - b);",Yue=zr({opSnippet:SR,packedOpSnippet:SR}),Zue={kernelName:bh,backendName:"webgl",kernelFunc:Yue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jue(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const i=t.readSync(s.dataId),a=qa(i),o=yne(a,"string",r);return t.makeTensorInfo(s.shape,"string",o)}const Que={kernelName:Bb,backendName:"webgl",kernelFunc:Jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe({inputs:n,attrs:e,backend:t}){const{x:r}=n,s=Si+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new pa(r.shape,s);return t.runWebGLProgram(i,[r],r.dtype)}const tfe={kernelName:Ch,backendName:"webgl",kernelFunc:efe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nfe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,i=Rn(r.length),a=Rn(r.length);let o="";if(s===1)o="coords * strides + begin";else{let c=0;o=r.map((l,u)=>(c++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${c-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:i,end:a,strides:o,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:f,shrinkAxisMask:d}=r,{finalShapeSparse:p,finalShape:m,isIdentity:I,sliceDim0:v,isSimpleSlice:b,begin:y,end:S,strides:w}=Fy(s.shape,i,a,o,c,l,u,f,d);let C;if(I)C=ut({inputs:{x:s},backend:t,attrs:{shape:m}});else if(v||b){ce(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const E=Ny(y,S,w),A=uu({inputs:{x:s},backend:t,attrs:{begin:y,size:E}});C=ut({inputs:{x:A},backend:t,attrs:{shape:m}}),t.disposeIntermediateTensorInfo(A)}else if(t.shouldExecuteOnCPU([s])){const A=t.readSync(s.dataId),M=Xt(s.shape,s.dtype,A),z=xne(p,M,w,y);C=t.makeTensorInfo(m,s.dtype,z.values)}else{const A=new nfe(y,w,p);C=t.runWebGLProgram(A,[s],s.dtype)}const N=ut({inputs:{x:C},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(C),N}const sfe={kernelName:Mb,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:i,leftPad:a,rightPad:o,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:f}=e,d=t.readSync(u.dataId),p=t.readSync(f.dataId),[m,I]=wne(d,p,s,i,a,o,c,l);return[t.makeTensorInfo([m.length],"string",m),t.makeTensorInfo(f.shape,"int32",I)]}const afe={kernelName:yE,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ofe(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:i,delimiter:a}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=t.readSync(i.dataId),c=t.readSync(a.dataId)[0],[l,u,f]=Sne(o,c,s),d=u.length;return[t.makeTensorInfo([d,2],"int32",l),t.makeTensorInfo([d],"string",u),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const cfe={kernelName:xE,backendName:"webgl",kernelFunc:ofe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const a=t.readSync(i.dataId),o=Cne(a,s);return t.makeTensorInfo(i.shape,"int32",o)}const ufe={kernelName:wE,backendName:"webgl",kernelFunc:lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe="return tan(x);",hfe=fn({opSnippet:ffe}),dfe={kernelName:xh,backendName:"webgl",kernelFunc:hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pfe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,gfe=fn({opSnippet:pfe}),mfe={kernelName:wh,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(n){const{inputs:e,backend:t,attrs:r}=n,{tensor:s,indices:i,updates:a}=e,{sliceRank:o,numUpdates:c,sliceSize:l,strides:u,outputSize:f}=Pc(a,i,s.shape),d=[f/l,l];if(f===0)return t.makeTensorInfo(s.shape,i.dtype);const p=ut({inputs:{x:i},backend:t,attrs:{shape:[c,o]}}),m=ut({inputs:{x:a},backend:t,attrs:{shape:[c,l]}}),I=ut({inputs:{x:s},backend:t,attrs:{shape:d}}),v=new Lx(c,o,p.shape.length,m.shape.length,u,d,!1,!0),b=t.runWebGLProgram(v,[m,p,I],I.dtype),y=ut({inputs:{x:b},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(I),t.disposeIntermediateTensorInfo(b),y}const Ife={kernelName:dE,backendName:"webgl",kernelFunc:vfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bfe{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[a]*t[a];this.outputShape=r,this.rank=r.length;const s=Rn(this.rank),i=yfe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function yfe(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<n.length;s++)r.push(`imod(${t[s]}, ${n[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:i}=r;if(s.dtype==="string"||s.shape.length>5){const c=t.readSync(s.dataId),l=s.dtype==="string"?c.map(d=>Ro(d)):c,u=Xt(s.shape,s.dtype,l),f=kne(u,i);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const a=new bfe(s.shape,i);return t.runWebGLProgram(a,[s],s.dtype)}const xfe={kernelName:Sh,backendName:"webgl",kernelFunc:O_};class wfe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Sfe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sc(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function CR(n){let e=1;for(;e<n;)e*=2;return e}function Cfe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:i,sorted:a}=r,o=Ge().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=Ge().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=s.shape,u=l[l.length-1];if(t.shouldExecuteOnCPU([s])||u<o||i>c){const z=t.readSync(s.dataId),[Y,re]=Ene(z,l,s.dtype,i,a);return[t.makeTensorInfo(Y.shape,Y.dtype,Y.values),t.makeTensorInfo(re.shape,re.dtype,re.values)]}if(i===0)return l[l.length-1]=0,[t.makeTensorInfo(l,s.dtype,[]),t.makeTensorInfo(l,"int32",[])];if(u===1)return[s,qh({attrs:{shape:l,dtype:"int32",value:0},backend:t})];const f=t.texData.get(s.dataId),d=f!==null&&f.isPacked,p=d?t.unpackTensor(s):s,I=Ye(l)/u,v=ut({inputs:{x:p},attrs:{shape:[I,u]},backend:t});d&&sc(t,p);const b=CR(i),y=CR(u);let S=null;const w=()=>S===null?[v,v]:[v,S],C=(z,Y,re)=>{const ne=w(),le=new wfe(re),ge=[[u],[S===null?1:0],[Number.NEGATIVE_INFINITY],[z],[Y]],Se=S;S=t.runWebGLProgram(le,ne,"int32",ge),sc(t,Se)};for(let z=1;z<b;z*=2){const Y=z*2;for(let re=z;re>=1;re/=2)C(Y,re,[I,y])}for(let z=y;z>b;z/=2){const Y=w(),re=new Sfe([I,z/2]),le=[[u],[S===null?1:0],[b]],j=S;S=t.runWebGLProgram(re,Y,"int32",le),sc(t,j);const ge=b/2,Se=ge*2;for(let me=ge;me>=1;me/=2)C(Se,me,S.shape)}let N=S;S=uu({inputs:{x:S},backend:t,attrs:{begin:0,size:[I,i]}}),sc(t,N);let E=C_({inputs:{x:v,indices:S},backend:t,attrs:{axis:1,batchDims:1}});sc(t,v);const A=l.slice(0,-1);A.push(i),N=S,S=ut({inputs:{x:S},attrs:{shape:A},backend:t}),sc(t,N);const M=E;return E=ut({inputs:{x:E},attrs:{shape:A},backend:t}),sc(t,M),[E,S]}const Rfe={kernelName:Pb,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kfe{constructor(e,t,r,s,i,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=r==="nearest"?1:2;let c;switch(s){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,transforms:i}=e,{interpolation:a,fillMode:o,fillValue:c,outputShape:l}=r,[u,f,d,p]=s.shape,[m,I]=l??[f,d],v=[u,m,I,p],b=new kfe(f,d,a,o,c,v);return t.runWebGLProgram(b,[s,i],"float32")}const Tfe={kernelName:Lb,backendName:"webgl",kernelFunc:Efe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:i}=e;Wh(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(i.dataId),{outputValues:o,outputShape:c,indices:l}=Tne(a,s,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,o),r.makeTensorInfo([l.length],"int32",l)]}const $fe={kernelName:Ub,backendName:"webgl",kernelFunc:Afe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:i}=r;i<0&&(i+=s.shape.length);const a=s,o=a.shape.length,c=s.shape[i],l=new Array(o-1);let u=0;for(let I=0;I<o;I++)I!==i&&(l[u++]=a.shape[I]);const f=[],d=new Array(o).fill(0),p=a.shape.slice();p[i]=1;const m=new Array(c);for(let I=0;I<m.length;I++){d[i]=I;const v=uu({inputs:{x:a},backend:t,attrs:{begin:d,size:p}}),b=ut({inputs:{x:v},backend:t,attrs:{shape:l}});m[I]=b,f.push(v)}return f.forEach(I=>t.disposeIntermediateTensorInfo(I)),m}const Ofe={kernelName:hm,backendName:"webgl",kernelFunc:Nfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _fe{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/r);this.outputShape=[s,o];const c="0.0",l="sumValue",u=Math.floor(r/4)*4,f=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let p="";i%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${l});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:i}=e,{numSegments:a}=r,o=s.shape.length,c=[];let l=0;const u=Kn([l],o);let f=s;u!=null&&(f=ss({inputs:{x:s},backend:t,attrs:{perm:u}}),c.push(f),l=ir(1,o)[0]);const d=gA(f.shape,l,a),p=Ye([f.shape[l]]),m=ut({inputs:{x:f},backend:t,attrs:{shape:[-1,p]}});c.push(m);const I=Wb(s.dtype),v=(w,C,N,E,A)=>{const M=w.shape[0],z=w.shape[1],Y=pA(z,A),re={windowSize:Y,inSize:z,batchSize:M,numSegments:A},ne=new _fe(re,C),le=t.compileAndRun(ne,[w,N],E);if(c.push(le),le.shape[1]===A)return le;const j=N_({backend:t,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),ge=O_({inputs:{x:j},backend:t,attrs:{reps:[z/Y]}});return c.push(j),c.push(ge),v(le,C,ge,E,A)},b=v(m,"unsortedSegmentSum",i,I,a),y=ut({inputs:{x:b},backend:t,attrs:{shape:d}});let S=y;if(u!=null){c.push(y);const w=Bo(u);S=ss({inputs:{x:S},backend:t,attrs:{perm:w}})}return c.forEach(w=>t.disposeIntermediateTensorInfo(w)),S}const Dfe={kernelName:dm,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=[bre,xre,Cre,Ere,Are,Ore,Fre,Bre,Ure,Vre,Hre,Kre,Zre,tse,sse,ase,cse,hse,pse,mse,yse,Ese,Ase,_se,Dse,zse,Wse,jse,nre,Yse,tie,iie,fie,pie,mie,Iie,yie,Cie,Eie,$ie,Oie,Fie,Bie,Lie,zie,Hie,jie,Yie,Qie,tae,iae,lae,dae,mae,bae,yae,wae,Cae,kae,Tae,$ae,Fae,Mae,Uae,Vae,Hae,Kae,Jae,noe,tre,soe,Qse,ooe,uoe,doe,sre,voe,xoe,Soe,Eoe,$oe,Foe,Moe,zoe,Hoe,Koe,Yoe,ece,nce,sce,cce,uce,hce,pce,mce,yce,Cce,Tce,Bce,ore,Uce,Wce,qce,Xce,Mse,Jce,ele,nle,ile,lle,are,fle,dle,gle,vle,Ile,Pse,Oce,xle,Rle,Ale,lre,_le,Ble,Ule,Wle,jle,Xle,Jle,tue,sue,oue,uue,due,vue,yue,Cue,Eue,Rse,Fce,$ue,Oue,Fue,Bue,Pue,Uue,Vue,Gue,que,Xue,Zue,Que,tfe,sfe,afe,cfe,ufe,_ce,mre,dfe,mfe,Ife,xfe,Rfe,Tfe,vre,$fe,Ofe,Dfe,Qce];for(const n of Bfe)CE(n);const RR=Ss("");function Mfe(){var n=null;const e=Ss([]);var t=[],r=[],s=[],i={promise:null,resolve:null,reject:null};const a=d=>{n.postMessage({type:"detectorModel",data:d})},o=d=>{n.postMessage({type:"classifierModel",data:d})},c=async d=>{s=[],t=[];for(var p=0;p<d.length;p++){let m=await wc(d[p]).array();t.push({name:r[p].name,id:r[p].id,detectorModelClassification:{prediction:m,probability:d[p][m]}}),m&&s.push([r[p],p])}s.length<1?(r=[],i.resolve()):o(s.map(m=>m[0].seq))},l=async d=>{for(var p=0;p<d.length;p++){let m=await wc(d[p]).array(),I=s[p][1];t[I].classifierModelClassification={prediction:m,probability:d[p][m]}}i.resolve(),r=[],s=[]};return{annotationResult:e,annotateSequenceList:async d=>{e.value=[],r=d,i.promise!=null&&i.reject(),i.promise=new Promise((p,m)=>{i.resolve=p,i.reject=m}),a(d.map(p=>{if(!p.seq)throw`No sequence found for - ${p.name}`;return p.seq})),await i.promise,e.value=t},modelError:RR,loadModel:()=>{n==null&&(n=new U6,n.addEventListener("message",d=>{const{type:p,data:m}=d.data;console.log("ANNOTATION TOOL: Data Recv:",d.data),p=="error"?RR.value=m:p=="detectorPrediction"?c(m):p=="classifierPrediction"&&l(m)}))}}}function Pfe(n){var e=[];const t=Ss(n||10),r=Ss(1),s=Ss(1),i=Ss([]),a=Ss(0),o=u=>{e=u.slice(),c()},c=()=>{r.value=Math.ceil(e.length/t.value),a.value=e.length,l(1)},l=u=>{u=Math.max(1,Math.min(u,r.value));let f=(u-1)*t.value;console.log("going to page:",u,f,f+t.value),s.value=u,i.value=e.slice(f,f+t.value).map((d,p)=>({index:f+p+1,item:d}))};return{itemsPerPage:t,totalPages:r,currentPage:s,pageItems:i,populateData:o,resetPage:c,goToPage:l,totalItemsCount:a}}const Ip={1:"Glycine Riboswitch",2:"Cyclic di-GMP-II riboswitch",3:"ZMP/ZTP riboswitch",4:"TPP riboswitch (THI element)",5:"S-adenosyl-L-homocysteine riboswitch",6:"SAM-I/IV variant riboswitch",7:"SAM riboswitch (S box leader)",8:"Cobalamin riboswitch",9:"Molybdenum Cofactor riboswitch",10:"SAM/SAH Riboswitch",11:"Abocbl Riboswitch",12:"nhaA-I RNA",13:"Fluroride riboswitch",14:"Purine Riboswitch",15:"glmS glucosamine-6-phosphate activated ribozyme",16:"Glutamine riboswitch",17:"raiA RNA",18:"sul RNA",19:"yKoK leader",20:"Lysine Riboswitch",21:"DUF1646 RNA",22:"Abocbl variant RNA",23:"ydaO/yuaA leader",24:"S-adenosyl methionine (SAM) riboswitch",25:"SMK box translational riboswitch (SAM-III)",26:"yybP-ykoY manganese riboswitch",27:"NiCo riboswitch",28:"Guanidine-I Riboswitch",29:"PreQ1 Riboswitch",30:"FMN Riboswitch",31:"THF riboswitch",32:"SAM riboswitch (alpha-proteobacteria)"};function Lfe(){const n=s=>s.map(i=>i.map(String).map(a=>a.replaceAll('"','""')).map(a=>`"${a}"`).join(",")).join(`\r
`),e=(s,i,a)=>{var o=new Blob([s],{type:a}),c=URL.createObjectURL(o),l=document.createElement("a");l.href=c,l.setAttribute("download",i),l.click()},t=s=>{let i=[];for(var a=0;a<s.length;a++){let o=s[a];i.push([o.id,o.detectorModelClassification.prediction,o.detectorModelClassification.probability,o.classifierModelClassification?o.classifierModelClassification.prediction:"",o.classifierModelClassification?Ip[o.classifierModelClassification.prediction+1]:"",o.classifierModelClassification?o.classifierModelClassification.probability:""])}return i};return{downloadPredictionCSV:async s=>{console.log("result",s);const i=[["Sequence ID","Riboswitch Detector","Riboswitch Detector Probability","Riboswitch Classifier","Riboswitch Label","Riboswitch Classifier Probability"]],a=t(s),o=n([...i,...a]);e(o,"RiboswitchToolResult.csv","text/csv;charset=utf-8;")}}}var lI={exports:{}},uI={exports:{}},fI={exports:{}},Ux={};(function(n){n.__esModule=!0,n.gbDivisions=n.default=void 0;var e={untitledSequenceName:"Untitled Sequence"};n.default=e;var t={PRI:!0,ROD:!0,MAM:!0,VRT:!0,INV:!0,PLN:!0,BCT:!0,VRL:!0,PHG:!0,SYN:!0,UNA:!0,EST:!0,PAT:!0,STS:!0,GSS:!0,HTG:!0,HTC:!0,ENV:!0,CON:!0};n.gbDivisions=t})(Ux);(function(n,e){e.__esModule=!0,e.default=s;var t=r(Ux);function r(i){return i&&i.__esModule?i:{default:i}}function s(i){return i=i||{},{messages:[],success:!0,parsedSequence:{features:[],name:i.fileName&&i.fileName.replace(/\.[^/.]+$/,"")||t.default.untitledSequenceName,sequence:""}}}n.exports=e.default})(fI,fI.exports);var Gm=fI.exports,hI={exports:{}};(function(n,e){e.__esModule=!0,e.default=t;function t(r){var s=[];return r===""||(s=r.split(/\r?\n/),s.length==1&&(s=r.split("\\n"))),s}n.exports=e.default})(hI,hI.exports);var __=hI.exports,dI={exports:{}},pI={exports:{}};function Ufe(n){return Object.prototype.toString.call(n)==="[object Array]"}var zfe=Array.isArray||Ufe;function Vfe(n){return(typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]")&&n.valueOf()===n.valueOf()}var Wfe=Vfe,Gfe=Wfe;function Hfe(n){return Gfe(n)&&n%1===0}var qfe=Hfe,jfe=qfe;function Kfe(n){return jfe(n)&&n>=0}var Xfe=Kfe,Yfe=zfe,Zfe=Xfe;function Jfe(n){var e;if(!Yfe(n)||(e=n.length,!e))return!1;for(var t=0;t<e;t++)if(!Zfe(n[t]))return!1;return!0}var Qfe=Jfe,it={},eg={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */eg.exports;(function(n,e){(function(){var t,r="4.17.21",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",f=1,d=2,p=4,m=1,I=2,v=1,b=2,y=4,S=8,w=16,C=32,N=64,E=128,A=256,M=512,z=30,Y="...",re=800,ne=16,le=1,j=2,ge=3,Se=1/0,me=9007199254740991,ye=17976931348623157e292,Ce=0/0,he=4294967295,Ne=he-1,xe=he>>>1,ae=[["ary",E],["bind",v],["bindKey",b],["curry",S],["curryRight",w],["flip",M],["partial",C],["partialRight",N],["rearg",A]],J="[object Arguments]",D="[object Array]",P="[object AsyncFunction]",Q="[object Boolean]",pe="[object Date]",Ee="[object DOMException]",L="[object Error]",q="[object Function]",Z="[object GeneratorFunction]",se="[object Map]",ie="[object Number]",B="[object Null]",R="[object Object]",k="[object Promise]",X="[object Proxy]",fe="[object RegExp]",Te="[object Set]",Be="[object String]",He="[object Symbol]",rt="[object Undefined]",ct="[object WeakMap]",lt="[object WeakSet]",W="[object ArrayBuffer]",T="[object DataView]",O="[object Float32Array]",ue="[object Float64Array]",Ae="[object Int8Array]",ze="[object Int16Array]",Xe="[object Int32Array]",Ct="[object Uint8Array]",hn="[object Uint8ClampedArray]",en="[object Uint16Array]",tn="[object Uint32Array]",Ht=/\b__p \+= '';/g,Os=/\b(__p \+=) '' \+/g,Ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Kc=/&(?:amp|lt|gt|quot|#39);/g,ji=/[&<>"']/g,cr=RegExp(Kc.source),an=RegExp(ji.source),Zn=/<%-([\s\S]+?)%>/g,Xs=/<%([\s\S]+?)%>/g,Ri=/<%=([\s\S]+?)%>/g,qo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ku=/^\w*$/,Qa=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jo=/[\\^$.*+?()[\]{}|]/g,Xc=RegExp(jo.source),Eu=/^\s+/,l0=/\s/,u0=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tu=/\{\n\/\* \[wrapped with (.+)\] \*/,sd=/,? & /,f0=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,h0=/[()=,{}\[\]\/\s]/,ka=/\\(\\)?/g,Ea=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Au=/\w*$/,$u=/^[-+]0x[0-9a-f]+$/i,id=/^0b[01]+$/i,d0=/^\[object .+?Constructor\]$/,ad=/^0o[0-7]+$/i,p0=/^(?:0|[1-9]\d*)$/,g0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yc=/($^)/,Jn=/['\n\r\u2028\u2029\\]/g,Zc="\\ud800-\\udfff",m0="\\u0300-\\u036f",v0="\\ufe20-\\ufe2f",I0="\\u20d0-\\u20ff",od=m0+v0+I0,Re="\\u2700-\\u27bf",_="a-z\\xdf-\\xf6\\xf8-\\xff",V="\\xac\\xb1\\xd7\\xf7",U="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",K="\\u2000-\\u206f",F=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",H="A-Z\\xc0-\\xd6\\xd8-\\xde",ee="\\ufe0e\\ufe0f",de=V+U+K+F,Ie="[']",ve="["+Zc+"]",ke="["+de+"]",Ue="["+od+"]",qe="\\d+",nt="["+Re+"]",ot="["+_+"]",mt="[^"+Zc+de+qe+Re+_+H+"]",At="\\ud83c[\\udffb-\\udfff]",Pt="(?:"+Ue+"|"+At+")",qt="[^"+Zc+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",Sn="[\\ud800-\\udbff][\\udc00-\\udfff]",jt="["+H+"]",gn="\\u200d",On="(?:"+ot+"|"+mt+")",Pn="(?:"+jt+"|"+mt+")",Nr="(?:"+Ie+"(?:d|ll|m|re|s|t|ve))?",Qn="(?:"+Ie+"(?:D|LL|M|RE|S|T|VE))?",Wn=Pt+"?",Vr="["+ee+"]?",ki="(?:"+gn+"(?:"+[qt,on,Sn].join("|")+")"+Vr+Wn+")*",DD="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",BD="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Aw=Vr+Wn+ki,MD="(?:"+[nt,on,Sn].join("|")+")"+Aw,PD="(?:"+[qt+Ue+"?",Ue,on,Sn,ve].join("|")+")",LD=RegExp(Ie,"g"),UD=RegExp(Ue,"g"),b0=RegExp(At+"(?="+At+")|"+PD+Aw,"g"),zD=RegExp([jt+"?"+ot+"+"+Nr+"(?="+[ke,jt,"$"].join("|")+")",Pn+"+"+Qn+"(?="+[ke,jt+On,"$"].join("|")+")",jt+"?"+On+"+"+Nr,jt+"+"+Qn,BD,DD,qe,MD].join("|"),"g"),VD=RegExp("["+gn+Zc+od+ee+"]"),WD=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,GD=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],HD=-1,Ln={};Ln[O]=Ln[ue]=Ln[Ae]=Ln[ze]=Ln[Xe]=Ln[Ct]=Ln[hn]=Ln[en]=Ln[tn]=!0,Ln[J]=Ln[D]=Ln[W]=Ln[Q]=Ln[T]=Ln[pe]=Ln[L]=Ln[q]=Ln[se]=Ln[ie]=Ln[R]=Ln[fe]=Ln[Te]=Ln[Be]=Ln[ct]=!1;var _n={};_n[J]=_n[D]=_n[W]=_n[T]=_n[Q]=_n[pe]=_n[O]=_n[ue]=_n[Ae]=_n[ze]=_n[Xe]=_n[se]=_n[ie]=_n[R]=_n[fe]=_n[Te]=_n[Be]=_n[He]=_n[Ct]=_n[hn]=_n[en]=_n[tn]=!0,_n[L]=_n[q]=_n[ct]=!1;var qD={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},jD={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},KD={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},XD={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},YD=parseFloat,ZD=parseInt,$w=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,JD=typeof self=="object"&&self&&self.Object===Object&&self,Wr=$w||JD||Function("return this")(),y0=e&&!e.nodeType&&e,Ko=y0&&!0&&n&&!n.nodeType&&n,Nw=Ko&&Ko.exports===y0,x0=Nw&&$w.process,Ys=function(){try{var De=Ko&&Ko.require&&Ko.require("util").types;return De||x0&&x0.binding&&x0.binding("util")}catch{}}(),Ow=Ys&&Ys.isArrayBuffer,_w=Ys&&Ys.isDate,Fw=Ys&&Ys.isMap,Dw=Ys&&Ys.isRegExp,Bw=Ys&&Ys.isSet,Mw=Ys&&Ys.isTypedArray;function _s(De,Ze,je){switch(je.length){case 0:return De.call(Ze);case 1:return De.call(Ze,je[0]);case 2:return De.call(Ze,je[0],je[1]);case 3:return De.call(Ze,je[0],je[1],je[2])}return De.apply(Ze,je)}function QD(De,Ze,je,It){for(var Lt=-1,In=De==null?0:De.length;++Lt<In;){var Cr=De[Lt];Ze(It,Cr,je(Cr),De)}return It}function Zs(De,Ze){for(var je=-1,It=De==null?0:De.length;++je<It&&Ze(De[je],je,De)!==!1;);return De}function eB(De,Ze){for(var je=De==null?0:De.length;je--&&Ze(De[je],je,De)!==!1;);return De}function Pw(De,Ze){for(var je=-1,It=De==null?0:De.length;++je<It;)if(!Ze(De[je],je,De))return!1;return!0}function eo(De,Ze){for(var je=-1,It=De==null?0:De.length,Lt=0,In=[];++je<It;){var Cr=De[je];Ze(Cr,je,De)&&(In[Lt++]=Cr)}return In}function cd(De,Ze){var je=De==null?0:De.length;return!!je&&Jc(De,Ze,0)>-1}function w0(De,Ze,je){for(var It=-1,Lt=De==null?0:De.length;++It<Lt;)if(je(Ze,De[It]))return!0;return!1}function Gn(De,Ze){for(var je=-1,It=De==null?0:De.length,Lt=Array(It);++je<It;)Lt[je]=Ze(De[je],je,De);return Lt}function to(De,Ze){for(var je=-1,It=Ze.length,Lt=De.length;++je<It;)De[Lt+je]=Ze[je];return De}function S0(De,Ze,je,It){var Lt=-1,In=De==null?0:De.length;for(It&&In&&(je=De[++Lt]);++Lt<In;)je=Ze(je,De[Lt],Lt,De);return je}function tB(De,Ze,je,It){var Lt=De==null?0:De.length;for(It&&Lt&&(je=De[--Lt]);Lt--;)je=Ze(je,De[Lt],Lt,De);return je}function C0(De,Ze){for(var je=-1,It=De==null?0:De.length;++je<It;)if(Ze(De[je],je,De))return!0;return!1}var nB=R0("length");function rB(De){return De.split("")}function sB(De){return De.match(f0)||[]}function Lw(De,Ze,je){var It;return je(De,function(Lt,In,Cr){if(Ze(Lt,In,Cr))return It=In,!1}),It}function ld(De,Ze,je,It){for(var Lt=De.length,In=je+(It?1:-1);It?In--:++In<Lt;)if(Ze(De[In],In,De))return In;return-1}function Jc(De,Ze,je){return Ze===Ze?mB(De,Ze,je):ld(De,Uw,je)}function iB(De,Ze,je,It){for(var Lt=je-1,In=De.length;++Lt<In;)if(It(De[Lt],Ze))return Lt;return-1}function Uw(De){return De!==De}function zw(De,Ze){var je=De==null?0:De.length;return je?E0(De,Ze)/je:Ce}function R0(De){return function(Ze){return Ze==null?t:Ze[De]}}function k0(De){return function(Ze){return De==null?t:De[Ze]}}function Vw(De,Ze,je,It,Lt){return Lt(De,function(In,Cr,Tn){je=It?(It=!1,In):Ze(je,In,Cr,Tn)}),je}function aB(De,Ze){var je=De.length;for(De.sort(Ze);je--;)De[je]=De[je].value;return De}function E0(De,Ze){for(var je,It=-1,Lt=De.length;++It<Lt;){var In=Ze(De[It]);In!==t&&(je=je===t?In:je+In)}return je}function T0(De,Ze){for(var je=-1,It=Array(De);++je<De;)It[je]=Ze(je);return It}function oB(De,Ze){return Gn(Ze,function(je){return[je,De[je]]})}function Ww(De){return De&&De.slice(0,jw(De)+1).replace(Eu,"")}function Fs(De){return function(Ze){return De(Ze)}}function A0(De,Ze){return Gn(Ze,function(je){return De[je]})}function Nu(De,Ze){return De.has(Ze)}function Gw(De,Ze){for(var je=-1,It=De.length;++je<It&&Jc(Ze,De[je],0)>-1;);return je}function Hw(De,Ze){for(var je=De.length;je--&&Jc(Ze,De[je],0)>-1;);return je}function cB(De,Ze){for(var je=De.length,It=0;je--;)De[je]===Ze&&++It;return It}var lB=k0(qD),uB=k0(jD);function fB(De){return"\\"+XD[De]}function hB(De,Ze){return De==null?t:De[Ze]}function Qc(De){return VD.test(De)}function dB(De){return WD.test(De)}function pB(De){for(var Ze,je=[];!(Ze=De.next()).done;)je.push(Ze.value);return je}function $0(De){var Ze=-1,je=Array(De.size);return De.forEach(function(It,Lt){je[++Ze]=[Lt,It]}),je}function qw(De,Ze){return function(je){return De(Ze(je))}}function no(De,Ze){for(var je=-1,It=De.length,Lt=0,In=[];++je<It;){var Cr=De[je];(Cr===Ze||Cr===u)&&(De[je]=u,In[Lt++]=je)}return In}function ud(De){var Ze=-1,je=Array(De.size);return De.forEach(function(It){je[++Ze]=It}),je}function gB(De){var Ze=-1,je=Array(De.size);return De.forEach(function(It){je[++Ze]=[It,It]}),je}function mB(De,Ze,je){for(var It=je-1,Lt=De.length;++It<Lt;)if(De[It]===Ze)return It;return-1}function vB(De,Ze,je){for(var It=je+1;It--;)if(De[It]===Ze)return It;return It}function el(De){return Qc(De)?bB(De):nB(De)}function Ei(De){return Qc(De)?yB(De):rB(De)}function jw(De){for(var Ze=De.length;Ze--&&l0.test(De.charAt(Ze)););return Ze}var IB=k0(KD);function bB(De){for(var Ze=b0.lastIndex=0;b0.test(De);)++Ze;return Ze}function yB(De){return De.match(b0)||[]}function xB(De){return De.match(zD)||[]}var wB=function De(Ze){Ze=Ze==null?Wr:tl.defaults(Wr.Object(),Ze,tl.pick(Wr,GD));var je=Ze.Array,It=Ze.Date,Lt=Ze.Error,In=Ze.Function,Cr=Ze.Math,Tn=Ze.Object,N0=Ze.RegExp,SB=Ze.String,Js=Ze.TypeError,fd=je.prototype,CB=In.prototype,nl=Tn.prototype,hd=Ze["__core-js_shared__"],dd=CB.toString,Cn=nl.hasOwnProperty,RB=0,Kw=function(){var h=/[^.]+$/.exec(hd&&hd.keys&&hd.keys.IE_PROTO||"");return h?"Symbol(src)_1."+h:""}(),pd=nl.toString,kB=dd.call(Tn),EB=Wr._,TB=N0("^"+dd.call(Cn).replace(jo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gd=Nw?Ze.Buffer:t,ro=Ze.Symbol,md=Ze.Uint8Array,Xw=gd?gd.allocUnsafe:t,vd=qw(Tn.getPrototypeOf,Tn),Yw=Tn.create,Zw=nl.propertyIsEnumerable,Id=fd.splice,Jw=ro?ro.isConcatSpreadable:t,Ou=ro?ro.iterator:t,Xo=ro?ro.toStringTag:t,bd=function(){try{var h=ec(Tn,"defineProperty");return h({},"",{}),h}catch{}}(),AB=Ze.clearTimeout!==Wr.clearTimeout&&Ze.clearTimeout,$B=It&&It.now!==Wr.Date.now&&It.now,NB=Ze.setTimeout!==Wr.setTimeout&&Ze.setTimeout,yd=Cr.ceil,xd=Cr.floor,O0=Tn.getOwnPropertySymbols,OB=gd?gd.isBuffer:t,Qw=Ze.isFinite,_B=fd.join,FB=qw(Tn.keys,Tn),Rr=Cr.max,Xr=Cr.min,DB=It.now,BB=Ze.parseInt,e2=Cr.random,MB=fd.reverse,_0=ec(Ze,"DataView"),_u=ec(Ze,"Map"),F0=ec(Ze,"Promise"),rl=ec(Ze,"Set"),Fu=ec(Ze,"WeakMap"),Du=ec(Tn,"create"),wd=Fu&&new Fu,sl={},PB=tc(_0),LB=tc(_u),UB=tc(F0),zB=tc(rl),VB=tc(Fu),Sd=ro?ro.prototype:t,Bu=Sd?Sd.valueOf:t,t2=Sd?Sd.toString:t;function te(h){if(er(h)&&!Vt(h)&&!(h instanceof rn)){if(h instanceof Qs)return h;if(Cn.call(h,"__wrapped__"))return nS(h)}return new Qs(h)}var il=function(){function h(){}return function(g){if(!Yn(g))return{};if(Yw)return Yw(g);h.prototype=g;var x=new h;return h.prototype=t,x}}();function Cd(){}function Qs(h,g){this.__wrapped__=h,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=t}te.templateSettings={escape:Zn,evaluate:Xs,interpolate:Ri,variable:"",imports:{_:te}},te.prototype=Cd.prototype,te.prototype.constructor=te,Qs.prototype=il(Cd.prototype),Qs.prototype.constructor=Qs;function rn(h){this.__wrapped__=h,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=he,this.__views__=[]}function WB(){var h=new rn(this.__wrapped__);return h.__actions__=vs(this.__actions__),h.__dir__=this.__dir__,h.__filtered__=this.__filtered__,h.__iteratees__=vs(this.__iteratees__),h.__takeCount__=this.__takeCount__,h.__views__=vs(this.__views__),h}function GB(){if(this.__filtered__){var h=new rn(this);h.__dir__=-1,h.__filtered__=!0}else h=this.clone(),h.__dir__*=-1;return h}function HB(){var h=this.__wrapped__.value(),g=this.__dir__,x=Vt(h),$=g<0,G=x?h.length:0,oe=rM(0,G,this.__views__),be=oe.start,$e=oe.end,Le=$e-be,Je=$?$e:be-1,Qe=this.__iteratees__,tt=Qe.length,ht=0,St=Xr(Le,this.__takeCount__);if(!x||!$&&G==Le&&St==Le)return R2(h,this.__actions__);var Ot=[];e:for(;Le--&&ht<St;){Je+=g;for(var Kt=-1,_t=h[Je];++Kt<tt;){var nn=Qe[Kt],cn=nn.iteratee,Ms=nn.type,cs=cn(_t);if(Ms==j)_t=cs;else if(!cs){if(Ms==le)continue e;break e}}Ot[ht++]=_t}return Ot}rn.prototype=il(Cd.prototype),rn.prototype.constructor=rn;function Yo(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var $=h[g];this.set($[0],$[1])}}function qB(){this.__data__=Du?Du(null):{},this.size=0}function jB(h){var g=this.has(h)&&delete this.__data__[h];return this.size-=g?1:0,g}function KB(h){var g=this.__data__;if(Du){var x=g[h];return x===c?t:x}return Cn.call(g,h)?g[h]:t}function XB(h){var g=this.__data__;return Du?g[h]!==t:Cn.call(g,h)}function YB(h,g){var x=this.__data__;return this.size+=this.has(h)?0:1,x[h]=Du&&g===t?c:g,this}Yo.prototype.clear=qB,Yo.prototype.delete=jB,Yo.prototype.get=KB,Yo.prototype.has=XB,Yo.prototype.set=YB;function Ta(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var $=h[g];this.set($[0],$[1])}}function ZB(){this.__data__=[],this.size=0}function JB(h){var g=this.__data__,x=Rd(g,h);if(x<0)return!1;var $=g.length-1;return x==$?g.pop():Id.call(g,x,1),--this.size,!0}function QB(h){var g=this.__data__,x=Rd(g,h);return x<0?t:g[x][1]}function e4(h){return Rd(this.__data__,h)>-1}function t4(h,g){var x=this.__data__,$=Rd(x,h);return $<0?(++this.size,x.push([h,g])):x[$][1]=g,this}Ta.prototype.clear=ZB,Ta.prototype.delete=JB,Ta.prototype.get=QB,Ta.prototype.has=e4,Ta.prototype.set=t4;function Aa(h){var g=-1,x=h==null?0:h.length;for(this.clear();++g<x;){var $=h[g];this.set($[0],$[1])}}function n4(){this.size=0,this.__data__={hash:new Yo,map:new(_u||Ta),string:new Yo}}function r4(h){var g=Md(this,h).delete(h);return this.size-=g?1:0,g}function s4(h){return Md(this,h).get(h)}function i4(h){return Md(this,h).has(h)}function a4(h,g){var x=Md(this,h),$=x.size;return x.set(h,g),this.size+=x.size==$?0:1,this}Aa.prototype.clear=n4,Aa.prototype.delete=r4,Aa.prototype.get=s4,Aa.prototype.has=i4,Aa.prototype.set=a4;function Zo(h){var g=-1,x=h==null?0:h.length;for(this.__data__=new Aa;++g<x;)this.add(h[g])}function o4(h){return this.__data__.set(h,c),this}function c4(h){return this.__data__.has(h)}Zo.prototype.add=Zo.prototype.push=o4,Zo.prototype.has=c4;function Ti(h){var g=this.__data__=new Ta(h);this.size=g.size}function l4(){this.__data__=new Ta,this.size=0}function u4(h){var g=this.__data__,x=g.delete(h);return this.size=g.size,x}function f4(h){return this.__data__.get(h)}function h4(h){return this.__data__.has(h)}function d4(h,g){var x=this.__data__;if(x instanceof Ta){var $=x.__data__;if(!_u||$.length<s-1)return $.push([h,g]),this.size=++x.size,this;x=this.__data__=new Aa($)}return x.set(h,g),this.size=x.size,this}Ti.prototype.clear=l4,Ti.prototype.delete=u4,Ti.prototype.get=f4,Ti.prototype.has=h4,Ti.prototype.set=d4;function n2(h,g){var x=Vt(h),$=!x&&nc(h),G=!x&&!$&&co(h),oe=!x&&!$&&!G&&ll(h),be=x||$||G||oe,$e=be?T0(h.length,SB):[],Le=$e.length;for(var Je in h)(g||Cn.call(h,Je))&&!(be&&(Je=="length"||G&&(Je=="offset"||Je=="parent")||oe&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||_a(Je,Le)))&&$e.push(Je);return $e}function r2(h){var g=h.length;return g?h[H0(0,g-1)]:t}function p4(h,g){return Pd(vs(h),Jo(g,0,h.length))}function g4(h){return Pd(vs(h))}function D0(h,g,x){(x!==t&&!Ai(h[g],x)||x===t&&!(g in h))&&$a(h,g,x)}function Mu(h,g,x){var $=h[g];(!(Cn.call(h,g)&&Ai($,x))||x===t&&!(g in h))&&$a(h,g,x)}function Rd(h,g){for(var x=h.length;x--;)if(Ai(h[x][0],g))return x;return-1}function m4(h,g,x,$){return so(h,function(G,oe,be){g($,G,x(G),be)}),$}function s2(h,g){return h&&Xi(g,Or(g),h)}function v4(h,g){return h&&Xi(g,bs(g),h)}function $a(h,g,x){g=="__proto__"&&bd?bd(h,g,{configurable:!0,enumerable:!0,value:x,writable:!0}):h[g]=x}function B0(h,g){for(var x=-1,$=g.length,G=je($),oe=h==null;++x<$;)G[x]=oe?t:m1(h,g[x]);return G}function Jo(h,g,x){return h===h&&(x!==t&&(h=h<=x?h:x),g!==t&&(h=h>=g?h:g)),h}function ei(h,g,x,$,G,oe){var be,$e=g&f,Le=g&d,Je=g&p;if(x&&(be=G?x(h,$,G,oe):x(h)),be!==t)return be;if(!Yn(h))return h;var Qe=Vt(h);if(Qe){if(be=iM(h),!$e)return vs(h,be)}else{var tt=Yr(h),ht=tt==q||tt==Z;if(co(h))return T2(h,$e);if(tt==R||tt==J||ht&&!G){if(be=Le||ht?{}:j2(h),!$e)return Le?K4(h,v4(be,h)):j4(h,s2(be,h))}else{if(!_n[tt])return G?h:{};be=aM(h,tt,$e)}}oe||(oe=new Ti);var St=oe.get(h);if(St)return St;oe.set(h,be),wS(h)?h.forEach(function(_t){be.add(ei(_t,g,x,_t,h,oe))}):yS(h)&&h.forEach(function(_t,nn){be.set(nn,ei(_t,g,x,nn,h,oe))});var Ot=Je?Le?n1:t1:Le?bs:Or,Kt=Qe?t:Ot(h);return Zs(Kt||h,function(_t,nn){Kt&&(nn=_t,_t=h[nn]),Mu(be,nn,ei(_t,g,x,nn,h,oe))}),be}function I4(h){var g=Or(h);return function(x){return i2(x,h,g)}}function i2(h,g,x){var $=x.length;if(h==null)return!$;for(h=Tn(h);$--;){var G=x[$],oe=g[G],be=h[G];if(be===t&&!(G in h)||!oe(be))return!1}return!0}function a2(h,g,x){if(typeof h!="function")throw new Js(a);return Gu(function(){h.apply(t,x)},g)}function Pu(h,g,x,$){var G=-1,oe=cd,be=!0,$e=h.length,Le=[],Je=g.length;if(!$e)return Le;x&&(g=Gn(g,Fs(x))),$?(oe=w0,be=!1):g.length>=s&&(oe=Nu,be=!1,g=new Zo(g));e:for(;++G<$e;){var Qe=h[G],tt=x==null?Qe:x(Qe);if(Qe=$||Qe!==0?Qe:0,be&&tt===tt){for(var ht=Je;ht--;)if(g[ht]===tt)continue e;Le.push(Qe)}else oe(g,tt,$)||Le.push(Qe)}return Le}var so=_2(Ki),o2=_2(P0,!0);function b4(h,g){var x=!0;return so(h,function($,G,oe){return x=!!g($,G,oe),x}),x}function kd(h,g,x){for(var $=-1,G=h.length;++$<G;){var oe=h[$],be=g(oe);if(be!=null&&($e===t?be===be&&!Bs(be):x(be,$e)))var $e=be,Le=oe}return Le}function y4(h,g,x,$){var G=h.length;for(x=Gt(x),x<0&&(x=-x>G?0:G+x),$=$===t||$>G?G:Gt($),$<0&&($+=G),$=x>$?0:CS($);x<$;)h[x++]=g;return h}function c2(h,g){var x=[];return so(h,function($,G,oe){g($,G,oe)&&x.push($)}),x}function Gr(h,g,x,$,G){var oe=-1,be=h.length;for(x||(x=cM),G||(G=[]);++oe<be;){var $e=h[oe];g>0&&x($e)?g>1?Gr($e,g-1,x,$,G):to(G,$e):$||(G[G.length]=$e)}return G}var M0=F2(),l2=F2(!0);function Ki(h,g){return h&&M0(h,g,Or)}function P0(h,g){return h&&l2(h,g,Or)}function Ed(h,g){return eo(g,function(x){return Fa(h[x])})}function Qo(h,g){g=ao(g,h);for(var x=0,$=g.length;h!=null&&x<$;)h=h[Yi(g[x++])];return x&&x==$?h:t}function u2(h,g,x){var $=g(h);return Vt(h)?$:to($,x(h))}function as(h){return h==null?h===t?rt:B:Xo&&Xo in Tn(h)?nM(h):gM(h)}function L0(h,g){return h>g}function x4(h,g){return h!=null&&Cn.call(h,g)}function w4(h,g){return h!=null&&g in Tn(h)}function S4(h,g,x){return h>=Xr(g,x)&&h<Rr(g,x)}function U0(h,g,x){for(var $=x?w0:cd,G=h[0].length,oe=h.length,be=oe,$e=je(oe),Le=1/0,Je=[];be--;){var Qe=h[be];be&&g&&(Qe=Gn(Qe,Fs(g))),Le=Xr(Qe.length,Le),$e[be]=!x&&(g||G>=120&&Qe.length>=120)?new Zo(be&&Qe):t}Qe=h[0];var tt=-1,ht=$e[0];e:for(;++tt<G&&Je.length<Le;){var St=Qe[tt],Ot=g?g(St):St;if(St=x||St!==0?St:0,!(ht?Nu(ht,Ot):$(Je,Ot,x))){for(be=oe;--be;){var Kt=$e[be];if(!(Kt?Nu(Kt,Ot):$(h[be],Ot,x)))continue e}ht&&ht.push(Ot),Je.push(St)}}return Je}function C4(h,g,x,$){return Ki(h,function(G,oe,be){g($,x(G),oe,be)}),$}function Lu(h,g,x){g=ao(g,h),h=Z2(h,g);var $=h==null?h:h[Yi(ni(g))];return $==null?t:_s($,h,x)}function f2(h){return er(h)&&as(h)==J}function R4(h){return er(h)&&as(h)==W}function k4(h){return er(h)&&as(h)==pe}function Uu(h,g,x,$,G){return h===g?!0:h==null||g==null||!er(h)&&!er(g)?h!==h&&g!==g:E4(h,g,x,$,Uu,G)}function E4(h,g,x,$,G,oe){var be=Vt(h),$e=Vt(g),Le=be?D:Yr(h),Je=$e?D:Yr(g);Le=Le==J?R:Le,Je=Je==J?R:Je;var Qe=Le==R,tt=Je==R,ht=Le==Je;if(ht&&co(h)){if(!co(g))return!1;be=!0,Qe=!1}if(ht&&!Qe)return oe||(oe=new Ti),be||ll(h)?G2(h,g,x,$,G,oe):eM(h,g,Le,x,$,G,oe);if(!(x&m)){var St=Qe&&Cn.call(h,"__wrapped__"),Ot=tt&&Cn.call(g,"__wrapped__");if(St||Ot){var Kt=St?h.value():h,_t=Ot?g.value():g;return oe||(oe=new Ti),G(Kt,_t,x,$,oe)}}return ht?(oe||(oe=new Ti),tM(h,g,x,$,G,oe)):!1}function T4(h){return er(h)&&Yr(h)==se}function z0(h,g,x,$){var G=x.length,oe=G,be=!$;if(h==null)return!oe;for(h=Tn(h);G--;){var $e=x[G];if(be&&$e[2]?$e[1]!==h[$e[0]]:!($e[0]in h))return!1}for(;++G<oe;){$e=x[G];var Le=$e[0],Je=h[Le],Qe=$e[1];if(be&&$e[2]){if(Je===t&&!(Le in h))return!1}else{var tt=new Ti;if($)var ht=$(Je,Qe,Le,h,g,tt);if(!(ht===t?Uu(Qe,Je,m|I,$,tt):ht))return!1}}return!0}function h2(h){if(!Yn(h)||uM(h))return!1;var g=Fa(h)?TB:d0;return g.test(tc(h))}function A4(h){return er(h)&&as(h)==fe}function $4(h){return er(h)&&Yr(h)==Te}function N4(h){return er(h)&&Gd(h.length)&&!!Ln[as(h)]}function d2(h){return typeof h=="function"?h:h==null?ys:typeof h=="object"?Vt(h)?m2(h[0],h[1]):g2(h):DS(h)}function V0(h){if(!Wu(h))return FB(h);var g=[];for(var x in Tn(h))Cn.call(h,x)&&x!="constructor"&&g.push(x);return g}function O4(h){if(!Yn(h))return pM(h);var g=Wu(h),x=[];for(var $ in h)$=="constructor"&&(g||!Cn.call(h,$))||x.push($);return x}function W0(h,g){return h<g}function p2(h,g){var x=-1,$=Is(h)?je(h.length):[];return so(h,function(G,oe,be){$[++x]=g(G,oe,be)}),$}function g2(h){var g=s1(h);return g.length==1&&g[0][2]?X2(g[0][0],g[0][1]):function(x){return x===h||z0(x,h,g)}}function m2(h,g){return a1(h)&&K2(g)?X2(Yi(h),g):function(x){var $=m1(x,h);return $===t&&$===g?v1(x,h):Uu(g,$,m|I)}}function Td(h,g,x,$,G){h!==g&&M0(g,function(oe,be){if(G||(G=new Ti),Yn(oe))_4(h,g,be,x,Td,$,G);else{var $e=$?$(c1(h,be),oe,be+"",h,g,G):t;$e===t&&($e=oe),D0(h,be,$e)}},bs)}function _4(h,g,x,$,G,oe,be){var $e=c1(h,x),Le=c1(g,x),Je=be.get(Le);if(Je){D0(h,x,Je);return}var Qe=oe?oe($e,Le,x+"",h,g,be):t,tt=Qe===t;if(tt){var ht=Vt(Le),St=!ht&&co(Le),Ot=!ht&&!St&&ll(Le);Qe=Le,ht||St||Ot?Vt($e)?Qe=$e:lr($e)?Qe=vs($e):St?(tt=!1,Qe=T2(Le,!0)):Ot?(tt=!1,Qe=A2(Le,!0)):Qe=[]:Hu(Le)||nc(Le)?(Qe=$e,nc($e)?Qe=RS($e):(!Yn($e)||Fa($e))&&(Qe=j2(Le))):tt=!1}tt&&(be.set(Le,Qe),G(Qe,Le,$,oe,be),be.delete(Le)),D0(h,x,Qe)}function v2(h,g){var x=h.length;if(x)return g+=g<0?x:0,_a(g,x)?h[g]:t}function I2(h,g,x){g.length?g=Gn(g,function(oe){return Vt(oe)?function(be){return Qo(be,oe.length===1?oe[0]:oe)}:oe}):g=[ys];var $=-1;g=Gn(g,Fs(Nt()));var G=p2(h,function(oe,be,$e){var Le=Gn(g,function(Je){return Je(oe)});return{criteria:Le,index:++$,value:oe}});return aB(G,function(oe,be){return q4(oe,be,x)})}function F4(h,g){return b2(h,g,function(x,$){return v1(h,$)})}function b2(h,g,x){for(var $=-1,G=g.length,oe={};++$<G;){var be=g[$],$e=Qo(h,be);x($e,be)&&zu(oe,ao(be,h),$e)}return oe}function D4(h){return function(g){return Qo(g,h)}}function G0(h,g,x,$){var G=$?iB:Jc,oe=-1,be=g.length,$e=h;for(h===g&&(g=vs(g)),x&&($e=Gn(h,Fs(x)));++oe<be;)for(var Le=0,Je=g[oe],Qe=x?x(Je):Je;(Le=G($e,Qe,Le,$))>-1;)$e!==h&&Id.call($e,Le,1),Id.call(h,Le,1);return h}function y2(h,g){for(var x=h?g.length:0,$=x-1;x--;){var G=g[x];if(x==$||G!==oe){var oe=G;_a(G)?Id.call(h,G,1):K0(h,G)}}return h}function H0(h,g){return h+xd(e2()*(g-h+1))}function B4(h,g,x,$){for(var G=-1,oe=Rr(yd((g-h)/(x||1)),0),be=je(oe);oe--;)be[$?oe:++G]=h,h+=x;return be}function q0(h,g){var x="";if(!h||g<1||g>me)return x;do g%2&&(x+=h),g=xd(g/2),g&&(h+=h);while(g);return x}function Jt(h,g){return l1(Y2(h,g,ys),h+"")}function M4(h){return r2(ul(h))}function P4(h,g){var x=ul(h);return Pd(x,Jo(g,0,x.length))}function zu(h,g,x,$){if(!Yn(h))return h;g=ao(g,h);for(var G=-1,oe=g.length,be=oe-1,$e=h;$e!=null&&++G<oe;){var Le=Yi(g[G]),Je=x;if(Le==="__proto__"||Le==="constructor"||Le==="prototype")return h;if(G!=be){var Qe=$e[Le];Je=$?$(Qe,Le,$e):t,Je===t&&(Je=Yn(Qe)?Qe:_a(g[G+1])?[]:{})}Mu($e,Le,Je),$e=$e[Le]}return h}var x2=wd?function(h,g){return wd.set(h,g),h}:ys,L4=bd?function(h,g){return bd(h,"toString",{configurable:!0,enumerable:!1,value:b1(g),writable:!0})}:ys;function U4(h){return Pd(ul(h))}function ti(h,g,x){var $=-1,G=h.length;g<0&&(g=-g>G?0:G+g),x=x>G?G:x,x<0&&(x+=G),G=g>x?0:x-g>>>0,g>>>=0;for(var oe=je(G);++$<G;)oe[$]=h[$+g];return oe}function z4(h,g){var x;return so(h,function($,G,oe){return x=g($,G,oe),!x}),!!x}function Ad(h,g,x){var $=0,G=h==null?$:h.length;if(typeof g=="number"&&g===g&&G<=xe){for(;$<G;){var oe=$+G>>>1,be=h[oe];be!==null&&!Bs(be)&&(x?be<=g:be<g)?$=oe+1:G=oe}return G}return j0(h,g,ys,x)}function j0(h,g,x,$){var G=0,oe=h==null?0:h.length;if(oe===0)return 0;g=x(g);for(var be=g!==g,$e=g===null,Le=Bs(g),Je=g===t;G<oe;){var Qe=xd((G+oe)/2),tt=x(h[Qe]),ht=tt!==t,St=tt===null,Ot=tt===tt,Kt=Bs(tt);if(be)var _t=$||Ot;else Je?_t=Ot&&($||ht):$e?_t=Ot&&ht&&($||!St):Le?_t=Ot&&ht&&!St&&($||!Kt):St||Kt?_t=!1:_t=$?tt<=g:tt<g;_t?G=Qe+1:oe=Qe}return Xr(oe,Ne)}function w2(h,g){for(var x=-1,$=h.length,G=0,oe=[];++x<$;){var be=h[x],$e=g?g(be):be;if(!x||!Ai($e,Le)){var Le=$e;oe[G++]=be===0?0:be}}return oe}function S2(h){return typeof h=="number"?h:Bs(h)?Ce:+h}function Ds(h){if(typeof h=="string")return h;if(Vt(h))return Gn(h,Ds)+"";if(Bs(h))return t2?t2.call(h):"";var g=h+"";return g=="0"&&1/h==-Se?"-0":g}function io(h,g,x){var $=-1,G=cd,oe=h.length,be=!0,$e=[],Le=$e;if(x)be=!1,G=w0;else if(oe>=s){var Je=g?null:J4(h);if(Je)return ud(Je);be=!1,G=Nu,Le=new Zo}else Le=g?[]:$e;e:for(;++$<oe;){var Qe=h[$],tt=g?g(Qe):Qe;if(Qe=x||Qe!==0?Qe:0,be&&tt===tt){for(var ht=Le.length;ht--;)if(Le[ht]===tt)continue e;g&&Le.push(tt),$e.push(Qe)}else G(Le,tt,x)||(Le!==$e&&Le.push(tt),$e.push(Qe))}return $e}function K0(h,g){return g=ao(g,h),h=Z2(h,g),h==null||delete h[Yi(ni(g))]}function C2(h,g,x,$){return zu(h,g,x(Qo(h,g)),$)}function $d(h,g,x,$){for(var G=h.length,oe=$?G:-1;($?oe--:++oe<G)&&g(h[oe],oe,h););return x?ti(h,$?0:oe,$?oe+1:G):ti(h,$?oe+1:0,$?G:oe)}function R2(h,g){var x=h;return x instanceof rn&&(x=x.value()),S0(g,function($,G){return G.func.apply(G.thisArg,to([$],G.args))},x)}function X0(h,g,x){var $=h.length;if($<2)return $?io(h[0]):[];for(var G=-1,oe=je($);++G<$;)for(var be=h[G],$e=-1;++$e<$;)$e!=G&&(oe[G]=Pu(oe[G]||be,h[$e],g,x));return io(Gr(oe,1),g,x)}function k2(h,g,x){for(var $=-1,G=h.length,oe=g.length,be={};++$<G;){var $e=$<oe?g[$]:t;x(be,h[$],$e)}return be}function Y0(h){return lr(h)?h:[]}function Z0(h){return typeof h=="function"?h:ys}function ao(h,g){return Vt(h)?h:a1(h,g)?[h]:tS(yn(h))}var V4=Jt;function oo(h,g,x){var $=h.length;return x=x===t?$:x,!g&&x>=$?h:ti(h,g,x)}var E2=AB||function(h){return Wr.clearTimeout(h)};function T2(h,g){if(g)return h.slice();var x=h.length,$=Xw?Xw(x):new h.constructor(x);return h.copy($),$}function J0(h){var g=new h.constructor(h.byteLength);return new md(g).set(new md(h)),g}function W4(h,g){var x=g?J0(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.byteLength)}function G4(h){var g=new h.constructor(h.source,Au.exec(h));return g.lastIndex=h.lastIndex,g}function H4(h){return Bu?Tn(Bu.call(h)):{}}function A2(h,g){var x=g?J0(h.buffer):h.buffer;return new h.constructor(x,h.byteOffset,h.length)}function $2(h,g){if(h!==g){var x=h!==t,$=h===null,G=h===h,oe=Bs(h),be=g!==t,$e=g===null,Le=g===g,Je=Bs(g);if(!$e&&!Je&&!oe&&h>g||oe&&be&&Le&&!$e&&!Je||$&&be&&Le||!x&&Le||!G)return 1;if(!$&&!oe&&!Je&&h<g||Je&&x&&G&&!$&&!oe||$e&&x&&G||!be&&G||!Le)return-1}return 0}function q4(h,g,x){for(var $=-1,G=h.criteria,oe=g.criteria,be=G.length,$e=x.length;++$<be;){var Le=$2(G[$],oe[$]);if(Le){if($>=$e)return Le;var Je=x[$];return Le*(Je=="desc"?-1:1)}}return h.index-g.index}function N2(h,g,x,$){for(var G=-1,oe=h.length,be=x.length,$e=-1,Le=g.length,Je=Rr(oe-be,0),Qe=je(Le+Je),tt=!$;++$e<Le;)Qe[$e]=g[$e];for(;++G<be;)(tt||G<oe)&&(Qe[x[G]]=h[G]);for(;Je--;)Qe[$e++]=h[G++];return Qe}function O2(h,g,x,$){for(var G=-1,oe=h.length,be=-1,$e=x.length,Le=-1,Je=g.length,Qe=Rr(oe-$e,0),tt=je(Qe+Je),ht=!$;++G<Qe;)tt[G]=h[G];for(var St=G;++Le<Je;)tt[St+Le]=g[Le];for(;++be<$e;)(ht||G<oe)&&(tt[St+x[be]]=h[G++]);return tt}function vs(h,g){var x=-1,$=h.length;for(g||(g=je($));++x<$;)g[x]=h[x];return g}function Xi(h,g,x,$){var G=!x;x||(x={});for(var oe=-1,be=g.length;++oe<be;){var $e=g[oe],Le=$?$(x[$e],h[$e],$e,x,h):t;Le===t&&(Le=h[$e]),G?$a(x,$e,Le):Mu(x,$e,Le)}return x}function j4(h,g){return Xi(h,i1(h),g)}function K4(h,g){return Xi(h,H2(h),g)}function Nd(h,g){return function(x,$){var G=Vt(x)?QD:m4,oe=g?g():{};return G(x,h,Nt($,2),oe)}}function al(h){return Jt(function(g,x){var $=-1,G=x.length,oe=G>1?x[G-1]:t,be=G>2?x[2]:t;for(oe=h.length>3&&typeof oe=="function"?(G--,oe):t,be&&os(x[0],x[1],be)&&(oe=G<3?t:oe,G=1),g=Tn(g);++$<G;){var $e=x[$];$e&&h(g,$e,$,oe)}return g})}function _2(h,g){return function(x,$){if(x==null)return x;if(!Is(x))return h(x,$);for(var G=x.length,oe=g?G:-1,be=Tn(x);(g?oe--:++oe<G)&&$(be[oe],oe,be)!==!1;);return x}}function F2(h){return function(g,x,$){for(var G=-1,oe=Tn(g),be=$(g),$e=be.length;$e--;){var Le=be[h?$e:++G];if(x(oe[Le],Le,oe)===!1)break}return g}}function X4(h,g,x){var $=g&v,G=Vu(h);function oe(){var be=this&&this!==Wr&&this instanceof oe?G:h;return be.apply($?x:this,arguments)}return oe}function D2(h){return function(g){g=yn(g);var x=Qc(g)?Ei(g):t,$=x?x[0]:g.charAt(0),G=x?oo(x,1).join(""):g.slice(1);return $[h]()+G}}function ol(h){return function(g){return S0(_S(OS(g).replace(LD,"")),h,"")}}function Vu(h){return function(){var g=arguments;switch(g.length){case 0:return new h;case 1:return new h(g[0]);case 2:return new h(g[0],g[1]);case 3:return new h(g[0],g[1],g[2]);case 4:return new h(g[0],g[1],g[2],g[3]);case 5:return new h(g[0],g[1],g[2],g[3],g[4]);case 6:return new h(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new h(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var x=il(h.prototype),$=h.apply(x,g);return Yn($)?$:x}}function Y4(h,g,x){var $=Vu(h);function G(){for(var oe=arguments.length,be=je(oe),$e=oe,Le=cl(G);$e--;)be[$e]=arguments[$e];var Je=oe<3&&be[0]!==Le&&be[oe-1]!==Le?[]:no(be,Le);if(oe-=Je.length,oe<x)return U2(h,g,Od,G.placeholder,t,be,Je,t,t,x-oe);var Qe=this&&this!==Wr&&this instanceof G?$:h;return _s(Qe,this,be)}return G}function B2(h){return function(g,x,$){var G=Tn(g);if(!Is(g)){var oe=Nt(x,3);g=Or(g),x=function($e){return oe(G[$e],$e,G)}}var be=h(g,x,$);return be>-1?G[oe?g[be]:be]:t}}function M2(h){return Oa(function(g){var x=g.length,$=x,G=Qs.prototype.thru;for(h&&g.reverse();$--;){var oe=g[$];if(typeof oe!="function")throw new Js(a);if(G&&!be&&Bd(oe)=="wrapper")var be=new Qs([],!0)}for($=be?$:x;++$<x;){oe=g[$];var $e=Bd(oe),Le=$e=="wrapper"?r1(oe):t;Le&&o1(Le[0])&&Le[1]==(E|S|C|A)&&!Le[4].length&&Le[9]==1?be=be[Bd(Le[0])].apply(be,Le[3]):be=oe.length==1&&o1(oe)?be[$e]():be.thru(oe)}return function(){var Je=arguments,Qe=Je[0];if(be&&Je.length==1&&Vt(Qe))return be.plant(Qe).value();for(var tt=0,ht=x?g[tt].apply(this,Je):Qe;++tt<x;)ht=g[tt].call(this,ht);return ht}})}function Od(h,g,x,$,G,oe,be,$e,Le,Je){var Qe=g&E,tt=g&v,ht=g&b,St=g&(S|w),Ot=g&M,Kt=ht?t:Vu(h);function _t(){for(var nn=arguments.length,cn=je(nn),Ms=nn;Ms--;)cn[Ms]=arguments[Ms];if(St)var cs=cl(_t),Ps=cB(cn,cs);if($&&(cn=N2(cn,$,G,St)),oe&&(cn=O2(cn,oe,be,St)),nn-=Ps,St&&nn<Je){var ur=no(cn,cs);return U2(h,g,Od,_t.placeholder,x,cn,ur,$e,Le,Je-nn)}var $i=tt?x:this,Ba=ht?$i[h]:h;return nn=cn.length,$e?cn=mM(cn,$e):Ot&&nn>1&&cn.reverse(),Qe&&Le<nn&&(cn.length=Le),this&&this!==Wr&&this instanceof _t&&(Ba=Kt||Vu(Ba)),Ba.apply($i,cn)}return _t}function P2(h,g){return function(x,$){return C4(x,h,g($),{})}}function _d(h,g){return function(x,$){var G;if(x===t&&$===t)return g;if(x!==t&&(G=x),$!==t){if(G===t)return $;typeof x=="string"||typeof $=="string"?(x=Ds(x),$=Ds($)):(x=S2(x),$=S2($)),G=h(x,$)}return G}}function Q0(h){return Oa(function(g){return g=Gn(g,Fs(Nt())),Jt(function(x){var $=this;return h(g,function(G){return _s(G,$,x)})})})}function Fd(h,g){g=g===t?" ":Ds(g);var x=g.length;if(x<2)return x?q0(g,h):g;var $=q0(g,yd(h/el(g)));return Qc(g)?oo(Ei($),0,h).join(""):$.slice(0,h)}function Z4(h,g,x,$){var G=g&v,oe=Vu(h);function be(){for(var $e=-1,Le=arguments.length,Je=-1,Qe=$.length,tt=je(Qe+Le),ht=this&&this!==Wr&&this instanceof be?oe:h;++Je<Qe;)tt[Je]=$[Je];for(;Le--;)tt[Je++]=arguments[++$e];return _s(ht,G?x:this,tt)}return be}function L2(h){return function(g,x,$){return $&&typeof $!="number"&&os(g,x,$)&&(x=$=t),g=Da(g),x===t?(x=g,g=0):x=Da(x),$=$===t?g<x?1:-1:Da($),B4(g,x,$,h)}}function Dd(h){return function(g,x){return typeof g=="string"&&typeof x=="string"||(g=ri(g),x=ri(x)),h(g,x)}}function U2(h,g,x,$,G,oe,be,$e,Le,Je){var Qe=g&S,tt=Qe?be:t,ht=Qe?t:be,St=Qe?oe:t,Ot=Qe?t:oe;g|=Qe?C:N,g&=~(Qe?N:C),g&y||(g&=~(v|b));var Kt=[h,g,G,St,tt,Ot,ht,$e,Le,Je],_t=x.apply(t,Kt);return o1(h)&&J2(_t,Kt),_t.placeholder=$,Q2(_t,h,g)}function e1(h){var g=Cr[h];return function(x,$){if(x=ri(x),$=$==null?0:Xr(Gt($),292),$&&Qw(x)){var G=(yn(x)+"e").split("e"),oe=g(G[0]+"e"+(+G[1]+$));return G=(yn(oe)+"e").split("e"),+(G[0]+"e"+(+G[1]-$))}return g(x)}}var J4=rl&&1/ud(new rl([,-0]))[1]==Se?function(h){return new rl(h)}:w1;function z2(h){return function(g){var x=Yr(g);return x==se?$0(g):x==Te?gB(g):oB(g,h(g))}}function Na(h,g,x,$,G,oe,be,$e){var Le=g&b;if(!Le&&typeof h!="function")throw new Js(a);var Je=$?$.length:0;if(Je||(g&=~(C|N),$=G=t),be=be===t?be:Rr(Gt(be),0),$e=$e===t?$e:Gt($e),Je-=G?G.length:0,g&N){var Qe=$,tt=G;$=G=t}var ht=Le?t:r1(h),St=[h,g,x,$,G,Qe,tt,oe,be,$e];if(ht&&dM(St,ht),h=St[0],g=St[1],x=St[2],$=St[3],G=St[4],$e=St[9]=St[9]===t?Le?0:h.length:Rr(St[9]-Je,0),!$e&&g&(S|w)&&(g&=~(S|w)),!g||g==v)var Ot=X4(h,g,x);else g==S||g==w?Ot=Y4(h,g,$e):(g==C||g==(v|C))&&!G.length?Ot=Z4(h,g,x,$):Ot=Od.apply(t,St);var Kt=ht?x2:J2;return Q2(Kt(Ot,St),h,g)}function V2(h,g,x,$){return h===t||Ai(h,nl[x])&&!Cn.call($,x)?g:h}function W2(h,g,x,$,G,oe){return Yn(h)&&Yn(g)&&(oe.set(g,h),Td(h,g,t,W2,oe),oe.delete(g)),h}function Q4(h){return Hu(h)?t:h}function G2(h,g,x,$,G,oe){var be=x&m,$e=h.length,Le=g.length;if($e!=Le&&!(be&&Le>$e))return!1;var Je=oe.get(h),Qe=oe.get(g);if(Je&&Qe)return Je==g&&Qe==h;var tt=-1,ht=!0,St=x&I?new Zo:t;for(oe.set(h,g),oe.set(g,h);++tt<$e;){var Ot=h[tt],Kt=g[tt];if($)var _t=be?$(Kt,Ot,tt,g,h,oe):$(Ot,Kt,tt,h,g,oe);if(_t!==t){if(_t)continue;ht=!1;break}if(St){if(!C0(g,function(nn,cn){if(!Nu(St,cn)&&(Ot===nn||G(Ot,nn,x,$,oe)))return St.push(cn)})){ht=!1;break}}else if(!(Ot===Kt||G(Ot,Kt,x,$,oe))){ht=!1;break}}return oe.delete(h),oe.delete(g),ht}function eM(h,g,x,$,G,oe,be){switch(x){case T:if(h.byteLength!=g.byteLength||h.byteOffset!=g.byteOffset)return!1;h=h.buffer,g=g.buffer;case W:return!(h.byteLength!=g.byteLength||!oe(new md(h),new md(g)));case Q:case pe:case ie:return Ai(+h,+g);case L:return h.name==g.name&&h.message==g.message;case fe:case Be:return h==g+"";case se:var $e=$0;case Te:var Le=$&m;if($e||($e=ud),h.size!=g.size&&!Le)return!1;var Je=be.get(h);if(Je)return Je==g;$|=I,be.set(h,g);var Qe=G2($e(h),$e(g),$,G,oe,be);return be.delete(h),Qe;case He:if(Bu)return Bu.call(h)==Bu.call(g)}return!1}function tM(h,g,x,$,G,oe){var be=x&m,$e=t1(h),Le=$e.length,Je=t1(g),Qe=Je.length;if(Le!=Qe&&!be)return!1;for(var tt=Le;tt--;){var ht=$e[tt];if(!(be?ht in g:Cn.call(g,ht)))return!1}var St=oe.get(h),Ot=oe.get(g);if(St&&Ot)return St==g&&Ot==h;var Kt=!0;oe.set(h,g),oe.set(g,h);for(var _t=be;++tt<Le;){ht=$e[tt];var nn=h[ht],cn=g[ht];if($)var Ms=be?$(cn,nn,ht,g,h,oe):$(nn,cn,ht,h,g,oe);if(!(Ms===t?nn===cn||G(nn,cn,x,$,oe):Ms)){Kt=!1;break}_t||(_t=ht=="constructor")}if(Kt&&!_t){var cs=h.constructor,Ps=g.constructor;cs!=Ps&&"constructor"in h&&"constructor"in g&&!(typeof cs=="function"&&cs instanceof cs&&typeof Ps=="function"&&Ps instanceof Ps)&&(Kt=!1)}return oe.delete(h),oe.delete(g),Kt}function Oa(h){return l1(Y2(h,t,iS),h+"")}function t1(h){return u2(h,Or,i1)}function n1(h){return u2(h,bs,H2)}var r1=wd?function(h){return wd.get(h)}:w1;function Bd(h){for(var g=h.name+"",x=sl[g],$=Cn.call(sl,g)?x.length:0;$--;){var G=x[$],oe=G.func;if(oe==null||oe==h)return G.name}return g}function cl(h){var g=Cn.call(te,"placeholder")?te:h;return g.placeholder}function Nt(){var h=te.iteratee||y1;return h=h===y1?d2:h,arguments.length?h(arguments[0],arguments[1]):h}function Md(h,g){var x=h.__data__;return lM(g)?x[typeof g=="string"?"string":"hash"]:x.map}function s1(h){for(var g=Or(h),x=g.length;x--;){var $=g[x],G=h[$];g[x]=[$,G,K2(G)]}return g}function ec(h,g){var x=hB(h,g);return h2(x)?x:t}function nM(h){var g=Cn.call(h,Xo),x=h[Xo];try{h[Xo]=t;var $=!0}catch{}var G=pd.call(h);return $&&(g?h[Xo]=x:delete h[Xo]),G}var i1=O0?function(h){return h==null?[]:(h=Tn(h),eo(O0(h),function(g){return Zw.call(h,g)}))}:S1,H2=O0?function(h){for(var g=[];h;)to(g,i1(h)),h=vd(h);return g}:S1,Yr=as;(_0&&Yr(new _0(new ArrayBuffer(1)))!=T||_u&&Yr(new _u)!=se||F0&&Yr(F0.resolve())!=k||rl&&Yr(new rl)!=Te||Fu&&Yr(new Fu)!=ct)&&(Yr=function(h){var g=as(h),x=g==R?h.constructor:t,$=x?tc(x):"";if($)switch($){case PB:return T;case LB:return se;case UB:return k;case zB:return Te;case VB:return ct}return g});function rM(h,g,x){for(var $=-1,G=x.length;++$<G;){var oe=x[$],be=oe.size;switch(oe.type){case"drop":h+=be;break;case"dropRight":g-=be;break;case"take":g=Xr(g,h+be);break;case"takeRight":h=Rr(h,g-be);break}}return{start:h,end:g}}function sM(h){var g=h.match(Tu);return g?g[1].split(sd):[]}function q2(h,g,x){g=ao(g,h);for(var $=-1,G=g.length,oe=!1;++$<G;){var be=Yi(g[$]);if(!(oe=h!=null&&x(h,be)))break;h=h[be]}return oe||++$!=G?oe:(G=h==null?0:h.length,!!G&&Gd(G)&&_a(be,G)&&(Vt(h)||nc(h)))}function iM(h){var g=h.length,x=new h.constructor(g);return g&&typeof h[0]=="string"&&Cn.call(h,"index")&&(x.index=h.index,x.input=h.input),x}function j2(h){return typeof h.constructor=="function"&&!Wu(h)?il(vd(h)):{}}function aM(h,g,x){var $=h.constructor;switch(g){case W:return J0(h);case Q:case pe:return new $(+h);case T:return W4(h,x);case O:case ue:case Ae:case ze:case Xe:case Ct:case hn:case en:case tn:return A2(h,x);case se:return new $;case ie:case Be:return new $(h);case fe:return G4(h);case Te:return new $;case He:return H4(h)}}function oM(h,g){var x=g.length;if(!x)return h;var $=x-1;return g[$]=(x>1?"& ":"")+g[$],g=g.join(x>2?", ":" "),h.replace(u0,`{
/* [wrapped with `+g+`] */
`)}function cM(h){return Vt(h)||nc(h)||!!(Jw&&h&&h[Jw])}function _a(h,g){var x=typeof h;return g=g??me,!!g&&(x=="number"||x!="symbol"&&p0.test(h))&&h>-1&&h%1==0&&h<g}function os(h,g,x){if(!Yn(x))return!1;var $=typeof g;return($=="number"?Is(x)&&_a(g,x.length):$=="string"&&g in x)?Ai(x[g],h):!1}function a1(h,g){if(Vt(h))return!1;var x=typeof h;return x=="number"||x=="symbol"||x=="boolean"||h==null||Bs(h)?!0:ku.test(h)||!qo.test(h)||g!=null&&h in Tn(g)}function lM(h){var g=typeof h;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?h!=="__proto__":h===null}function o1(h){var g=Bd(h),x=te[g];if(typeof x!="function"||!(g in rn.prototype))return!1;if(h===x)return!0;var $=r1(x);return!!$&&h===$[0]}function uM(h){return!!Kw&&Kw in h}var fM=hd?Fa:C1;function Wu(h){var g=h&&h.constructor,x=typeof g=="function"&&g.prototype||nl;return h===x}function K2(h){return h===h&&!Yn(h)}function X2(h,g){return function(x){return x==null?!1:x[h]===g&&(g!==t||h in Tn(x))}}function hM(h){var g=Vd(h,function($){return x.size===l&&x.clear(),$}),x=g.cache;return g}function dM(h,g){var x=h[1],$=g[1],G=x|$,oe=G<(v|b|E),be=$==E&&x==S||$==E&&x==A&&h[7].length<=g[8]||$==(E|A)&&g[7].length<=g[8]&&x==S;if(!(oe||be))return h;$&v&&(h[2]=g[2],G|=x&v?0:y);var $e=g[3];if($e){var Le=h[3];h[3]=Le?N2(Le,$e,g[4]):$e,h[4]=Le?no(h[3],u):g[4]}return $e=g[5],$e&&(Le=h[5],h[5]=Le?O2(Le,$e,g[6]):$e,h[6]=Le?no(h[5],u):g[6]),$e=g[7],$e&&(h[7]=$e),$&E&&(h[8]=h[8]==null?g[8]:Xr(h[8],g[8])),h[9]==null&&(h[9]=g[9]),h[0]=g[0],h[1]=G,h}function pM(h){var g=[];if(h!=null)for(var x in Tn(h))g.push(x);return g}function gM(h){return pd.call(h)}function Y2(h,g,x){return g=Rr(g===t?h.length-1:g,0),function(){for(var $=arguments,G=-1,oe=Rr($.length-g,0),be=je(oe);++G<oe;)be[G]=$[g+G];G=-1;for(var $e=je(g+1);++G<g;)$e[G]=$[G];return $e[g]=x(be),_s(h,this,$e)}}function Z2(h,g){return g.length<2?h:Qo(h,ti(g,0,-1))}function mM(h,g){for(var x=h.length,$=Xr(g.length,x),G=vs(h);$--;){var oe=g[$];h[$]=_a(oe,x)?G[oe]:t}return h}function c1(h,g){if(!(g==="constructor"&&typeof h[g]=="function")&&g!="__proto__")return h[g]}var J2=eS(x2),Gu=NB||function(h,g){return Wr.setTimeout(h,g)},l1=eS(L4);function Q2(h,g,x){var $=g+"";return l1(h,oM($,vM(sM($),x)))}function eS(h){var g=0,x=0;return function(){var $=DB(),G=ne-($-x);if(x=$,G>0){if(++g>=re)return arguments[0]}else g=0;return h.apply(t,arguments)}}function Pd(h,g){var x=-1,$=h.length,G=$-1;for(g=g===t?$:g;++x<g;){var oe=H0(x,G),be=h[oe];h[oe]=h[x],h[x]=be}return h.length=g,h}var tS=hM(function(h){var g=[];return h.charCodeAt(0)===46&&g.push(""),h.replace(Qa,function(x,$,G,oe){g.push(G?oe.replace(ka,"$1"):$||x)}),g});function Yi(h){if(typeof h=="string"||Bs(h))return h;var g=h+"";return g=="0"&&1/h==-Se?"-0":g}function tc(h){if(h!=null){try{return dd.call(h)}catch{}try{return h+""}catch{}}return""}function vM(h,g){return Zs(ae,function(x){var $="_."+x[0];g&x[1]&&!cd(h,$)&&h.push($)}),h.sort()}function nS(h){if(h instanceof rn)return h.clone();var g=new Qs(h.__wrapped__,h.__chain__);return g.__actions__=vs(h.__actions__),g.__index__=h.__index__,g.__values__=h.__values__,g}function IM(h,g,x){(x?os(h,g,x):g===t)?g=1:g=Rr(Gt(g),0);var $=h==null?0:h.length;if(!$||g<1)return[];for(var G=0,oe=0,be=je(yd($/g));G<$;)be[oe++]=ti(h,G,G+=g);return be}function bM(h){for(var g=-1,x=h==null?0:h.length,$=0,G=[];++g<x;){var oe=h[g];oe&&(G[$++]=oe)}return G}function yM(){var h=arguments.length;if(!h)return[];for(var g=je(h-1),x=arguments[0],$=h;$--;)g[$-1]=arguments[$];return to(Vt(x)?vs(x):[x],Gr(g,1))}var xM=Jt(function(h,g){return lr(h)?Pu(h,Gr(g,1,lr,!0)):[]}),wM=Jt(function(h,g){var x=ni(g);return lr(x)&&(x=t),lr(h)?Pu(h,Gr(g,1,lr,!0),Nt(x,2)):[]}),SM=Jt(function(h,g){var x=ni(g);return lr(x)&&(x=t),lr(h)?Pu(h,Gr(g,1,lr,!0),t,x):[]});function CM(h,g,x){var $=h==null?0:h.length;return $?(g=x||g===t?1:Gt(g),ti(h,g<0?0:g,$)):[]}function RM(h,g,x){var $=h==null?0:h.length;return $?(g=x||g===t?1:Gt(g),g=$-g,ti(h,0,g<0?0:g)):[]}function kM(h,g){return h&&h.length?$d(h,Nt(g,3),!0,!0):[]}function EM(h,g){return h&&h.length?$d(h,Nt(g,3),!0):[]}function TM(h,g,x,$){var G=h==null?0:h.length;return G?(x&&typeof x!="number"&&os(h,g,x)&&(x=0,$=G),y4(h,g,x,$)):[]}function rS(h,g,x){var $=h==null?0:h.length;if(!$)return-1;var G=x==null?0:Gt(x);return G<0&&(G=Rr($+G,0)),ld(h,Nt(g,3),G)}function sS(h,g,x){var $=h==null?0:h.length;if(!$)return-1;var G=$-1;return x!==t&&(G=Gt(x),G=x<0?Rr($+G,0):Xr(G,$-1)),ld(h,Nt(g,3),G,!0)}function iS(h){var g=h==null?0:h.length;return g?Gr(h,1):[]}function AM(h){var g=h==null?0:h.length;return g?Gr(h,Se):[]}function $M(h,g){var x=h==null?0:h.length;return x?(g=g===t?1:Gt(g),Gr(h,g)):[]}function NM(h){for(var g=-1,x=h==null?0:h.length,$={};++g<x;){var G=h[g];$[G[0]]=G[1]}return $}function aS(h){return h&&h.length?h[0]:t}function OM(h,g,x){var $=h==null?0:h.length;if(!$)return-1;var G=x==null?0:Gt(x);return G<0&&(G=Rr($+G,0)),Jc(h,g,G)}function _M(h){var g=h==null?0:h.length;return g?ti(h,0,-1):[]}var FM=Jt(function(h){var g=Gn(h,Y0);return g.length&&g[0]===h[0]?U0(g):[]}),DM=Jt(function(h){var g=ni(h),x=Gn(h,Y0);return g===ni(x)?g=t:x.pop(),x.length&&x[0]===h[0]?U0(x,Nt(g,2)):[]}),BM=Jt(function(h){var g=ni(h),x=Gn(h,Y0);return g=typeof g=="function"?g:t,g&&x.pop(),x.length&&x[0]===h[0]?U0(x,t,g):[]});function MM(h,g){return h==null?"":_B.call(h,g)}function ni(h){var g=h==null?0:h.length;return g?h[g-1]:t}function PM(h,g,x){var $=h==null?0:h.length;if(!$)return-1;var G=$;return x!==t&&(G=Gt(x),G=G<0?Rr($+G,0):Xr(G,$-1)),g===g?vB(h,g,G):ld(h,Uw,G,!0)}function LM(h,g){return h&&h.length?v2(h,Gt(g)):t}var UM=Jt(oS);function oS(h,g){return h&&h.length&&g&&g.length?G0(h,g):h}function zM(h,g,x){return h&&h.length&&g&&g.length?G0(h,g,Nt(x,2)):h}function VM(h,g,x){return h&&h.length&&g&&g.length?G0(h,g,t,x):h}var WM=Oa(function(h,g){var x=h==null?0:h.length,$=B0(h,g);return y2(h,Gn(g,function(G){return _a(G,x)?+G:G}).sort($2)),$});function GM(h,g){var x=[];if(!(h&&h.length))return x;var $=-1,G=[],oe=h.length;for(g=Nt(g,3);++$<oe;){var be=h[$];g(be,$,h)&&(x.push(be),G.push($))}return y2(h,G),x}function u1(h){return h==null?h:MB.call(h)}function HM(h,g,x){var $=h==null?0:h.length;return $?(x&&typeof x!="number"&&os(h,g,x)?(g=0,x=$):(g=g==null?0:Gt(g),x=x===t?$:Gt(x)),ti(h,g,x)):[]}function qM(h,g){return Ad(h,g)}function jM(h,g,x){return j0(h,g,Nt(x,2))}function KM(h,g){var x=h==null?0:h.length;if(x){var $=Ad(h,g);if($<x&&Ai(h[$],g))return $}return-1}function XM(h,g){return Ad(h,g,!0)}function YM(h,g,x){return j0(h,g,Nt(x,2),!0)}function ZM(h,g){var x=h==null?0:h.length;if(x){var $=Ad(h,g,!0)-1;if(Ai(h[$],g))return $}return-1}function JM(h){return h&&h.length?w2(h):[]}function QM(h,g){return h&&h.length?w2(h,Nt(g,2)):[]}function eP(h){var g=h==null?0:h.length;return g?ti(h,1,g):[]}function tP(h,g,x){return h&&h.length?(g=x||g===t?1:Gt(g),ti(h,0,g<0?0:g)):[]}function nP(h,g,x){var $=h==null?0:h.length;return $?(g=x||g===t?1:Gt(g),g=$-g,ti(h,g<0?0:g,$)):[]}function rP(h,g){return h&&h.length?$d(h,Nt(g,3),!1,!0):[]}function sP(h,g){return h&&h.length?$d(h,Nt(g,3)):[]}var iP=Jt(function(h){return io(Gr(h,1,lr,!0))}),aP=Jt(function(h){var g=ni(h);return lr(g)&&(g=t),io(Gr(h,1,lr,!0),Nt(g,2))}),oP=Jt(function(h){var g=ni(h);return g=typeof g=="function"?g:t,io(Gr(h,1,lr,!0),t,g)});function cP(h){return h&&h.length?io(h):[]}function lP(h,g){return h&&h.length?io(h,Nt(g,2)):[]}function uP(h,g){return g=typeof g=="function"?g:t,h&&h.length?io(h,t,g):[]}function f1(h){if(!(h&&h.length))return[];var g=0;return h=eo(h,function(x){if(lr(x))return g=Rr(x.length,g),!0}),T0(g,function(x){return Gn(h,R0(x))})}function cS(h,g){if(!(h&&h.length))return[];var x=f1(h);return g==null?x:Gn(x,function($){return _s(g,t,$)})}var fP=Jt(function(h,g){return lr(h)?Pu(h,g):[]}),hP=Jt(function(h){return X0(eo(h,lr))}),dP=Jt(function(h){var g=ni(h);return lr(g)&&(g=t),X0(eo(h,lr),Nt(g,2))}),pP=Jt(function(h){var g=ni(h);return g=typeof g=="function"?g:t,X0(eo(h,lr),t,g)}),gP=Jt(f1);function mP(h,g){return k2(h||[],g||[],Mu)}function vP(h,g){return k2(h||[],g||[],zu)}var IP=Jt(function(h){var g=h.length,x=g>1?h[g-1]:t;return x=typeof x=="function"?(h.pop(),x):t,cS(h,x)});function lS(h){var g=te(h);return g.__chain__=!0,g}function bP(h,g){return g(h),h}function Ld(h,g){return g(h)}var yP=Oa(function(h){var g=h.length,x=g?h[0]:0,$=this.__wrapped__,G=function(oe){return B0(oe,h)};return g>1||this.__actions__.length||!($ instanceof rn)||!_a(x)?this.thru(G):($=$.slice(x,+x+(g?1:0)),$.__actions__.push({func:Ld,args:[G],thisArg:t}),new Qs($,this.__chain__).thru(function(oe){return g&&!oe.length&&oe.push(t),oe}))});function xP(){return lS(this)}function wP(){return new Qs(this.value(),this.__chain__)}function SP(){this.__values__===t&&(this.__values__=SS(this.value()));var h=this.__index__>=this.__values__.length,g=h?t:this.__values__[this.__index__++];return{done:h,value:g}}function CP(){return this}function RP(h){for(var g,x=this;x instanceof Cd;){var $=nS(x);$.__index__=0,$.__values__=t,g?G.__wrapped__=$:g=$;var G=$;x=x.__wrapped__}return G.__wrapped__=h,g}function kP(){var h=this.__wrapped__;if(h instanceof rn){var g=h;return this.__actions__.length&&(g=new rn(this)),g=g.reverse(),g.__actions__.push({func:Ld,args:[u1],thisArg:t}),new Qs(g,this.__chain__)}return this.thru(u1)}function EP(){return R2(this.__wrapped__,this.__actions__)}var TP=Nd(function(h,g,x){Cn.call(h,x)?++h[x]:$a(h,x,1)});function AP(h,g,x){var $=Vt(h)?Pw:b4;return x&&os(h,g,x)&&(g=t),$(h,Nt(g,3))}function $P(h,g){var x=Vt(h)?eo:c2;return x(h,Nt(g,3))}var NP=B2(rS),OP=B2(sS);function _P(h,g){return Gr(Ud(h,g),1)}function FP(h,g){return Gr(Ud(h,g),Se)}function DP(h,g,x){return x=x===t?1:Gt(x),Gr(Ud(h,g),x)}function uS(h,g){var x=Vt(h)?Zs:so;return x(h,Nt(g,3))}function fS(h,g){var x=Vt(h)?eB:o2;return x(h,Nt(g,3))}var BP=Nd(function(h,g,x){Cn.call(h,x)?h[x].push(g):$a(h,x,[g])});function MP(h,g,x,$){h=Is(h)?h:ul(h),x=x&&!$?Gt(x):0;var G=h.length;return x<0&&(x=Rr(G+x,0)),Hd(h)?x<=G&&h.indexOf(g,x)>-1:!!G&&Jc(h,g,x)>-1}var PP=Jt(function(h,g,x){var $=-1,G=typeof g=="function",oe=Is(h)?je(h.length):[];return so(h,function(be){oe[++$]=G?_s(g,be,x):Lu(be,g,x)}),oe}),LP=Nd(function(h,g,x){$a(h,x,g)});function Ud(h,g){var x=Vt(h)?Gn:p2;return x(h,Nt(g,3))}function UP(h,g,x,$){return h==null?[]:(Vt(g)||(g=g==null?[]:[g]),x=$?t:x,Vt(x)||(x=x==null?[]:[x]),I2(h,g,x))}var zP=Nd(function(h,g,x){h[x?0:1].push(g)},function(){return[[],[]]});function VP(h,g,x){var $=Vt(h)?S0:Vw,G=arguments.length<3;return $(h,Nt(g,4),x,G,so)}function WP(h,g,x){var $=Vt(h)?tB:Vw,G=arguments.length<3;return $(h,Nt(g,4),x,G,o2)}function GP(h,g){var x=Vt(h)?eo:c2;return x(h,Wd(Nt(g,3)))}function HP(h){var g=Vt(h)?r2:M4;return g(h)}function qP(h,g,x){(x?os(h,g,x):g===t)?g=1:g=Gt(g);var $=Vt(h)?p4:P4;return $(h,g)}function jP(h){var g=Vt(h)?g4:U4;return g(h)}function KP(h){if(h==null)return 0;if(Is(h))return Hd(h)?el(h):h.length;var g=Yr(h);return g==se||g==Te?h.size:V0(h).length}function XP(h,g,x){var $=Vt(h)?C0:z4;return x&&os(h,g,x)&&(g=t),$(h,Nt(g,3))}var YP=Jt(function(h,g){if(h==null)return[];var x=g.length;return x>1&&os(h,g[0],g[1])?g=[]:x>2&&os(g[0],g[1],g[2])&&(g=[g[0]]),I2(h,Gr(g,1),[])}),zd=$B||function(){return Wr.Date.now()};function ZP(h,g){if(typeof g!="function")throw new Js(a);return h=Gt(h),function(){if(--h<1)return g.apply(this,arguments)}}function hS(h,g,x){return g=x?t:g,g=h&&g==null?h.length:g,Na(h,E,t,t,t,t,g)}function dS(h,g){var x;if(typeof g!="function")throw new Js(a);return h=Gt(h),function(){return--h>0&&(x=g.apply(this,arguments)),h<=1&&(g=t),x}}var h1=Jt(function(h,g,x){var $=v;if(x.length){var G=no(x,cl(h1));$|=C}return Na(h,$,g,x,G)}),pS=Jt(function(h,g,x){var $=v|b;if(x.length){var G=no(x,cl(pS));$|=C}return Na(g,$,h,x,G)});function gS(h,g,x){g=x?t:g;var $=Na(h,S,t,t,t,t,t,g);return $.placeholder=gS.placeholder,$}function mS(h,g,x){g=x?t:g;var $=Na(h,w,t,t,t,t,t,g);return $.placeholder=mS.placeholder,$}function vS(h,g,x){var $,G,oe,be,$e,Le,Je=0,Qe=!1,tt=!1,ht=!0;if(typeof h!="function")throw new Js(a);g=ri(g)||0,Yn(x)&&(Qe=!!x.leading,tt="maxWait"in x,oe=tt?Rr(ri(x.maxWait)||0,g):oe,ht="trailing"in x?!!x.trailing:ht);function St(ur){var $i=$,Ba=G;return $=G=t,Je=ur,be=h.apply(Ba,$i),be}function Ot(ur){return Je=ur,$e=Gu(nn,g),Qe?St(ur):be}function Kt(ur){var $i=ur-Le,Ba=ur-Je,BS=g-$i;return tt?Xr(BS,oe-Ba):BS}function _t(ur){var $i=ur-Le,Ba=ur-Je;return Le===t||$i>=g||$i<0||tt&&Ba>=oe}function nn(){var ur=zd();if(_t(ur))return cn(ur);$e=Gu(nn,Kt(ur))}function cn(ur){return $e=t,ht&&$?St(ur):($=G=t,be)}function Ms(){$e!==t&&E2($e),Je=0,$=Le=G=$e=t}function cs(){return $e===t?be:cn(zd())}function Ps(){var ur=zd(),$i=_t(ur);if($=arguments,G=this,Le=ur,$i){if($e===t)return Ot(Le);if(tt)return E2($e),$e=Gu(nn,g),St(Le)}return $e===t&&($e=Gu(nn,g)),be}return Ps.cancel=Ms,Ps.flush=cs,Ps}var JP=Jt(function(h,g){return a2(h,1,g)}),QP=Jt(function(h,g,x){return a2(h,ri(g)||0,x)});function eL(h){return Na(h,M)}function Vd(h,g){if(typeof h!="function"||g!=null&&typeof g!="function")throw new Js(a);var x=function(){var $=arguments,G=g?g.apply(this,$):$[0],oe=x.cache;if(oe.has(G))return oe.get(G);var be=h.apply(this,$);return x.cache=oe.set(G,be)||oe,be};return x.cache=new(Vd.Cache||Aa),x}Vd.Cache=Aa;function Wd(h){if(typeof h!="function")throw new Js(a);return function(){var g=arguments;switch(g.length){case 0:return!h.call(this);case 1:return!h.call(this,g[0]);case 2:return!h.call(this,g[0],g[1]);case 3:return!h.call(this,g[0],g[1],g[2])}return!h.apply(this,g)}}function tL(h){return dS(2,h)}var nL=V4(function(h,g){g=g.length==1&&Vt(g[0])?Gn(g[0],Fs(Nt())):Gn(Gr(g,1),Fs(Nt()));var x=g.length;return Jt(function($){for(var G=-1,oe=Xr($.length,x);++G<oe;)$[G]=g[G].call(this,$[G]);return _s(h,this,$)})}),d1=Jt(function(h,g){var x=no(g,cl(d1));return Na(h,C,t,g,x)}),IS=Jt(function(h,g){var x=no(g,cl(IS));return Na(h,N,t,g,x)}),rL=Oa(function(h,g){return Na(h,A,t,t,t,g)});function sL(h,g){if(typeof h!="function")throw new Js(a);return g=g===t?g:Gt(g),Jt(h,g)}function iL(h,g){if(typeof h!="function")throw new Js(a);return g=g==null?0:Rr(Gt(g),0),Jt(function(x){var $=x[g],G=oo(x,0,g);return $&&to(G,$),_s(h,this,G)})}function aL(h,g,x){var $=!0,G=!0;if(typeof h!="function")throw new Js(a);return Yn(x)&&($="leading"in x?!!x.leading:$,G="trailing"in x?!!x.trailing:G),vS(h,g,{leading:$,maxWait:g,trailing:G})}function oL(h){return hS(h,1)}function cL(h,g){return d1(Z0(g),h)}function lL(){if(!arguments.length)return[];var h=arguments[0];return Vt(h)?h:[h]}function uL(h){return ei(h,p)}function fL(h,g){return g=typeof g=="function"?g:t,ei(h,p,g)}function hL(h){return ei(h,f|p)}function dL(h,g){return g=typeof g=="function"?g:t,ei(h,f|p,g)}function pL(h,g){return g==null||i2(h,g,Or(g))}function Ai(h,g){return h===g||h!==h&&g!==g}var gL=Dd(L0),mL=Dd(function(h,g){return h>=g}),nc=f2(function(){return arguments}())?f2:function(h){return er(h)&&Cn.call(h,"callee")&&!Zw.call(h,"callee")},Vt=je.isArray,vL=Ow?Fs(Ow):R4;function Is(h){return h!=null&&Gd(h.length)&&!Fa(h)}function lr(h){return er(h)&&Is(h)}function IL(h){return h===!0||h===!1||er(h)&&as(h)==Q}var co=OB||C1,bL=_w?Fs(_w):k4;function yL(h){return er(h)&&h.nodeType===1&&!Hu(h)}function xL(h){if(h==null)return!0;if(Is(h)&&(Vt(h)||typeof h=="string"||typeof h.splice=="function"||co(h)||ll(h)||nc(h)))return!h.length;var g=Yr(h);if(g==se||g==Te)return!h.size;if(Wu(h))return!V0(h).length;for(var x in h)if(Cn.call(h,x))return!1;return!0}function wL(h,g){return Uu(h,g)}function SL(h,g,x){x=typeof x=="function"?x:t;var $=x?x(h,g):t;return $===t?Uu(h,g,t,x):!!$}function p1(h){if(!er(h))return!1;var g=as(h);return g==L||g==Ee||typeof h.message=="string"&&typeof h.name=="string"&&!Hu(h)}function CL(h){return typeof h=="number"&&Qw(h)}function Fa(h){if(!Yn(h))return!1;var g=as(h);return g==q||g==Z||g==P||g==X}function bS(h){return typeof h=="number"&&h==Gt(h)}function Gd(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=me}function Yn(h){var g=typeof h;return h!=null&&(g=="object"||g=="function")}function er(h){return h!=null&&typeof h=="object"}var yS=Fw?Fs(Fw):T4;function RL(h,g){return h===g||z0(h,g,s1(g))}function kL(h,g,x){return x=typeof x=="function"?x:t,z0(h,g,s1(g),x)}function EL(h){return xS(h)&&h!=+h}function TL(h){if(fM(h))throw new Lt(i);return h2(h)}function AL(h){return h===null}function $L(h){return h==null}function xS(h){return typeof h=="number"||er(h)&&as(h)==ie}function Hu(h){if(!er(h)||as(h)!=R)return!1;var g=vd(h);if(g===null)return!0;var x=Cn.call(g,"constructor")&&g.constructor;return typeof x=="function"&&x instanceof x&&dd.call(x)==kB}var g1=Dw?Fs(Dw):A4;function NL(h){return bS(h)&&h>=-me&&h<=me}var wS=Bw?Fs(Bw):$4;function Hd(h){return typeof h=="string"||!Vt(h)&&er(h)&&as(h)==Be}function Bs(h){return typeof h=="symbol"||er(h)&&as(h)==He}var ll=Mw?Fs(Mw):N4;function OL(h){return h===t}function _L(h){return er(h)&&Yr(h)==ct}function FL(h){return er(h)&&as(h)==lt}var DL=Dd(W0),BL=Dd(function(h,g){return h<=g});function SS(h){if(!h)return[];if(Is(h))return Hd(h)?Ei(h):vs(h);if(Ou&&h[Ou])return pB(h[Ou]());var g=Yr(h),x=g==se?$0:g==Te?ud:ul;return x(h)}function Da(h){if(!h)return h===0?h:0;if(h=ri(h),h===Se||h===-Se){var g=h<0?-1:1;return g*ye}return h===h?h:0}function Gt(h){var g=Da(h),x=g%1;return g===g?x?g-x:g:0}function CS(h){return h?Jo(Gt(h),0,he):0}function ri(h){if(typeof h=="number")return h;if(Bs(h))return Ce;if(Yn(h)){var g=typeof h.valueOf=="function"?h.valueOf():h;h=Yn(g)?g+"":g}if(typeof h!="string")return h===0?h:+h;h=Ww(h);var x=id.test(h);return x||ad.test(h)?ZD(h.slice(2),x?2:8):$u.test(h)?Ce:+h}function RS(h){return Xi(h,bs(h))}function ML(h){return h?Jo(Gt(h),-me,me):h===0?h:0}function yn(h){return h==null?"":Ds(h)}var PL=al(function(h,g){if(Wu(g)||Is(g)){Xi(g,Or(g),h);return}for(var x in g)Cn.call(g,x)&&Mu(h,x,g[x])}),kS=al(function(h,g){Xi(g,bs(g),h)}),qd=al(function(h,g,x,$){Xi(g,bs(g),h,$)}),LL=al(function(h,g,x,$){Xi(g,Or(g),h,$)}),UL=Oa(B0);function zL(h,g){var x=il(h);return g==null?x:s2(x,g)}var VL=Jt(function(h,g){h=Tn(h);var x=-1,$=g.length,G=$>2?g[2]:t;for(G&&os(g[0],g[1],G)&&($=1);++x<$;)for(var oe=g[x],be=bs(oe),$e=-1,Le=be.length;++$e<Le;){var Je=be[$e],Qe=h[Je];(Qe===t||Ai(Qe,nl[Je])&&!Cn.call(h,Je))&&(h[Je]=oe[Je])}return h}),WL=Jt(function(h){return h.push(t,W2),_s(ES,t,h)});function GL(h,g){return Lw(h,Nt(g,3),Ki)}function HL(h,g){return Lw(h,Nt(g,3),P0)}function qL(h,g){return h==null?h:M0(h,Nt(g,3),bs)}function jL(h,g){return h==null?h:l2(h,Nt(g,3),bs)}function KL(h,g){return h&&Ki(h,Nt(g,3))}function XL(h,g){return h&&P0(h,Nt(g,3))}function YL(h){return h==null?[]:Ed(h,Or(h))}function ZL(h){return h==null?[]:Ed(h,bs(h))}function m1(h,g,x){var $=h==null?t:Qo(h,g);return $===t?x:$}function JL(h,g){return h!=null&&q2(h,g,x4)}function v1(h,g){return h!=null&&q2(h,g,w4)}var QL=P2(function(h,g,x){g!=null&&typeof g.toString!="function"&&(g=pd.call(g)),h[g]=x},b1(ys)),e5=P2(function(h,g,x){g!=null&&typeof g.toString!="function"&&(g=pd.call(g)),Cn.call(h,g)?h[g].push(x):h[g]=[x]},Nt),t5=Jt(Lu);function Or(h){return Is(h)?n2(h):V0(h)}function bs(h){return Is(h)?n2(h,!0):O4(h)}function n5(h,g){var x={};return g=Nt(g,3),Ki(h,function($,G,oe){$a(x,g($,G,oe),$)}),x}function r5(h,g){var x={};return g=Nt(g,3),Ki(h,function($,G,oe){$a(x,G,g($,G,oe))}),x}var s5=al(function(h,g,x){Td(h,g,x)}),ES=al(function(h,g,x,$){Td(h,g,x,$)}),i5=Oa(function(h,g){var x={};if(h==null)return x;var $=!1;g=Gn(g,function(oe){return oe=ao(oe,h),$||($=oe.length>1),oe}),Xi(h,n1(h),x),$&&(x=ei(x,f|d|p,Q4));for(var G=g.length;G--;)K0(x,g[G]);return x});function a5(h,g){return TS(h,Wd(Nt(g)))}var o5=Oa(function(h,g){return h==null?{}:F4(h,g)});function TS(h,g){if(h==null)return{};var x=Gn(n1(h),function($){return[$]});return g=Nt(g),b2(h,x,function($,G){return g($,G[0])})}function c5(h,g,x){g=ao(g,h);var $=-1,G=g.length;for(G||(G=1,h=t);++$<G;){var oe=h==null?t:h[Yi(g[$])];oe===t&&($=G,oe=x),h=Fa(oe)?oe.call(h):oe}return h}function l5(h,g,x){return h==null?h:zu(h,g,x)}function u5(h,g,x,$){return $=typeof $=="function"?$:t,h==null?h:zu(h,g,x,$)}var AS=z2(Or),$S=z2(bs);function f5(h,g,x){var $=Vt(h),G=$||co(h)||ll(h);if(g=Nt(g,4),x==null){var oe=h&&h.constructor;G?x=$?new oe:[]:Yn(h)?x=Fa(oe)?il(vd(h)):{}:x={}}return(G?Zs:Ki)(h,function(be,$e,Le){return g(x,be,$e,Le)}),x}function h5(h,g){return h==null?!0:K0(h,g)}function d5(h,g,x){return h==null?h:C2(h,g,Z0(x))}function p5(h,g,x,$){return $=typeof $=="function"?$:t,h==null?h:C2(h,g,Z0(x),$)}function ul(h){return h==null?[]:A0(h,Or(h))}function g5(h){return h==null?[]:A0(h,bs(h))}function m5(h,g,x){return x===t&&(x=g,g=t),x!==t&&(x=ri(x),x=x===x?x:0),g!==t&&(g=ri(g),g=g===g?g:0),Jo(ri(h),g,x)}function v5(h,g,x){return g=Da(g),x===t?(x=g,g=0):x=Da(x),h=ri(h),S4(h,g,x)}function I5(h,g,x){if(x&&typeof x!="boolean"&&os(h,g,x)&&(g=x=t),x===t&&(typeof g=="boolean"?(x=g,g=t):typeof h=="boolean"&&(x=h,h=t)),h===t&&g===t?(h=0,g=1):(h=Da(h),g===t?(g=h,h=0):g=Da(g)),h>g){var $=h;h=g,g=$}if(x||h%1||g%1){var G=e2();return Xr(h+G*(g-h+YD("1e-"+((G+"").length-1))),g)}return H0(h,g)}var b5=ol(function(h,g,x){return g=g.toLowerCase(),h+(x?NS(g):g)});function NS(h){return I1(yn(h).toLowerCase())}function OS(h){return h=yn(h),h&&h.replace(g0,lB).replace(UD,"")}function y5(h,g,x){h=yn(h),g=Ds(g);var $=h.length;x=x===t?$:Jo(Gt(x),0,$);var G=x;return x-=g.length,x>=0&&h.slice(x,G)==g}function x5(h){return h=yn(h),h&&an.test(h)?h.replace(ji,uB):h}function w5(h){return h=yn(h),h&&Xc.test(h)?h.replace(jo,"\\$&"):h}var S5=ol(function(h,g,x){return h+(x?"-":"")+g.toLowerCase()}),C5=ol(function(h,g,x){return h+(x?" ":"")+g.toLowerCase()}),R5=D2("toLowerCase");function k5(h,g,x){h=yn(h),g=Gt(g);var $=g?el(h):0;if(!g||$>=g)return h;var G=(g-$)/2;return Fd(xd(G),x)+h+Fd(yd(G),x)}function E5(h,g,x){h=yn(h),g=Gt(g);var $=g?el(h):0;return g&&$<g?h+Fd(g-$,x):h}function T5(h,g,x){h=yn(h),g=Gt(g);var $=g?el(h):0;return g&&$<g?Fd(g-$,x)+h:h}function A5(h,g,x){return x||g==null?g=0:g&&(g=+g),BB(yn(h).replace(Eu,""),g||0)}function $5(h,g,x){return(x?os(h,g,x):g===t)?g=1:g=Gt(g),q0(yn(h),g)}function N5(){var h=arguments,g=yn(h[0]);return h.length<3?g:g.replace(h[1],h[2])}var O5=ol(function(h,g,x){return h+(x?"_":"")+g.toLowerCase()});function _5(h,g,x){return x&&typeof x!="number"&&os(h,g,x)&&(g=x=t),x=x===t?he:x>>>0,x?(h=yn(h),h&&(typeof g=="string"||g!=null&&!g1(g))&&(g=Ds(g),!g&&Qc(h))?oo(Ei(h),0,x):h.split(g,x)):[]}var F5=ol(function(h,g,x){return h+(x?" ":"")+I1(g)});function D5(h,g,x){return h=yn(h),x=x==null?0:Jo(Gt(x),0,h.length),g=Ds(g),h.slice(x,x+g.length)==g}function B5(h,g,x){var $=te.templateSettings;x&&os(h,g,x)&&(g=t),h=yn(h),g=qd({},g,$,V2);var G=qd({},g.imports,$.imports,V2),oe=Or(G),be=A0(G,oe),$e,Le,Je=0,Qe=g.interpolate||Yc,tt="__p += '",ht=N0((g.escape||Yc).source+"|"+Qe.source+"|"+(Qe===Ri?Ea:Yc).source+"|"+(g.evaluate||Yc).source+"|$","g"),St="//# sourceURL="+(Cn.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++HD+"]")+`
`;h.replace(ht,function(_t,nn,cn,Ms,cs,Ps){return cn||(cn=Ms),tt+=h.slice(Je,Ps).replace(Jn,fB),nn&&($e=!0,tt+=`' +
__e(`+nn+`) +
'`),cs&&(Le=!0,tt+=`';
`+cs+`;
__p += '`),cn&&(tt+=`' +
((__t = (`+cn+`)) == null ? '' : __t) +
'`),Je=Ps+_t.length,_t}),tt+=`';
`;var Ot=Cn.call(g,"variable")&&g.variable;if(!Ot)tt=`with (obj) {
`+tt+`
}
`;else if(h0.test(Ot))throw new Lt(o);tt=(Le?tt.replace(Ht,""):tt).replace(Os,"$1").replace(Ci,"$1;"),tt="function("+(Ot||"obj")+`) {
`+(Ot?"":`obj || (obj = {});
`)+"var __t, __p = ''"+($e?", __e = _.escape":"")+(Le?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+tt+`return __p
}`;var Kt=FS(function(){return In(oe,St+"return "+tt).apply(t,be)});if(Kt.source=tt,p1(Kt))throw Kt;return Kt}function M5(h){return yn(h).toLowerCase()}function P5(h){return yn(h).toUpperCase()}function L5(h,g,x){if(h=yn(h),h&&(x||g===t))return Ww(h);if(!h||!(g=Ds(g)))return h;var $=Ei(h),G=Ei(g),oe=Gw($,G),be=Hw($,G)+1;return oo($,oe,be).join("")}function U5(h,g,x){if(h=yn(h),h&&(x||g===t))return h.slice(0,jw(h)+1);if(!h||!(g=Ds(g)))return h;var $=Ei(h),G=Hw($,Ei(g))+1;return oo($,0,G).join("")}function z5(h,g,x){if(h=yn(h),h&&(x||g===t))return h.replace(Eu,"");if(!h||!(g=Ds(g)))return h;var $=Ei(h),G=Gw($,Ei(g));return oo($,G).join("")}function V5(h,g){var x=z,$=Y;if(Yn(g)){var G="separator"in g?g.separator:G;x="length"in g?Gt(g.length):x,$="omission"in g?Ds(g.omission):$}h=yn(h);var oe=h.length;if(Qc(h)){var be=Ei(h);oe=be.length}if(x>=oe)return h;var $e=x-el($);if($e<1)return $;var Le=be?oo(be,0,$e).join(""):h.slice(0,$e);if(G===t)return Le+$;if(be&&($e+=Le.length-$e),g1(G)){if(h.slice($e).search(G)){var Je,Qe=Le;for(G.global||(G=N0(G.source,yn(Au.exec(G))+"g")),G.lastIndex=0;Je=G.exec(Qe);)var tt=Je.index;Le=Le.slice(0,tt===t?$e:tt)}}else if(h.indexOf(Ds(G),$e)!=$e){var ht=Le.lastIndexOf(G);ht>-1&&(Le=Le.slice(0,ht))}return Le+$}function W5(h){return h=yn(h),h&&cr.test(h)?h.replace(Kc,IB):h}var G5=ol(function(h,g,x){return h+(x?" ":"")+g.toUpperCase()}),I1=D2("toUpperCase");function _S(h,g,x){return h=yn(h),g=x?t:g,g===t?dB(h)?xB(h):sB(h):h.match(g)||[]}var FS=Jt(function(h,g){try{return _s(h,t,g)}catch(x){return p1(x)?x:new Lt(x)}}),H5=Oa(function(h,g){return Zs(g,function(x){x=Yi(x),$a(h,x,h1(h[x],h))}),h});function q5(h){var g=h==null?0:h.length,x=Nt();return h=g?Gn(h,function($){if(typeof $[1]!="function")throw new Js(a);return[x($[0]),$[1]]}):[],Jt(function($){for(var G=-1;++G<g;){var oe=h[G];if(_s(oe[0],this,$))return _s(oe[1],this,$)}})}function j5(h){return I4(ei(h,f))}function b1(h){return function(){return h}}function K5(h,g){return h==null||h!==h?g:h}var X5=M2(),Y5=M2(!0);function ys(h){return h}function y1(h){return d2(typeof h=="function"?h:ei(h,f))}function Z5(h){return g2(ei(h,f))}function J5(h,g){return m2(h,ei(g,f))}var Q5=Jt(function(h,g){return function(x){return Lu(x,h,g)}}),e6=Jt(function(h,g){return function(x){return Lu(h,x,g)}});function x1(h,g,x){var $=Or(g),G=Ed(g,$);x==null&&!(Yn(g)&&(G.length||!$.length))&&(x=g,g=h,h=this,G=Ed(g,Or(g)));var oe=!(Yn(x)&&"chain"in x)||!!x.chain,be=Fa(h);return Zs(G,function($e){var Le=g[$e];h[$e]=Le,be&&(h.prototype[$e]=function(){var Je=this.__chain__;if(oe||Je){var Qe=h(this.__wrapped__),tt=Qe.__actions__=vs(this.__actions__);return tt.push({func:Le,args:arguments,thisArg:h}),Qe.__chain__=Je,Qe}return Le.apply(h,to([this.value()],arguments))})}),h}function t6(){return Wr._===this&&(Wr._=EB),this}function w1(){}function n6(h){return h=Gt(h),Jt(function(g){return v2(g,h)})}var r6=Q0(Gn),s6=Q0(Pw),i6=Q0(C0);function DS(h){return a1(h)?R0(Yi(h)):D4(h)}function a6(h){return function(g){return h==null?t:Qo(h,g)}}var o6=L2(),c6=L2(!0);function S1(){return[]}function C1(){return!1}function l6(){return{}}function u6(){return""}function f6(){return!0}function h6(h,g){if(h=Gt(h),h<1||h>me)return[];var x=he,$=Xr(h,he);g=Nt(g),h-=he;for(var G=T0($,g);++x<h;)g(x);return G}function d6(h){return Vt(h)?Gn(h,Yi):Bs(h)?[h]:vs(tS(yn(h)))}function p6(h){var g=++RB;return yn(h)+g}var g6=_d(function(h,g){return h+g},0),m6=e1("ceil"),v6=_d(function(h,g){return h/g},1),I6=e1("floor");function b6(h){return h&&h.length?kd(h,ys,L0):t}function y6(h,g){return h&&h.length?kd(h,Nt(g,2),L0):t}function x6(h){return zw(h,ys)}function w6(h,g){return zw(h,Nt(g,2))}function S6(h){return h&&h.length?kd(h,ys,W0):t}function C6(h,g){return h&&h.length?kd(h,Nt(g,2),W0):t}var R6=_d(function(h,g){return h*g},1),k6=e1("round"),E6=_d(function(h,g){return h-g},0);function T6(h){return h&&h.length?E0(h,ys):0}function A6(h,g){return h&&h.length?E0(h,Nt(g,2)):0}return te.after=ZP,te.ary=hS,te.assign=PL,te.assignIn=kS,te.assignInWith=qd,te.assignWith=LL,te.at=UL,te.before=dS,te.bind=h1,te.bindAll=H5,te.bindKey=pS,te.castArray=lL,te.chain=lS,te.chunk=IM,te.compact=bM,te.concat=yM,te.cond=q5,te.conforms=j5,te.constant=b1,te.countBy=TP,te.create=zL,te.curry=gS,te.curryRight=mS,te.debounce=vS,te.defaults=VL,te.defaultsDeep=WL,te.defer=JP,te.delay=QP,te.difference=xM,te.differenceBy=wM,te.differenceWith=SM,te.drop=CM,te.dropRight=RM,te.dropRightWhile=kM,te.dropWhile=EM,te.fill=TM,te.filter=$P,te.flatMap=_P,te.flatMapDeep=FP,te.flatMapDepth=DP,te.flatten=iS,te.flattenDeep=AM,te.flattenDepth=$M,te.flip=eL,te.flow=X5,te.flowRight=Y5,te.fromPairs=NM,te.functions=YL,te.functionsIn=ZL,te.groupBy=BP,te.initial=_M,te.intersection=FM,te.intersectionBy=DM,te.intersectionWith=BM,te.invert=QL,te.invertBy=e5,te.invokeMap=PP,te.iteratee=y1,te.keyBy=LP,te.keys=Or,te.keysIn=bs,te.map=Ud,te.mapKeys=n5,te.mapValues=r5,te.matches=Z5,te.matchesProperty=J5,te.memoize=Vd,te.merge=s5,te.mergeWith=ES,te.method=Q5,te.methodOf=e6,te.mixin=x1,te.negate=Wd,te.nthArg=n6,te.omit=i5,te.omitBy=a5,te.once=tL,te.orderBy=UP,te.over=r6,te.overArgs=nL,te.overEvery=s6,te.overSome=i6,te.partial=d1,te.partialRight=IS,te.partition=zP,te.pick=o5,te.pickBy=TS,te.property=DS,te.propertyOf=a6,te.pull=UM,te.pullAll=oS,te.pullAllBy=zM,te.pullAllWith=VM,te.pullAt=WM,te.range=o6,te.rangeRight=c6,te.rearg=rL,te.reject=GP,te.remove=GM,te.rest=sL,te.reverse=u1,te.sampleSize=qP,te.set=l5,te.setWith=u5,te.shuffle=jP,te.slice=HM,te.sortBy=YP,te.sortedUniq=JM,te.sortedUniqBy=QM,te.split=_5,te.spread=iL,te.tail=eP,te.take=tP,te.takeRight=nP,te.takeRightWhile=rP,te.takeWhile=sP,te.tap=bP,te.throttle=aL,te.thru=Ld,te.toArray=SS,te.toPairs=AS,te.toPairsIn=$S,te.toPath=d6,te.toPlainObject=RS,te.transform=f5,te.unary=oL,te.union=iP,te.unionBy=aP,te.unionWith=oP,te.uniq=cP,te.uniqBy=lP,te.uniqWith=uP,te.unset=h5,te.unzip=f1,te.unzipWith=cS,te.update=d5,te.updateWith=p5,te.values=ul,te.valuesIn=g5,te.without=fP,te.words=_S,te.wrap=cL,te.xor=hP,te.xorBy=dP,te.xorWith=pP,te.zip=gP,te.zipObject=mP,te.zipObjectDeep=vP,te.zipWith=IP,te.entries=AS,te.entriesIn=$S,te.extend=kS,te.extendWith=qd,x1(te,te),te.add=g6,te.attempt=FS,te.camelCase=b5,te.capitalize=NS,te.ceil=m6,te.clamp=m5,te.clone=uL,te.cloneDeep=hL,te.cloneDeepWith=dL,te.cloneWith=fL,te.conformsTo=pL,te.deburr=OS,te.defaultTo=K5,te.divide=v6,te.endsWith=y5,te.eq=Ai,te.escape=x5,te.escapeRegExp=w5,te.every=AP,te.find=NP,te.findIndex=rS,te.findKey=GL,te.findLast=OP,te.findLastIndex=sS,te.findLastKey=HL,te.floor=I6,te.forEach=uS,te.forEachRight=fS,te.forIn=qL,te.forInRight=jL,te.forOwn=KL,te.forOwnRight=XL,te.get=m1,te.gt=gL,te.gte=mL,te.has=JL,te.hasIn=v1,te.head=aS,te.identity=ys,te.includes=MP,te.indexOf=OM,te.inRange=v5,te.invoke=t5,te.isArguments=nc,te.isArray=Vt,te.isArrayBuffer=vL,te.isArrayLike=Is,te.isArrayLikeObject=lr,te.isBoolean=IL,te.isBuffer=co,te.isDate=bL,te.isElement=yL,te.isEmpty=xL,te.isEqual=wL,te.isEqualWith=SL,te.isError=p1,te.isFinite=CL,te.isFunction=Fa,te.isInteger=bS,te.isLength=Gd,te.isMap=yS,te.isMatch=RL,te.isMatchWith=kL,te.isNaN=EL,te.isNative=TL,te.isNil=$L,te.isNull=AL,te.isNumber=xS,te.isObject=Yn,te.isObjectLike=er,te.isPlainObject=Hu,te.isRegExp=g1,te.isSafeInteger=NL,te.isSet=wS,te.isString=Hd,te.isSymbol=Bs,te.isTypedArray=ll,te.isUndefined=OL,te.isWeakMap=_L,te.isWeakSet=FL,te.join=MM,te.kebabCase=S5,te.last=ni,te.lastIndexOf=PM,te.lowerCase=C5,te.lowerFirst=R5,te.lt=DL,te.lte=BL,te.max=b6,te.maxBy=y6,te.mean=x6,te.meanBy=w6,te.min=S6,te.minBy=C6,te.stubArray=S1,te.stubFalse=C1,te.stubObject=l6,te.stubString=u6,te.stubTrue=f6,te.multiply=R6,te.nth=LM,te.noConflict=t6,te.noop=w1,te.now=zd,te.pad=k5,te.padEnd=E5,te.padStart=T5,te.parseInt=A5,te.random=I5,te.reduce=VP,te.reduceRight=WP,te.repeat=$5,te.replace=N5,te.result=c5,te.round=k6,te.runInContext=De,te.sample=HP,te.size=KP,te.snakeCase=O5,te.some=XP,te.sortedIndex=qM,te.sortedIndexBy=jM,te.sortedIndexOf=KM,te.sortedLastIndex=XM,te.sortedLastIndexBy=YM,te.sortedLastIndexOf=ZM,te.startCase=F5,te.startsWith=D5,te.subtract=E6,te.sum=T6,te.sumBy=A6,te.template=B5,te.times=h6,te.toFinite=Da,te.toInteger=Gt,te.toLength=CS,te.toLower=M5,te.toNumber=ri,te.toSafeInteger=ML,te.toString=yn,te.toUpper=P5,te.trim=L5,te.trimEnd=U5,te.trimStart=z5,te.truncate=V5,te.unescape=W5,te.uniqueId=p6,te.upperCase=G5,te.upperFirst=I1,te.each=uS,te.eachRight=fS,te.first=aS,x1(te,function(){var h={};return Ki(te,function(g,x){Cn.call(te.prototype,x)||(h[x]=g)}),h}(),{chain:!1}),te.VERSION=r,Zs(["bind","bindKey","curry","curryRight","partial","partialRight"],function(h){te[h].placeholder=te}),Zs(["drop","take"],function(h,g){rn.prototype[h]=function(x){x=x===t?1:Rr(Gt(x),0);var $=this.__filtered__&&!g?new rn(this):this.clone();return $.__filtered__?$.__takeCount__=Xr(x,$.__takeCount__):$.__views__.push({size:Xr(x,he),type:h+($.__dir__<0?"Right":"")}),$},rn.prototype[h+"Right"]=function(x){return this.reverse()[h](x).reverse()}}),Zs(["filter","map","takeWhile"],function(h,g){var x=g+1,$=x==le||x==ge;rn.prototype[h]=function(G){var oe=this.clone();return oe.__iteratees__.push({iteratee:Nt(G,3),type:x}),oe.__filtered__=oe.__filtered__||$,oe}}),Zs(["head","last"],function(h,g){var x="take"+(g?"Right":"");rn.prototype[h]=function(){return this[x](1).value()[0]}}),Zs(["initial","tail"],function(h,g){var x="drop"+(g?"":"Right");rn.prototype[h]=function(){return this.__filtered__?new rn(this):this[x](1)}}),rn.prototype.compact=function(){return this.filter(ys)},rn.prototype.find=function(h){return this.filter(h).head()},rn.prototype.findLast=function(h){return this.reverse().find(h)},rn.prototype.invokeMap=Jt(function(h,g){return typeof h=="function"?new rn(this):this.map(function(x){return Lu(x,h,g)})}),rn.prototype.reject=function(h){return this.filter(Wd(Nt(h)))},rn.prototype.slice=function(h,g){h=Gt(h);var x=this;return x.__filtered__&&(h>0||g<0)?new rn(x):(h<0?x=x.takeRight(-h):h&&(x=x.drop(h)),g!==t&&(g=Gt(g),x=g<0?x.dropRight(-g):x.take(g-h)),x)},rn.prototype.takeRightWhile=function(h){return this.reverse().takeWhile(h).reverse()},rn.prototype.toArray=function(){return this.take(he)},Ki(rn.prototype,function(h,g){var x=/^(?:filter|find|map|reject)|While$/.test(g),$=/^(?:head|last)$/.test(g),G=te[$?"take"+(g=="last"?"Right":""):g],oe=$||/^find/.test(g);G&&(te.prototype[g]=function(){var be=this.__wrapped__,$e=$?[1]:arguments,Le=be instanceof rn,Je=$e[0],Qe=Le||Vt(be),tt=function(nn){var cn=G.apply(te,to([nn],$e));return $&&ht?cn[0]:cn};Qe&&x&&typeof Je=="function"&&Je.length!=1&&(Le=Qe=!1);var ht=this.__chain__,St=!!this.__actions__.length,Ot=oe&&!ht,Kt=Le&&!St;if(!oe&&Qe){be=Kt?be:new rn(this);var _t=h.apply(be,$e);return _t.__actions__.push({func:Ld,args:[tt],thisArg:t}),new Qs(_t,ht)}return Ot&&Kt?h.apply(this,$e):(_t=this.thru(tt),Ot?$?_t.value()[0]:_t.value():_t)})}),Zs(["pop","push","shift","sort","splice","unshift"],function(h){var g=fd[h],x=/^(?:push|sort|unshift)$/.test(h)?"tap":"thru",$=/^(?:pop|shift)$/.test(h);te.prototype[h]=function(){var G=arguments;if($&&!this.__chain__){var oe=this.value();return g.apply(Vt(oe)?oe:[],G)}return this[x](function(be){return g.apply(Vt(be)?be:[],G)})}}),Ki(rn.prototype,function(h,g){var x=te[g];if(x){var $=x.name+"";Cn.call(sl,$)||(sl[$]=[]),sl[$].push({name:g,func:x})}}),sl[Od(t,b).name]=[{name:"wrapper",func:t}],rn.prototype.clone=WB,rn.prototype.reverse=GB,rn.prototype.value=HB,te.prototype.at=yP,te.prototype.chain=xP,te.prototype.commit=wP,te.prototype.next=SP,te.prototype.plant=RP,te.prototype.reverse=kP,te.prototype.toJSON=te.prototype.valueOf=te.prototype.value=EP,te.prototype.first=te.prototype.head,Ou&&(te.prototype[Ou]=CP),te},tl=wB();Ko?((Ko.exports=tl)._=tl,y0._=tl):Wr._=tl}).call(Hn)})(eg,eg.exports);var zt=eg.exports,zx=Math.floor(Math.random()*16777215),kR=jn.index=parseInt(Math.random()*16777215,10),ehe=(typeof process>"u"||typeof process.pid!="number"?Math.floor(Math.random()*1e5):process.pid)%65535,the=function(n){return!!(n!=null&&n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n))};function jn(n){if(!(this instanceof jn))return new jn(n);if(n&&(n instanceof jn||n._bsontype==="ObjectID"))return n;var e;if(the(n)||Array.isArray(n)&&n.length===12)e=Array.prototype.slice.call(n);else if(typeof n=="string"){if(n.length!==12&&!jn.isValid(n))throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");e=ER(n)}else/number|undefined/.test(typeof n)&&(e=ER(F_(n)));Object.defineProperty(this,"id",{enumerable:!0,get:function(){return String.fromCharCode.apply(this,e)}}),Object.defineProperty(this,"str",{get:function(){return e.map(Rl.bind(this,2)).join("")}})}var fu=jn;jn.generate=F_;jn.default=jn;jn.createFromTime=function(n){return n=parseInt(n,10)%4294967295,new jn(Rl(8,n)+"0000000000000000")};jn.createFromHexString=function(n){if(!jn.isValid(n))throw new Error("Invalid ObjectID hex string");return new jn(n)};jn.isValid=function(n){return!n||typeof n!="string"&&(typeof n!="object"||Array.isArray(n)||typeof n.toString!="function")?!1:/^[0-9A-F]{24}$/i.test(n.toString())};jn.setMachineID=function(n){var e;if(typeof n=="string"){if(e=parseInt(n,16),isNaN(e)){n=("000000"+n).substr(-7,6),e="";for(var t=0;t<6;t++)e+=n.charCodeAt(t)}}else/number|undefined/.test(typeof n)&&(e=n|0);zx=e&16777215};jn.getMachineID=function(){return zx};jn.prototype={_bsontype:"ObjectID",constructor:jn,toHexString:function(){return this.str},equals:function(n){return!!n&&this.str===n.toString()},getTimestamp:function(){return new Date(parseInt(this.str.substr(0,8),16)*1e3)}};function nhe(){return kR=(kR+1)%16777215}function F_(n){return typeof n!="number"&&(n=Date.now()/1e3),n=parseInt(n,10)%4294967295,Rl(8,n)+Rl(6,zx)+Rl(4,ehe)+Rl(6,nhe())}function Rl(n,e){return e=e.toString(16),e.length===n?e:"00000000".substring(e.length,n)+e}function ER(n){var e=0,t=[];if(n.length===24)for(;e<24;t.push(parseInt(n[e]+n[e+1],16)),e+=2);else if(n.length===12)for(;e<12;t.push(n.charCodeAt(e)),e++);return t}var rhe=Symbol&&Symbol.for("nodejs.util.inspect.custom")||"inspect";jn.prototype[rhe]=function(){return"ObjectID("+this+")"};jn.prototype.toJSON=jn.prototype.toHexString;jn.prototype.toString=jn.prototype.toHexString;var pt={},hu=function(e,t){t!==0&&(t=t||1/0);var r=[];return e.start>e.end?(r.push({start:0,end:e.end,type:"end"}),r.push({start:e.start,end:t-1,type:"beginning"})):r.push({start:e.start,end:e.end,type:"beginningAndEnd"}),r},D_=function(e,t){if(e.start<t.start){if(!(e.end<t.start))return e.end<t.end?{start:t.start,end:e.end}:{start:t.start,end:t.end}}else if(!(e.start>t.end))return e.end<t.end?{start:e.start,end:e.end}:{start:e.start,end:t.end}},she=zt,ihe=she.flatMap,TR=hu,ahe=D_,jh=function(e,t,r,s){var i=TR(e,r),a=TR(t,r),o=[];if(i.forEach(function(l,u){a.forEach(function(f,d){var p=ahe(l,f);p&&o.push(p)})}),s&&i.length===2&&a.length===2&&r){var c={};o=ihe(o,function(l,u){if(l.start===0)return c.end=l.end,[];if(l.end===r-1)return c.start=l.start,[]}),o.push(c)}return o},B_=function(e,t){var r=void 0;return e&&(e.start<t.start?e.end<t.start?r={start:e.start,end:e.end}:e.end>t.end?r={start:e.start,end:e.end}:r={start:e.start,end:t.start-1}:e.end<=t.end||(e.start>t.end?r={end:e.end,start:e.start}:r={end:e.end,start:t.end+1})),r},ohe=jh,che=hu,lhe=B_,uhe=zt,fhe=uhe.extend,Hm=function(e,t,r){if(!e||!t)return console.warn("invalid range input"),null;for(var s=void 0,i=[e.start,e.end,t.start,t.end],a=0;a<i.length;a++)if(s=i[a],s<0||!s&&s!==0)return console.warn("invalid range input"),null;var o=ohe(e,t,r);if(!o.length)return e;var c=che(e,r);c.forEach(function(f,d){o.forEach(function(p){f&&(f=lhe(f,p))}),c[d]=f});var l=c.filter(function(f){return!!f}),u=void 0;if(l.length<0||(l.length===1?u=l[0]:l.length===2&&(l[0].start<l[1].start?u={start:l[1].start,end:l[0].end}:u={start:l[0].start,end:l[1].end})),u)return fhe({},e,{start:u.start,end:u.end})},hhe=hu,dhe=Hm,phe=function(e,t,r){var s=dhe(e,t,r);if(s){var i=hhe(t,r);i.forEach(function(a){var o=a.end-a.start+1;s.start>s.end?a.start<s.end?(s.start-=o,s.end-=o):a.start<s.start&&(s.start-=o):a.start<s.start?(s.start-=o,s.end-=o):a.start<s.end&&(s.end-=o)})}return s},ghe=zt,mhe=ghe.assign,vhe=function(e,t,r){var s=mhe({},e);return e.start>e.end?e.end>=t?(s.start+=r,s.end+=r):e.start>=t&&(s.start+=r):e.start>=t?(s.start+=r,s.end+=r):e.end>=t&&(s.end+=r),s},M_=function(e,t){return e.start<t.start?!(e.end<t.start):!(e.start>t.end)},Ihe=M_,AR=hu,P_=function(e,t){return AR(e,1/0).some(function(r){return AR(t,1/0).some(function(s){return Ihe(r,s)})})},L_=function n(e,t,r){var s=r&&r.start<=r.end;if(e.length===1||e.length===0)return e;if(e.length===2)return e[0].start===0&&e[1].end+1===t&&!s?[{start:e[1].start,end:e[0].end}]:e[1].start===0&&e[0].end+1===t&&!s?[{start:e[0].start,end:e[1].end}]:e;if(e.length===3){var i=e[0],a=e[1],o=e[2],c=n([i,a],t,r);return c.length===1?(c.push(o),c):(c=n([i,o],t,r),c.length===1?(c.push(a),c):(c=n([a,o],t,r),c.length===1?(c.push(i),c):e))}},bhe=zt,yhe=bhe.assign,Vx=function(e,t,r){return t=t||{},r=r||{},yhe({},e,{start:Number(e.start)+(t.inclusive1BasedStart?r.inclusive1BasedStart?0:-1:r.inclusive1BasedStart?1:0),end:Number(e.end)+(t.inclusive1BasedEnd?r.inclusive1BasedEnd?0:-1:r.inclusive1BasedEnd?1:0)})},xhe=Vx,whe=function(e){return xhe(e,{inclusive1BasedStart:!0,inclusive1BasedEnd:!0})},She=Vx,Che=function(e){return She(e,{},{inclusive1BasedStart:!0,inclusive1BasedEnd:!0})},Rhe=zt,ap=Rhe.assign,qm=function(e){return function(){var t=Array.prototype.slice.call(arguments),r=t[t.length-1];r&&(r.inclusive1BasedEnd||r.inclusive1BasedStart)&&t.forEach(function(i,a){i&&i.start>-1&&r.inclusive1BasedStart&&(t[a]=ap(i,{start:i.start-1})),i&&i.end>-1&&r.inclusive1BasedEnd&&(t[a]=ap(i,{end:i.end-1}))});var s=e.apply(this,t);return s&&s.start>-1&&r&&r.inclusive1BasedStart&&(s=ap(s,{start:s.start+1})),s&&s.end>-1&&r&&r.inclusive1BasedEnd&&(s=ap(s,{end:s.end+1})),s}},khe=qm,Hc=khe(Ehe);function Ehe(n,e){var t=void 0;return n.end<n.start?t=e-n.start+n.end+1:t=n.end-n.start+1,n.overlapsSelf&&e&&(t+=e),t}var The=Hc,Ahe=function(e,t){if(The(e)===t)return!0},$he=Hm,Wx=function(e,t,r){var s=$he(e,t,r);return s===null?!1:!s},Nhe=hu;function Ohe(n,e,t,r,s){var i=Nhe(e,t),a=i.some(function(o){return(r?n<o.start:n<=o.start)?!1:s?n<=o.end+1:n<=o.end});return a}var U_=Ohe,_he=zt,Fhe=_he.isObject,Dhe=Wx,Bhe=U_,Mhe=function(e,t,r,s,i){return e==null||t===void 0||t===null?!1:Fhe(e)?Dhe(e,t,r):Bhe(e,t,r,s,i)},Phe=function(e){return e.start>e.end},Ra=function(e,t,r){var s=e;return s<0?s+=t:s+(r?0:1)>t&&(s-=t),s<0?0:s>t-(r?0:1)?t-(r?0:1):s},Lhe=Ra,Uhe=zt,zhe=Uhe.assign,z_=function(e,t,r){var s=zhe({},e),i=!0;return e.end>=t?t+r-e.start>e.end-t?s.end=Lhe(t-1,r,!1):(s.start=t,i=!1):e.start<t?e.end+r-t>t-e.start?(s.start=t,i=!1):s.end=t-1:e.start-t>t-e.end?s.end=t-1:(i=!1,s.start=t),{newRange:s,endMoved:i}},Vhe=zt,Whe=Vhe.assign,V_=function(e,t){var r=Whe({},e),s=!0;return e.start>t?(r.start=t,s=!1):e.end<t||t-e.start>e.end-t?r.end=t-1:(r.start=t,s=!1),{newRange:r,endMoved:s}},Ghe=zt,Hhe=Ghe.assign,$R=Ra,W_=function(e,t){return Hhe({},e,{start:$R(e.start,t),end:$R(e.end,t)})},qhe=zt,jhe=qhe.clone,Khe=W_,G_=function(e,t,r,s){var i=jhe(e);return r?i.start-=t:i.end+=t,Khe(i,s)},Xhe=z_,Yhe=V_,Zhe=function(e,t,r){return e.start>e.end?Xhe(e,t,r):Yhe(e,t)},Jhe=zt,Qhe=Jhe.assign,NR=Ra,H_=function(e,t,r){return Qhe({},e,{start:NR(e.start+t,r),end:NR(e.end+t,r)})},W1=G_,q_=Wx,ede=jh,G1=H_,sf=Hc,tde=function(e,t,r,s){var i=q_(e,t,r);return i?j_(e,t,r):nde(e,t,r)};function nde(n,e,t,r){var s=q_(e,n,t),i;if(s){var a=sf({start:n.start,end:e.start},t)-1;i=W1(e,a,!1,t);var o=sf({end:n.end,start:e.end},t)-1;i=W1(i,o,!0,t)}else{var c=ede(n,e,t);if(c.length>=1){var l,u=c[0];l=u.start!==e.start;var f=j_(u,e,t),d=sf(n,t)-sf(f,t);i=W1(f,d,l,t)}else throw new Error("This case (relative ranges that do not overlap) is unsupported! ")}return i}function j_(n,e,t,r){var s=-e.start,i=G1(e,s,t),a=G1(n,s,t),o=rde(a,i,t),c=G1(o,-s,t);return c}function rde(n,e,t){var r=n.start-e.start,s=e.end-r,i=sf(n,t);return{end:s,start:s-(i-1)}}var sde=Ra,ide=function(e,t,r){var s=H1(e,t),i;return r?i=sde(H1(s,s+r),t):i=H1(e,t),{start:s,end:i}};function H1(n,e){return Math.floor(Math.random()*(e-n))+n}var ade=function(e,t,r){return e.start===t.start?e.end===t.end?"beginningAndEnd":r?"start":"end":e.end===t.end?r?"end":"start":"middle"},ode=Ra,cde=Hc,K_=function(e,t){var r=[],s=cde(e,t);if(!(s>0))return r;for(var i=e.start;i<s+e.start;i++){var a=ode(i,t);r.push(a)}return r},lde=Hc,ude=jh,fde=function(e,t,r){var s=ude(e,t,r);return s.reduce(function(i,a){return i+lde(a,r)},0)},hde=function(e,t,r){var s=e/Math.PI/2*t;return r?Math.round(s):Math.floor(s)},dde=Hc,pde=function n(e,t){var r=gde(e,t),s=r.startAngle,i=r.totalAngle,a=r.endAngle;return{startAngle:s,totalAngle:i,endAngle:a,centerAngle:s+i/2,locationAngles:e.locations&&e.locations.map(function(o){return n(o,t)})}};function gde(n,e){var t=dde({start:n.start,end:n.end},e);return{startAngle:2*Math.PI*(n.start/e),totalAngle:t/e*Math.PI*2,endAngle:2*Math.PI*(n.end+1)/e}}var mde=Hc,vde=Ra,Ide=function(e,t){var r=mde({start:e.start,end:e.end},t);return vde(e.start+Math.floor(r/2),t)},bde=function(e,t){var r=[];return e.start>-1&&e.end>-1&&t.start>-1&&t.end>-1?[{start:e.start,end:t.end},{start:t.start,end:e.end}]:r},yde=function(e,t){if(e.start<0||e.end<0)return"";if(e.start>e.end){var r=t.slice(e.start,t.length);return typeof r=="string"?r+=t.slice(0,e.end+1):r=r.concat(t.slice(0,e.end+1)),r}else return t.slice(e.start,e.end+1)},X_=function(e,t,r){if(e<t){var s=e;e=t,t=s}var i=e-t,a=r-e+t;return Math.min(i,a)},xde=P_,Y_=function(e,t,r){var s=[],i=t.some(function(a,o){var c=a.some(function(l){return xde(e,l)});if(!c)return s=o,r&&(e.yOffset=o),a.push(e),!0});return i||(s=t.length,r&&(e.yOffset=t.length)),s},wde=Y_,Sde=function(e,t){var r=[],s=0,i=[];return e.forEach(function(a){var o=wde(a,i,t);r.push(o),o>s&&(s=o),a.yOffset=o,i[o]||(i[o]=[]),i[o].push(a)}),{yOffsets:r,maxYOffset:s}},op=Ra,Cde=qm,Rde=Cde(kde);function kde(n,e){if(n.start>-1){var t=n.end+1,r=n.start-1;return{start:op(t,e,!1),end:op(r,e,!1)}}else if(n>-1)return{start:op(n,e,!1),end:op(n-1,e,!1)}}var OR=X_,Ede=function(e,t,r){var s=OR(t.start,e,r),i=OR(t.end,e,r);return s<=i},Tde=K_,Ade=function(e,t,r){Tde(e,t).map(r)},Z_=function(e,t){var r=e;return e<t.start?r=t.end-(t.start-(e+1)):e>t.end&&(r=t.start+(e-t.end-1)),r},_R=Ra,$de=qm,Nde=zt,Ode=Nde.assign,_de=$de(Fde);function Fde(n,e){return Ode(n,{start:_R(n.start,e),end:_R(n.end,e)})}var Dde=Z_,Bde=function(e,t){return Dde(e,{start:1,end:t})},Mde=function(e,t,r){return t-e-(r?0:1)},Pde=function(e,t){return e<0&&(e=0),e>t&&(e=t),e},Lde=Hm,J_=function(e,t,r){var s=Lde(e,t,r);if(s)throw new Error("subRange must be fully contained by containerRange! Otherwise this function does not make sense");var i={};return i.start=e.start-t.start,i.end=e.end-t.start,i.start<0&&(i.start+=r),i.end<0&&(i.end+=r),i},Ude=zt,zde=Ude.assign,Vde=zt,Wde=Vde.identity,Gde=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments[2],s=r?Hde:Wde,i=zde({},e,{start:s(e.start-(t||0),r),end:s(e.end-(t||0),r)});return i};function Hde(n,e){return(n%e+e)%e}var qde=jh,jde=L_,Kde=J_,Xde=Ra,Yde=function(e,t,r){var s=jde(qde(e,t,r),r,e),i=s.map(function(a){return Kde(a,{start:t.start,end:Xde(t.start-1,r)},r)});return i};pt.adjustRangeToDeletionOfAnotherRange=phe;pt.adjustRangeToInsert=vhe;pt.checkIfNonCircularRangesOverlap=M_;pt.checkIfPotentiallyCircularRangesOverlap=P_;pt.collapseOverlapsGeneratedFromRangeComparisonIfPossible=L_;pt.convertRangeIndices=Vx;pt.convertRangeTo0Based=whe;pt.convertRangeTo1Based=Che;pt.doesRangeSpanEntireSequence=Ahe;pt.isRangeOrPositionWithinRange=Mhe;pt.doesRangeSpanOrigin=Phe;pt.expandOrContractCircularRangeToPosition=z_;pt.expandOrContractNonCircularRangeToPosition=V_;pt.expandOrContractRangeByLength=G_;pt.expandOrContractRangeToPosition=Zhe;pt.flipContainedRange=tde;pt.generateRandomRange=ide;pt.getAnnotationRangeType=ade;pt.getEachPositionInRangeAsArray=K_;pt.getLengthOfOverlappingRegionsBetweenTwoRanges=fde;pt.getOverlapOfNonCircularRanges=D_;pt.getOverlapsOfPotentiallyCircularRanges=jh;pt.getPositionFromAngle=hde;pt.getRangeAngles=pde;pt.getRangeLength=Hc;pt.getMiddleOfRange=Ide;pt.getRangesBetweenTwoRanges=bde;pt.getSequenceWithinRange=yde;pt.getShortestDistanceBetweenTwoPositions=X_;pt.getYOffsetForPotentiallyCircularRange=Y_;pt.getYOffsetsForPotentiallyCircularRanges=Sde;pt.invertRange=Rde;pt.isPositionCloserToRangeStartThanRangeEnd=Ede;pt.isPositionWithinRange=U_;pt.isRangeWithinRange=Wx;pt.loopEachPositionInRange=Ade;pt.modulatePositionByRange=Z_;pt.modulateRangeBySequenceLength=_de;pt.normalizePositionByRangeLength=Ra;pt.normalizePositionByRangeLength1Based=Bde;pt.normalizeRange=W_;pt.provideInclusiveOptions=qm;pt.reversePositionInRange=Mde;pt.splitRangeIntoTwoPartsIfItIsCircular=hu;pt.translateRange=H_;pt.trimNonCicularRangeByAnotherNonCircularRange=B_;pt.trimNumberToFitWithin0ToAnotherNumber=Pde;pt.trimRangeByAnotherRange=Hm;pt.zeroSubrangeByContainerRange=J_;pt.adjustRangeToRotation=Gde;pt.getZeroedRangeOverlaps=Yde;var Zde={".":".",a:"t",t:"a",u:"a",c:"g",g:"c",A:"T",T:"A",U:"A",C:"G",G:"C",r:"y",R:"Y",y:"r",Y:"R",d:"h",D:"H",h:"d",H:"D",k:"m",K:"M",m:"k",M:"K",v:"b",V:"B",b:"v",B:"V"},Gx=Zde,Jde=Gx,Vo=function(e){for(var t="",r=e.length-1;r>=0;r--){var s=Jde[e[r]];s||(s=e[r]),t+=s}return t},Kh={A:{value:"A",name:"Alanine",threeLettersName:"Ala",hydrophobicity:1.8,colorByFamily:"#00FFFF",color:"hsl(327.3, 100%, 69%)",mass:89.1},R:{value:"R",name:"Arginine",threeLettersName:"Arg",hydrophobicity:-4.5,colorByFamily:"#FFC0CB",color:"hsl(258.1, 100%, 69%)",mass:174.2},N:{value:"N",name:"Asparagine",threeLettersName:"Asn",hydrophobicity:-3.5,colorByFamily:"#D3D3D3",color:"hsl(268.9, 100%, 69%)",mass:132.1},D:{value:"D",name:"Aspartic acid",threeLettersName:"Asp",hydrophobicity:-3.5,colorByFamily:"#EE82EE",color:"hsl(268.9, 100%, 69%)",mass:133.1},C:{value:"C",name:"Cysteine",threeLettersName:"Cys",hydrophobicity:2.5,colorByFamily:"#FFFF00",color:"hsl(335.1, 100%, 69%)",mass:121.2},E:{value:"E",name:"Glutamic acid",threeLettersName:"Glu",hydrophobicity:-3.5,colorByFamily:"#EE82EE",color:"hsl(268.9, 100%, 69%)",mass:147.1},Q:{value:"Q",name:"Glutamine",threeLettersName:"Gln",hydrophobicity:-3.5,colorByFamily:"#D3D3D3",color:"hsl(268.9, 100%, 69%)",mass:146.2},G:{value:"G",name:"Glycine",threeLettersName:"Gly",hydrophobicity:-.4,colorByFamily:"#00FFFF",color:"hsl(303.1, 100%, 69%)",mass:75.1},H:{value:"H",name:"Histidine",threeLettersName:"His",hydrophobicity:-3.2,colorByFamily:"#FFC0CB",color:"hsl(272.2, 100%, 69%)",mass:155.2},I:{value:"I",name:"Isoleucine ",threeLettersName:"Ile",hydrophobicity:4.5,colorByFamily:"#00FFFF",color:"hsl(356.9, 100%, 69%)",mass:131.2},L:{value:"L",name:"Leucine",threeLettersName:"Leu",hydrophobicity:3.8,colorByFamily:"#00FFFF",color:"hsl(349.4, 100%, 69%)",mass:131.2},K:{value:"K",name:"Lysine",threeLettersName:"Lys",hydrophobicity:-3.9,colorByFamily:"#FFC0CB",color:"hsl(264.7, 100%, 69%)",mass:146.2},M:{value:"M",name:"Methionine",threeLettersName:"Met",hydrophobicity:1.9,colorByFamily:"#FFFF00",color:"hsl(328.5, 100%, 69%)",mass:149.2},F:{value:"F",name:"Phenylalanine",threeLettersName:"Phe",hydrophobicity:2.8,colorByFamily:"#FFA500",color:"hsl(338.4, 100%, 69%)",mass:165.2},P:{value:"P",name:"Proline",threeLettersName:"Pro",hydrophobicity:-1.6,colorByFamily:"#00FFFF",color:"hsl(289.9, 100%, 69%)",mass:115.1},S:{value:"S",name:"Serine",threeLettersName:"Ser",hydrophobicity:-.8,colorByFamily:"#90EE90",color:"hsl(298.6, 100%, 69%)",mass:105.1},T:{value:"T",name:"Threonine",threeLettersName:"Thr",hydrophobicity:-.7,colorByFamily:"#90EE90",color:"hsl(299.8, 100%, 69%)",mass:119.1},U:{value:"U",name:"Selenocysteine",threeLettersName:"Sec",colorByFamily:"#FF0000",color:"hsl(0, 100%, 69%)",mass:168.1},W:{value:"W",name:"Tryptophan",threeLettersName:"Trp",hydrophobicity:-.9,colorByFamily:"#FFA500",color:"hsl(297.6, 100%, 69%)",mass:204.2},Y:{value:"Y",name:"Tyrosine",threeLettersName:"Tyr",hydrophobicity:-1.3,colorByFamily:"#FFA500",color:"hsl(293.2, 100%, 69%)",mass:181.2},V:{value:"V",name:"Valine",threeLettersName:"Val",hydrophobicity:4.2,colorByFamily:"#00FFFF",color:"hsl(353.6, 100%, 69%)",mass:117.1},"*":{value:"*",name:"Stop",threeLettersName:"Stop",colorByFamily:"#FF0000",color:"hsl(0, 100%, 69%)",mass:0},".":{value:".",name:"Gap",threeLettersName:"Gap",colorByFamily:"#FF0000",color:"hsl(0, 100%, 69%)",mass:0},"-":{value:"-",name:"Gap",threeLettersName:"Gap",colorByFamily:"#FF0000",color:"hsl(0, 100%, 69%)",mass:0},B:{value:"B",threeLettersName:"ND",colorByFamily:"#D3D3D3",color:"hsl(268.9, 100%, 69%)",isAmbiguous:!0,name:"B",aliases:"ND",mass:0},J:{value:"J",threeLettersName:"IL",colorByFamily:"#00FFFF",color:"hsl(352, 100%, 69%)",isAmbiguous:!0,name:"J",aliases:"IL",mass:0},X:{value:"X",threeLettersName:"ACDEFGHIKLMNPQRSTVWY",colorByFamily:"#FFFFFF",color:"hsl(60, 100%, 69%)",isAmbiguous:!0,name:"X",aliases:"ACDEFGHIKLMNPQRSTVWY",mass:0},Z:{value:"Z",threeLettersName:"QE",colorByFamily:"#D3D3D3",color:"hsl(268.9, 100%, 69%)",isAmbiguous:!0,name:"Z",aliases:"QE",mass:0}},st=Kh,Q_={gct:st.A,gcc:st.A,gca:st.A,gcg:st.A,gcu:st.A,cgt:st.R,cgc:st.R,cga:st.R,cgg:st.R,aga:st.R,agg:st.R,cgu:st.R,aat:st.N,aac:st.N,aau:st.N,gat:st.D,gac:st.D,gau:st.D,tgt:st.C,tgc:st.C,ugu:st.C,ugc:st.C,gaa:st.E,gag:st.E,caa:st.Q,cag:st.Q,ggt:st.G,ggc:st.G,gga:st.G,ggg:st.G,ggu:st.G,cat:st.H,cac:st.H,cau:st.H,att:st.I,atc:st.I,ata:st.I,auu:st.I,auc:st.I,aua:st.I,ctt:st.L,ctc:st.L,cta:st.L,ctg:st.L,tta:st.L,ttg:st.L,cuu:st.L,cuc:st.L,cua:st.L,cug:st.L,uua:st.L,uug:st.L,aaa:st.K,aag:st.K,atg:st.M,aug:st.M,ttt:st.F,ttc:st.F,uuu:st.F,uuc:st.F,cct:st.P,ccc:st.P,cca:st.P,ccg:st.P,ccu:st.P,tct:st.S,tcc:st.S,tca:st.S,tcg:st.S,agt:st.S,agc:st.S,ucu:st.S,ucc:st.S,uca:st.S,ucg:st.S,agu:st.S,act:st.T,acc:st.T,aca:st.T,acg:st.T,acu:st.T,tgg:st.W,ugg:st.W,tat:st.Y,tac:st.Y,uau:st.Y,uac:st.Y,gtt:st.V,gtc:st.V,gta:st.V,gtg:st.V,guu:st.V,guc:st.V,gua:st.V,gug:st.V,taa:st["*"],tag:st["*"],tga:st["*"],"...":st["."],"---":st["-"]},Qde={"-":"---",".":"...","*":"trr",a:"gcn",b:"ray",c:"tgy",d:"gay",e:"gar",f:"tty",g:"ggn",h:"cay",i:"ath",j:"htn",k:"aar",l:"ytn",m:"atg",n:"aay",o:"tag",p:"ccn",q:"car",r:"mgn",s:"wsn",t:"acn",u:"tga",v:"gtn",w:"tgg",x:"nnn",y:"tay",z:"sar"},jm=Qde,epe=zt,tpe=epe.invert,npe=jm,rpe=tpe(npe),e3=rpe,spe=Q_,ipe=Kh,ape=e3,t3=function(e){if(e=e.toLowerCase(),e.length!==3)throw new Error("must pass a string of length 3");var t=spe[e];if(t)return t;var r=ape[e.replace("x","n")]||"x";return ipe[r.toUpperCase()]},n3=pt,q1=n3.translateRange,ope=n3.getSequenceWithinRange,cpe=Vo,j1=t3,lpe=Kh,Km=function(e,t,r,s){var i=s?e.length*3:e.length,a=e,o=0;r&&(a=ope(r,e),o=r.start);var c=s?a.length*3:a.length,l=[],u=void 0,f=0,d=0;if(!t&&(d=Math.floor((c-1)/3),f=c%3,u=q1({start:0,end:f-1},o,i),f>0)){for(var p=0;p<f;p++)l.push({aminoAcid:j1("xxx"),positionInCodon:f-p-1,aminoAcidIndex:d,sequenceIndex:u.start+p,codonRange:u,fullCodon:!1});d--}for(var m=2+f;m<c;m+=3){var I=void 0;if(s)I=lpe[a[(m-2)/3].toUpperCase()];else{var v=a.slice(m-2,m+1);t||(v=cpe(v)),I=j1(v)}u=q1({start:m-2,end:m},o,i),l.push({aminoAcid:I,positionInCodon:t?0:2,aminoAcidIndex:d,sequenceIndex:u.start,codonRange:u,fullCodon:!0}),l.push({aminoAcid:I,positionInCodon:1,aminoAcidIndex:d,sequenceIndex:u.start+1,codonRange:u,fullCodon:!0}),l.push({aminoAcid:I,positionInCodon:t?2:0,aminoAcidIndex:d,sequenceIndex:u.start+2,codonRange:u,fullCodon:!0}),t?d++:d--}var b=c-l.length;u=q1({start:c-b,end:c-1},o,i);for(var y=0;y<b;y++)l.push({aminoAcid:j1("xxx"),positionInCodon:y,aminoAcidIndex:d,sequenceIndex:u.start+y,fullCodon:!1,codonRange:u});if(c!==l.length)throw new Error("something went wrong!");return l},Hx={exports:{}};Hx.exports=["features","warnings","assemblyPieces","lineageAnnotations","parts","cutsites","orfs","translations","primers","guides"];Hx.exports.modifiableTypes=["features","assemblyPieces","lineageAnnotations","warnings","parts","translations","primers","guides"];var Ja=Hx.exports,r3=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments[2];return e&&e.replace(new RegExp("[^"+(r||"atgcyrswkmbvdhnu"+t.split("").join("\\"))+"]","gi"),"")},Wo={},K1=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},qx=zt,FR=qx.get,DR=qx.keyBy,s3=qx.filter,jx=[{name:"-10_signal",color:"#4ECDC4"},{name:"-35_signal",color:"#F7FFF7"},{name:"3'clip",color:"#FF6B6B"},{name:"3'UTR",color:"#FFE66D"},{name:"5'clip",color:"#3E517A"},{name:"5'UTR",color:"#BBBBBB"},{name:"D-loop",color:"#F13C73"},{name:"assembly_gap",color:"#DE9151"},{name:"centromere",color:"#F34213"},{name:"Het",color:"#BC5D2E"},{name:"mobile_element",color:"#6DB1BF"},{name:"ncRNA",color:"#FFEAEC"},{name:"proprotein",color:"#F39A9D"},{name:"regulatory",color:"#3F6C51"},{name:"SecStr",color:"#7B4B94"},{name:"Site",color:"#7D82B8"},{name:"telomere",color:"DE9151"},{name:"tmRNA",color:"#B7E3CC"},{name:"unsure",color:"#C4FFB2"},{name:"V_segment",color:"#D6F7A3"},{name:"allele",color:"#D86D6D"},{name:"attenuator",color:"#6B7F9C"},{name:"C_region",color:"#B5D89D"},{name:"CAAT_signal",color:"#E9CD98"},{name:"CDS",color:"#EF6500"},{name:"conserved",color:"#A3A5F0"},{name:"D_segment",color:"#C060F7"},{name:"default",color:"#CCCCCC"},{name:"enhancer",color:"#38F872"},{name:"exon",color:"#95F844"},{name:"gap",color:"#F7D43C"},{name:"GC_signal",color:"#861F1F"},{name:"gene",color:"#684E27"},{name:"iDNA",color:"#A59B41"},{name:"intron",color:"#52963E"},{name:"J_region",color:"#369283"},{name:"LTR",color:"#31748F"},{name:"m_rna",color:"#FFFF00"},{name:"mat_peptide",color:"#353E8F"},{name:"misc_binding",color:"#006FEF"},{name:"misc_difference",color:"#5A368A"},{name:"misc_feature",color:"#006FEF"},{name:"misc_marker",color:"#8DCEB1"},{name:"misc_part",color:"#006FEF"},{name:"misc_recomb",color:"#DD97B4"},{name:"misc_RNA",color:"#BD0101"},{name:"misc_signal",color:"#FF9A04"},{name:"misc_structure",color:"#B3FF00"},{name:"modified_base",color:"#00F7FF"},{name:"mRNA",color:"#FFD900"},{name:"N_region",color:"#AE00FF"},{name:"old_sequence",color:"#F0A7FF"},{name:"operator",color:"#63004D"},{name:"operon",color:"#000653"},{name:"oriT",color:"#580000"},{name:"plasmid",color:"#00635E"},{name:"polyA_signal",color:"#BBBBBB"},{name:"polyA_site",color:"#003328"},{name:"precursor_RNA",color:"#443200"},{name:"prim_transcript",color:"#665E4C"},{name:"primer_bind",color:"#53d969"},{name:"promoter",color:"#31B440"},{name:"protein_bind",color:"#2E2E2E"},{name:"protein_domain",color:"#4D4B4B"},{name:"protein",color:"#696969"},{name:"RBS",color:"#BDFFCB"},{name:"rep_origin",color:"#878787"},{name:"repeat_region",color:"#966363"},{name:"repeat_unit",color:"#A16D8D"},{name:"rRNA",color:"#9BF0FF"},{name:"s_mutation",color:"#70A2FF"},{name:"S_region",color:"#FF74A9"},{name:"satellite",color:"#164E64"},{name:"scRNA",color:"#A057FF"},{name:"sig_peptide",color:"#2FFF8D"},{name:"snoRNA",color:"#296B14"},{name:"snRNA",color:"#A16249"},{name:"source",color:"#0B17BD"},{name:"start",color:"#D6A336"},{name:"stem_loop",color:"#67069E"},{name:"stop",color:"#D44FC9"},{name:"STS",color:"#597FE7"},{name:"tag",color:"#E419DA"},{name:"TATA_signal",color:"#EB2B2B"},{name:"terminator",color:"#F51600"},{name:"transit_peptide",color:"#24D491"},{name:"transposon",color:"#B6E436"},{name:"tRNA",color:"#D1456F"},{name:"V_region",color:"#7B5EE7"},{name:"variation",color:"#2EE455"}],Kx=function(){var e=DR(jx.map(function(r){return K1({},r,{isGenbankStandardType:!0})}),"name"),t=typeof window<"u"&&FR(window,"tg_featureTypeOverrides")||typeof Hn<"u"&&FR(Hn,"tg_featureTypeOverrides");return t=t||[],t=t.map(function(r){var s=e[r.name];return K1({},s,r,s?{isOverridden:!0}:{isCustomType:!0})}),t=DR(t,"name"),K1({},e,t)},upe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.includeHidden,r={};return s3(Kx(),function(s){return t?!0:!s.isHidden}).forEach(function(s){r[s.name]=s.color}),r},fpe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.includeHidden;return s3(Kx(),function(r){return t?!0:!r.isHidden}).map(function(r){return r.name})};Wo.genbankFeatureTypes=jx;Wo.getGenbankFeatureToColorMap=function(){var n={};return jx.forEach(function(e){var t=e.name,r=e.color;n[t]=r}),n};Wo.getFeatureToColorMap=upe;Wo.getFeatureTypes=fpe;Wo.getMergedFeatureMap=Kx;var hpe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Xx=zt,dpe=Xx.cloneDeep,BR=Xx.get,ppe=Xx.some,i3=Wo,gpe=i3.getFeatureToColorMap,mpe=i3.getFeatureTypes,MR=fu,a3=function(e,t){var r=t.sequenceData,s=r===void 0?{}:r,i=t.convertAnnotationsFromAAIndices,a=t.annotationType,o=t.provideNewIdsForAnnotations,c=t.doNotProvideIdsForAnnotations,l=t.messages,u=l===void 0?[]:l,f=t.mutative,d=t.allowNonStandardGenbankTypes,p=t.featureTypes,m=s.size,I=s.circular,v=s.isProtein;if(!e||(typeof e>"u"?"undefined":hpe(e))!=="object")return u.push("Invalid annotation detected and removed"),!1;var b=e;if(f||(b=dpe(e)),b.annotationTypePlural=a,(!b.name||typeof b.name!="string")&&(u.push('Unable to detect valid name for annotation, setting name to "Untitled annotation"'),b.name="Untitled annotation"),o&&(b.id=MR().str),!b.id&&b.id!==0&&!c&&(b.id=MR().str,u.push("Unable to detect valid ID for annotation, setting ID to "+b.id)),PR({isProtein:v,location:b,convertAnnotationsFromAAIndices:i,size:m,messages:u,circular:I,name:b.name}),b.locations&&b.locations.forEach(function(y){PR({isProtein:v,location:y,convertAnnotationsFromAAIndices:i,size:m,messages:u,circular:I,name:b.name})}),v||b.forward===!0||b.forward==="true"||b.strand===1||b.strand==="1"||b.strand==="+"?(b.forward=!0,b.strand=1):(b.forward=!1,b.strand=-1),(!b.type||typeof b.type!="string"||!ppe(p||mpe(),function(y){return y.toLowerCase()===b.type.toLowerCase()?(b.type=y,!0):!!(d||typeof window<"u"&&BR(window,"tg_allowNonStandardGenbankTypes")||typeof Hn<"u"&&BR(Hn,"tg_allowNonStandardGenbankTypes"))}))&&(u.push("Invalid annotation type detected:  "+b.type+" for "+b.name+". set type to misc_feature"),b.type="misc_feature"),b.notes&&typeof b.notes=="string")try{b.notes=JSON.parse(b.notes)}catch(y){console.info("warning 33y00a0912 - couldn't parse notes for "+(b.name||"")+" "+b.notes+":",y)}return b.color||(b.color=gpe()[b.type]),b};function PR(n){var e=n.location,t=n.convertAnnotationsFromAAIndices,r=n.size,s=n.isProtein,i=n.messages,a=n.circular,o=n.name;e.start=parseInt(e.start,10),e.end=parseInt(e.end,10),t&&(e.start=e.start*3,e.end=e.end*3+2),(e.start<0||!(e.start<=r-1)||e.start>r-1)&&(i.push("Invalid annotation start: "+e.start+" detected for "+e.name+" and set to size: "+r),e.start=r-(s?3:1)),(e.end<0||!(e.end<=r-1)||e.end>r-1)&&(i.push("Invalid annotation end:  "+e.end+" detected for "+e.name+" and set to seq size: "+r),e.end=r-1),e.start>e.end&&a===!1&&(i.push("Invalid circular annotation detected for "+o+". end set to 1"),e.end=r)}var o3=function(e,t){return t=t||{},t.includeStopCodon?e.replace(/[^xtgalmfwkqespvicyhrndu.*]/gi,""):e.replace(/[^xtgalmfwkqespvicyhrndu]/gi,"")},vpe=jm,c3=function(e){return e.split("").map(function(t){return vpe[t.toLowerCase()]||"nnn"}).join("")},Ipe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},LR=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},bpe=fu,UR=Km,l3=zt,ype=l3.cloneDeep,xpe=l3.flatMap,zR=Ja,wpe=r3,Spe=a3,Cpe=o3,Rpe=c3,kpe=Wo,Epe=kpe.getFeatureTypes,qc=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.annotationsAsObjects,s=t.logMessages,i=t.removeUnwantedChars,a=t.additionalValidChars,o=t.noTranslationData,c=t.charOverrides,l=t.doNotProvideIdsForAnnotations,u=t.proteinFilterOptions,f=t.noCdsTranslations,d=t.convertAnnotationsFromAAIndices,p=ype(e),m={messages:[]};p||(p={}),p.sequence||(p.sequence=""),p.proteinSequence||(p.proteinSequence="");var I=!1;p.isProtein&&(p.circular=!1,!p.proteinSequence&&p.proteinSequence!==""&&(p.proteinSequence=p.sequence),(!p.sequence||p.sequence.length!==p.proteinSequence.length*3)&&(I=!0)),p.isRna&&(p.sequence=p.sequence.replace(/t/gi,"u")),i&&(p.isProtein?p.proteinSequence=Cpe(p.proteinSequence,LR({includeStopCodon:!0},u)):p.sequence=wpe(p.sequence,""+(a||"")+(p.isRna||p.isMixedRnaAndDna?"u":""),c)),p.isProtein&&(I&&(p.sequence=Rpe(p.proteinSequence)),p.aminoAcidDataForEachBaseOfDNA=UR(p.proteinSequence,!0,null,!0)),p.size=p.noSequence?p.size:p.sequence.length,p.proteinSize=p.noSequence?p.proteinSize:p.proteinSequence.length,p.circular==="false"||p.circular==-1||p.circular===!1||!p.circular&&p.sequenceTypeCode!=="CIRCULAR_DNA"?p.circular=!1:p.circular=!0;var v=Epe();return zR.forEach(function(b){Array.isArray(p[b])||(Ipe(p[b])==="object"?p[b]=Object.keys(p[b]).map(function(y){return p[b][y]}):p[b]=[]),p[b]=p[b].filter(function(y){return Spe(y,LR({},t,{featureTypes:v,sequenceData:p,convertAnnotationsFromAAIndices:d,mutative:!0,annotationType:b}))})}),o||(p.translations=xpe(p.translations,function(b){return f&&b.translationType==="CDS Feature"?[]:(!b.aminoAcids&&!p.noSequence&&(b.aminoAcids=UR(p.sequence,b.forward,b)),b)})),r&&zR.forEach(function(b){p[b]=p[b].reduce(function(y,S){var w=void 0;return S.id||S.id===0?w=S.id:(w=bpe().str,l||(S.id=w)),y[w]=S,y},{})}),s&&m.messages.length>0&&console.info("tidyUpSequenceData messages:",m.messages),p},gI={exports:{}},VR={},WR;function Tpe(){return WR||(WR=1),VR}(function(n,e){(function(t,r){r(e,Tpe())})(Hn,function(t,r){r=r&&r.hasOwnProperty("default")?r.default:r;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Re){return typeof Re}:function(Re){return Re&&typeof Symbol=="function"&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re},i=function(Re,_){if(!(Re instanceof _))throw new TypeError("Cannot call a class as a function")},a=function(){function Re(_,V){for(var U=0;U<V.length;U++){var K=V[U];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(_,K.key,K)}}return function(_,V,U){return V&&Re(_.prototype,V),U&&Re(_,U),_}}(),o=function Re(_,V,U){_===null&&(_=Function.prototype);var K=Object.getOwnPropertyDescriptor(_,V);if(K===void 0){var F=Object.getPrototypeOf(_);return F===null?void 0:Re(F,V,U)}else{if("value"in K)return K.value;var H=K.get;return H===void 0?void 0:H.call(U)}},c=function(Re,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);Re.prototype=Object.create(_&&_.prototype,{constructor:{value:Re,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(Re,_):Re.__proto__=_)},l=function(Re,_){if(!Re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:Re},u=function(){function Re(_,V){var U=[],K=!0,F=!1,H=void 0;try{for(var ee=_[Symbol.iterator](),de;!(K=(de=ee.next()).done)&&(U.push(de.value),!(V&&U.length===V));K=!0);}catch(Ie){F=!0,H=Ie}finally{try{!K&&ee.return&&ee.return()}finally{if(F)throw H}}return U}return function(_,V){if(Array.isArray(_))return _;if(Symbol.iterator in Object(_))return Re(_,V);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(Re){if(Array.isArray(Re)){for(var _=0,V=Array(Re.length);_<Re.length;_++)V[_]=Re[_];return V}else return Array.from(Re)},d=function(){function Re(_){i(this,Re),this.selfOptions=_||{},this.pipes={}}return a(Re,[{key:"options",value:function(V){return V&&(this.selfOptions=V),this.selfOptions}},{key:"pipe",value:function(V,U){var K=U;if(typeof V=="string"){if(typeof K>"u")return this.pipes[V];this.pipes[V]=K}if(V&&V.name){if(K=V,K.processor===this)return K;this.pipes[K.name]=K}return K.processor=this,K}},{key:"process",value:function(V,U){var K=V;K.options=this.options();for(var F=U||V.pipe||"default",H=void 0,ee=void 0;F;)typeof K.nextAfterChildren<"u"&&(K.next=K.nextAfterChildren,K.nextAfterChildren=null),typeof F=="string"&&(F=this.pipe(F)),F.process(K),ee=K,H=F,F=null,K&&K.next&&(K=K.next,F=ee.nextPipe||K.pipe||H);return K.hasResult?K.result:void 0}}]),Re}(),p=function(){function Re(_){i(this,Re),this.name=_,this.filters=[]}return a(Re,[{key:"process",value:function(V){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var U=this.debug,K=this.filters.length,F=V,H=0;H<K;H++){var ee=this.filters[H];if(U&&this.log("filter: "+ee.filterName),ee(F),(typeof F>"u"?"undefined":s(F))==="object"&&F.exiting){F.exiting=!1;break}}!F.next&&this.resultCheck&&this.resultCheck(F)}},{key:"log",value:function(V){console.log("[jsondiffpatch] "+this.name+" pipe, "+V)}},{key:"append",value:function(){var V;return(V=this.filters).push.apply(V,arguments),this}},{key:"prepend",value:function(){var V;return(V=this.filters).unshift.apply(V,arguments),this}},{key:"indexOf",value:function(V){if(!V)throw new Error("a filter name is required");for(var U=0;U<this.filters.length;U++){var K=this.filters[U];if(K.filterName===V)return U}throw new Error("filter not found: "+V)}},{key:"list",value:function(){return this.filters.map(function(V){return V.filterName})}},{key:"after",value:function(V){var U=this.indexOf(V),K=Array.prototype.slice.call(arguments,1);if(!K.length)throw new Error("a filter is required");return K.unshift(U+1,0),Array.prototype.splice.apply(this.filters,K),this}},{key:"before",value:function(V){var U=this.indexOf(V),K=Array.prototype.slice.call(arguments,1);if(!K.length)throw new Error("a filter is required");return K.unshift(U,0),Array.prototype.splice.apply(this.filters,K),this}},{key:"replace",value:function(V){var U=this.indexOf(V),K=Array.prototype.slice.call(arguments,1);if(!K.length)throw new Error("a filter is required");return K.unshift(U,1),Array.prototype.splice.apply(this.filters,K),this}},{key:"remove",value:function(V){var U=this.indexOf(V);return this.filters.splice(U,1),this}},{key:"clear",value:function(){return this.filters.length=0,this}},{key:"shouldHaveResult",value:function(V){if(V===!1){this.resultCheck=null;return}if(!this.resultCheck){var U=this;return this.resultCheck=function(K){if(!K.hasResult){console.log(K);var F=new Error(U.name+" failed");throw F.noResult=!0,F}},this}}}]),Re}(),m=function(){function Re(){i(this,Re)}return a(Re,[{key:"setResult",value:function(V){return this.result=V,this.hasResult=!0,this}},{key:"exit",value:function(){return this.exiting=!0,this}},{key:"switchTo",value:function(V,U){return typeof V=="string"||V instanceof p?this.nextPipe=V:(this.next=V,U&&(this.nextPipe=U)),this}},{key:"push",value:function(V,U){return V.parent=this,typeof U<"u"&&(V.childName=U),V.root=this.root||this,V.options=V.options||this.options,this.children?(this.children[this.children.length-1].next=V,this.children.push(V)):(this.children=[V],this.nextAfterChildren=this.next||null,this.next=V),V.next=this,this}}]),Re}(),I=typeof Array.isArray=="function"?Array.isArray:function(Re){return Re instanceof Array};function v(Re){var _=/^\/(.*)\/([gimyu]*)$/.exec(Re.toString());return new RegExp(_[1],_[2])}function b(Re){if((typeof Re>"u"?"undefined":s(Re))!=="object")return Re;if(Re===null)return null;if(I(Re))return Re.map(b);if(Re instanceof Date)return new Date(Re.getTime());if(Re instanceof RegExp)return v(Re);var _={};for(var V in Re)Object.prototype.hasOwnProperty.call(Re,V)&&(_[V]=b(Re[V]));return _}var y=function(Re){c(_,Re);function _(V,U){i(this,_);var K=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return K.left=V,K.right=U,K.pipe="diff",K}return a(_,[{key:"setResult",value:function(U){if(this.options.cloneDiffValues&&(typeof U>"u"?"undefined":s(U))==="object"){var K=typeof this.options.cloneDiffValues=="function"?this.options.cloneDiffValues:b;s(U[0])==="object"&&(U[0]=K(U[0])),s(U[1])==="object"&&(U[1]=K(U[1]))}return m.prototype.setResult.apply(this,arguments)}}]),_}(m),S=function(Re){c(_,Re);function _(V,U){i(this,_);var K=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return K.left=V,K.delta=U,K.pipe="patch",K}return _}(m),w=function(Re){c(_,Re);function _(V){i(this,_);var U=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return U.delta=V,U.pipe="reverse",U}return _}(m),C=typeof Array.isArray=="function"?Array.isArray:function(Re){return Re instanceof Array},N=function(_){if(_.left===_.right){_.setResult(void 0).exit();return}if(typeof _.left>"u"){if(typeof _.right=="function")throw new Error("functions are not supported");_.setResult([_.right]).exit();return}if(typeof _.right>"u"){_.setResult([_.left,0,0]).exit();return}if(typeof _.left=="function"||typeof _.right=="function")throw new Error("functions are not supported");if(_.leftType=_.left===null?"null":s(_.left),_.rightType=_.right===null?"null":s(_.right),_.leftType!==_.rightType){_.setResult([_.left,_.right]).exit();return}if(_.leftType==="boolean"||_.leftType==="number"){_.setResult([_.left,_.right]).exit();return}if(_.leftType==="object"&&(_.leftIsArray=C(_.left)),_.rightType==="object"&&(_.rightIsArray=C(_.right)),_.leftIsArray!==_.rightIsArray){_.setResult([_.left,_.right]).exit();return}_.left instanceof RegExp&&(_.right instanceof RegExp?_.setResult([_.left.toString(),_.right.toString()]).exit():_.setResult([_.left,_.right]).exit())};N.filterName="trivial";var E=function(_){if(typeof _.delta>"u"){_.setResult(_.left).exit();return}if(_.nested=!C(_.delta),!_.nested){if(_.delta.length===1){_.setResult(_.delta[0]).exit();return}if(_.delta.length===2){if(_.left instanceof RegExp){var V=/^\/(.*)\/([gimyu]+)$/.exec(_.delta[1]);if(V){_.setResult(new RegExp(V[1],V[2])).exit();return}}_.setResult(_.delta[1]).exit();return}_.delta.length===3&&_.delta[2]===0&&_.setResult(void 0).exit()}};E.filterName="trivial";var A=function(_){if(typeof _.delta>"u"){_.setResult(_.delta).exit();return}if(_.nested=!C(_.delta),!_.nested){if(_.delta.length===1){_.setResult([_.delta[0],0,0]).exit();return}if(_.delta.length===2){_.setResult([_.delta[1],_.delta[0]]).exit();return}_.delta.length===3&&_.delta[2]===0&&_.setResult([_.delta[0]]).exit()}};A.filterName="trivial";function M(Re){if(!(!Re||!Re.children)){for(var _=Re.children.length,V=void 0,U=Re.result,K=0;K<_;K++)V=Re.children[K],!(typeof V.result>"u")&&(U=U||{},U[V.childName]=V.result);U&&Re.leftIsArray&&(U._t="a"),Re.setResult(U).exit()}}M.filterName="collectChildren";function z(Re){if(!(Re.leftIsArray||Re.leftType!=="object")){var _=void 0,V=void 0,U=Re.options.propertyFilter;for(_ in Re.left)Object.prototype.hasOwnProperty.call(Re.left,_)&&(U&&!U(_,Re)||(V=new y(Re.left[_],Re.right[_]),Re.push(V,_)));for(_ in Re.right)Object.prototype.hasOwnProperty.call(Re.right,_)&&(U&&!U(_,Re)||typeof Re.left[_]>"u"&&(V=new y(void 0,Re.right[_]),Re.push(V,_)));if(!Re.children||Re.children.length===0){Re.setResult(void 0).exit();return}Re.exit()}}z.filterName="objects";var Y=function(_){if(_.nested&&!_.delta._t){var V=void 0,U=void 0;for(V in _.delta)U=new S(_.left[V],_.delta[V]),_.push(U,V);_.exit()}};Y.filterName="objects";var re=function(_){if(!(!_||!_.children)&&!_.delta._t){for(var V=_.children.length,U=void 0,K=0;K<V;K++)U=_.children[K],Object.prototype.hasOwnProperty.call(_.left,U.childName)&&U.result===void 0?delete _.left[U.childName]:_.left[U.childName]!==U.result&&(_.left[U.childName]=U.result);_.setResult(_.left).exit()}};re.filterName="collectChildren";var ne=function(_){if(_.nested&&!_.delta._t){var V=void 0,U=void 0;for(V in _.delta)U=new w(_.delta[V]),_.push(U,V);_.exit()}};ne.filterName="objects";function le(Re){if(!(!Re||!Re.children)&&!Re.delta._t){for(var _=Re.children.length,V=void 0,U={},K=0;K<_;K++)V=Re.children[K],U[V.childName]!==V.result&&(U[V.childName]=V.result);Re.setResult(U).exit()}}le.filterName="collectChildren";var j=function(_,V,U,K){return _[U]===V[K]},ge=function(_,V,U,K){var F=_.length,H=V.length,ee=void 0,de=void 0,Ie=[F+1];for(ee=0;ee<F+1;ee++)for(Ie[ee]=[H+1],de=0;de<H+1;de++)Ie[ee][de]=0;for(Ie.match=U,ee=1;ee<F+1;ee++)for(de=1;de<H+1;de++)U(_,V,ee-1,de-1,K)?Ie[ee][de]=Ie[ee-1][de-1]+1:Ie[ee][de]=Math.max(Ie[ee-1][de],Ie[ee][de-1]);return Ie},Se=function Re(_,V,U,K,F,H){if(K===0||F===0)return{sequence:[],indices1:[],indices2:[]};if(_.match(V,U,K-1,F-1,H)){var ee=Re(_,V,U,K-1,F-1,H);return ee.sequence.push(V[K-1]),ee.indices1.push(K-1),ee.indices2.push(F-1),ee}return _[K][F-1]>_[K-1][F]?Re(_,V,U,K,F-1,H):Re(_,V,U,K-1,F,H)},me=function(_,V,U,K){var F=K||{},H=ge(_,V,U||j,F),ee=Se(H,_,V,_.length,V.length,F);return typeof _=="string"&&typeof V=="string"&&(ee.sequence=ee.sequence.join("")),ee},ye={get:me},Ce=3,he=typeof Array.isArray=="function"?Array.isArray:function(Re){return Re instanceof Array},Ne=typeof Array.prototype.indexOf=="function"?function(Re,_){return Re.indexOf(_)}:function(Re,_){for(var V=Re.length,U=0;U<V;U++)if(Re[U]===_)return U;return-1};function xe(Re,_,V,U){for(var K=0;K<V;K++)for(var F=Re[K],H=0;H<U;H++){var ee=_[H];if(K!==H&&F===ee)return!0}}function ae(Re,_,V,U,K){var F=Re[V],H=_[U];if(F===H)return!0;if((typeof F>"u"?"undefined":s(F))!=="object"||(typeof H>"u"?"undefined":s(H))!=="object")return!1;var ee=K.objectHash;if(!ee)return K.matchByPosition&&V===U;var de=void 0,Ie=void 0;return typeof V=="number"?(K.hashCache1=K.hashCache1||[],de=K.hashCache1[V],typeof de>"u"&&(K.hashCache1[V]=de=ee(F,V))):de=ee(F),typeof de>"u"||(typeof U=="number"?(K.hashCache2=K.hashCache2||[],Ie=K.hashCache2[U],typeof Ie>"u"&&(K.hashCache2[U]=Ie=ee(H,U))):Ie=ee(H),typeof Ie>"u")?!1:de===Ie}var J=function(_){if(_.leftIsArray){var V={objectHash:_.options&&_.options.objectHash,matchByPosition:_.options&&_.options.matchByPosition},U=0,K=0,F=void 0,H=void 0,ee=void 0,de=_.left,Ie=_.right,ve=de.length,ke=Ie.length,Ue=void 0;for(ve>0&&ke>0&&!V.objectHash&&typeof V.matchByPosition!="boolean"&&(V.matchByPosition=!xe(de,Ie,ve,ke));U<ve&&U<ke&&ae(de,Ie,U,U,V);)F=U,Ue=new y(_.left[F],_.right[F]),_.push(Ue,F),U++;for(;K+U<ve&&K+U<ke&&ae(de,Ie,ve-1-K,ke-1-K,V);)H=ve-1-K,ee=ke-1-K,Ue=new y(_.left[H],_.right[ee]),_.push(Ue,ee),K++;var qe=void 0;if(U+K===ve){if(ve===ke){_.setResult(void 0).exit();return}for(qe=qe||{_t:"a"},F=U;F<ke-K;F++)qe[F]=[Ie[F]];_.setResult(qe).exit();return}if(U+K===ke){for(qe=qe||{_t:"a"},F=U;F<ve-K;F++)qe["_"+F]=[de[F],0,0];_.setResult(qe).exit();return}delete V.hashCache1,delete V.hashCache2;var nt=de.slice(U,ve-K),ot=Ie.slice(U,ke-K),mt=ye.get(nt,ot,ae,V),At=[];for(qe=qe||{_t:"a"},F=U;F<ve-K;F++)Ne(mt.indices1,F-U)<0&&(qe["_"+F]=[de[F],0,0],At.push(F));var Pt=!0;_.options&&_.options.arrays&&_.options.arrays.detectMove===!1&&(Pt=!1);var qt=!1;_.options&&_.options.arrays&&_.options.arrays.includeValueOnMove&&(qt=!0);var on=At.length;for(F=U;F<ke-K;F++){var Sn=Ne(mt.indices2,F-U);if(Sn<0){var jt=!1;if(Pt&&on>0){for(var gn=0;gn<on;gn++)if(H=At[gn],ae(nt,ot,H-U,F-U,V)){qe["_"+H].splice(1,2,F,Ce),qt||(qe["_"+H][0]=""),ee=F,Ue=new y(_.left[H],_.right[ee]),_.push(Ue,ee),At.splice(gn,1),jt=!0;break}}jt||(qe[F]=[Ie[F]])}else H=mt.indices1[Sn]+U,ee=mt.indices2[Sn]+U,Ue=new y(_.left[H],_.right[ee]),_.push(Ue,ee)}_.setResult(qe).exit()}};J.filterName="arrays";var D={numerically:function(_,V){return _-V},numericallyBy:function(_){return function(V,U){return V[_]-U[_]}}},P=function(_){if(_.nested&&_.delta._t==="a"){var V=void 0,U=void 0,K=_.delta,F=_.left,H=[],ee=[],de=[];for(V in K)if(V!=="_t")if(V[0]==="_")if(K[V][2]===0||K[V][2]===Ce)H.push(parseInt(V.slice(1),10));else throw new Error("only removal or move can be applied at original array indices,"+(" invalid diff type: "+K[V][2]));else K[V].length===1?ee.push({index:parseInt(V,10),value:K[V][0]}):de.push({index:parseInt(V,10),delta:K[V]});for(H=H.sort(D.numerically),V=H.length-1;V>=0;V--){U=H[V];var Ie=K["_"+U],ve=F.splice(U,1)[0];Ie[2]===Ce&&ee.push({index:Ie[1],value:ve})}ee=ee.sort(D.numericallyBy("index"));var ke=ee.length;for(V=0;V<ke;V++){var Ue=ee[V];F.splice(Ue.index,0,Ue.value)}var qe=de.length,nt=void 0;if(qe>0)for(V=0;V<qe;V++){var ot=de[V];nt=new S(_.left[ot.index],ot.delta),_.push(nt,ot.index)}if(!_.children){_.setResult(_.left).exit();return}_.exit()}};P.filterName="arrays";var Q=function(_){if(!(!_||!_.children)&&_.delta._t==="a"){for(var V=_.children.length,U=void 0,K=0;K<V;K++)U=_.children[K],_.left[U.childName]=U.result;_.setResult(_.left).exit()}};Q.filterName="arraysCollectChildren";var pe=function(_){if(!_.nested){_.delta[2]===Ce&&(_.newName="_"+_.delta[1],_.setResult([_.delta[0],parseInt(_.childName.substr(1),10),Ce]).exit());return}if(_.delta._t==="a"){var V=void 0,U=void 0;for(V in _.delta)V!=="_t"&&(U=new w(_.delta[V]),_.push(U,V));_.exit()}};pe.filterName="arrays";var Ee=function(_,V,U){if(typeof V=="string"&&V[0]==="_")return parseInt(V.substr(1),10);if(he(U)&&U[2]===0)return"_"+V;var K=+V;for(var F in _){var H=_[F];if(he(H))if(H[2]===Ce){var ee=parseInt(F.substr(1),10),de=H[1];if(de===+V)return ee;ee<=K&&de>K?K++:ee>=K&&de<K&&K--}else if(H[2]===0){var Ie=parseInt(F.substr(1),10);Ie<=K&&K++}else H.length===1&&F<=K&&K--}return K};function L(Re){if(!(!Re||!Re.children)&&Re.delta._t==="a"){for(var _=Re.children.length,V=void 0,U={_t:"a"},K=0;K<_;K++){V=Re.children[K];var F=V.newName;typeof F>"u"&&(F=Ee(Re.delta,V.childName,V.result)),U[F]!==V.result&&(U[F]=V.result)}Re.setResult(U).exit()}}L.filterName="arraysCollectChildren";var q=function(_){_.left instanceof Date?(_.right instanceof Date?_.left.getTime()!==_.right.getTime()?_.setResult([_.left,_.right]):_.setResult(void 0):_.setResult([_.left,_.right]),_.exit()):_.right instanceof Date&&_.setResult([_.left,_.right]).exit()};q.filterName="dates";function Z(Re,_){return _={exports:{}},Re(_,_.exports),_.exports}var se=Z(function(Re){function _(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var V=-1,U=1,K=0;_.prototype.diff_main=function(F,H,ee,de){typeof de>"u"&&(this.Diff_Timeout<=0?de=Number.MAX_VALUE:de=new Date().getTime()+this.Diff_Timeout*1e3);var Ie=de;if(F==null||H==null)throw new Error("Null input. (diff_main)");if(F==H)return F?[[K,F]]:[];typeof ee>"u"&&(ee=!0);var ve=ee,ke=this.diff_commonPrefix(F,H),Ue=F.substring(0,ke);F=F.substring(ke),H=H.substring(ke),ke=this.diff_commonSuffix(F,H);var qe=F.substring(F.length-ke);F=F.substring(0,F.length-ke),H=H.substring(0,H.length-ke);var nt=this.diff_compute_(F,H,ve,Ie);return Ue&&nt.unshift([K,Ue]),qe&&nt.push([K,qe]),this.diff_cleanupMerge(nt),nt},_.prototype.diff_compute_=function(F,H,ee,de){var Ie;if(!F)return[[U,H]];if(!H)return[[V,F]];var ve=F.length>H.length?F:H,ke=F.length>H.length?H:F,Ue=ve.indexOf(ke);if(Ue!=-1)return Ie=[[U,ve.substring(0,Ue)],[K,ke],[U,ve.substring(Ue+ke.length)]],F.length>H.length&&(Ie[0][0]=Ie[2][0]=V),Ie;if(ke.length==1)return[[V,F],[U,H]];var qe=this.diff_halfMatch_(F,H);if(qe){var nt=qe[0],ot=qe[1],mt=qe[2],At=qe[3],Pt=qe[4],qt=this.diff_main(nt,mt,ee,de),on=this.diff_main(ot,At,ee,de);return qt.concat([[K,Pt]],on)}return ee&&F.length>100&&H.length>100?this.diff_lineMode_(F,H,de):this.diff_bisect_(F,H,de)},_.prototype.diff_lineMode_=function(F,H,ee){var de=this.diff_linesToChars_(F,H);F=de.chars1,H=de.chars2;var Ie=de.lineArray,ve=this.diff_main(F,H,!1,ee);this.diff_charsToLines_(ve,Ie),this.diff_cleanupSemantic(ve),ve.push([K,""]);for(var ke=0,Ue=0,qe=0,nt="",ot="";ke<ve.length;){switch(ve[ke][0]){case U:qe++,ot+=ve[ke][1];break;case V:Ue++,nt+=ve[ke][1];break;case K:if(Ue>=1&&qe>=1){ve.splice(ke-Ue-qe,Ue+qe),ke=ke-Ue-qe;for(var de=this.diff_main(nt,ot,!1,ee),mt=de.length-1;mt>=0;mt--)ve.splice(ke,0,de[mt]);ke=ke+de.length}qe=0,Ue=0,nt="",ot="";break}ke++}return ve.pop(),ve},_.prototype.diff_bisect_=function(F,H,ee){for(var de=F.length,Ie=H.length,ve=Math.ceil((de+Ie)/2),ke=ve,Ue=2*ve,qe=new Array(Ue),nt=new Array(Ue),ot=0;ot<Ue;ot++)qe[ot]=-1,nt[ot]=-1;qe[ke+1]=0,nt[ke+1]=0;for(var mt=de-Ie,At=mt%2!=0,Pt=0,qt=0,on=0,Sn=0,jt=0;jt<ve&&!(new Date().getTime()>ee);jt++){for(var gn=-jt+Pt;gn<=jt-qt;gn+=2){var On=ke+gn,Pn;gn==-jt||gn!=jt&&qe[On-1]<qe[On+1]?Pn=qe[On+1]:Pn=qe[On-1]+1;for(var Nr=Pn-gn;Pn<de&&Nr<Ie&&F.charAt(Pn)==H.charAt(Nr);)Pn++,Nr++;if(qe[On]=Pn,Pn>de)qt+=2;else if(Nr>Ie)Pt+=2;else if(At){var Qn=ke+mt-gn;if(Qn>=0&&Qn<Ue&&nt[Qn]!=-1){var Wn=de-nt[Qn];if(Pn>=Wn)return this.diff_bisectSplit_(F,H,Pn,Nr,ee)}}}for(var Vr=-jt+on;Vr<=jt-Sn;Vr+=2){var Qn=ke+Vr,Wn;Vr==-jt||Vr!=jt&&nt[Qn-1]<nt[Qn+1]?Wn=nt[Qn+1]:Wn=nt[Qn-1]+1;for(var ki=Wn-Vr;Wn<de&&ki<Ie&&F.charAt(de-Wn-1)==H.charAt(Ie-ki-1);)Wn++,ki++;if(nt[Qn]=Wn,Wn>de)Sn+=2;else if(ki>Ie)on+=2;else if(!At){var On=ke+mt-Vr;if(On>=0&&On<Ue&&qe[On]!=-1){var Pn=qe[On],Nr=ke+Pn-On;if(Wn=de-Wn,Pn>=Wn)return this.diff_bisectSplit_(F,H,Pn,Nr,ee)}}}}return[[V,F],[U,H]]},_.prototype.diff_bisectSplit_=function(F,H,ee,de,Ie){var ve=F.substring(0,ee),ke=H.substring(0,de),Ue=F.substring(ee),qe=H.substring(de),nt=this.diff_main(ve,ke,!1,Ie),ot=this.diff_main(Ue,qe,!1,Ie);return nt.concat(ot)},_.prototype.diff_linesToChars_=function(F,H){var ee=[],de={};ee[0]="";function Ie(Ue){for(var qe="",nt=0,ot=-1,mt=ee.length;ot<Ue.length-1;){ot=Ue.indexOf(`
`,nt),ot==-1&&(ot=Ue.length-1);var At=Ue.substring(nt,ot+1);nt=ot+1,(de.hasOwnProperty?de.hasOwnProperty(At):de[At]!==void 0)?qe+=String.fromCharCode(de[At]):(qe+=String.fromCharCode(mt),de[At]=mt,ee[mt++]=At)}return qe}var ve=Ie(F),ke=Ie(H);return{chars1:ve,chars2:ke,lineArray:ee}},_.prototype.diff_charsToLines_=function(F,H){for(var ee=0;ee<F.length;ee++){for(var de=F[ee][1],Ie=[],ve=0;ve<de.length;ve++)Ie[ve]=H[de.charCodeAt(ve)];F[ee][1]=Ie.join("")}},_.prototype.diff_commonPrefix=function(F,H){if(!F||!H||F.charAt(0)!=H.charAt(0))return 0;for(var ee=0,de=Math.min(F.length,H.length),Ie=de,ve=0;ee<Ie;)F.substring(ve,Ie)==H.substring(ve,Ie)?(ee=Ie,ve=ee):de=Ie,Ie=Math.floor((de-ee)/2+ee);return Ie},_.prototype.diff_commonSuffix=function(F,H){if(!F||!H||F.charAt(F.length-1)!=H.charAt(H.length-1))return 0;for(var ee=0,de=Math.min(F.length,H.length),Ie=de,ve=0;ee<Ie;)F.substring(F.length-Ie,F.length-ve)==H.substring(H.length-Ie,H.length-ve)?(ee=Ie,ve=ee):de=Ie,Ie=Math.floor((de-ee)/2+ee);return Ie},_.prototype.diff_commonOverlap_=function(F,H){var ee=F.length,de=H.length;if(ee==0||de==0)return 0;ee>de?F=F.substring(ee-de):ee<de&&(H=H.substring(0,ee));var Ie=Math.min(ee,de);if(F==H)return Ie;for(var ve=0,ke=1;;){var Ue=F.substring(Ie-ke),qe=H.indexOf(Ue);if(qe==-1)return ve;ke+=qe,(qe==0||F.substring(Ie-ke)==H.substring(0,ke))&&(ve=ke,ke++)}},_.prototype.diff_halfMatch_=function(F,H){if(this.Diff_Timeout<=0)return null;var ee=F.length>H.length?F:H,de=F.length>H.length?H:F;if(ee.length<4||de.length*2<ee.length)return null;var Ie=this;function ve(qt,on,Sn){for(var jt=qt.substring(Sn,Sn+Math.floor(qt.length/4)),gn=-1,On="",Pn,Nr,Qn,Wn;(gn=on.indexOf(jt,gn+1))!=-1;){var Vr=Ie.diff_commonPrefix(qt.substring(Sn),on.substring(gn)),ki=Ie.diff_commonSuffix(qt.substring(0,Sn),on.substring(0,gn));On.length<ki+Vr&&(On=on.substring(gn-ki,gn)+on.substring(gn,gn+Vr),Pn=qt.substring(0,Sn-ki),Nr=qt.substring(Sn+Vr),Qn=on.substring(0,gn-ki),Wn=on.substring(gn+Vr))}return On.length*2>=qt.length?[Pn,Nr,Qn,Wn,On]:null}var ke=ve(ee,de,Math.ceil(ee.length/4)),Ue=ve(ee,de,Math.ceil(ee.length/2)),qe;if(!ke&&!Ue)return null;Ue?ke?qe=ke[4].length>Ue[4].length?ke:Ue:qe=Ue:qe=ke;var nt,ot,mt,At;F.length>H.length?(nt=qe[0],ot=qe[1],mt=qe[2],At=qe[3]):(mt=qe[0],At=qe[1],nt=qe[2],ot=qe[3]);var Pt=qe[4];return[nt,ot,mt,At,Pt]},_.prototype.diff_cleanupSemantic=function(F){for(var H=!1,ee=[],de=0,Ie=null,ve=0,ke=0,Ue=0,qe=0,nt=0;ve<F.length;)F[ve][0]==K?(ee[de++]=ve,ke=qe,Ue=nt,qe=0,nt=0,Ie=F[ve][1]):(F[ve][0]==U?qe+=F[ve][1].length:nt+=F[ve][1].length,Ie&&Ie.length<=Math.max(ke,Ue)&&Ie.length<=Math.max(qe,nt)&&(F.splice(ee[de-1],0,[V,Ie]),F[ee[de-1]+1][0]=U,de--,de--,ve=de>0?ee[de-1]:-1,ke=0,Ue=0,qe=0,nt=0,Ie=null,H=!0)),ve++;for(H&&this.diff_cleanupMerge(F),this.diff_cleanupSemanticLossless(F),ve=1;ve<F.length;){if(F[ve-1][0]==V&&F[ve][0]==U){var ot=F[ve-1][1],mt=F[ve][1],At=this.diff_commonOverlap_(ot,mt),Pt=this.diff_commonOverlap_(mt,ot);At>=Pt?(At>=ot.length/2||At>=mt.length/2)&&(F.splice(ve,0,[K,mt.substring(0,At)]),F[ve-1][1]=ot.substring(0,ot.length-At),F[ve+1][1]=mt.substring(At),ve++):(Pt>=ot.length/2||Pt>=mt.length/2)&&(F.splice(ve,0,[K,ot.substring(0,Pt)]),F[ve-1][0]=U,F[ve-1][1]=mt.substring(0,mt.length-Pt),F[ve+1][0]=V,F[ve+1][1]=ot.substring(Pt),ve++),ve++}ve++}},_.prototype.diff_cleanupSemanticLossless=function(F){function H(Pt,qt){if(!Pt||!qt)return 6;var on=Pt.charAt(Pt.length-1),Sn=qt.charAt(0),jt=on.match(_.nonAlphaNumericRegex_),gn=Sn.match(_.nonAlphaNumericRegex_),On=jt&&on.match(_.whitespaceRegex_),Pn=gn&&Sn.match(_.whitespaceRegex_),Nr=On&&on.match(_.linebreakRegex_),Qn=Pn&&Sn.match(_.linebreakRegex_),Wn=Nr&&Pt.match(_.blanklineEndRegex_),Vr=Qn&&qt.match(_.blanklineStartRegex_);return Wn||Vr?5:Nr||Qn?4:jt&&!On&&Pn?3:On||Pn?2:jt||gn?1:0}for(var ee=1;ee<F.length-1;){if(F[ee-1][0]==K&&F[ee+1][0]==K){var de=F[ee-1][1],Ie=F[ee][1],ve=F[ee+1][1],ke=this.diff_commonSuffix(de,Ie);if(ke){var Ue=Ie.substring(Ie.length-ke);de=de.substring(0,de.length-ke),Ie=Ue+Ie.substring(0,Ie.length-ke),ve=Ue+ve}for(var qe=de,nt=Ie,ot=ve,mt=H(de,Ie)+H(Ie,ve);Ie.charAt(0)===ve.charAt(0);){de+=Ie.charAt(0),Ie=Ie.substring(1)+ve.charAt(0),ve=ve.substring(1);var At=H(de,Ie)+H(Ie,ve);At>=mt&&(mt=At,qe=de,nt=Ie,ot=ve)}F[ee-1][1]!=qe&&(qe?F[ee-1][1]=qe:(F.splice(ee-1,1),ee--),F[ee][1]=nt,ot?F[ee+1][1]=ot:(F.splice(ee+1,1),ee--))}ee++}},_.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,_.whitespaceRegex_=/\s/,_.linebreakRegex_=/[\r\n]/,_.blanklineEndRegex_=/\n\r?\n$/,_.blanklineStartRegex_=/^\r?\n\r?\n/,_.prototype.diff_cleanupEfficiency=function(F){for(var H=!1,ee=[],de=0,Ie=null,ve=0,ke=!1,Ue=!1,qe=!1,nt=!1;ve<F.length;)F[ve][0]==K?(F[ve][1].length<this.Diff_EditCost&&(qe||nt)?(ee[de++]=ve,ke=qe,Ue=nt,Ie=F[ve][1]):(de=0,Ie=null),qe=nt=!1):(F[ve][0]==V?nt=!0:qe=!0,Ie&&(ke&&Ue&&qe&&nt||Ie.length<this.Diff_EditCost/2&&ke+Ue+qe+nt==3)&&(F.splice(ee[de-1],0,[V,Ie]),F[ee[de-1]+1][0]=U,de--,Ie=null,ke&&Ue?(qe=nt=!0,de=0):(de--,ve=de>0?ee[de-1]:-1,qe=nt=!1),H=!0)),ve++;H&&this.diff_cleanupMerge(F)},_.prototype.diff_cleanupMerge=function(F){F.push([K,""]);for(var H=0,ee=0,de=0,Ie="",ve="",ke;H<F.length;)switch(F[H][0]){case U:de++,ve+=F[H][1],H++;break;case V:ee++,Ie+=F[H][1],H++;break;case K:ee+de>1?(ee!==0&&de!==0&&(ke=this.diff_commonPrefix(ve,Ie),ke!==0&&(H-ee-de>0&&F[H-ee-de-1][0]==K?F[H-ee-de-1][1]+=ve.substring(0,ke):(F.splice(0,0,[K,ve.substring(0,ke)]),H++),ve=ve.substring(ke),Ie=Ie.substring(ke)),ke=this.diff_commonSuffix(ve,Ie),ke!==0&&(F[H][1]=ve.substring(ve.length-ke)+F[H][1],ve=ve.substring(0,ve.length-ke),Ie=Ie.substring(0,Ie.length-ke))),ee===0?F.splice(H-de,ee+de,[U,ve]):de===0?F.splice(H-ee,ee+de,[V,Ie]):F.splice(H-ee-de,ee+de,[V,Ie],[U,ve]),H=H-ee-de+(ee?1:0)+(de?1:0)+1):H!==0&&F[H-1][0]==K?(F[H-1][1]+=F[H][1],F.splice(H,1)):H++,de=0,ee=0,Ie="",ve="";break}F[F.length-1][1]===""&&F.pop();var Ue=!1;for(H=1;H<F.length-1;)F[H-1][0]==K&&F[H+1][0]==K&&(F[H][1].substring(F[H][1].length-F[H-1][1].length)==F[H-1][1]?(F[H][1]=F[H-1][1]+F[H][1].substring(0,F[H][1].length-F[H-1][1].length),F[H+1][1]=F[H-1][1]+F[H+1][1],F.splice(H-1,1),Ue=!0):F[H][1].substring(0,F[H+1][1].length)==F[H+1][1]&&(F[H-1][1]+=F[H+1][1],F[H][1]=F[H][1].substring(F[H+1][1].length)+F[H+1][1],F.splice(H+1,1),Ue=!0)),H++;Ue&&this.diff_cleanupMerge(F)},_.prototype.diff_xIndex=function(F,H){var ee=0,de=0,Ie=0,ve=0,ke;for(ke=0;ke<F.length&&(F[ke][0]!==U&&(ee+=F[ke][1].length),F[ke][0]!==V&&(de+=F[ke][1].length),!(ee>H));ke++)Ie=ee,ve=de;return F.length!=ke&&F[ke][0]===V?ve:ve+(H-Ie)},_.prototype.diff_prettyHtml=function(F){for(var H=[],ee=/&/g,de=/</g,Ie=/>/g,ve=/\n/g,ke=0;ke<F.length;ke++){var Ue=F[ke][0],qe=F[ke][1],nt=qe.replace(ee,"&amp;").replace(de,"&lt;").replace(Ie,"&gt;").replace(ve,"&para;<br>");switch(Ue){case U:H[ke]='<ins style="background:#e6ffe6;">'+nt+"</ins>";break;case V:H[ke]='<del style="background:#ffe6e6;">'+nt+"</del>";break;case K:H[ke]="<span>"+nt+"</span>";break}}return H.join("")},_.prototype.diff_text1=function(F){for(var H=[],ee=0;ee<F.length;ee++)F[ee][0]!==U&&(H[ee]=F[ee][1]);return H.join("")},_.prototype.diff_text2=function(F){for(var H=[],ee=0;ee<F.length;ee++)F[ee][0]!==V&&(H[ee]=F[ee][1]);return H.join("")},_.prototype.diff_levenshtein=function(F){for(var H=0,ee=0,de=0,Ie=0;Ie<F.length;Ie++){var ve=F[Ie][0],ke=F[Ie][1];switch(ve){case U:ee+=ke.length;break;case V:de+=ke.length;break;case K:H+=Math.max(ee,de),ee=0,de=0;break}}return H+=Math.max(ee,de),H},_.prototype.diff_toDelta=function(F){for(var H=[],ee=0;ee<F.length;ee++)switch(F[ee][0]){case U:H[ee]="+"+encodeURI(F[ee][1]);break;case V:H[ee]="-"+F[ee][1].length;break;case K:H[ee]="="+F[ee][1].length;break}return H.join("	").replace(/%20/g," ")},_.prototype.diff_fromDelta=function(F,H){for(var ee=[],de=0,Ie=0,ve=H.split(/\t/g),ke=0;ke<ve.length;ke++){var Ue=ve[ke].substring(1);switch(ve[ke].charAt(0)){case"+":try{ee[de++]=[U,decodeURI(Ue)]}catch{throw new Error("Illegal escape in diff_fromDelta: "+Ue)}break;case"-":case"=":var qe=parseInt(Ue,10);if(isNaN(qe)||qe<0)throw new Error("Invalid number in diff_fromDelta: "+Ue);var nt=F.substring(Ie,Ie+=qe);ve[ke].charAt(0)=="="?ee[de++]=[K,nt]:ee[de++]=[V,nt];break;default:if(ve[ke])throw new Error("Invalid diff operation in diff_fromDelta: "+ve[ke])}}if(Ie!=F.length)throw new Error("Delta length ("+Ie+") does not equal source text length ("+F.length+").");return ee},_.prototype.match_main=function(F,H,ee){if(F==null||H==null||ee==null)throw new Error("Null input. (match_main)");return ee=Math.max(0,Math.min(ee,F.length)),F==H?0:F.length?F.substring(ee,ee+H.length)==H?ee:this.match_bitap_(F,H,ee):-1},_.prototype.match_bitap_=function(F,H,ee){if(H.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var de=this.match_alphabet_(H),Ie=this;function ve(Pn,Nr){var Qn=Pn/H.length,Wn=Math.abs(ee-Nr);return Ie.Match_Distance?Qn+Wn/Ie.Match_Distance:Wn?1:Qn}var ke=this.Match_Threshold,Ue=F.indexOf(H,ee);Ue!=-1&&(ke=Math.min(ve(0,Ue),ke),Ue=F.lastIndexOf(H,ee+H.length),Ue!=-1&&(ke=Math.min(ve(0,Ue),ke)));var qe=1<<H.length-1;Ue=-1;for(var nt,ot,mt=H.length+F.length,At,Pt=0;Pt<H.length;Pt++){for(nt=0,ot=mt;nt<ot;)ve(Pt,ee+ot)<=ke?nt=ot:mt=ot,ot=Math.floor((mt-nt)/2+nt);mt=ot;var qt=Math.max(1,ee-ot+1),on=Math.min(ee+ot,F.length)+H.length,Sn=Array(on+2);Sn[on+1]=(1<<Pt)-1;for(var jt=on;jt>=qt;jt--){var gn=de[F.charAt(jt-1)];if(Pt===0?Sn[jt]=(Sn[jt+1]<<1|1)&gn:Sn[jt]=(Sn[jt+1]<<1|1)&gn|((At[jt+1]|At[jt])<<1|1)|At[jt+1],Sn[jt]&qe){var On=ve(Pt,jt-1);if(On<=ke)if(ke=On,Ue=jt-1,Ue>ee)qt=Math.max(1,2*ee-Ue);else break}}if(ve(Pt+1,ee)>ke)break;At=Sn}return Ue},_.prototype.match_alphabet_=function(F){for(var H={},ee=0;ee<F.length;ee++)H[F.charAt(ee)]=0;for(var ee=0;ee<F.length;ee++)H[F.charAt(ee)]|=1<<F.length-ee-1;return H},_.prototype.patch_addContext_=function(F,H){if(H.length!=0){for(var ee=H.substring(F.start2,F.start2+F.length1),de=0;H.indexOf(ee)!=H.lastIndexOf(ee)&&ee.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)de+=this.Patch_Margin,ee=H.substring(F.start2-de,F.start2+F.length1+de);de+=this.Patch_Margin;var Ie=H.substring(F.start2-de,F.start2);Ie&&F.diffs.unshift([K,Ie]);var ve=H.substring(F.start2+F.length1,F.start2+F.length1+de);ve&&F.diffs.push([K,ve]),F.start1-=Ie.length,F.start2-=Ie.length,F.length1+=Ie.length+ve.length,F.length2+=Ie.length+ve.length}},_.prototype.patch_make=function(F,H,ee){var de,Ie;if(typeof F=="string"&&typeof H=="string"&&typeof ee>"u")de=F,Ie=this.diff_main(de,H,!0),Ie.length>2&&(this.diff_cleanupSemantic(Ie),this.diff_cleanupEfficiency(Ie));else if(F&&typeof F=="object"&&typeof H>"u"&&typeof ee>"u")Ie=F,de=this.diff_text1(Ie);else if(typeof F=="string"&&H&&typeof H=="object"&&typeof ee>"u")de=F,Ie=H;else if(typeof F=="string"&&typeof H=="string"&&ee&&typeof ee=="object")de=F,Ie=ee;else throw new Error("Unknown call format to patch_make.");if(Ie.length===0)return[];for(var ve=[],ke=new _.patch_obj,Ue=0,qe=0,nt=0,ot=de,mt=de,At=0;At<Ie.length;At++){var Pt=Ie[At][0],qt=Ie[At][1];switch(!Ue&&Pt!==K&&(ke.start1=qe,ke.start2=nt),Pt){case U:ke.diffs[Ue++]=Ie[At],ke.length2+=qt.length,mt=mt.substring(0,nt)+qt+mt.substring(nt);break;case V:ke.length1+=qt.length,ke.diffs[Ue++]=Ie[At],mt=mt.substring(0,nt)+mt.substring(nt+qt.length);break;case K:qt.length<=2*this.Patch_Margin&&Ue&&Ie.length!=At+1?(ke.diffs[Ue++]=Ie[At],ke.length1+=qt.length,ke.length2+=qt.length):qt.length>=2*this.Patch_Margin&&Ue&&(this.patch_addContext_(ke,ot),ve.push(ke),ke=new _.patch_obj,Ue=0,ot=mt,qe=nt);break}Pt!==U&&(qe+=qt.length),Pt!==V&&(nt+=qt.length)}return Ue&&(this.patch_addContext_(ke,ot),ve.push(ke)),ve},_.prototype.patch_deepCopy=function(F){for(var H=[],ee=0;ee<F.length;ee++){var de=F[ee],Ie=new _.patch_obj;Ie.diffs=[];for(var ve=0;ve<de.diffs.length;ve++)Ie.diffs[ve]=de.diffs[ve].slice();Ie.start1=de.start1,Ie.start2=de.start2,Ie.length1=de.length1,Ie.length2=de.length2,H[ee]=Ie}return H},_.prototype.patch_apply=function(F,H){if(F.length==0)return[H,[]];F=this.patch_deepCopy(F);var ee=this.patch_addPadding(F);H=ee+H+ee,this.patch_splitMax(F);for(var de=0,Ie=[],ve=0;ve<F.length;ve++){var ke=F[ve].start2+de,Ue=this.diff_text1(F[ve].diffs),qe,nt=-1;if(Ue.length>this.Match_MaxBits?(qe=this.match_main(H,Ue.substring(0,this.Match_MaxBits),ke),qe!=-1&&(nt=this.match_main(H,Ue.substring(Ue.length-this.Match_MaxBits),ke+Ue.length-this.Match_MaxBits),(nt==-1||qe>=nt)&&(qe=-1))):qe=this.match_main(H,Ue,ke),qe==-1)Ie[ve]=!1,de-=F[ve].length2-F[ve].length1;else{Ie[ve]=!0,de=qe-ke;var ot;if(nt==-1?ot=H.substring(qe,qe+Ue.length):ot=H.substring(qe,nt+this.Match_MaxBits),Ue==ot)H=H.substring(0,qe)+this.diff_text2(F[ve].diffs)+H.substring(qe+Ue.length);else{var mt=this.diff_main(Ue,ot,!1);if(Ue.length>this.Match_MaxBits&&this.diff_levenshtein(mt)/Ue.length>this.Patch_DeleteThreshold)Ie[ve]=!1;else{this.diff_cleanupSemanticLossless(mt);for(var At=0,Pt,qt=0;qt<F[ve].diffs.length;qt++){var on=F[ve].diffs[qt];on[0]!==K&&(Pt=this.diff_xIndex(mt,At)),on[0]===U?H=H.substring(0,qe+Pt)+on[1]+H.substring(qe+Pt):on[0]===V&&(H=H.substring(0,qe+Pt)+H.substring(qe+this.diff_xIndex(mt,At+on[1].length))),on[0]!==V&&(At+=on[1].length)}}}}}return H=H.substring(ee.length,H.length-ee.length),[H,Ie]},_.prototype.patch_addPadding=function(F){for(var H=this.Patch_Margin,ee="",de=1;de<=H;de++)ee+=String.fromCharCode(de);for(var de=0;de<F.length;de++)F[de].start1+=H,F[de].start2+=H;var Ie=F[0],ve=Ie.diffs;if(ve.length==0||ve[0][0]!=K)ve.unshift([K,ee]),Ie.start1-=H,Ie.start2-=H,Ie.length1+=H,Ie.length2+=H;else if(H>ve[0][1].length){var ke=H-ve[0][1].length;ve[0][1]=ee.substring(ve[0][1].length)+ve[0][1],Ie.start1-=ke,Ie.start2-=ke,Ie.length1+=ke,Ie.length2+=ke}if(Ie=F[F.length-1],ve=Ie.diffs,ve.length==0||ve[ve.length-1][0]!=K)ve.push([K,ee]),Ie.length1+=H,Ie.length2+=H;else if(H>ve[ve.length-1][1].length){var ke=H-ve[ve.length-1][1].length;ve[ve.length-1][1]+=ee.substring(0,ke),Ie.length1+=ke,Ie.length2+=ke}return ee},_.prototype.patch_splitMax=function(F){for(var H=this.Match_MaxBits,ee=0;ee<F.length;ee++)if(!(F[ee].length1<=H)){var de=F[ee];F.splice(ee--,1);for(var Ie=de.start1,ve=de.start2,ke="";de.diffs.length!==0;){var Ue=new _.patch_obj,qe=!0;for(Ue.start1=Ie-ke.length,Ue.start2=ve-ke.length,ke!==""&&(Ue.length1=Ue.length2=ke.length,Ue.diffs.push([K,ke]));de.diffs.length!==0&&Ue.length1<H-this.Patch_Margin;){var nt=de.diffs[0][0],ot=de.diffs[0][1];nt===U?(Ue.length2+=ot.length,ve+=ot.length,Ue.diffs.push(de.diffs.shift()),qe=!1):nt===V&&Ue.diffs.length==1&&Ue.diffs[0][0]==K&&ot.length>2*H?(Ue.length1+=ot.length,Ie+=ot.length,qe=!1,Ue.diffs.push([nt,ot]),de.diffs.shift()):(ot=ot.substring(0,H-Ue.length1-this.Patch_Margin),Ue.length1+=ot.length,Ie+=ot.length,nt===K?(Ue.length2+=ot.length,ve+=ot.length):qe=!1,Ue.diffs.push([nt,ot]),ot==de.diffs[0][1]?de.diffs.shift():de.diffs[0][1]=de.diffs[0][1].substring(ot.length))}ke=this.diff_text2(Ue.diffs),ke=ke.substring(ke.length-this.Patch_Margin);var mt=this.diff_text1(de.diffs).substring(0,this.Patch_Margin);mt!==""&&(Ue.length1+=mt.length,Ue.length2+=mt.length,Ue.diffs.length!==0&&Ue.diffs[Ue.diffs.length-1][0]===K?Ue.diffs[Ue.diffs.length-1][1]+=mt:Ue.diffs.push([K,mt])),qe||F.splice(++ee,0,Ue)}}},_.prototype.patch_toText=function(F){for(var H=[],ee=0;ee<F.length;ee++)H[ee]=F[ee];return H.join("")},_.prototype.patch_fromText=function(F){var H=[];if(!F)return H;for(var ee=F.split(`
`),de=0,Ie=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;de<ee.length;){var ve=ee[de].match(Ie);if(!ve)throw new Error("Invalid patch string: "+ee[de]);var ke=new _.patch_obj;for(H.push(ke),ke.start1=parseInt(ve[1],10),ve[2]===""?(ke.start1--,ke.length1=1):ve[2]=="0"?ke.length1=0:(ke.start1--,ke.length1=parseInt(ve[2],10)),ke.start2=parseInt(ve[3],10),ve[4]===""?(ke.start2--,ke.length2=1):ve[4]=="0"?ke.length2=0:(ke.start2--,ke.length2=parseInt(ve[4],10)),de++;de<ee.length;){var Ue=ee[de].charAt(0);try{var qe=decodeURI(ee[de].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+qe)}if(Ue=="-")ke.diffs.push([V,qe]);else if(Ue=="+")ke.diffs.push([U,qe]);else if(Ue==" ")ke.diffs.push([K,qe]);else{if(Ue=="@")break;if(Ue!=="")throw new Error('Invalid patch mode "'+Ue+'" in: '+qe)}de++}}return H},_.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},_.patch_obj.prototype.toString=function(){var F,H;this.length1===0?F=this.start1+",0":this.length1==1?F=this.start1+1:F=this.start1+1+","+this.length1,this.length2===0?H=this.start2+",0":this.length2==1?H=this.start2+1:H=this.start2+1+","+this.length2;for(var ee=["@@ -"+F+" +"+H+` @@
`],de,Ie=0;Ie<this.diffs.length;Ie++){switch(this.diffs[Ie][0]){case U:de="+";break;case V:de="-";break;case K:de=" ";break}ee[Ie+1]=de+encodeURI(this.diffs[Ie][1])+`
`}return ee.join("").replace(/%20/g," ")},Re.exports=_,Re.exports.diff_match_patch=_,Re.exports.DIFF_DELETE=V,Re.exports.DIFF_INSERT=U,Re.exports.DIFF_EQUAL=K}),ie=2,B=60,R=null,k=function(_){if(!R){var V=void 0;if(typeof diff_match_patch<"u")V=typeof diff_match_patch=="function"?new diff_match_patch:new diff_match_patch.diff_match_patch;else if(se)try{V=se&&new se}catch{V=null}if(!V){if(!_)return null;var U=new Error("text diff_match_patch library not found");throw U.diff_match_patch_not_found=!0,U}R={diff:function(F,H){return V.patch_toText(V.patch_make(F,H))},patch:function(F,H){for(var ee=V.patch_apply(V.patch_fromText(H),F),de=0;de<ee[1].length;de++)if(!ee[1][de]){var Ie=new Error("text patch failed");Ie.textPatchFailed=!0}return ee[0]}}}return R},X=function(_){if(_.leftType==="string"){var V=_.options&&_.options.textDiff&&_.options.textDiff.minLength||B;if(_.left.length<V||_.right.length<V){_.setResult([_.left,_.right]).exit();return}var U=k();if(!U){_.setResult([_.left,_.right]).exit();return}var K=U.diff;_.setResult([K(_.left,_.right),0,ie]).exit()}};X.filterName="texts";var fe=function(_){if(!_.nested&&_.delta[2]===ie){var V=k(!0).patch;_.setResult(V(_.left,_.delta[0])).exit()}};fe.filterName="texts";var Te=function(_){var V=void 0,U=void 0,K=void 0,F=void 0,H=void 0,ee=null,de=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,Ie=void 0;for(K=_.split(`
`),V=0,U=K.length;V<U;V++){F=K[V];var ve=F.slice(0,1);ve==="@"?(ee=de.exec(F),Ie=V,K[Ie]="@@ -"+ee[3]+","+ee[4]+" +"+ee[1]+","+ee[2]+" @@"):ve==="+"?(K[V]="-"+K[V].slice(1),K[V-1].slice(0,1)==="+"&&(H=K[V],K[V]=K[V-1],K[V-1]=H)):ve==="-"&&(K[V]="+"+K[V].slice(1))}return K.join(`
`)},Be=function(_){_.nested||_.delta[2]===ie&&_.setResult([Te(_.delta[0]),0,ie]).exit()};Be.filterName="texts";var He=function(){function Re(_){i(this,Re),this.processor=new d(_),this.processor.pipe(new p("diff").append(M,N,q,X,z,J).shouldHaveResult()),this.processor.pipe(new p("patch").append(re,Q,E,fe,Y,P).shouldHaveResult()),this.processor.pipe(new p("reverse").append(le,L,A,Be,ne,pe).shouldHaveResult())}return a(Re,[{key:"options",value:function(){var V;return(V=this.processor).options.apply(V,arguments)}},{key:"diff",value:function(V,U){return this.processor.process(new y(V,U))}},{key:"patch",value:function(V,U){return this.processor.process(new S(V,U))}},{key:"reverse",value:function(V){return this.processor.process(new w(V))}},{key:"unpatch",value:function(V,U){return this.patch(V,this.reverse(U))}},{key:"clone",value:function(V){return b(V)}}]),Re}(),rt=typeof Array.isArray=="function"?Array.isArray:function(Re){return Re instanceof Array},ct=typeof Object.keys=="function"?function(Re){return Object.keys(Re)}:function(Re){var _=[];for(var V in Re)Object.prototype.hasOwnProperty.call(Re,V)&&_.push(V);return _},lt=function(_){return _.substr(0,1)==="_"?_.slice(1):_},W=function(_){return _==="_t"?-1:_.substr(0,1)==="_"?parseInt(_.slice(1),10):parseInt(_,10)+.1},T=function(_,V){return W(_)-W(V)},O=function(){function Re(){i(this,Re)}return a(Re,[{key:"format",value:function(V,U){var K={};return this.prepareContext(K),this.recurse(K,V,U),this.finalize(K)}},{key:"prepareContext",value:function(V){V.buffer=[],V.out=function(){var U;(U=this.buffer).push.apply(U,arguments)}}},{key:"typeFormattterNotFound",value:function(V,U){throw new Error("cannot format delta type: "+U)}},{key:"typeFormattterErrorFormatter",value:function(V,U){return U.toString()}},{key:"finalize",value:function(V){var U=V.buffer;if(rt(U))return U.join("")}},{key:"recurse",value:function(V,U,K,F,H,ee,de){var Ie=U&&ee,ve=Ie?ee.value:K;if(!(typeof U>"u"&&typeof F>"u")){var ke=this.getDeltaType(U,ee),Ue=ke==="node"?U._t==="a"?"array":"object":"";typeof F<"u"?this.nodeBegin(V,F,H,ke,Ue,de):this.rootBegin(V,ke,Ue);var qe=void 0;try{qe=this["format_"+ke]||this.typeFormattterNotFound(V,ke),qe.call(this,V,U,ve,F,H,ee)}catch(nt){this.typeFormattterErrorFormatter(V,nt,U,ve,F,H,ee),typeof console<"u"&&console.error&&console.error(nt.stack)}typeof F<"u"?this.nodeEnd(V,F,H,ke,Ue,de):this.rootEnd(V,ke,Ue)}}},{key:"formatDeltaChildren",value:function(V,U,K){var F=this;this.forEachDeltaKey(U,K,function(H,ee,de,Ie){F.recurse(V,U[H],K?K[ee]:void 0,H,ee,de,Ie)})}},{key:"forEachDeltaKey",value:function(V,U,K){var F=ct(V),H=V._t==="a",ee={},de=void 0;if(typeof U<"u")for(de in U)Object.prototype.hasOwnProperty.call(U,de)&&typeof V[de]>"u"&&(!H||typeof V["_"+de]>"u")&&F.push(de);for(de in V)if(Object.prototype.hasOwnProperty.call(V,de)){var Ie=V[de];rt(Ie)&&Ie[2]===3&&(ee[Ie[1].toString()]={key:de,value:U&&U[parseInt(de.substr(1))]},this.includeMoveDestinations!==!1&&typeof U>"u"&&typeof V[Ie[1]]>"u"&&F.push(Ie[1].toString()))}H?F.sort(T):F.sort();for(var ve=0,ke=F.length;ve<ke;ve++){var Ue=F[ve];if(!(H&&Ue==="_t")){var qe=H?typeof Ue=="number"?Ue:parseInt(lt(Ue),10):Ue,nt=ve===ke-1;K(Ue,qe,ee[qe],nt)}}}},{key:"getDeltaType",value:function(V,U){if(typeof V>"u")return typeof U<"u"?"movedestination":"unchanged";if(rt(V)){if(V.length===1)return"added";if(V.length===2)return"modified";if(V.length===3&&V[2]===0)return"deleted";if(V.length===3&&V[2]===2)return"textdiff";if(V.length===3&&V[2]===3)return"moved"}else if((typeof V>"u"?"undefined":s(V))==="object")return"node";return"unknown"}},{key:"parseTextDiff",value:function(V){for(var U=[],K=V.split(`
@@ `),F=0,H=K.length;F<H;F++){var ee=K[F],de={pieces:[]},Ie=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(ee).slice(1);de.location={line:Ie[0],chr:Ie[1]};for(var ve=ee.split(`
`).slice(1),ke=0,Ue=ve.length;ke<Ue;ke++){var qe=ve[ke];if(qe.length){var nt={type:"context"};qe.substr(0,1)==="+"?nt.type="added":qe.substr(0,1)==="-"&&(nt.type="deleted"),nt.text=qe.slice(1),de.pieces.push(nt)}}U.push(de)}return U}}]),Re}(),ue=Object.freeze({default:O}),Ae=function(Re){c(_,Re);function _(){return i(this,_),l(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return a(_,[{key:"typeFormattterErrorFormatter",value:function(U,K){U.out('<pre class="jsondiffpatch-error">'+K+"</pre>")}},{key:"formatValue",value:function(U,K){U.out("<pre>"+ze(JSON.stringify(K,null,2))+"</pre>")}},{key:"formatTextDiffString",value:function(U,K){var F=this.parseTextDiff(K);U.out('<ul class="jsondiffpatch-textdiff">');for(var H=0,ee=F.length;H<ee;H++){var de=F[H];U.out('<li><div class="jsondiffpatch-textdiff-location">'+('<span class="jsondiffpatch-textdiff-line-number">'+de.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+de.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">'));for(var Ie=de.pieces,ve=0,ke=Ie.length;ve<ke;ve++){var Ue=Ie[ve];U.out('<span class="jsondiffpatch-textdiff-'+Ue.type+'">'+ze(decodeURI(Ue.text))+"</span>")}U.out("</div></li>")}U.out("</ul>")}},{key:"rootBegin",value:function(U,K,F){var H="jsondiffpatch-"+K+(F?" jsondiffpatch-child-node-type-"+F:"");U.out('<div class="jsondiffpatch-delta '+H+'">')}},{key:"rootEnd",value:function(U){U.out("</div>"+(U.hasArrows?'<script type="text/javascript">setTimeout('+(Xe.toString()+",10);<\/script>"):""))}},{key:"nodeBegin",value:function(U,K,F,H,ee){var de="jsondiffpatch-"+H+(ee?" jsondiffpatch-child-node-type-"+ee:"");U.out('<li class="'+de+'" data-key="'+F+'">'+('<div class="jsondiffpatch-property-name">'+F+"</div>"))}},{key:"nodeEnd",value:function(U){U.out("</li>")}},{key:"format_unchanged",value:function(U,K,F){typeof F>"u"||(U.out('<div class="jsondiffpatch-value">'),this.formatValue(U,F),U.out("</div>"))}},{key:"format_movedestination",value:function(U,K,F){typeof F>"u"||(U.out('<div class="jsondiffpatch-value">'),this.formatValue(U,F),U.out("</div>"))}},{key:"format_node",value:function(U,K,F){var H=K._t==="a"?"array":"object";U.out('<ul class="jsondiffpatch-node jsondiffpatch-node-type-'+H+'">'),this.formatDeltaChildren(U,K,F),U.out("</ul>")}},{key:"format_added",value:function(U,K){U.out('<div class="jsondiffpatch-value">'),this.formatValue(U,K[0]),U.out("</div>")}},{key:"format_modified",value:function(U,K){U.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(U,K[0]),U.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(U,K[1]),U.out("</div>")}},{key:"format_deleted",value:function(U,K){U.out('<div class="jsondiffpatch-value">'),this.formatValue(U,K[0]),U.out("</div>")}},{key:"format_moved",value:function(U,K){U.out('<div class="jsondiffpatch-value">'),this.formatValue(U,K[0]),U.out('</div><div class="jsondiffpatch-moved-destination">'+K[1]+"</div>"),U.out(`<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">
          <svg width="30" height="60" style="position: absolute; display: none;">
          <defs>
              <marker id="markerArrow" markerWidth="8" markerHeight="8"
                 refx="2" refy="4"
                     orient="auto" markerUnits="userSpaceOnUse">
                  <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />
              </marker>
          </defs>
          <path d="M30,0 Q-10,25 26,50"
            style="stroke: #88f; stroke-width: 2px; fill: none; stroke-opacity: 0.5; marker-end: url(#markerArrow);"
          ></path>
          </svg>
      </div>`),U.hasArrows=!0}},{key:"format_textdiff",value:function(U,K){U.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(U,K[0]),U.out("</div>")}}]),_}(O);function ze(Re){for(var _=Re,V=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]],U=0;U<V.length;U++)_=_.replace(V[U][0],V[U][1]);return _}var Xe=function(_){var V=_||document,U=function(ee){var de=ee.textContent,Ie=ee.innerText;return de||Ie},K=function(ee,de,Ie){for(var ve=ee.querySelectorAll(de),ke=0,Ue=ve.length;ke<Ue;ke++)Ie(ve[ke])},F=function(ee,de){for(var Ie=ee.children,ve=0,ke=Ie.length;ve<ke;ve++)de(Ie[ve],ve)};K(V,".jsondiffpatch-arrow",function(H){var ee=H.parentNode,de=H.children,Ie=H.style,ve=ee,ke=de[0],Ue=ke.children[1];ke.style.display="none";var qe=U(ve.querySelector(".jsondiffpatch-moved-destination")),nt=ve.parentNode,ot=void 0;if(F(nt,function(Pt){Pt.getAttribute("data-key")===qe&&(ot=Pt)}),!!ot)try{var mt=ot.offsetTop-ve.offsetTop;ke.setAttribute("height",Math.abs(mt)+6),Ie.top=-8+(mt>0?0:mt)+"px";var At=mt>0?"M30,0 Q-10,"+Math.round(mt/2)+" 26,"+(mt-4):"M30,"+-mt+" Q-10,"+Math.round(-mt/2)+" 26,4";Ue.setAttribute("d",At),ke.style.display=""}catch{}})},Ct=function(_,V,U){var K=V||document.body,F="jsondiffpatch-unchanged-",H={showing:F+"showing",hiding:F+"hiding",visible:F+"visible",hidden:F+"hidden"},ee=K.classList;if(ee){if(!U){ee.remove(H.showing),ee.remove(H.hiding),ee.remove(H.visible),ee.remove(H.hidden),_===!1&&ee.add(H.hidden);return}_===!1?(ee.remove(H.showing),ee.add(H.visible),setTimeout(function(){ee.add(H.hiding)},10)):(ee.remove(H.hiding),ee.add(H.showing),ee.remove(H.hidden));var de=setInterval(function(){Xe(K)},100);setTimeout(function(){ee.remove(H.showing),ee.remove(H.hiding),_===!1?(ee.add(H.hidden),ee.remove(H.visible)):(ee.add(H.visible),ee.remove(H.hidden)),setTimeout(function(){ee.remove(H.visible),clearInterval(de)},U+400)},U)}},hn=function(_,V){return Ct(!1,_,V)},en=void 0;function tn(Re,_){return en||(en=new Ae),en.format(Re,_)}var Ht=Object.freeze({showUnchanged:Ct,hideUnchanged:hn,default:Ae,format:tn}),Os=function(Re){c(_,Re);function _(){i(this,_);var V=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return V.includeMoveDestinations=!1,V}return a(_,[{key:"prepareContext",value:function(U){o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"prepareContext",this).call(this,U),U.indent=function(K){this.indentLevel=(this.indentLevel||0)+(typeof K>"u"?1:K),this.indentPad=new Array(this.indentLevel+1).join("&nbsp;&nbsp;")},U.row=function(K,F){U.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),U.out(U.indentPad),U.out('</pre><pre style="display: inline-block">'),U.out(K),U.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),U.out(F),U.out("</div></td></tr>")}}},{key:"typeFormattterErrorFormatter",value:function(U,K){U.row("",'<pre class="jsondiffpatch-error">'+K+"</pre>")}},{key:"formatTextDiffString",value:function(U,K){var F=this.parseTextDiff(K);U.out('<ul class="jsondiffpatch-textdiff">');for(var H=0,ee=F.length;H<ee;H++){var de=F[H];U.out('<li><div class="jsondiffpatch-textdiff-location">'+('<span class="jsondiffpatch-textdiff-line-number">'+de.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+de.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">'));for(var Ie=de.pieces,ve=0,ke=Ie.length;ve<ke;ve++){var Ue=Ie[ve];U.out('<span class="jsondiffpatch-textdiff-'+Ue.type+'">'+Ue.text+"</span>")}U.out("</div></li>")}U.out("</ul>")}},{key:"rootBegin",value:function(U,K,F){U.out('<table class="jsondiffpatch-annotated-delta">'),K==="node"&&(U.row("{"),U.indent()),F==="array"&&U.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"rootEnd",value:function(U,K){K==="node"&&(U.indent(-1),U.row("}")),U.out("</table>")}},{key:"nodeBegin",value:function(U,K,F,H,ee){U.row("&quot;"+K+"&quot;: {"),H==="node"&&U.indent(),ee==="array"&&U.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"nodeEnd",value:function(U,K,F,H,ee,de){H==="node"&&U.indent(-1),U.row("}"+(de?"":","))}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(U,K,F){this.formatDeltaChildren(U,K,F)}}]),_}(O),Ci=function(_){return'<pre style="display:inline-block">&quot;'+_+"&quot;</pre>"},Kc={added:function(_,V,U,K){var F=" <pre>([newValue])</pre>";return typeof K>"u"?"new value"+F:typeof K=="number"?"insert at index "+K+F:"add property "+Ci(K)+F},modified:function(_,V,U,K){var F=" <pre>([previousValue, newValue])</pre>";return typeof K>"u"?"modify value"+F:typeof K=="number"?"modify at index "+K+F:"modify property "+Ci(K)+F},deleted:function(_,V,U,K){var F=" <pre>([previousValue, 0, 0])</pre>";return typeof K>"u"?"delete value"+F:typeof K=="number"?"remove index "+K+F:"delete property "+Ci(K)+F},moved:function(_,V,U,K){return'move from <span title="(position to remove at original state)">'+("index "+K+'</span> to <span title="(position to insert at final')+(' state)">index '+_[1]+"</span>")},textdiff:function(_,V,U,K){var F=typeof K>"u"?"":typeof K=="number"?" at index "+K:" at property "+Ci(K);return"text diff"+F+', format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>'}},ji=function(_,V){var U=this.getDeltaType(V),K=Kc[U],F=K&&K.apply(K,Array.prototype.slice.call(arguments,1)),H=JSON.stringify(V,null,2);U==="textdiff"&&(H=H.split("\\n").join(`\\n"+
   "`)),_.indent(),_.row(H,F),_.indent(-1)};Os.prototype.format_added=ji,Os.prototype.format_modified=ji,Os.prototype.format_deleted=ji,Os.prototype.format_moved=ji,Os.prototype.format_textdiff=ji;var cr=void 0;function an(Re,_){return cr||(cr=new Os),cr.format(Re,_)}var Zn=Object.freeze({default:Os,format:an}),Xs={add:"add",remove:"remove",replace:"replace",move:"move"},Ri=function(Re){c(_,Re);function _(){i(this,_);var V=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return V.includeMoveDestinations=!0,V}return a(_,[{key:"prepareContext",value:function(U){o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"prepareContext",this).call(this,U),U.result=[],U.path=[],U.pushCurrentOp=function(K){var F=K.op,H=K.value,ee={op:F,path:this.currentPath()};typeof H<"u"&&(ee.value=H),this.result.push(ee)},U.pushMoveOp=function(K){var F=this.currentPath();this.result.push({op:Xs.move,from:F,path:this.toPath(K)})},U.currentPath=function(){return"/"+this.path.join("/")},U.toPath=function(K){var F=this.path.slice();return F[F.length-1]=K,"/"+F.join("/")}}},{key:"typeFormattterErrorFormatter",value:function(U,K){U.out("[ERROR] "+K)}},{key:"rootBegin",value:function(){}},{key:"rootEnd",value:function(){}},{key:"nodeBegin",value:function(U,K,F){var H=U.path;H.push(F)}},{key:"nodeEnd",value:function(U){var K=U.path;K.pop()}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(U,K,F){this.formatDeltaChildren(U,K,F)}},{key:"format_added",value:function(U,K){U.pushCurrentOp({op:Xs.add,value:K[0]})}},{key:"format_modified",value:function(U,K){U.pushCurrentOp({op:Xs.replace,value:K[1]})}},{key:"format_deleted",value:function(U){U.pushCurrentOp({op:Xs.remove})}},{key:"format_moved",value:function(U,K){var F=K[1];U.pushMoveOp(F)}},{key:"format_textdiff",value:function(){throw new Error("Not implemented")}},{key:"format",value:function(U,K){var F={};return this.prepareContext(F),this.recurse(F,U,K),F.result}}]),_}(O),qo=function(_){return _[_.length-1]},ku=function(_,V){return _.sort(V),_},Qa=function(_,V){var U=parseInt(_,10),K=parseInt(V,10);return isNaN(U)||isNaN(K)?0:K-U},jo=function(_){return ku(_,function(V,U){var K=V.path.split("/"),F=U.path.split("/");return K.length!==F.length?K.length-F.length:Qa(qo(K),qo(F))})},Xc=function(_,V){var U=Array(V.length+1).fill().map(function(){return[]});return _.map(function(K){var F=V.map(function(H){return H(K)}).indexOf(!0);return F<0&&(F=V.length),{item:K,position:F}}).reduce(function(K,F){return K[F.position].push(F.item),K},U)},Eu=function(_){var V=_.op;return V==="move"},l0=function(_){var V=_.op;return V==="remove"},u0=function(_){var V=Xc(_,[Eu,l0]),U=u(V,3),K=U[0],F=U[1],H=U[2],ee=jo(F);return[].concat(f(ee),f(K),f(H))},Tu=void 0,sd=function(_,V){return Tu||(Tu=new Ri),u0(Tu.format(_,V))},f0=function(_,V){console.log(sd(_,V))},h0=Object.freeze({default:Ri,partitionOps:Xc,format:sd,log:f0});function ka(Re){return r&&r[Re]||function(){for(var _=arguments.length,V=Array(_),U=0;U<_;U++)V[U]=arguments[U];return V}}var Ea={added:ka("green"),deleted:ka("red"),movedestination:ka("gray"),moved:ka("yellow"),unchanged:ka("gray"),error:ka("white.bgRed"),textDiffLine:ka("gray")},Au=function(Re){c(_,Re);function _(){i(this,_);var V=l(this,(_.__proto__||Object.getPrototypeOf(_)).call(this));return V.includeMoveDestinations=!1,V}return a(_,[{key:"prepareContext",value:function(U){o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"prepareContext",this).call(this,U),U.indent=function(K){this.indentLevel=(this.indentLevel||0)+(typeof K>"u"?1:K),this.indentPad=new Array(this.indentLevel+1).join("  "),this.outLine()},U.outLine=function(){this.buffer.push(`
`+(this.indentPad||""))},U.out=function(){for(var K=arguments.length,F=Array(K),H=0;H<K;H++)F[H]=arguments[H];for(var ee=0,de=F.length;ee<de;ee++){var Ie=F[ee].split(`
`),ve=Ie.join(`
`+(this.indentPad||""));this.color&&this.color[0]&&(ve=this.color[0](ve)),this.buffer.push(ve)}},U.pushColor=function(K){this.color=this.color||[],this.color.unshift(K)},U.popColor=function(){this.color=this.color||[],this.color.shift()}}},{key:"typeFormattterErrorFormatter",value:function(U,K){U.pushColor(Ea.error),U.out("[ERROR]"+K),U.popColor()}},{key:"formatValue",value:function(U,K){U.out(JSON.stringify(K,null,2))}},{key:"formatTextDiffString",value:function(U,K){var F=this.parseTextDiff(K);U.indent();for(var H=0,ee=F.length;H<ee;H++){var de=F[H];U.pushColor(Ea.textDiffLine),U.out(de.location.line+","+de.location.chr+" "),U.popColor();for(var Ie=de.pieces,ve=0,ke=Ie.length;ve<ke;ve++){var Ue=Ie[ve];U.pushColor(Ea[Ue.type]),U.out(Ue.text),U.popColor()}H<ee-1&&U.outLine()}U.indent(-1)}},{key:"rootBegin",value:function(U,K,F){U.pushColor(Ea[K]),K==="node"&&(U.out(F==="array"?"[":"{"),U.indent())}},{key:"rootEnd",value:function(U,K,F){K==="node"&&(U.indent(-1),U.out(F==="array"?"]":"}")),U.popColor()}},{key:"nodeBegin",value:function(U,K,F,H,ee){U.pushColor(Ea[H]),U.out(F+": "),H==="node"&&(U.out(ee==="array"?"[":"{"),U.indent())}},{key:"nodeEnd",value:function(U,K,F,H,ee,de){H==="node"&&(U.indent(-1),U.out(ee==="array"?"]":"}"+(de?"":","))),de||U.outLine(),U.popColor()}},{key:"format_unchanged",value:function(U,K,F){typeof F>"u"||this.formatValue(U,F)}},{key:"format_movedestination",value:function(U,K,F){typeof F>"u"||this.formatValue(U,F)}},{key:"format_node",value:function(U,K,F){this.formatDeltaChildren(U,K,F)}},{key:"format_added",value:function(U,K){this.formatValue(U,K[0])}},{key:"format_modified",value:function(U,K){U.pushColor(Ea.deleted),this.formatValue(U,K[0]),U.popColor(),U.out(" => "),U.pushColor(Ea.added),this.formatValue(U,K[1]),U.popColor()}},{key:"format_deleted",value:function(U,K){this.formatValue(U,K[0])}},{key:"format_moved",value:function(U,K){U.out("==> "+K[1])}},{key:"format_textdiff",value:function(U,K){this.formatTextDiffString(U,K[0])}}]),_}(O),$u=void 0,id=function(_,V){return $u||($u=new Au),$u.format(_,V)};function d0(Re,_){console.log(id(Re,_))}var ad=Object.freeze({default:Au,format:id,log:d0}),p0=Object.freeze({base:ue,html:Ht,annotated:Zn,jsonpatch:h0,console:ad});function g0(Re,_){var V=void 0;return typeof _=="string"&&(V=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+-])(\d{2}):(\d{2}))$/.exec(_),V)?new Date(Date.UTC(+V[1],+V[2]-1,+V[3],+V[4],+V[5],+V[6],+(V[7]||0))):_}function Yc(Re){return new He(Re)}var Jn=void 0;function Zc(){return Jn||(Jn=new He),Jn.diff.apply(Jn,arguments)}function m0(){return Jn||(Jn=new He),Jn.patch.apply(Jn,arguments)}function v0(){return Jn||(Jn=new He),Jn.unpatch.apply(Jn,arguments)}function I0(){return Jn||(Jn=new He),Jn.reverse.apply(Jn,arguments)}function od(){return Jn||(Jn=new He),Jn.clone.apply(Jn,arguments)}t.DiffPatcher=He,t.formatters=p0,t.console=ad,t.create=Yc,t.dateReviver=g0,t.diff=Zc,t.patch=m0,t.unpatch=v0,t.reverse=I0,t.clone=od,Object.defineProperty(t,"__esModule",{value:!0})})})(gI,gI.exports);var Ape=gI.exports,u3=zt,$pe=u3.cloneDeep,Npe=u3.forEach,mI=qc,Yx=Ape.create({}),Ope=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.ignoreKeys,i=s===void 0?[]:s;return e=mI(e,{annotationsAsObjects:!0,noTranslationData:!0}),t=mI(t,{annotationsAsObjects:!0,noTranslationData:!0}),[e,t].forEach(function(a){["cutsites","orfs","filteredFeatures","size","fromFileUpload","description","materiallyAvailable"].concat(i).forEach(function(o){delete a[o]}),a.translations&&Npe(a.translations,function(o,c){o.translationType&&o.translationType!=="User Created"?delete a.translations[c]:delete o.aminoAcids})}),Yx.diff(e,t)},_pe=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.ignoreKeys,i=s===void 0?[]:s;return i.forEach(function(a){delete t[a]}),Yx.patch(mI($pe(e),{annotationsAsObjects:!0}),t)},Fpe=function(e){return Yx.reverse(e)},Dpe={getDiffFromSeqs:Ope,patchSeqWithDiff:_pe,reverseSeqDiff:Fpe},Xn={};Xn.protein_letters="ACDEFGHIKLMNPQRSTVWY";Xn.extended_protein_letters="ACDEFGHIKLMNPQRSTVWYBXZJUO.*-";Xn.protein_letters_1to3={A:"Ala",C:"Cys",D:"Asp",E:"Glu",F:"Phe",G:"Gly",H:"His",I:"Ile",K:"Lys",L:"Leu",M:"Met",N:"Asn",P:"Pro",Q:"Gln",R:"Arg",S:"Ser",T:"Thr",V:"Val",W:"Trp",Y:"Tyr",O:"Pyl",U:"Sec"};Xn.ambiguous_dna_letters="GATCRYWSMKHBVDN";Xn.unambiguous_dna_letters="GATC";Xn.ambiguous_rna_letters="GAUCRYWSMKHBVDN";Xn.unambiguous_rna_letters="GAUC";Xn.extended_dna_letters="GATCBDSW";Xn.ambiguous_dna_values={".":".",A:"A",C:"C",G:"G",T:"T",M:"AC",R:"AG",W:"AT",S:"CG",Y:"CT",K:"GT",V:"ACG",H:"ACT",D:"AGT",B:"CGT",X:"GATC",N:"GATC"};Xn.ambiguous_rna_values={".":".",A:"A",C:"C",G:"G",U:"U",M:"AC",R:"AG",W:"AU",S:"CG",Y:"CU",K:"GU",V:"ACG",H:"ACU",D:"AGU",B:"CGU",X:"GAUC",N:"GAUC"};Xn.ambiguous_dna_complement={".":".",A:"T",C:"G",G:"C",T:"A",M:"K",R:"Y",W:"W",S:"S",Y:"R",K:"M",V:"B",H:"D",D:"H",B:"V",X:"X",N:"N"};Xn.ambiguous_rna_complement={".":".",A:"U",C:"G",G:"C",U:"A",M:"K",R:"Y",W:"W",S:"S",Y:"R",K:"M",V:"B",H:"D",D:"H",B:"V",X:"X",N:"N"};Xn.unambiguous_dna_weights={A:331.2218,C:307.1971,G:347.2212,T:322.2085};Xn.monoisotopic_unambiguous_dna_weights={A:331.06817,C:307.056936,G:347.063084,T:322.056602};Xn.unambiguous_rna_weights={A:347.2212,C:323.1965,G:363.2206,U:324.1813};Xn.monoisotopic_unambiguous_rna_weights={A:347.063084,C:323.051851,G:363.057999,U:324.035867};Xn.protein_weights={A:89.0932,C:121.1582,D:133.1027,E:147.1293,F:165.1891,G:75.0666,H:155.1546,I:131.1729,K:146.1876,L:131.1729,M:149.2113,N:132.1179,O:255.3134,P:115.1305,Q:146.1445,R:174.201,S:105.0926,T:119.1192,U:168.0532,V:117.1463,W:204.2252,Y:181.1885};Xn.monoisotopic_protein_weights={A:89.047678,C:121.019749,D:133.037508,E:147.053158,F:165.078979,G:75.032028,H:155.069477,I:131.094629,K:146.105528,L:131.094629,M:149.051049,N:132.053492,O:255.158292,P:115.063329,Q:146.069142,R:174.111676,S:105.042593,T:119.058243,U:168.964203,V:117.078979,W:204.089878,Y:181.073893};Xn.extended_protein_values={A:"A",B:"ND",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"IL",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"ACDEFGHIKLMNPQRSTVWY",Y:"Y",Z:"QE","*":"\\*\\.",".":"\\.\\.","-":"\\-"};Xn.atom_weights={H:1.00794,D:2.0141,He:4.002602,Li:6.941,Be:9.012182,B:10.811,C:12.0107,N:14.0067,O:15.9994,F:18.9984032,Ne:20.1797,Na:22.98977,Mg:24.305,Al:26.981538,Si:28.0855,P:30.973761,S:32.065,Cl:35.453,Ar:39.948,K:39.0983,Ca:40.078,Sc:44.95591,Ti:47.867,V:50.9415,Cr:51.9961,Mn:54.938049,Fe:55.845,Co:58.9332,Ni:58.6934,Cu:63.546,Zn:65.39,Ga:69.723,Ge:72.64,As:74.9216,Se:78.96,Br:79.904,Kr:83.8,Rb:85.4678,Sr:87.62,Y:88.90585,Zr:91.224,Nb:92.90638,Mo:95.94,Tc:98,Ru:101.07,Rh:102.9055,Pd:106.42,Ag:107.8682,Cd:112.411,In:114.818,Sn:118.71,Sb:121.76,Te:127.6,I:126.90447,Xe:131.293,Cs:132.90545,Ba:137.327,La:138.9055,Ce:140.116,Pr:140.90765,Nd:144.24,Pm:145,Sm:150.36,Eu:151.964,Gd:157.25,Tb:158.92534,Dy:162.5,Ho:164.93032,Er:167.259,Tm:168.93421,Yb:173.04,Lu:174.967,Hf:178.49,Ta:180.9479,W:183.84,Re:186.207,Os:190.23,Ir:192.217,Pt:195.078,Au:196.96655,Hg:200.59,Tl:204.3833,Pb:207.2,Bi:208.98038,Po:208.98,At:209.99,Rn:222.02,Fr:223.02,Ra:226.03,Ac:227.03,Th:232.0381,Pa:231.03588,U:238.02891,Np:237.05,Pu:244.06,Am:243.06,Cm:247.07,Bk:247.07,Cf:251.08,Es:252.08,Fm:257.1,Md:258.1,No:259.1,Lr:262.11,Rf:261.11,Db:262.11,Sg:266.12,Bh:264.12,Hs:269.13,Mt:268.14};var Bpe=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},f3=zt,Xu=f3.forEach,Mpe=f3.omitBy,Ppe=Xn,Lpe=jm,h3=pt,Upe=h3.normalizePositionByRangeLength,GR=h3.reversePositionInRange,zpe=Vo,HR=Ppe.ambiguous_dna_values;function Vpe(n){var e=n.seqsToAnnotateById,t=n.annotationsToCheckById,r=n.compareName,s=n.warnIfMoreThan,i={};Xu(t,function(o){var c=new RegExp(o.sequence,"gi");Xu(Mpe(e,function(l){return!l.sequence.length}),function(l,u){var f=l.circular,d=l.sequence;function p(v){var b=v.seqToMatchAgainst,y=v.isReverse,S=v.seqLen,w=void 0,C=void 0;try{for(;w=c.exec(b);){var N=w,E=N.index,A=N[0];if(E>=S)return;var M=E+A.length;if(C&&E>C.start&&M<=C.end){c.lastIndex=w.index+1;continue}C={start:E,end:M};var z={start:E,end:Upe(M-1,S)};i[u]||(i[u]=[]),i[u].push(Bpe({},y?{start:GR(z.end,S),end:GR(z.start,S)}:z,{strand:y?-1:1,id:o.id})),c.lastIndex=w.index+1}}catch(Y){console.error("error:",Y)}}var m=d.length,I=zpe(d);p({seqLen:m,seqToMatchAgainst:f?d+d:d}),p({seqLen:m,isReverse:!0,seqToMatchAgainst:f?I+I:I})})});var a={};return Xu(i,function(o,c){var l=e[c],u={};Xu(l.annotations,function(p){u[qR(p,{compareName:r})]=p});var f={},d=o.filter(function(p){var m=u[qR(p,{compareName:r})];return m?!1:(s&&(f[p.id]=(f[p.id]||0)+1),!0)}).sort(function(p,m){return p.start-m.start});d.length&&(a[c]=d),s&&Xu(f,function(p,m){p>s&&(a.__more_than_warnings=a.__more_than_warnings||{},a.__more_than_warnings[c]=a.__more_than_warnings[c]||[],a.__more_than_warnings[c].push(m))})}),a}function qR(n,e){var t=n.start,r=n.end,s=n.name,i=n.strand,a=n.forward,o=e.compareName,c=i===-1||a===!1;return t+"-"+r+"-"+(c?"rev":"for")+"-"+(o?s:"")}function Wpe(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e="",t="",r="",s="",i=void 0,a=void 0,o=void 0,u=n.replace("(","").replace(")",""),c=Array.isArray(u),l=0,u=c?u:u[Symbol.iterator]();;){var f=function(S){o&&(t+=S,r=""+t+(r.length?"|":"")+r)},d;if(c){if(l>=u.length)break;d=u[l++]}else{if(l=u.next(),l.done)break;d=l.value}var p=d,m=HR[p.toUpperCase()];if(m&&m.length>1){var I=void 0;m.length===4?I=".":I="["+m+"]",e+=I,f(I);continue}if(p==="#"){if(o)throw new Error("Error converting regex");var v=i?"[^"+i+"]*?":".*?";e+=v,f(v);continue}if(p==="<"){var b=function(){if(o)throw new Error("Error converting to regex");if(a)throw new Error("Error converting to regex");for(var y="",S="",w=!0,C=void 0,N=[],E=0;E<e.length;E++){var A=e[E],M=e[E+1];A==="["?w=!1:(A==="]"||C)&&(C=!0,(HR[M]||M==="[")&&(w=!0,C=!1)),y+=A,w&&(N.push(y),y="")}var z="";return N.reverse(),N.forEach(function(Y){z=Y+z,S=""+z+(S.length?"|":"")+S}),e="("+S+")?",a=!0,"continue"}();if(b==="continue")continue}if(p===">"){if(o)throw new Error("Error converting regex");o=!0,s=e;continue}e+=p,f(p),i=p}return o&&(e=s+"("+r+")?"),e}function Gpe(n){for(var e="",t=void 0,i=n,r=Array.isArray(i),s=0,i=r?i:i[Symbol.iterator]();;){if(r){if(s>=i.length)break;t=i[s++]}else{if(s=i.next(),s.done)break;t=s.value}var a=Lpe[t.toLowerCase()];a?e+=a:e+=t}return e}var d3={convertProteinSeqToDNAIupac:Gpe,convertApELikeRegexToRegex:Wpe,autoAnnotate:Vpe},p3=function(e){var t=[];e.forEach(function(i){for(var a=i.cigar.match(/([0-9]*[MDI])/g),o=0;o<a.length;o++)if(a[o].slice(-1)==="I"){for(var c=i.pos,l=Number(a[o].slice(0,-1)),u=0;u<o;u++)if(a[u].slice(-1)!=="I"){var f=Number(a[u].slice(0,-1));c+=f}var d={bpPos:c,number:l};t.push(d)}});for(var r=t.sort(function(i,a){return i.bpPos-a.bpPos}),s=0;s<r.length-1;s++)r[s].bpPos===r[s+1].bpPos&&(r[s].number>r[s+1].number?(r.splice(s+1,1),s--):(r[s].number<r[s+1].number||r[s].number===r[s+1].number)&&(r.splice(s,1),s--));return r},jR=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Hpe=d3,qpe=Hpe.autoAnnotate;function jpe(n){var e,t,r=n.fullSeq,s=n.searchSeq,i=r.id||"fullSeqId",a=s.id||"searchSeqId",o=qpe({seqsToAnnotateById:(e={},e[i]=jR({},r,{id:i}),e),annotationsToCheckById:(t={},t[a]=jR({},s,{id:a}),t),compareName:!1});return o&&o[i]?{matches:o[i]}:{matches:[]}}var Kpe=jpe,Xpe={"-":"---",".":"...","*":"trr",a:"gcn",b:"ray",c:"ugy",d:"gay",e:"gar",f:"uuy",g:"ggn",h:"cay",i:"auh",j:"hun",k:"aar",l:"yun",m:"aug",n:"aay",o:"uag",p:"ccn",q:"car",r:"mgn",s:"wsn",t:"acn",u:"uga",v:"gun",w:"ugg",x:"nnn",y:"uay",z:"sar"},Zx=Xpe,Ype=Zx,Zpe=function(e){return e.split("").map(function(t){return Ype[t.toLowerCase()]||"nnn"}).join("")},Jpe=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Qpe=zt,KR=Qpe.get,g3=pt,XR=g3.normalizePositionByRangeLength,ege=g3.getRangeLength,tge=function(e){var t=e.cutsites,r=e.sequenceLength,s=e.isCircular,i=e.computePartialDigest,a=e.computePartialDigestDisabled,o=e.computeDigestDisabled,c=[],l=[],u=[],f=t.sort(function(d,p){return d.topSnipPosition-p.topSnipPosition});return f.forEach(function(d,p){i&&!a&&f.forEach(function(m,I){u.push([d,f[I]])}),o||u.push([d,f[p+1]?f[p+1]:f[0]])}),u.forEach(function(d){var p=d[0],m=d[1],I=XR(p.topSnipPosition,r),v=XR(m.topSnipPosition-1,r);if(!s&&I>v){var b={start:I,end:r-1,cut1:p,cut2:{type:"endOfSeq",restrictionEnzyme:{name:"End Of Seq"}}},y={start:0,end:v,cut1:{type:"startOfSeq",restrictionEnzyme:{name:"Start Of Seq"}},cut2:m};c.push(X1(b,r)),c.push(X1(y,r))}else{var S={cut1:p,cut2:m,start:I,end:v};c.push(X1(S,r))}}),c=c.filter(function(d){return d.size?!0:(l.push(d),!1)}),{computePartialDigestDisabled:a,computeDigestDisabled:o,fragments:c,overlappingEnzymes:l}};function X1(n,e){var t=ege({start:n.start,end:n.end},e),r=KR(n,"cut1.restrictionEnzyme.name","Untitled Cutsite")+" -- "+KR(n,"cut2.restrictionEnzyme.name","Untitled Cutsite")+" "+t+" bps";return Jpe({},n,{size:t,name:r,id:n.start+"-"+n.end+"-"+t+"-"})}var nge=function(e){return e.site.length<e.topSnipOffset||e.site.length<e.bottomSnipOffset},rge=p3,m3=function(e,t){for(var r=e.split(""),s=rge(t),i=0;i<s.length;i++){for(var a=s[i].bpPos,o=s[i].number,c="",l=0;l<o;l++)c+="-";r.splice(a-1,0,c);for(var u=i+1;u<s.length;u++)s[u].bpPos+=1}return r.join("")},sge=function(e,t,r,s){return e.slice(0,t)+(s||"")+e.slice(t+r)},Xh=pt,ige=Xh.splitRangeIntoTwoPartsIfItIsCircular,age=Xh.getSequenceWithinRange,oge=Xh.getRangeLength,cge=Xh.invertRange,lge=Xh.isPositionWithinRange,uge=sge,v3=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments[2],s=e;if(r&&r.start>-1){if(oge(r,e.length)===e.length)return t;var i=ige(cge(r,e.length));s="",i.forEach(function(a,o){s+=age(a,e),i.length===1?lge(0,a,e.length,!0,!0)?s=s+t:s=t+s:o===0&&(s+=t)})}else s=uge(e,r,0,t);return s},I3=function(e){return(e.match(/[cg]/gi)||[]).length/e.length*100||0},YR={TABLE_BRESLAUER:"breslauer",TABLE_SUGIMOTO:"sugimoto",TABLE_UNIFIED:"unified",A:-10.8,R:1.987,C:5e-7,Na:.05,calculateTemperature:function(e,t,r,s,i,a){if(typeof t>"u")t=this.TABLE_BRESLAUER;else if(t!=this.TABLE_BRESLAUER&&t!=this.TABLE_UNIFIED&&t!=this.TABLE_SUGIMOTO)throw new Error("Invalid table type!");r||(r=this.A),s||(s=this.R),i||(i=this.C),a||(a=this.Na);var o=e.length;if(o==0)return 0;var c=this.getDeltaHTable(t),l=this.getDeltaSTable(t),u=[];u.push(this.calculateReps(e,"aa")),u.push(this.calculateNumberOfOccurrences(e,"at")),u.push(this.calculateNumberOfOccurrences(e,"ac")),u.push(this.calculateNumberOfOccurrences(e,"ag")),u.push(this.calculateReps(e,"tt")),u.push(this.calculateNumberOfOccurrences(e,"ta")),u.push(this.calculateNumberOfOccurrences(e,"tc")),u.push(this.calculateNumberOfOccurrences(e,"tg")),u.push(this.calculateReps(e,"cc")),u.push(this.calculateNumberOfOccurrences(e,"ca")),u.push(this.calculateNumberOfOccurrences(e,"ct")),u.push(this.calculateNumberOfOccurrences(e,"cg")),u.push(this.calculateReps(e,"gg")),u.push(this.calculateNumberOfOccurrences(e,"ga")),u.push(this.calculateNumberOfOccurrences(e,"gt")),u.push(this.calculateNumberOfOccurrences(e,"gc"));for(var f=0,d=0,p=0;p<16;p++)f=f+u[p]*c[p],d=d+u[p]*l[p];var m=-1e3*f/(r+-d+s*Math.log(i/4))-273.15+16.6*Math.LOG10E*Math.log(a);return m<0?0:m.toFixed(2)},getDeltaHTable:function(e){return e==this.TABLE_BRESLAUER?[9.1,8.6,6.5,7.8,9.1,6,5.6,5.8,11,5.8,7.8,11.9,11,5.6,6.5,11.1]:e==this.TABLE_SUGIMOTO?[8,5.6,6.5,7.8,8,5.6,5.6,5.8,10.9,8.2,6.6,11.8,10.9,6.6,9.4,11.9]:e==this.TABLE_UNIFIED?[7.9,7.2,8.4,7.8,7.9,7.2,8.2,8.5,8,8.5,7.8,10.6,8,8.2,8.4,9.8]:null},getDeltaSTable:function(e){return e==this.TABLE_BRESLAUER?[24,23.9,17.3,20.8,24,16.9,13.5,12.9,26.6,12.9,20.8,27.8,26.6,13.5,17.3,26.7]:e==this.TABLE_SUGIMOTO?[21.9,15.2,17.3,20.8,21.9,15.2,13.5,12.9,28.4,25.5,23.5,29,28.4,16.4,25.5,29]:e==this.TABLE_UNIFIED?[22.2,20.4,22.4,21,22.2,21.3,22.2,22.7,19.9,22.7,21,27.2,19.9,22.2,22.4,24.4]:null},calculateReps:function(e,t){var r=e.length;if(r==0)return 0;for(var s=0,i=0;;){var a=e.indexOf(t,i);if(a==-1||(i=a+1,s++,i>r))break}return s},calculateNumberOfOccurrences:function(e,t){var r=e.length;if(r==0)return 0;var s=e.split(t).length-1;return s}},fge=YR.calculateTemperature.bind(YR),hge=zt,dge=hge.assign,pge=fu,ZR=Vo,Jx=pt,gge=Jx.getSequenceWithinRange,Zi=Jx.normalizePositionByRangeLength,lo=Jx.reversePositionInRange,Xm=function(e,t,r){if(r.forwardRegex.length===0||r.reverseRegex.length===0){var s=[];return s.error="Cannot cut sequence. Enzyme restriction site must be at least 1 bp long.",s}var i=new RegExp(r.forwardRegex,"ig"),a=e,o=JR(i,r,a,t),c=[];if(r.forwardRegex!==r.reverseRegex){var l=ZR(a);c=JR(i,r,l,t),c=c.map(function(f){return u(f,a.length)})}return o.concat(c);function u(f,d){return f.start=lo(f.start,d,!1),f.end=lo(f.end,d,!1),f.topSnipPosition=lo(f.topSnipPosition,d,!0),f.bottomSnipPosition=lo(f.bottomSnipPosition,d,!0),f.cutsTwice&&(f.upstreamTopSnip=lo(f.upstreamTopSnip,d,!0),f.upstreamBottomSnip=lo(f.upstreamBottomSnip,d,!0)),f.recognitionSiteRange.start=lo(f.recognitionSiteRange.start,d,!1),f.recognitionSiteRange.end=lo(f.recognitionSiteRange.end,d,!1),dge({},f,{start:f.end,end:f.start,overhangBps:ZR(f.overhangBps),topSnipPosition:f.bottomSnipPosition,bottomSnipPosition:f.topSnipPosition,upstreamTopSnip:f.upstreamBottomSnip,upstreamBottomSnip:f.upstreamTopSnip,upstreamTopBeforeBottom:!!f.upstreamTopBeforeBottom,topSnipBeforeBottom:!!f.topSnipBeforeBottom,recognitionSiteRange:{start:f.recognitionSiteRange.end,end:f.recognitionSiteRange.start},forward:!1})}};function JR(n,e,t,r){var s=[],i=void 0,a=e.site.length,o=t,c=t.length;r&&(t+=t);for(var l=t.length,u=t.search(n),f=0,d=t;u!==-1;){var p={},m=void 0,I=void 0,v=null,b=null,y=!1,S=null,w=null,C=!1,N=!1;if(p.start=u+f,m=p.start,p.end=u+a-1+f,I=p.end,e.cutType===1&&(v=p.end-e.usForward,b=p.end-e.usReverse,v>=0&&b>=0?(N=!0,v<b?(m>v&&(m=v+1),y=!0):m>b&&(m=b+1),v=Zi(v,c,!0),b=Zi(b,c,!0)):(v=null,b=null)),S=p.start+e.topSnipOffset,w=p.start+e.bottomSnipOffset,w<=l&&S<=l?(N=!0,S>w?S>p.end&&(I=S-1):(w>p.end&&(I=w-1),C=!0),S=Zi(S,c,!0),w=Zi(w,c,!0)):(S=null,w=null),N&&m>=0&&I>=0&&m<c&&I<l){m=Zi(m,c,!1),I=Zi(I,c,!1),p.start=Zi(p.start,c,!1),p.end=Zi(p.end,c,!1);var E={start:-1,end:-1};S!==w&&(E=C?{start:S,end:Zi(w-1,c)}:{start:w,end:Zi(S-1,c)});var A=gge(E,o);i={id:pge().str,start:m,end:I,topSnipPosition:S,bottomSnipPosition:w,topSnipBeforeBottom:C,overhangBps:A,overhangSize:A.length,upstreamTopBeforeBottom:y,upstreamTopSnip:v,annotationTypePlural:"cutsites",upstreamBottomSnip:b,recognitionSiteRange:p,forward:!0,name:e.name,restrictionEnzyme:e},s.push(i)}f=f+u+1,d=t.substring(f,t.length),u=d.search(n)}return s}var b3=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},mge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Qx=function(e){return(typeof e>"u"?"undefined":mge(e))==="object"&&e!==null?QR(b3({},e,{locations:e.locations?e.locations.map(QR):void 0})):vge(e)};function vge(n){return Math.floor(n/3)}function QR(n){return b3({},n,{start:n.start>-1?Math.floor(n.start/3):n.start,end:n.end>-1?Math.floor(n.end-2)/3:n.end})}var y3=function(e,t){return Ige(e.split(""),t).join("")};function Ige(n,e){return e-=n.length*Math.floor(e/n.length),n.push.apply(n,n.splice(0,e)),n}var bge=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},yge=zt,xge=yge.map,wge=pt,ek=wge.adjustRangeToRotation,Sge=qc,Cge=Ja.modifiableTypes,Rge=y3,x3=function(e,t,r){var s=Sge(e,r);return s.sequence=Rge(s.sequence,t),Cge.forEach(function(i){s[i]=kge(s[i],t,s.sequence.length)}),s};function kge(n,e,t){return xge(n,function(r){return bge({},ek(r,e,t),{locations:r.locations?r.locations.map(function(s){return ek(s,e,t)}):void 0})}).filter(function(r){return!!r})}var Ege=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Tge=pt,tk=Tge.adjustRangeToInsert,Age=zt,$ge=Age.map,ew=function(e,t,r){return $ge(e,function(s){return Ege({},tk(s,t,r),s.locations&&{locations:s.locations.map(function(i){return tk(i,t,r)})})})},w3=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Nge=pt,nk=Nge.getRangeLength,S3=zt,Oge=S3.map,_ge=S3.cloneDeep,Fge=Qx,Dge=x3,Bge=pt,rk=Bge.adjustRangeToDeletionOfAnotherRange,Y1=qc,sk=Ja.modifiableTypes,ik=v3,ak=ew,tw=function(e,t,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=s.maintainOriginSplit,a=Y1(t,s),o=Y1(e,s),c=_ge(a),l=o.proteinSequence?o.proteinSequence.length*3:o.sequence.length,u=r,f=o.sequence.length===nk(r,a.sequence.length);if(r.start>-1&&nk(r,a.sequence.length)===a.sequence.length?(a=Y1(w3({},a,sk.reduce(function(p,m){return p[m]=[]},{}),{sequence:"",proteinSequence:"",chromatogramData:void 0}),s),c.chromatogramData=void 0):c.chromatogramData&&c.chromatogramData.baseTraces&&(r&&r.start>-1&&(r.start>r.end?(c.chromatogramData=Z1({chromatogramData:c.chromatogramData,range:{start:r.start,end:c.sequence.length},justBaseCalls:f}),c.chromatogramData=Z1({chromatogramData:c.chromatogramData,range:{start:0,end:r.end},justBaseCalls:f})):c.chromatogramData=Z1({chromatogramData:c.chromatogramData,range:{start:r.start,end:r.end},justBaseCalls:f})),o.sequence&&Pge({chromatogramData:c.chromatogramData,caretPosition:r.start>-1?r.start:r,seqToInsert:o.sequence,justBaseCalls:f})),c.sequence=ik(a.sequence,o.sequence,r),c.size=c.sequence.length,c.proteinSequence=ik(a.proteinSequence,o.proteinSequence,Fge(r)),c.proteinSize=c.proteinSequence.length,sk.forEach(function(p){var m=a[p];if(r&&r.start>-1){var I=r;u=I.start>I.end?0:I.start,m=Mge(m,I,a.sequence.length)}c[p]=[],c[p]=c[p].concat(ak(m,u,l)),c[p]=c[p].concat(ak(o[p],0,u))}),i&&r&&r.start>r.end){var d=a.sequence.length-r.start;return Dge(c,Math.min(d,l))}return c};function Mge(n,e,t){return Oge(n,function(r){var s=rk(r,e,t),i=r.locations&&r.locations.map(function(a){return rk(a,e,t)}).filter(function(a){return!!a});return i&&i.length?w3({},s,{start:i[0].start,end:i[i.length-1].end},i.length>1&&{locations:i}):s}).filter(function(r){return!!r})}function Pge(n){var e,t,r,s=n.chromatogramData,i=n.caretPosition,a=n.seqToInsert,o=n.justBaseCalls;if(a.length){if(s.baseCalls&&(e=s.baseCalls).splice.apply(e,[i,0].concat(a.split(""))),o)return s;for(var c=[],l=[],u=0;u<a.length;u++){l.push(0);var f=[0,0,0,0,0,0,0,0,0,0,0];c.push({aTrace:f,cTrace:f,gTrace:f,tTrace:f})}return s.baseTraces&&(t=s.baseTraces).splice.apply(t,[i,0].concat(c)),s.qualNums&&(r=s.qualNums).splice.apply(r,[i,0].concat(l)),s}}function Z1(n){var e=n.chromatogramData,t=n.range,r=t.start,s=t.end,i=n.justBaseCalls;return["baseCalls"].concat(i?[]:["qualNums","baseTraces","basePos"]).forEach(function(a){e[a]&&e[a].splice(r,s-r+1)}),e}var Lge=tw,Uge=function(e,t){return Lge({},e,t)},zge=function(e){return e.topSnipOffset>e.site.length||e.bottomSnipOffset>e.site.length},Vge=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Wge=[{aliases:["ErpI","Bme18I","BsrAI","SmuEI","FdiI","BmpI","VpaK11BI","CauI","Kzo49I","SinI","EagMI","HgiHIII","AvaII","BamNxI","AflI","FssI","Asp745I","BthAI","HgiCII","FspMSI","DsaIV","Eco47I","Csp68KI","BcuAI","HgiEI","HgiJI","HgiBI","Bme216I"],site:"ggwcc",forwardRegex:"g{2}[atw]c{2}",reverseRegex:"g{2}[atw]c{2}",topSnipOffset:1,bottomSnipOffset:4},{aliases:["Eco196I","Uba1126I","Pae17I","Ssp1725I","BacI","Eco104I","Bsp12I","Eco100I","EccI","Kpn19I","DrdFI","Cfr37I","DrdEI","DrdBI","DrdAI","DrdCI","Cfr45II","FscI","Cte1I","Pfl1108II","NlaSI","Ecl1I","Bac465I","Uba66I","NgoDIII","NgoJIII","Pae7I","Dsp1I","SseII","BscTI","MraI","Pae36I","SsmII","NlaDIII","Eco55I","Uba77I","Uba1364I","Uba1369I","Pae44I","Pae43I","Pae42I","Sfr382I","Ese3I","Ese6I","SfrI","Cfr43I","Cfr41I","Uba1234I","StaI","Uba90I","NgoKIII","Eco151I","Eco208I","Uba1306I","Ecl28I","Eco158I","TtoI","Uba1244I","Asp32HI","SboI","Eco134I","Eco135I","SenpCI","ShyI","TglI","UbaHKAI","NgoGIII","NgoMIII","Eco96I","SakI","Eco92I","Ssm5II","SaaI","SabI","Uba1111I","AosIII","Uba1113I","Eco182I","Eco99I","Uba1187I","Uba1095I","Uba1093I","Ecl37I","Uba1229I"],site:"ccgcgg",forwardRegex:"c{2}gcg{2}",reverseRegex:"c{2}gcg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SplI","PpuAI","BvuBI","Pfl23II","PspLI","SunI","BsiWI","BpuB5I","MaeK81I"],site:"cgtacg",forwardRegex:"cgtacg",reverseRegex:"cgtacg",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Uba1366II","Bsh108AI","Uba1161I","Uba1379I","BfrAI","BscVI","Uba1145I","Uba1257I","Uba1144I","Bsp145I","Apu16I","Uba1138I","Uba1286I","Bth1202I","Uba1137I","Uba1133I","Bli576I","Bsp84I","Uba1427I","BstLVI","Uba1200I","Bsp127I","Bsp126I","Bsp125I","Uba1275I","Bli585I","BazI","Uba1412I","Uba1342I","Uba1416I","Uba1195I","Uba1197I","Uba1196I","Bth9415I","Uba1295I","Uba1096I","Bco79I","Bsp2I","Uba43I","Bsp4I","Uba34I","Asp86I","Asp14I","Uba1430I","Uba1100I","Csp4I","Uba1198I","Uba1199I","Uba30I","Asp123I","Uba1246I","Uba22I","Uba24I","Asp707I","BsrCI","Uba1168I","Uba1315I","Uba1394I","Asp37I","Uba1233I","Uba1238I","Asp130I","BtuI","Uba1451I","Uba1453I","Uba1380I"],site:"atcgat",forwardRegex:"atcgat",reverseRegex:"atcgat",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bbv12I","MspV281I","BsiHKAI","Alw21I","Bsm6I","Bsh45I","AspHI","HgiAI"],site:"gwgcwc",forwardRegex:"g[atw]gc[atw]c",reverseRegex:"g[atw]gc[atw]c",topSnipOffset:5,bottomSnipOffset:1},{aliases:["SmiMII","NflAI","Rma495II","Bsc217I","Tsp273I","Eco17I","NanI","Eco178I","BshLI","Bsp16I","Pac1110II","BsoAI","PxyARI","UbaN4I","Rma497II","Rma496II","Uba1400I","BstRI","Pfl16I"],site:"gatatc",forwardRegex:"gatatc",reverseRegex:"gatatc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Uba1223I","MthTI","Bpa36I","Bce71I","NgoCII","SagI","Bal3006I","Uba9I","NlaI","Uba1449I","HhgI","Bsu1114I","Uba1336I","Bfi458I","Uba1228I","Bsp23I","Uba1097I","Uba1214I","Tsp266I","TteAI","Uba1210I","Afl83II","BmeU1594I","Uba1322I","Bme46I","Bsp2500I","Csp2I","UbaN8I","MniI","BshAI","BshDI","BshEI","Van91III","BshBI","BshCI","Bsp2013I","HpyF10V","NgoAII","SulI","BsiDI","BsiAI","Uba1169I","NgoNII","Uba1319I","BliI","BsiHI","Uba1392I","Uba1395I","Uba1231I","BsaRI","HpyF72I","Uba1235I","Uba1450I","Bsp1261I","Tsp132I","Uba1230I","FinSI","Tsp281I","Bsp2362I","BssCI","Uba1176I","Uba1175I","Uba1174I","Uba1179I","Uba1388I","Uba1178I","BspLRI","Psp29I","BspBDG2I","Bsu1076I","PaiI","TtnI","Bse126I","Bsp137I","BstJI","HpyF69II","Uba1150I","HpyF63I","Uba1152I","Bal475I","HpyF26II","Uba1153I","Uba1155I","BhaII","Uth557I","Tsp273II","Uba1408I","Uth555I","Bco33I","PpuI","BscQI","Uba1377I","Bme74I","HpyF33II","VniI","BstCI","BluII","AspTIII","Tsp560I","Uba1146I","HpyF57I","Uba1147I","HpyF53I","BseI","Uba1140I","Bsp881I","M.H2I","HpyF73III","Vha1168I","M.Csp68KV","TspZNI","HpyF49IV","Uth549I","BspBSE18I","HpyF42I","UbaN2I","Uba1288I","Uba1209I","Uba1208I","EsaWC1I","HpyF46V","Uba1207I","Asp742I","ClmI","Bse9I","Bsp44II","Uba1429I","BspCHE15I","Uba61I","OchI","NgoSII","Uba1422I","Hpy178VII","Uba1292I","SplIII","Uba1293I","Bsp1593I","MnnII","Bsp226I","BspBake1I","AcaIV","M.NgoGII","Uba1418I","VhaI","Uba54I","BspGHA1I","BspH106II","Psb9879I","Ple214I","NgoTII","AvrBI","HpyF29I"],site:"ggcc",forwardRegex:"g{2}c{2}",reverseRegex:"g{2}c{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["ErhB9I","Afa16RI","XorII","NblI","Ple19I","RshI","BpvUI","Afa22MI","PvuI","Psu161I","EagBI","MvrI","BspCI"],site:"cgatcg",forwardRegex:"cgatcg",reverseRegex:"cgatcg",topSnipOffset:4,bottomSnipOffset:2},{aliases:["BsmRI","Ssp4800I","Bsp1407I","BstAUI","BsrGI","SspBI","AauI"],site:"tgtaca",forwardRegex:"tgtaca",reverseRegex:"tgtaca",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Psp32I","Acs1422I","Acs1421I","BstZ16I","Acs1371I","Acs1372I","Acs1373I","CglAII","RhpI","RheI","Psp89I","XamI","RroI","RrhI","Uba89I","BtgAI","Psp33I","KoyI"],site:"gtcgac",forwardRegex:"gtcgac",reverseRegex:"gtcgac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Ecl136I","Scg2I","Bme2095I","Ecl1zII","Bsp56I","Esp2I","Eco70I","Eco71I","Eco206I","Asp2HI","Eco207I","Uba1181I","M.SPRI","Eco67I","Uba1185I","Uba13I","Acc38I","Uba11I","CfrS37I","BsaNI","Uba20I","Bsp44I","Ese6II","SflHK7462I","Cdi27I","Sau16I","Uba1171I","BsiUI","Uba1243I","BsiVI","UbaN16I","Bsp103I","Uba1218I","Eco128I","BspSI","SflHK7234I","SflHK2374I","Eco170I","Cfr11I","Esp24I","M.EcoKDcm","AcuII","EagKI","Cfr5I","Bsp317I","Ecl37kII","EcaII","Uba1118I","Bst7QII","Uba1189I","HhdI","Uba1114I","Uba1193I","SflHK8401I","BstGII","Sfl2bI","Uba1410I","Sfl2aI","Kpn16I","Kpn14I","Cfr35I","Eco38I","Kpn13I","MpsI","Ecl57kI","Cfr31I","Cfr30I","EclII","Uba1120I","Uba1121I","KspHK12I","KspHK14I","Eco256I","Kpn10I","TspAI","Eco254I","BsoGI","Eco193I","Cfr28I","Cfr29I","Uba1125I","MphI","Cfr27I","Cfr25I","Cfr24I","Ecl66I","EclS39I","Uba1428I","Cfr22I","Lla497I","Cfr20I","EspHK7I","Sgr20I","Mlu2300I","BspH43I","EspHK30I","Cfr58I","Kox165I","SflHK2731I","UbaN11II","Eco60I","Ecl54kI","Eco61I","Sth455I","SflHK10790I","SflHK6873I","BinSI","Psp39I","AtuBI","Uba82I","Uba81I","Ecl137II","Eco41I","Eco40I","AtuII","SflHK1794I","Atu1I","Pca17AI","M.Bbu297I","EspHK22I"],site:"ccwgg",forwardRegex:"c{2}[atw]g{2}",reverseRegex:"c{2}[atw]g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SspCI","NaeI","SauLPI","SauSI","SauBMKI","RrhJ1I","SauHPI","CcoI","PdiI","SauNI","Slu1777I"],site:"gccggc",forwardRegex:"gc{2}g{2}c",reverseRegex:"gc{2}g{2}c",topSnipOffset:3,bottomSnipOffset:3},{aliases:["AflIV","BstMI","Uba1158I","LlaDI","VchO49I","NmeSI","PinI","Asp763I","BsoSI","Uba1094I","BshHI"],site:"agtact",forwardRegex:"agtact",reverseRegex:"agtact",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco190I","Uba1280I","Uba1347I","RshII","BspJ67I","Uba1424I","Uba1423I","SflHK11086I","Asp1I","SflHK11087I","BspF105I","SflHK10695I","Uba1372I","Uba1370I","Tmu1I","Uba1378I","Uba1401I","Uba1376I","Uba1389I","Bsp55I","SflHK11572I","HgiS21I","Uba1318I","Pae181I","Eco179I","UbaN11I","Eco121I","Hin3I","Bsp7I","Bsp8I","SflHK115731I","Uba42I","Uba41I","EciDI","Ssp2I"],site:"ccsgg",forwardRegex:"c{2}[cgs]g{2}",reverseRegex:"c{2}[cgs]g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AgeI","CsiAI","AsiAI","AsiGI","PinAI","BshTI","CspAI"],site:"accggt",forwardRegex:"ac{2}g{2}t",reverseRegex:"ac{2}g{2}t",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BtsI"],site:"gcagtg",forwardRegex:"gcagtg",reverseRegex:"cactgc",topSnipOffset:8,bottomSnipOffset:6,isType2S:!0},{aliases:["SteI","Eco147I","StuI","PceI","AatI","SarI","Pme55I","GdiI","Sru30DI","SseBI","Eco1524I","AspMI"],site:"aggcct",forwardRegex:"ag{2}c{2}t",reverseRegex:"ag{2}c{2}t",topSnipOffset:3,bottomSnipOffset:3},{aliases:["HpyF10I","HinS1I","HinS2I","Hin7I","BcaI","HinGUI","Hpy99III","Mho2965I","Csp1470I","MnnIV","CcoP95I","NgoEII"],site:"gcgc",forwardRegex:"gcgc",reverseRegex:"gcgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BceBI","Bsp50I","BtkI","Bpu95I","Csp68KVI","BepI","MvnI","Bsh1236I","AccII","BstFNI","FnuDII","FalII","FauBII","Bsp123I","ThaI","BstUI","BspFNI","Bsu1532I"],site:"cgcg",forwardRegex:"cgcg",reverseRegex:"cgcg",topSnipOffset:2,bottomSnipOffset:2},{aliases:["TspBI","BstDSI","BtgI","DsaI"],site:"ccrygg",forwardRegex:"c{2}[agr][cty]g{2}",reverseRegex:"c{2}[agr][cty]g{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BecAII","BspKI","HaeIII","PlaI","BshFI","BspBRI","BspRI","SuaI","PhoI","Pde133I","SbvI","NgoPII","PalI","PflKI","BteI","SfaI","Bsp211I","DsaII","Bme361I","BsuRI","BshI","BsnI","CltI","NspLKI","MchAII","EsaBC4I","BspANI","FnuDI","BseQI","Bim19II","MfoAI","BanAI","Pru2I"],site:"ggcc",forwardRegex:"g{2}c{2}",reverseRegex:"g{2}c{2}",topSnipOffset:2,bottomSnipOffset:2},{aliases:["CceI","Bsp116I","HpyF43I","Uba1355I","Asp748I","M.Csp68KIV","Uba1128I","Uba1267I","Pme35I","SecII","Uba1141I","Bsp48I","Bsp47I","HpyVIII","BsaZI","FinII","Hin5I","SfaGUI","Msp199I","MniII","Bsu1192I","Uba1338I","Bsp5I","Bsp1591II","BshMI","UbaN13I","Uba1439I"],site:"ccgg",forwardRegex:"c{2}g{2}",reverseRegex:"c{2}g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Cfr10I","Bse634I","BssAI","Bco118I","Bse118I","BstB7SI","BsrFI"],site:"rccggy",forwardRegex:"[agr]c{2}g{2}[cty]",reverseRegex:"[agr]c{2}g{2}[cty]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BseRI"],isType2S:!0,site:"gaggag",forwardRegex:"gag{2}ag",reverseRegex:"ctc{2}tc",topSnipOffset:16,bottomSnipOffset:14},{aliases:["MmaI","XmaII","XorI","ScoAI","VpaK29AI","XveI","Pph2066I","Asp708I","Bsp43I","Uba1399I","Eco161I","Eco83I","BloHIII","Eco167I","Uba1184I","BsaQI","Pma44I","MkrI","Ali2882I","Uba1232I","Asp36I","Pph2059I","Ecl133I","EaePI","SkaII","Bsp268I","Psp28I","Uba1115I","PmaI","Uba1116I","Ssp12I","Uba1112I","Bth9411I","Uba46I","Bsp17I","Uba1225I","Uba1294II","Uba1296I","PspSI","Ecl1zI","AinI","Uba1337I","Uba1186I","Uba1119I","SriI","UbaHKBI","Uba1213I","Uba1212I","Uba1211I","Uba1328I","Bsp107I","Uba1215I","Uba1216I","Esp141I","NasI","PmyI","PshEI","Pae24I","Pae25I","Pae22I","Ecl593I","Pae26I","Pfl37I","Uba1287I","BbiI","ClcI","Bsp108I","MauI","VchO87I","Bsp81I","BspS122I","VpaK4AI","VpaK4BI","Pae14I","Pae15I","Uba1123I","GseII","Kpn12I","SgiI","Ecl699kI","Ecl77I","Uba1411I","Srl32DI","Bsp93I","Uba1417I","XorKII","Esp5II","Eco260I","Eco261I","Srl2DI","Uba1262I","Pae40I","Pae41I","YenDI","YenEI","YenBI","YenCI","Eco49I","YenAI","BscDI","TspGWII","Eco48I","Msp11I","VpaKutGI","AspTI","Pae39I","BsaNII","Srl1DI","Uba1256I","CauIII","Sal13I","Uba1149I","Bsp78I","Bce170I","Pae9I","Pae8I","Uba72I","Psp46I","Uba71I","BmeBI","SprLI","NgbI","NocI","XphI","MizI"],site:"ctgcag",forwardRegex:"ctgcag",reverseRegex:"ctgcag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco32I","HpyCI","HjaI","EcoRV","CeqI","NsiCI"],site:"gatatc",forwardRegex:"gatatc",reverseRegex:"gatatc",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BspBS31I","BbsI","Bbv16II","BpiI","BstV2I","BspTS514I","BspIS4I","BstBS32I","Bsc91I","BbvII","BstTS5I","BpuAI"],isType2S:!0,site:"gaagac",forwardRegex:"ga{2}gac",reverseRegex:"gtct{2}c",topSnipOffset:8,bottomSnipOffset:12},{aliases:["BspJ64I","HpyHPK5II","Ssu212I","Ssu211I","R2.Ssu4109I","TrsSI","M.PhaTDam","Uba1204I","Bst1274I","NlaDI","TrsTI","M.Kpn43816Dam","UbaN1I","CtyI","Bth1997I","Bth1786I","AsuMBI","Mel7JI","Ssu220I","NciAI","BfiSHI","M.EcoT2Dam","SauCI","M.Ssp6803Dam","R1.Ssu11318I","SalAI","Bsp122I","SauFI","M.CjeEDam","SauGI","MspBI","SauDI","SauEI","Uba59I","SalHI","Msp67II","NmeAII","Bth1140I","BsmXII","Bth1141I","EsaLHCI","SsuRBI","NsuDI","NgoDXIV","Bsp91I","Bsp61I","Bsp60I","R2.SsuDAT1I","M.SmaII","NsiAI","Bsp65I","Bsp135I","Bsp64I","R1.SsuDAT1I","HpyAIII","Mel5TI","BthCanI","Bsp138I","Mel5OI","Bsp136I","Bsp66I","FtnUIV","BstEIII","Bth211I","Mel5JI","SinMI","M.HinHP1Dam","M.EcoEc67Dam","M.FspVDam","CcoP31I","R2.Ssu4961I","Bth84I","Cte1179I","PfaI","TruII","Uba1259I","Bsp72I","Bsp74I","Bsp147I","FnuAII","Bsp76I","Cte1180I","NflI","CdiCD6II","R1.Ssu4961I","Mel4OI","CcoP95II","Sau6782I","Bth221I","Uba1366I","Bth213I","M.HindDam","CpaPI","Mmu5I","Rlu1I","Bme2494I","BspI","CviHI","NanII","MnoIII","Sau15I","Mel3JI","R1.Ssu8074I","M.YpsADam","TdeI","BsrMI","Uba1317I","Vha44I","Bsp49I","M.HinHP2Dam","M.CviBII","R1.Ssu2479I","MthI","BsrPII","M.VvuDam","Pph288I","LlaDCHI","Tsp133I","Uba1183I","Pei9403I","Uba1182I","SmiMBI","M.StyDam","M.TpaI","M.PmuADam","MjaIII","Bth945I","Mel2TI","BsaPI","BssGII","M.NmaPhiCh1I","BtcI","Btu41I","NmeBL859I","Bsp58I","Bsp59I","M.CjeNIII","Bsp57I","Bsp54I","MmeII","Bsp52I","M.PgiI","Bsp51I","Uba1177I","NspAI","NflBI","Lsp1109II","M.EcoT1Dam","CcoP219I","Mth1047I","LlaKR2I","Cin1467I","CcoP76I","Gst1588II","M.EcoVT2Dam","NmuEI","R2.Ssu8074I","MmuP2I","Bsp18I","NmuDI","R1.Ssu4109I","Btu34I","R2.Ssu2479I","Uba4I","Btu33I","MosI","TrsKTI","Btu39I","Btu36I","M.EcoT4Dam","CjeP338I","M.Sty14028Dam","M.VchK139I","Bsp9I","Btu37I","NsuI","Uba1101I","Csp5I","R2.Ssu11318I","M.EcoP1Dam","M.StyLT2Dam","CcoP84I","Uba1323I","MeuI","M.EcoKDam","BstXII","CpfAI","M.PmuDam","Mph1103II","NflAII","MthAI"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SmaAIII","EclJI","Pvu84I","Uba1129I","XorKI","DrdIII","Uba1139I","BmaDI","BmaCI","BmaBI","Cfr51I","RspI","Xgl3220I","Kpl79I","Xgl3216I","BmaI","XniI","Xgl3219I","Xgl3218I","Xgl3217I","PntI","BstZ8I","BmaAI","SplAIII","SpaPII","Cas2I","XmlAI","XmlI"],site:"cgatcg",forwardRegex:"cgatcg",reverseRegex:"cgatcg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BthII","Bth617I","BsrWI","BpuFI","Ral8I"],site:"ggatc",forwardRegex:"g{2}atc",reverseRegex:"gatc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BfuAI","BspMI","Acc36I","BveI"],isType2S:!0,site:"acctgc",forwardRegex:"ac{2}tgc",reverseRegex:"gcag{2}t",topSnipOffset:10,bottomSnipOffset:14},{aliases:["Bst2BI","BssSI","BsiI","BauI"],site:"cacgag",forwardRegex:"cacgag",reverseRegex:"ctcgtg",topSnipOffset:1,bottomSnipOffset:5},{aliases:["NmuFI","Afa24RI","ApeAI","RluI","SaoI","AmeII","NasWI","AniMI","NmuI","Srl77DI","Esp5I","NspWI","Smo40529I","SkaI","MisI","PglI","Mlu9273II","NtaSII","NbrI","NbaI","BheI","Psp61I","AprI","SacAI","MauAI","SauAI","SalCI","Uba1122I"],site:"gccggc",forwardRegex:"gc{2}g{2}c",reverseRegex:"gc{2}g{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BthI","DdeII","PflNI","BbiIII","McaI","ScuI","PflWI","Pfl67I","Uba1237I","Uba1397I","SluI","Uba1166I","MecI","Sca1827I","Asp703I","Uba1248I","SdiAI","Sfu1762I","Msp23II","AhyAI","Psp4I","Asp15I","PspNI","Ssp4I","Uba1298I","Uba1448I","CjaI","Uba1335I","Sph1719I","DrdDI","SgoI","MpuI","Bsp92I","Sve194I","BadI","Uba1271I","MhaI","SpaI","Bsp129I","SgaI","AlwFII","Shy1766I","OcoI","AerAI","Uba1130I","BbfI","StaAI","Asp47I","Sgr1841I","Bsp140I","Bsp141I","SrifpI","Bsp142I","MrhI","BsuMI","SciBI","Uba1148I","Sci1831I","Eae2I","MscAI","Sal1974I","Uba1154I","SexI","BstLI","MsiI","BstHI","Bsp139I"],site:"ctcgag",forwardRegex:"ctcgag",reverseRegex:"ctcgag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Uba1382I","Uba1415I"],site:"gaatgc",forwardRegex:"ga{2}tgc",reverseRegex:"gcat{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco97I","Eco95I","Bli161I","Eco120I","Eco127I","Eco233I","Eco185I","Eco217I","Eco225I","Eco203I","Eco156I","Eco204I","Eco155I","Eco205I","Eco157I","PpaI","Eco162I","Uba1316I","SlbI","Eco129I","Sau12I","Eco51I","Bli49I","Bli5508I","Cfr56I","VpaKutHI","Eco71KI","Eco42I","VpaK57AI","Uba84I","Rle69I","Eco263I","Eco101I","VpaK57I","Uba1343I","Bli576II","Eco191I","Uba65I","Eco239I","Eco246I","Eco247I","Eco240I","Eco241I"],site:"ggtctc",forwardRegex:"g{2}tctc",reverseRegex:"gagac{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BmrI","BfiI","BmuI"],isType2S:!0,site:"actggg",forwardRegex:"actg{3}",reverseRegex:"c{3}agt",topSnipOffset:11,bottomSnipOffset:10},{aliases:["BstRZ246I","MspSWI","BstSWI","SmiI","SwaI"],site:"atttaaat",forwardRegex:"at{3}a{3}t",reverseRegex:"at{3}a{3}t",topSnipOffset:4,bottomSnipOffset:4},{aliases:["Srl76DI","Srl19I","Srl61DI"],site:"tttaaa",forwardRegex:"t{3}a{3}",reverseRegex:"t{3}a{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Tsp32I","Tsp32II","TaqI","PpaAII","TthHB8I"],site:"tcga",forwardRegex:"tcga",reverseRegex:"tcga",topSnipOffset:1,bottomSnipOffset:3},{aliases:["EcoPI"],isType2S:!0,site:"agacc",forwardRegex:"agac{2}",reverseRegex:"g{2}tct",topSnipOffset:30,bottomSnipOffset:32},{aliases:["OmiBII","DsaVI"],site:"gtmkac",forwardRegex:"gt[acm][gkt]ac",reverseRegex:"gt[acm][gkt]ac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BpuSI","BspLU11III","BstOZ616I","BslFI","FaqI","BsmFI"],isType2S:!0,site:"gggac",forwardRegex:"g{3}ac",reverseRegex:"gtc{3}",topSnipOffset:15,bottomSnipOffset:19},{aliases:["BspJ105I","VpaK13AI","Uba1314I","GspAI","Uba1249I","PolI","VpaK7AI","NspDII","BceSII","MliI","VpaK11DI","AspBII","VpaK11I","NspGI","BtiI","NspKI","VpaK11CI","Uba1304I","Bsp1260I","MfoI","Uba48I","UbaN15I","NmuAII","Uba1438I","Bsp100I","Tsp301I","BspF53I","Uba62I","ClmII","VpaK65I","AspDII","NspHII","Sgh1835I","Uba1131I","CliI","Asp697I","Uba1413I","Nli3877II","Uba1278I","Uba1272I","Bsp128I","NliII","MspAI","Bst4QI","SfnI","Uth554I","Uba1373I","Tru28I","Pfl19I","SinJI","SinHI","SinGI","SinFI","SinEI","SinDI","SinCI","SinBI","SinAI","Bsp133I","Bsp132I","SynI","TruI","Hsp2I","Bsp71I"],site:"ggwcc",forwardRegex:"g{2}[atw]c{2}",reverseRegex:"g{2}[atw]c{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NtaSI","Uba1180I","SsvI","Uba1239I","Uba1170I","Ppu13I","VchO44I","ChyI","GobAI","Uba1217I","PluI","Uba40I","Uba1419I","Asp78I","Uba1371I","Uba1403I"],site:"aggcct",forwardRegex:"ag{2}c{2}t",reverseRegex:"ag{2}c{2}t",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BseGI","BstF5I","BtsCI"],site:"ggatg",forwardRegex:"g{2}atg",reverseRegex:"catc{2}",topSnipOffset:7,bottomSnipOffset:5,isType2S:!0},{aliases:["AvrII","AspA2I","XmaJI","BlnI","AvrBII","BspA2I"],site:"cctagg",forwardRegex:"c{2}tag{2}",reverseRegex:"c{2}tag{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BspKT8I","SsbI","BspLAIII","LlaCI","BstFI","HindIII","HsuI","BbrI","EcoVIII"],site:"aagctt",forwardRegex:"a{2}gct{2}",reverseRegex:"a{2}gct{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["NsbI","Acc16I","PamI","Pun14627I","MstI","AosI","FspI","AviII","FdiII"],site:"tgcgca",forwardRegex:"tgcgca",reverseRegex:"tgcgca",topSnipOffset:3,bottomSnipOffset:3},{aliases:["Ecl136II","BpuAmI","MxaI","Eco53kI","EcoICRI"],site:"gagctc",forwardRegex:"gagctc",reverseRegex:"gagctc",topSnipOffset:3,bottomSnipOffset:3},{aliases:["TtmI","TspWAM8AI","HpyF74II","HpyF35II","TspIDSI","HpyF13III"],site:"acgt",forwardRegex:"acgt",reverseRegex:"acgt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BseZI","Ksp632I","EarI","Eam1104I","Bsu6I","Bst6I","CatHI","Bco116I","Bco5I","BcoKI"],isType2S:!0,site:"ctcttc",forwardRegex:"ctct{2}c",reverseRegex:"ga{2}gag",topSnipOffset:7,bottomSnipOffset:10},{aliases:["Msp24I","BsaSI","HpyF73IV","MjaII","VpaK15I","TdeIII","Sau557I","Sau17I","GseI","Bfi105I","Eco201I","CfrNI","Sau13I","Sau14I","Bse54I","Eco196II","VpaK25I","Uba1164I","NlaDII","Cfr4I","Cfr8I","CdiCD6I","AhaB1I","MthBI","Pph1579I","Pph1773I","Hin5II","Sau32I","VpaK9AI","Sau33I","Uba1099I","NmuSI","SauBI","VchO85I","Sau5I","Cfr33I","Eco39I","Sau2I","ApuI","VchO90I","PspI","Uba1134I","BpsI","Cfr23I","MhoI","PseI","Eco47II","HpyF71II","VpaK19AI","VpaK19BI","SdyI","NmuEII","Cfr52I","Cfr54I","NspLII","VpaKutBI","CdiAI","VpaKutAI","Bsu5044I","HpyF66I","SelAI","Cfr46I","Cfr47I","Cfr45I","Uba1160I","VchO66I","VpaKutJI"],site:"ggncc",forwardRegex:"g{2}[abcdghkmnrstvwy]c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]c{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Cpa1150I","PflAI","TmaI","BceRI","FspMI","MvaAI","Uba1446I","Bsu1193I","EsaBS9I","HpyF52II","Bsu1192II","HpyF14I","HpyF15I","Uba1321I","HpyF64IV","SceAI","HpyF26I","BspJ76I","Bce31293I","BsuEII","Hin1056I","Uba1405I","Uba1404I","Bsu6633I","CpaAI","Bsp70I"],site:"cgcg",forwardRegex:"cgcg",reverseRegex:"cgcg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TseI","ApeKI","AceI","Taq52I","SuiI"],site:"gcwgc",forwardRegex:"gc[atw]gc",reverseRegex:"gc[atw]gc",topSnipOffset:1,bottomSnipOffset:4},{aliases:["Asp27HI","Asp26HI","PctI","Asp40HI","BsaMI","BscCI","BsmI","BmaHI","Mva1269I","Asp50HI","Asp36HI","Asp35HI"],site:"gaatgc",forwardRegex:"ga{2}tgc",reverseRegex:"gcat{2}c",topSnipOffset:7,bottomSnipOffset:5},{aliases:["Uba51I","M.BamHII","Uba1414I","Uba1346I","Bsu8646I","AcaII","SpvI","BamNI","GdoI","UbaN3I","BamKI","Uba1205I","BamFI","BsuB519I","Bst2902I","Rlu4I","Ali12257I","Ali12258I","Uba1250I","RhsI","Psp56I","Uba1258I","Bsp144I","AinII","Bco10278I","Uba88I","Uba1402I","Bca1259I","Bsp90II","Bsp131I","Bsp130I","BstQI","MleI","Uba1383I","Uba1302I","GinI","Uba19I","Bst2464I","Uba1167I","GseIII","Uba1163I","BsaDI","Pac1110I","Bsp46I","Uba1398I","Uba1173I","Uba1242I","Uba1172I","NasBI","UbaN14I","GoxI","AaeI","Uba31I","DdsI","Uba1324I","Bsp30I","Uba1325I","AspTII","Uba38I","AacLI","Pae177I","Uba1098I","BsuB763I","Uba1339I","Uba1297I","Uba1334I","Bst1126I","Uba1224I","Atu1II","Bsu8565I","Bsu90I"],site:"ggatcc",forwardRegex:"g{2}atc{2}",reverseRegex:"g{2}atc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SpaPIII","PvuHKUI","MziI","SciAII","SplAIV","Sol3335I","Bth2350I","GspI","Uba1245I","Uba1227I","SmaAIV","Psp3I","SbaI","Psp5I"],site:"cagctg",forwardRegex:"cagctg",reverseRegex:"cagctg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BspZEI","BscI","Bsa29I","PgaI","BspOVII","ClaI","BseCI","Bli41I","BavCI","BciBI","LplI","SpmI","Ssp27144I","ZhoI","BspDI","BanIII","BsuTUI","BshVI","BspXI","BstNZ169I","Bsu15I","BspJII","AagI","Bsp106I","Bli86I","BliAI","Bst28I","BbvAII","BsiXI","BcmI","BliRI","Bci29I","LcaI","Rme21I","BdiI"],site:"atcgat",forwardRegex:"atcgat",reverseRegex:"atcgat",topSnipOffset:2,bottomSnipOffset:4},{aliases:["BspJ74I","Bco35I","Bth1795I","Uba1444I","Bsp22I","Bsp28I","Uba1437I"],site:"ctggag",forwardRegex:"ctg{2}ag",reverseRegex:"ctc{2}ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SolI","Bsp98I","Bce751I","Uba4009I","BamHI","RspLKII","SurI","BstI","OkrAI","ApaCI","Nsp29132II","BspAAIII","CelI","AliI","AsiI","GstI","Mlu23I","NspSAIV","Pfl8I","BnaI","AccEBI","Bsp4009I"],site:"ggatcc",forwardRegex:"g{2}atc{2}",reverseRegex:"g{2}atc{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["M.NgoHVIII","NgoMVIII","NgoJVIII","NgoBVIII","NgoDVIII"],site:"ggtga",forwardRegex:"g{2}tga",reverseRegex:"tcac{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF13I","HpyF1I","HpyF4I","HpyF6II","HpyF9I","HpyF31II","HpyF49II","HpyF51I","HpyF34II","HpyF48I","HpyF62III","HpyF40III","HpyF25II","Hpy99II","Hpy8II","HpyF35IV","HpyF36I"],site:"gtsac",forwardRegex:"gt[cgs]ac",reverseRegex:"gt[cgs]ac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PsyI","BgiI","TelI","Tth111I","AspI","PflFI","AtsI"],site:"gacnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{3}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{3}gtc",topSnipOffset:4,bottomSnipOffset:5},{aliases:["PfaAI","AccB1I","HgiHI","HgiCI","BspT107I","MspB4I","BanI","BshNI","Eco64I","BbvBI"],site:"ggyrcc",forwardRegex:"g{2}[cty][agr]c{2}",reverseRegex:"g{2}[cty][agr]c{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BspMAI","CflI","Psp23I","BspBI","AliAJI","Srl5DI","MhaAI","CfrA4I","Ecl2zI","AjoI","Sag16I","PstI","Sag23I","Ecl37kI","Pfl21I","ApiI","Sst12I","SalPI","CstI","YenI","Bsp63I","BloHII","CfuII","PaePI","SflI","HalII","BsuBI","Asp713I"],site:"ctgcag",forwardRegex:"ctgcag",reverseRegex:"ctgcag",topSnipOffset:5,bottomSnipOffset:1},{aliases:["SvoI","PsuNI"],site:"crccggyg",forwardRegex:"c[agr]c{2}g{2}[cty]g",reverseRegex:"c[agr]c{2}g{2}[cty]g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SphI","BbuI","PaeI","SpaHI","RspLKI","PfaAIII"],site:"gcatgc",forwardRegex:"gcatgc",reverseRegex:"gcatgc",topSnipOffset:5,bottomSnipOffset:1},{aliases:["PspN4I","BspLI","BmiI","AspNI","BscBI","NlaIV"],site:"ggnncc",forwardRegex:"g{2}[abcdghkmnrstvwy]{2}c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]{2}c{2}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["HpyHPK5I","HpyF32I","HpyF34I","HpyHI","HpyF25I","HpyF27I","HpyF24II","HpyF37I","HpyF13II","HpyF60II","HpyF59I","HpyF68II","HpyF4II","Bpa36II","HpyF67I","HpyF41II","HpyF64V","Bst295I","BscPI","HpyF70I","HpyF5I","HpyF7I","HpyF66II","HpyF6III","HpyF72II","HpyF30II","HpyF11I","HpyF19I","HpyF22II","HpyCH4II","HpyF9II","HpyF21I"],site:"ctnag",forwardRegex:"ct[abcdghkmnrstvwy]ag",reverseRegex:"ct[abcdghkmnrstvwy]ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF51II","HpyF74I","HpyF42II","HpyF35III","HpyF9III","HpyF64II","HpyF20I","HpyF22I","HpyF12I","HpyF41I","HpyF40I","HpyF46I","HpyF56I","HpyF58I","HpyF55I","HpyF54I","HpyF5II","HpyF48II","HpyF69I","HpyF68I","HpyF65I","HpyF62I"],site:"acngt",forwardRegex:"ac[abcdghkmnrstvwy]gt",reverseRegex:"ac[abcdghkmnrstvwy]gt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF15II","HpyF17I","HpyF64III","HpyF50II","HpyF61I","HpyF11II","HpyF27II","HpyF12II","HpyF46IV","Hpy166I","HpyF42III","HpyF33I","HpyF28I","HpyF19II"],site:"tcnga",forwardRegex:"tc[abcdghkmnrstvwy]ga",reverseRegex:"tc[abcdghkmnrstvwy]ga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EclRI","TspMI","Pac25I","XmaCI","EaeAI","AhyI","XmaI","Cfr9I","PspAI","XcyI"],site:"cccggg",forwardRegex:"c{3}g{3}",reverseRegex:"c{3}g{3}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["XapI","CfaI","FsiI","ApoI","AcsI"],site:"raatty",forwardRegex:"[agr]a{2}t{2}[cty]",reverseRegex:"[agr]a{2}t{2}[cty]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["SenPI","HpyNI","Bsp548I","LlaMI","Eco51II","Eco43I","BsoI","Bsp73I","Eco200I","Eco85I","BsaCI","Eco80I","Uba17I","Uba1391I","Eco153I","Bsp53I","Eco93I"],site:"ccngg",forwardRegex:"c{2}[abcdghkmnrstvwy]g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Tsp49I","TaiI","TscI"],site:"acgt",forwardRegex:"acgt",reverseRegex:"acgt",topSnipOffset:4,bottomSnipOffset:0},{aliases:["DraII","EcoO109I"],site:"rggnccy",forwardRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",reverseRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",topSnipOffset:2,bottomSnipOffset:5},{aliases:["Ssp34I","AcaI","Bsp151I","Uba1452I","Ssp48I","Ssp47I","BpuHI","NspJI","Uba1385I","Rma376I","NspFI","Ssp45I","NspBI","Ssp42I","Ssp43I","Ssp14I","Psc27I","Psc28I","BspH22I","Afl83I","Bsp101I","Ssp152I","Bsp102I","Bsp104I","Mva16I","Bsp241I","Rma523I","Bsp82I","Sgr1839I","OspI","Bsp90I","AviI","BspH106I","BspH103I","Bsp148I","Nsp29132I"],site:"ttcgaa",forwardRegex:"t{2}cga{2}",reverseRegex:"t{2}cga{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CjuII"],site:"caynnnnnctc",forwardRegex:"ca[cty][abcdghkmnrstvwy]{5}ctc",reverseRegex:"gag[abcdghkmnrstvwy]{5}[agr]tg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaN6II","BstNSII","Bst7QI","AspDI","AspBI","AvrI","EspHK29I","NspDI","NspEI","AcrI","Uba1205II","Gst1588I","BstZ4I","Uba1436I","BstBAII","Umi5I","NliI","NmuAI","Uba1440I"],site:"cycgrg",forwardRegex:"c[cty]cg[agr]g",reverseRegex:"c[cty]cg[agr]g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AdeI","DraIII","BstIZ316I"],site:"cacnnngtg",forwardRegex:"cac[abcdghkmnrstvwy]{3}gtg",reverseRegex:"cac[abcdghkmnrstvwy]{3}gtg",topSnipOffset:6,bottomSnipOffset:3},{aliases:["Uba153AI","BavAI","BavBI","BspO4I","BamGI","BavI","EclI","Pvu84II","BspM39I","UbaM39I","NmeRI","PvuII","DmaI","Bsp153AI","Pun14627II","Cfr6I","Pae17kI"],site:"cagctg",forwardRegex:"cagctg",reverseRegex:"cagctg",topSnipOffset:3,bottomSnipOffset:3},{aliases:["Ava458I","Cfr38I","Cfr39I","KspHK15I","Cfr40I","EspHK24I","Cfr55I","EcoHAI","Cfr59I","Eco164I","EspHK16I","Uba1188I","EciBI","Eco90I","Uba1327I","Cfr14I","Uba36I"],site:"yggccr",forwardRegex:"[cty]g{2}c{2}[agr]",reverseRegex:"[cty]g{2}c{2}[agr]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MchAI","CspBI","NotI","CsiBI","CciNI"],site:"gcggccgc",forwardRegex:"gcg{2}c{2}gc",reverseRegex:"gcg{2}c{2}gc",topSnipOffset:2,bottomSnipOffset:6},{aliases:["BscKI","Rtr20I","BspVI","Bco102II","BsaVI"],site:"gaagac",forwardRegex:"ga{2}gac",reverseRegex:"gtct{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AspMDI","BfuCI","NlaII","HacI","CcyI","FnuEI","FnuCI","NdeII","RalF40I","BstMBI","Sth368I","SauMI","Kzo9I","MgoI","MboI","NphI","Bsp67I","BscFI","LlaAI","Bsp143I","DpnII","CviAI","Bme12I","PbrTI","CpfI","NmeCI","SsiBI","SsiAI","Bfi57I","Bst19II","BstENII","BssMI","MkrAI","BspAI","BspFI","BtkII","BspJI","CacI","Bsp2095I","BspKMI","Sau3AI","Bce243I","Bsp105I"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:0,bottomSnipOffset:4},{aliases:["EcoprrI"],site:"ccannnnnnnrtgc",forwardRegex:"c{2}a[abcdghkmnrstvwy]{7}[agr]tgc",reverseRegex:"gca[cty][abcdghkmnrstvwy]{7}tg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Cfr48I","Ese4I","BscMI","Uba1409I","Eco262I","Uba1159I","Uba1264I","Uba1263I","Uba1363I","Uba1142I","Uba1357I","Uba1421I","Eco26I","Eco25I","Bsp117I","Uba1206I","Eco249I","Eco35I","Uba57I","Uba1124I","OmiAI","OmiBI","Eco113I","Eco215I","Eco216I","Eco180I","Uba1330I","EcoT88I","Uba1329I","Ppu20I","Eco232I","Uba39I","BstZ7I","Uba1307I","EcoT95I","EcoT93I","Eco68I","Psp31I","Eco211I"],site:"grgcyc",forwardRegex:"g[agr]gc[cty]c",reverseRegex:"g[agr]gc[cty]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PaeR7I","PanI","BluI","BssHI","TliI","Sol10179I","StrI","SauLPII","SlaI","AbrI","Sfr274I","EscI","Sbi68I","Sau3239I","MavI","CcrI","BspAAI","MlaAI","XpaI","BstVI","XhoI"],site:"ctcgag",forwardRegex:"ctcgag",reverseRegex:"ctcgag",topSnipOffset:1,bottomSnipOffset:5},{aliases:["MchI","Mly113I","NarI","NunII","SseAI","NdaI"],site:"ggcgcc",forwardRegex:"g{2}cgc{2}",reverseRegex:"g{2}cgc{2}",topSnipOffset:2,bottomSnipOffset:4},{aliases:["EgeI","Eco78I","DinI","SfoI","EheI"],site:"ggcgcc",forwardRegex:"g{2}cgc{2}",reverseRegex:"g{2}cgc{2}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["M.AtuCI","HpyF72III","HpyF38I","HpyF44I","HpyAIV","M.BabI","HpyF55II","HpyF2II","HpyIV","NcaI","NsiHI","HpyF60I","CviEI","CviFI","CviCI","M.SmeI","CviDI","CviGI","HpyF10II","HpyF71III","Hpy87AI","HpyF18I","NovII"],site:"gantc",forwardRegex:"ga[abcdghkmnrstvwy]tc",reverseRegex:"ga[abcdghkmnrstvwy]tc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bsp6I","SatI","Uur960I","ItaI","Fsp4HI","Fnu4HI","BisI","FbrI","GluI","BsoFI"],site:"gcngc",forwardRegex:"gc[abcdghkmnrstvwy]gc",reverseRegex:"gc[abcdghkmnrstvwy]gc",topSnipOffset:2,bottomSnipOffset:3},{aliases:["BsoDI","Tsp504I","TauII"],site:"cggccg",forwardRegex:"cg{2}c{2}g",reverseRegex:"cg{2}c{2}g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Hpy178II","TceI","HpyAII","HpyII"],site:"gaaga",forwardRegex:"ga{2}ga",reverseRegex:"tct{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PfeI","TfiI"],site:"gawtc",forwardRegex:"ga[atw]tc",reverseRegex:"ga[atw]tc",topSnipOffset:1,bottomSnipOffset:4},{aliases:["NspIII","BsoBI","AvaI","PunAI","NspSAI","BstSI","BcoI","BmeT110I","PlaAI","Bse15I","OfoI","AquI","Eco88I","BspLU4I","Ama87I","Eco27kI","BsiHKCI"],site:"cycgrg",forwardRegex:"c[cty]cg[agr]g",reverseRegex:"c[cty]cg[agr]g",topSnipOffset:1,bottomSnipOffset:5},{aliases:["SdeAI"],site:"cagrag",forwardRegex:"cag[agr]ag",reverseRegex:"ct[cty]ctg",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["BcoDI","BsoMAI","BsmAI","Alw26I","BstMAI"],site:"gtctc",forwardRegex:"gtctc",reverseRegex:"gagac",topSnipOffset:6,bottomSnipOffset:10,isType2S:!0},{aliases:["SauHI","Uba1294I","BseG73I","Uba1184II","PxyMZI","AsuSAI","SecIII","Bli643I","Eco76I","Bst29I","Eco110kI","BstZ6I","Eco118I","Bst30I","EciCI","Eco115I","Uba1333I","Uba1332I"],site:"cctnagg",forwardRegex:"c{2}t[abcdghkmnrstvwy]ag{2}",reverseRegex:"c{2}t[abcdghkmnrstvwy]ag{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF44IV","HpyCH4VI","HpyF16II","HpyF22III","HpyF19III","HpyNSH57II"],site:"tcnnga",forwardRegex:"tc[abcdghkmnrstvwy]{2}ga",reverseRegex:"tc[abcdghkmnrstvwy]{2}ga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["OtuI","MarI","OtuNI","Uba1433I","Uba1441I","Mho2111I","BsaLI","OxaI"],site:"agct",forwardRegex:"agct",reverseRegex:"agct",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BfoI","Bsp143II","BstH2I","AccB2I","HaeII"],site:"rgcgcy",forwardRegex:"[agr]gcgc[cty]",reverseRegex:"[agr]gcgc[cty]",topSnipOffset:5,bottomSnipOffset:1},{aliases:["Eco57I","BspKT5I","AcuI"],site:"ctgaag",forwardRegex:"ctga{2}g",reverseRegex:"ct{2}cag",topSnipOffset:22,bottomSnipOffset:20,isType2S:!0},{aliases:["Uba1276I","TdeII","VpaO5I","Bst158I","UbaN7I","BcrAI","VpaKutEI","VpaKutFI","BsrEI","Uba1192I","BcoSI"],site:"ctcttc",forwardRegex:"ctct{2}c",reverseRegex:"ga{2}gag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SsoII","StyD4I","BstSCI","Eco137kI","Ecl18kI","BstMZ611I","Eco13kI","BssKI","DsaV","Eco21kI","Kpn2kI"],site:"ccngg",forwardRegex:"c{2}[abcdghkmnrstvwy]g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]g{2}",topSnipOffset:0,bottomSnipOffset:5},{aliases:["BsmXI","BsmDI","BsmCI"],site:"acnnnnnctcc",forwardRegex:"ac[abcdghkmnrstvwy]{5}ctc{2}",reverseRegex:"g{2}ag[abcdghkmnrstvwy]{5}gt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Uba1426I","Uba1420I","TrsTII","Uba1374I","BscLI","Uba1266I","VfiI","BsaFI","Uba1313I","Uba1312I","Uba1299I","Uba1331I","Uba1443I","Cfr92I"],site:"cttaag",forwardRegex:"ct{2}a{2}g",reverseRegex:"ct{2}a{2}g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcaI","BstEII","AspAI","Eci125I","BstT9I","Bse64I","AcrII","BstPI","BseT9I","NspSAII","BsiKI","EcoO128I","BstT10I","Eco91I","BseT10I","EcoO65I","PspEI"],site:"ggtnacc",forwardRegex:"g{2}t[abcdghkmnrstvwy]ac{2}",reverseRegex:"g{2}t[abcdghkmnrstvwy]ac{2}",topSnipOffset:1,bottomSnipOffset:6},{aliases:["HpyAV","Hin4II"],site:"ccttc",forwardRegex:"c{2}t{2}c",reverseRegex:"ga{2}g{2}",topSnipOffset:11,bottomSnipOffset:10,isType2S:!0},{aliases:["BseII","BsaKI","Uba1408II","MwhI"],site:"gttaac",forwardRegex:"gt{2}a{2}c",reverseRegex:"gt{2}a{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Sse8387I","SdaI","SbfI"],site:"cctgcagg",forwardRegex:"c{2}tgcag{2}",reverseRegex:"c{2}tgcag{2}",topSnipOffset:6,bottomSnipOffset:2},{aliases:["SacII","CscI","SpuI","PaeAI","GceI","SchZI","SstII","Cfr42I","PaeQI","Eae46I","Pae14kI","RaqI","Mpr154I","GalI","NgoAIII","GceGLI","Eco29kI","Sfr303I","Pae5kI","NgoPIII","SenPT14bI","SgrBI","KspI","SexBI","SexCI","Kpn378I"],site:"ccgcgg",forwardRegex:"c{2}gcg{2}",reverseRegex:"c{2}gcg{2}",topSnipOffset:4,bottomSnipOffset:2},{aliases:["BpuNI","FinI","BscWI"],site:"gggac",forwardRegex:"g{3}ac",reverseRegex:"gtc{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Uba1431I","SseI","Umi7I","Uba1447I","PovI","CpeI","BceDI","BmeTI","Bco102I","AtuSI","M.TaeII","Bst77I","BstKI","BstGI","SstIV","Uba1282I","CthI","Uba1283I","BstZ10II"],site:"tgatca",forwardRegex:"tgatca",reverseRegex:"tgatca",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MaeIII"],site:"gtnac",forwardRegex:"gt[abcdghkmnrstvwy]ac",reverseRegex:"gt[abcdghkmnrstvwy]ac",topSnipOffset:0,bottomSnipOffset:5},{aliases:["Eco646I","Eco1341I","Eco1413I","Eco1432I","Eco1424I","Eco1422I","Eco1383I"],site:"ccannnnnnncttc",forwardRegex:"c{2}a[abcdghkmnrstvwy]{7}ct{2}c",reverseRegex:"ga{2}g[abcdghkmnrstvwy]{7}tg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MvaI","Bst1I","Bst2I","BsiLI","CthII","Sth302I","BshGI","BspNI","TaqXI","Bse17I","Bse16I","Bst2UI","Bse24I","Bst38I","SslI","BciBII","AglI","BthDI","BthEI","ApyI","ZanI","CbrI","BstM6I","BptI","AorI","ApaORI","BseBI","Fsp1604I","AeuI","Sth117I","SniI","Bst100I","BstOI","BstNI"],site:"ccwgg",forwardRegex:"c{2}[atw]g{2}",reverseRegex:"c{2}[atw]g{2}",topSnipOffset:2,bottomSnipOffset:3},{aliases:["Bco27I","CboI","MspI","BsuFI","BsiSI","Pde137I","HpaII","Sth134I","Hin2I","Bst40I","HapII","MnoI"],site:"ccgg",forwardRegex:"c{2}g{2}",reverseRegex:"c{2}g{2}",topSnipOffset:1,bottomSnipOffset:3},{aliases:["Uba1368I","Uba1156I","Uba1157I","Uba1202I","EciEI","Psp30I","Uba1165I","Uba1241I"],site:"gggccc",forwardRegex:"g{3}c{3}",reverseRegex:"g{3}c{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SduI","BsoCI","BspLS2I","MhlI","Bsp1286I","BmyI","NspII","AocII"],site:"gdgchc",forwardRegex:"g[adgkrtw]gc[achmtwy]c",reverseRegex:"g[adgkrtw]gc[achmtwy]c",topSnipOffset:5,bottomSnipOffset:1},{aliases:["KspAI","BstEZ359I","BstHPI","SsrI","HpaI"],site:"gttaac",forwardRegex:"gt{2}a{2}c",reverseRegex:"gt{2}a{2}c",topSnipOffset:3,bottomSnipOffset:3},{aliases:["SfiI","SdiI"],site:"ggccnnnnnggcc",forwardRegex:"g{2}c{2}[abcdghkmnrstvwy]{5}g{2}c{2}",reverseRegex:"g{2}c{2}[abcdghkmnrstvwy]{5}g{2}c{2}",topSnipOffset:8,bottomSnipOffset:5},{aliases:["LlaG2I","NheI","PstNHI","AsuNHI"],site:"gctagc",forwardRegex:"gctagc",reverseRegex:"gctagc",topSnipOffset:1,bottomSnipOffset:5},{aliases:["AluBI","AluI","MltI"],site:"agct",forwardRegex:"agct",reverseRegex:"agct",topSnipOffset:2,bottomSnipOffset:2},{aliases:["HpyF49V","HpyF36III","M.CviSI","HpyF48III","HpyJP26I","HpyF38II","HpyF45II","HpyF67II","Hpy26I"],site:"tgca",forwardRegex:"tgca",reverseRegex:"tgca",topSnipOffset:1,bottomSnipOffset:1},{aliases:["DraRI"],site:"caagnac",forwardRegex:"ca{2}g[abcdghkmnrstvwy]ac",reverseRegex:"gt[abcdghkmnrstvwy]ct{2}g",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["Eco1265I","Eco1441I","Eco1443I","Eco1447I","Eco1158I","Eco14444I","EcoBI"],site:"tgannnnnnnntgct",forwardRegex:"tga[abcdghkmnrstvwy]{8}tgct",reverseRegex:"agca[abcdghkmnrstvwy]{8}tca",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BbeAI","PmnI","McaAI","NamI","PatAI","MsaI"],site:"ggcgcc",forwardRegex:"g{2}cgc{2}",reverseRegex:"g{2}cgc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BstC8I","Cac8I"],site:"gcnngc",forwardRegex:"gc[abcdghkmnrstvwy]{2}gc",reverseRegex:"gc[abcdghkmnrstvwy]{2}gc",topSnipOffset:3,bottomSnipOffset:3},{aliases:["EsaBC3I"],site:"tcga",forwardRegex:"tcga",reverseRegex:"tcga",topSnipOffset:2,bottomSnipOffset:2},{aliases:["Pfr12I","AmeI","Bsp146I","Uba1203I","Pfl23I","PliI","AaqI","DaqI","ScoNI","Uba1387I"],site:"gtgcac",forwardRegex:"gtgcac",reverseRegex:"gtgcac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AccIII","PinBII","CauB3I","MroI","Aor13HI","BseAI","Bsp13I","Kpn2I","PtaI","BspEI","Bsu23I","BsiMI","BlfI","BbvAIII","BspMII"],site:"tccgga",forwardRegex:"tc{2}g{2}a",reverseRegex:"tc{2}g{2}a",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Eco1342I","Eco1344I","EcoKI","Eco1394I"],site:"aacnnnnnngtgc",forwardRegex:"a{2}c[abcdghkmnrstvwy]{6}gtgc",reverseRegex:"gcac[abcdghkmnrstvwy]{6}gt{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NgoJI","NgoGI","NgoMI","HinHI","NgoAI","NgoBI","M.NgoEI","NgoCI","NgoWI","Bst16I","Btu34II","Bst1473II","BsmHI"],site:"rgcgcy",forwardRegex:"[agr]gcgc[cty]",reverseRegex:"[agr]gcgc[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MboII","NcuI"],site:"gaaga",forwardRegex:"ga{2}ga",reverseRegex:"tct{2}c",topSnipOffset:13,bottomSnipOffset:12,isType2S:!0},{aliases:["Eco188I","Eco98I","Uba1435I","Hin5III","Uba1219I","UbaN17I","SpaPIV","Eco231I","BstZ1II","Csp231I","Eco65I","HinbIII","ChuEI","Asp52I","Asp3065I","Uba83I","HinfII","MkiI","HinJCII","BsmGII","Hin1076III","HinSAFI","Hin173I","Uba1164II","BseHI","BbrAI","Bst170II","BpeI","Cfr32I"],site:"aagctt",forwardRegex:"a{2}gct{2}",reverseRegex:"a{2}gct{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["StsI"],site:"ggatg",forwardRegex:"g{2}atg",reverseRegex:"catc{2}",topSnipOffset:15,bottomSnipOffset:19,isType2S:!0},{aliases:["BstZ2I","Uba1191I","Uba1190I"],site:"gacnnnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{5}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{5}gtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Hin6I","HinP1I","HsoI","HspAI","SciNI","BbtI"],site:"gcgc",forwardRegex:"gcgc",reverseRegex:"gcgc",topSnipOffset:1,bottomSnipOffset:3},{aliases:["PmdI"],site:"cctcagc",forwardRegex:"c{2}tcagc",reverseRegex:"gctgag{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BcefI"],site:"acggc",forwardRegex:"acg{2}c",reverseRegex:"gc{2}gt",topSnipOffset:17,bottomSnipOffset:18,isType2S:!0},{aliases:["Eco52I","BstZI","EagI","XmaIII","BseX3I","EclXI","AaaI","SenPT16I"],site:"cggccg",forwardRegex:"cg{2}c{2}g",reverseRegex:"cg{2}c{2}g",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BsaJI","SecI","BssECI","BseDI"],site:"ccnngg",forwardRegex:"c{2}[abcdghkmnrstvwy]{2}g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]{2}g{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["CciI","RspXI","BspHI","PagI","RcaI"],site:"tcatga",forwardRegex:"tcatga",reverseRegex:"tcatga",topSnipOffset:1,bottomSnipOffset:5},{aliases:["FseI","RigI"],site:"ggccggcc",forwardRegex:"g{2}c{2}g{2}c{2}",reverseRegex:"g{2}c{2}g{2}c{2}",topSnipOffset:6,bottomSnipOffset:2},{aliases:["BstMWI","HpyF10VI","Bce4I","BceCI","BspWI","MwoI"],site:"gcnnnnnnngc",forwardRegex:"gc[abcdghkmnrstvwy]{7}gc",reverseRegex:"gc[abcdghkmnrstvwy]{7}gc",topSnipOffset:7,bottomSnipOffset:4},{aliases:["HpyF10III","Uba1442I","HpyF67IV","BstZ10I","BsoKI","HpyF61II","Hpy99IV"],site:"ccnngg",forwardRegex:"c{2}[abcdghkmnrstvwy]{2}g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]{2}g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Aor51HI","FunI","Eco47III","AitI","AfeI"],site:"agcgct",forwardRegex:"agcgct",reverseRegex:"agcgct",topSnipOffset:3,bottomSnipOffset:3},{aliases:["MlyI","SchI"],site:"gagtc",forwardRegex:"gagtc",reverseRegex:"gactc",topSnipOffset:10,bottomSnipOffset:10,isType2S:!0},{aliases:["BseB631I","VanI","Bpu86I","Tsp219I","BsoJI"],site:"gccnnnnnggc",forwardRegex:"gc{2}[abcdghkmnrstvwy]{5}g{2}c",reverseRegex:"gc{2}[abcdghkmnrstvwy]{5}g{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bsp120I","PspOMI"],site:"gggccc",forwardRegex:"g{3}c{3}",reverseRegex:"g{3}c{3}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Csp6I","RsaNI","CviRII","CviQI"],site:"gtac",forwardRegex:"gtac",reverseRegex:"gtac",topSnipOffset:1,bottomSnipOffset:3},{aliases:["M.Phi3TI","Cac824I","Bpu1811I","M.NgoBXII","M.Rho11sI","CcoP216I","CcoP215I","Bli1904II","BssFI","BssXI","M.SPBetaI","LlaDII"],site:"gcngc",forwardRegex:"gc[abcdghkmnrstvwy]gc",reverseRegex:"gc[abcdghkmnrstvwy]gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AflII","MspCI","Vha464I","Bst98I","BstAFI","Esp4I","BstPZ740I","BfrI","BspTI"],site:"cttaag",forwardRegex:"ct{2}a{2}g",reverseRegex:"ct{2}a{2}g",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BthCI"],site:"gcngc",forwardRegex:"gc[abcdghkmnrstvwy]gc",reverseRegex:"gc[abcdghkmnrstvwy]gc",topSnipOffset:4,bottomSnipOffset:1},{aliases:["TfiTok6A1I","TspAK13D21I","TspVil3I","M.Rho11sII","Hpy26II","HpyF65II","TflI","HpyF16I","TfiTok4A2I","HpyF23I","HpyV","Tsp358I","HpyF71I","HpyF73II","TfiA3I","HpyF26III","TspAK16D24I","Tsc4aI","HpyF42IV","HpyF66IV","TspVi4AI","M.CviBIII","TthRQI","Tbr51I","HpyF52I","HpyF49I","Tth24I","M.Phi3TII","HpyF64I","CviSIII","HpyF40II","Taq20I","Tsp505I","HpyF35I","HpyF62II","HpyJP26II","HpyF30I","HpyF24I","HpyF59III","TspNI","Tsp510I","HpyF45I","HpyF14III"],site:"tcga",forwardRegex:"tcga",reverseRegex:"tcga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SthNI","SthBI","SthCI","SthDI","SthEI","SthAI","SthJI","SthKI","SthLI","SthMI","SthFI","SthGI","SthHI","Uba1201I","Uba76I","Uba86I","Uba85I","Uba87I","NmiI","KpnK14I","Eco149I","MvsAI","MvsDI","MvsEI","MvsBI","MvsCI","BspJ106I","Sau10I","Esp19I","MvsI"],site:"ggtacc",forwardRegex:"g{2}tac{2}",reverseRegex:"g{2}tac{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["M.NgoBIX"],site:"gtannnnnctc",forwardRegex:"gta[abcdghkmnrstvwy]{5}ctc",reverseRegex:"gag[abcdghkmnrstvwy]{5}tac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Asp29HI","HpyF65III","HpyF21II","HpyF59II","Hpy303I","HpyF10IV","HpyF66III","Hpy471I","Hpy423I","Hpy421I","HpyHII","Asp18HI","CcoP73I","HpyNSH57I","Hpy312I","HpyF53II","Asp17HI","HpyF44V","Hpy401I","HpyF13IV","HpyF31I","HpyF36II","Asp16HI","HpyF52III","Hpy501I","MjaV"],site:"gtac",forwardRegex:"gtac",reverseRegex:"gtac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bsp19I","NcoI"],site:"ccatgg",forwardRegex:"c{2}atg{2}",reverseRegex:"c{2}atg{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Psp1406I","AclI"],site:"aacgtt",forwardRegex:"a{2}cgt{2}",reverseRegex:"a{2}cgt{2}",topSnipOffset:2,bottomSnipOffset:4},{aliases:["Uba1432I","Asp17I","Asp8HI","AitII","AitAI","BpuGI","Asp21HI","Asp22I","Asp1HI","Asp14HI","BscSI","Asp6HI"],site:"rgatcy",forwardRegex:"[agr]gatc[cty]",reverseRegex:"[agr]gatc[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["RpaB5I"],site:"cgrggac",forwardRegex:"cg[agr]g{2}ac",reverseRegex:"gtc{2}[cty]cg",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["LweI","SfaNI","BspST5I","BmsI","PhaI"],site:"gcatc",forwardRegex:"gcatc",reverseRegex:"gatgc",topSnipOffset:10,bottomSnipOffset:14,isType2S:!0},{aliases:["EcoA4I","BspTNI","EcoO44I","Bso31I","BsaI","Eco31I","Bli736I"],isType2S:!0,site:"ggtctc",forwardRegex:"g{2}tctc",reverseRegex:"gagac{2}",topSnipOffset:7,bottomSnipOffset:11},{aliases:["Asi256I"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:1,bottomSnipOffset:3},{aliases:["Uba1362I","TseAI","Bka1125I","HpyF36IV","HpyF47I","Mlu40I","BstZ15I"],site:"gdgchc",forwardRegex:"g[adgkrtw]gc[achmtwy]c",reverseRegex:"g[adgkrtw]gc[achmtwy]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Ppu21I","BsaAI","PsuAI","BstBAI","MspYI"],site:"yacgtr",forwardRegex:"[cty]acgt[agr]",reverseRegex:"[cty]acgt[agr]",topSnipOffset:3,bottomSnipOffset:3},{aliases:["Vsp2246I","Eco50I","Uba1127I","Eco195I","Bme05I","Eco173I","SspM1III","Eco171I","Esp25I","Esp22I","Esp21I","Esp15I","Esp9I","Esp14I","Esp13I","Esp12I","Esp11I","Esp10I","Esp1I","Esp6I","Pph14I","Eco169I","Eco168I"],site:"ggyrcc",forwardRegex:"g{2}[cty][agr]c{2}",reverseRegex:"g{2}[cty][agr]c{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Mlu1106I"],site:"rggwccy",forwardRegex:"[agr]g{2}[atw]c{2}[cty]",reverseRegex:"[agr]g{2}[atw]c{2}[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bst22I","BsiYI","BflI","Bsc107I","BseLI","AfiI","BslI","Bsc4I"],site:"ccnnnnnnngg",forwardRegex:"c{2}[abcdghkmnrstvwy]{7}g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]{7}g{2}",topSnipOffset:7,bottomSnipOffset:4},{aliases:["BstD102I","BsrBI","MbiI","AccBSI","Bst31NI"],site:"ccgctc",forwardRegex:"c{2}gctc",reverseRegex:"gagcg{2}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BsrXI","Msp23I","BspLU11II"],site:"tctaga",forwardRegex:"tctaga",reverseRegex:"tctaga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AclNI","BcuI","SpeI","AhlI"],site:"actagt",forwardRegex:"actagt",reverseRegex:"actagt",topSnipOffset:1,bottomSnipOffset:5},{aliases:["PunAII","AvoI","PauAI","NspHI","BstNSI","NspI","XceI"],site:"rcatgy",forwardRegex:"[agr]catg[cty]",reverseRegex:"[agr]catg[cty]",topSnipOffset:5,bottomSnipOffset:1},{aliases:["MscI","BalI","MluNI","MlsI","Mlu31I","Msp20I"],site:"tggcca",forwardRegex:"tg{2}c{2}a",reverseRegex:"tg{2}c{2}a",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BmgI"],site:"gkgccc",forwardRegex:"g[gkt]gc{3}",reverseRegex:"g{3}c[acm]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BglII","NcrI","Pae2kI","Pae18kI","NspMACI"],site:"agatct",forwardRegex:"agatct",reverseRegex:"agatct",topSnipOffset:1,bottomSnipOffset:5},{aliases:["FatII","M.CviSII","Hin8II"],site:"catg",forwardRegex:"catg",reverseRegex:"catg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CglI","NgoFVII"],site:"gcsgc",forwardRegex:"gc[cgs]gc",reverseRegex:"gc[cgs]gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SspM1II","NlaSII","SspJII","Uba1381I","Hin8I","SspM2II"],site:"grcgyc",forwardRegex:"g[agr]cg[cty]c",reverseRegex:"g[agr]cg[cty]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["VchO68I","BscOI","PaeCI","Asp5HI","Bsp121I","Uba1226I","Uba1162I","CglAI","BtgAII","SpaXI"],site:"gcatgc",forwardRegex:"gcatgc",reverseRegex:"gcatgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["XcaI","BstZ17I","BspM90I","BssNAI","BstBSI","Bst1107I"],site:"gtatac",forwardRegex:"gtatac",reverseRegex:"gtatac",topSnipOffset:3,bottomSnipOffset:3},{aliases:["Bme1580I","BstSLI","BseSI","BaeGI"],site:"gkgcmc",forwardRegex:"g[gkt]gc[acm]c",reverseRegex:"g[gkt]gc[acm]c",topSnipOffset:5,bottomSnipOffset:1},{aliases:["MthFI","Rma500I","Rma501I","Rma503I","FisI","Rma509I","Rma506I","Rma510I","MjaI","Rma515I","Rma516I","Rma517I","Rma518I","Rma519I","Rma496I","Rma495I","Rma522I","Rma497I","UbaN5I","Rma490I","Rma486I","Rma485I"],site:"ctag",forwardRegex:"ctag",reverseRegex:"ctag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SelI"],site:"cgcg",forwardRegex:"cgcg",reverseRegex:"cgcg",topSnipOffset:0,bottomSnipOffset:4},{aliases:["Mlu9273I","VchO70I","Sna3286I","SalDI","PspDI","Uba1117I","Uba1386I","AmaSI"],site:"tcgcga",forwardRegex:"tcgcga",reverseRegex:"tcgcga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Hsp92I","BbiII","Msp17I","HgiGI","HgiDI","AsuIII","PamII","BsaHI","BstACI","HgiHII","AcyI","BssNI","Hin1I","AhaII","AstWI","HgiI","AosII"],site:"grcgyc",forwardRegex:"g[agr]cg[cty]c",reverseRegex:"g[agr]cg[cty]c",topSnipOffset:2,bottomSnipOffset:4},{aliases:["BtgZI"],site:"gcgatg",forwardRegex:"gcgatg",reverseRegex:"catcgc",topSnipOffset:16,bottomSnipOffset:20,isType2S:!0},{aliases:["Bme142I","LpnI"],site:"rgcgcy",forwardRegex:"[agr]gcgc[cty]",reverseRegex:"[agr]gcgc[cty]",topSnipOffset:3,bottomSnipOffset:3},{aliases:["PlaAII","HpyBI","RsaI","AfaI"],site:"gtac",forwardRegex:"gtac",reverseRegex:"gtac",topSnipOffset:2,bottomSnipOffset:2},{aliases:["Tru201I","BloHI","BstX2I","MflI","BstYI","XhoII","PsuI","DsaIII"],site:"rgatcy",forwardRegex:"[agr]gatc[cty]",reverseRegex:"[agr]gatc[cty]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Eco252I","Uba58I","Van91II","VchO2I","Eco159I","Hal22I","Eco82I","Eco228I","Eco237I","VchN100I"],site:"gaattc",forwardRegex:"ga{2}t{2}c",reverseRegex:"ga{2}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MluB2I","Bsp68I","RruI","SpoI","NruI","BtuMI","Sbo13I"],site:"tcgcga",forwardRegex:"tcgcga",reverseRegex:"tcgcga",topSnipOffset:3,bottomSnipOffset:3},{aliases:["AlwXI","Bst12I","BseKI","BbvI","Bst71I","BseXI","BstV1I","Bsp423I","Lsp1109I"],site:"gcagc",forwardRegex:"gcagc",reverseRegex:"gctgc",topSnipOffset:13,bottomSnipOffset:17,isType2S:!0},{aliases:["BspACI","SsiI","AciI"],site:"ccgc",forwardRegex:"c{2}gc",reverseRegex:"gcg{2}",topSnipOffset:1,bottomSnipOffset:3},{aliases:["EcoT38I","PaeHI","KoxII","SacNI","Eco24I","BpuI","FriOI","Bsu1854I","Eco75KI","BanII","BvuI","HgiJII","Bsp519I"],site:"grgcyc",forwardRegex:"g[agr]gc[cty]c",reverseRegex:"g[agr]gc[cty]c",topSnipOffset:5,bottomSnipOffset:1},{aliases:["PasI"],site:"cccwggg",forwardRegex:"c{3}[atw]g{3}",reverseRegex:"c{3}[atw]g{3}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["MluCI","TseCI"],site:"aatt",forwardRegex:"a{2}t{2}",reverseRegex:"a{2}t{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF50I","HpyF49III","HpyF14II","HpyF7III","HpyF46III","MjaIV"],site:"gtnnac",forwardRegex:"gt[abcdghkmnrstvwy]{2}ac",reverseRegex:"gt[abcdghkmnrstvwy]{2}ac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Psp1009I","Tsp8EI","BglI"],site:"gccnnnnnggc",forwardRegex:"gc{2}[abcdghkmnrstvwy]{5}g{2}c",reverseRegex:"gc{2}[abcdghkmnrstvwy]{5}g{2}c",topSnipOffset:7,bottomSnipOffset:4},{aliases:["SruI","DraI","PauAII","AhaIII"],site:"tttaaa",forwardRegex:"t{3}a{3}",reverseRegex:"t{3}a{3}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["AccI","XmiI","FblI"],site:"gtmkac",forwardRegex:"gt[acm][gkt]ac",reverseRegex:"gt[acm][gkt]ac",topSnipOffset:2,bottomSnipOffset:4},{aliases:["PmeI","MssI"],site:"gtttaaac",forwardRegex:"gt{3}a{3}c",reverseRegex:"gt{3}a{3}c",topSnipOffset:4,bottomSnipOffset:4},{aliases:["PshDI","PshCI","PspBI","Pgl34I","Psp38I","VpaK3AI","VpaK3BI","Bsp87I"],site:"cacgtg",forwardRegex:"cacgtg",reverseRegex:"cacgtg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AxyI","AocI","Lmu60I","BspR7I","OxaNI","CvnI","MstII","Bsu36I","Eco81I","SshAI","SauI","BliHKI","Bse21I"],site:"cctnagg",forwardRegex:"c{2}t[abcdghkmnrstvwy]ag{2}",reverseRegex:"c{2}t[abcdghkmnrstvwy]ag{2}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["TsoI"],site:"tarcca",forwardRegex:"ta[agr]c{2}a",reverseRegex:"tg{2}[cty]ta",topSnipOffset:17,bottomSnipOffset:15,isType2S:!0},{aliases:["PlaII","LspI","SspRFI","BsiCI","Bpu14I","AcpI","FspII","MlaI","AsuII","Ssp1I","Asp10HI","NspV","Bsp119I","BspLAII","SviI","PpaAI","SfuI","CbiI","Bim19I","BstBI","BimI","Csp68KII","Csp45I","BspT104I"],site:"ttcgaa",forwardRegex:"t{2}cga{2}",reverseRegex:"t{2}cga{2}",topSnipOffset:2,bottomSnipOffset:4},{aliases:["EspHK26I","Bla7920I","Uba1375I","BspH226I","Cfr57I","Tsp514I","Bsp233I","Uba1136I","Uba1425I","Tsp507I","Bsp228I","Uba1279I","Bbf7411I","BstZ3I","Bsu22I","BstZ1I","BsiGI","BsiOI","Bsp508I"],site:"tccgga",forwardRegex:"tc{2}g{2}a",reverseRegex:"tc{2}g{2}a",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BpuEI","Bce83I"],site:"cttgag",forwardRegex:"ct{2}gag",reverseRegex:"ctca{2}g",topSnipOffset:22,bottomSnipOffset:20,isType2S:!0},{aliases:["AspS9I","AsuI","NspIV","BsiZI","Bsp1894I","BspF4I","Cfr13I","BshKI","BspBII","Pde12I","PspPI","MaeK81II","BavAII","Nsp7121I","BavBII","Bal228I","CcuI","Sau96I","AvcI","Bsu54I","Bce22I","Bac36I"],site:"ggncc",forwardRegex:"g{2}[abcdghkmnrstvwy]c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]c{2}",topSnipOffset:1,bottomSnipOffset:4},{aliases:["BstKTI","BspKT6I"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:3,bottomSnipOffset:1},{aliases:["BfmI","BdiSI","Srl56DI","BpcI","BthP35I","SfcI","BstSFI","LlaBI","SfeI"],site:"ctryag",forwardRegex:"ct[agr][cty]ag",reverseRegex:"ct[agr][cty]ag",topSnipOffset:1,bottomSnipOffset:5},{aliases:["MseI","Tru1I","Tru9I","SaqAI"],site:"ttaa",forwardRegex:"t{2}a{2}",reverseRegex:"t{2}a{2}",topSnipOffset:1,bottomSnipOffset:3},{aliases:["Sau96mI","Sau93I","Sau98I","Sau90I"],site:"ctyrag",forwardRegex:"ct[cty][agr]ag",reverseRegex:"ct[cty][agr]ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TrsSII"],site:"gacnnnnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{6}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{6}gtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["ParI","BsiQI","BclI","AbaI","FbaI","Ksp22I","BstT7I","BspXII"],site:"tgatca",forwardRegex:"tgatca",reverseRegex:"tgatca",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Eco255I","DpaI","BmcAI","ZrmI","ScaI","AssI","Bpa34I","Acc113I","RflFII"],site:"agtact",forwardRegex:"agtact",reverseRegex:"agtact",topSnipOffset:3,bottomSnipOffset:3},{aliases:["SplAII","TteI","TspI","TrsKTII","FsuI","SmaAII","NtaI","SplII","SpaPI","TtrI"],site:"gacnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{3}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{3}gtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AspLEI","HhaI","BspLAI","CfoI","BstHHI","FnuDIII"],site:"gcgc",forwardRegex:"gcgc",reverseRegex:"gcgc",topSnipOffset:3,bottomSnipOffset:1},{aliases:["StyLTI"],site:"cagag",forwardRegex:"cagag",reverseRegex:"ctctg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BsoEI","Uba1289I","Uba1290I","BstWI","Uba1309I","Uba1308I","Uba1310I","Bpu1268I"],site:"cctnnnnnagg",forwardRegex:"c{2}t[abcdghkmnrstvwy]{5}ag{2}",reverseRegex:"c{2}t[abcdghkmnrstvwy]{5}ag{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco826I","Eco1455I"],site:"gcannnnnnctga",forwardRegex:"gca[abcdghkmnrstvwy]{6}ctga",reverseRegex:"tcag[abcdghkmnrstvwy]{6}tgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["ApaI","PpeI"],site:"gggccc",forwardRegex:"g{3}c{3}",reverseRegex:"g{3}c{3}",topSnipOffset:5,bottomSnipOffset:1},{aliases:["KpnBI"],site:"caaannnnnnrtca",forwardRegex:"ca{3}[abcdghkmnrstvwy]{6}[agr]tca",reverseRegex:"tga[cty][abcdghkmnrstvwy]{6}t{3}g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UnbI"],site:"ggncc",forwardRegex:"g{2}[abcdghkmnrstvwy]c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]c{2}",topSnipOffset:0,bottomSnipOffset:5},{aliases:["Uba1384I","SmuCI","AvaIII","Uba1353I","PxyJKI","Uba1367I","BfrCI","SrlII"],site:"atgcat",forwardRegex:"atgcat",reverseRegex:"atgcat",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BspMKI","XciI","SalI","HgiCIII","Rtr63I","Rrh4273I","RflFI","HgiDII","NopI","RtrI"],site:"gtcgac",forwardRegex:"gtcgac",reverseRegex:"gtcgac",topSnipOffset:1,bottomSnipOffset:5},{aliases:["EcoR124I"],site:"gaannnnnnrtcg",forwardRegex:"ga{2}[abcdghkmnrstvwy]{6}[agr]tcg",reverseRegex:"cga[cty][abcdghkmnrstvwy]{6}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SynII","Psc2I"],site:"gaannnnttc",forwardRegex:"ga{2}[abcdghkmnrstvwy]{4}t{2}c",reverseRegex:"ga{2}[abcdghkmnrstvwy]{4}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CspI","Rsr2I","RsrII","CpoI"],site:"cggwccg",forwardRegex:"cg{2}[atw]c{2}g",reverseRegex:"cg{2}[atw]c{2}g",topSnipOffset:2,bottomSnipOffset:5},{aliases:["AscI","PalAI","SgsI"],site:"ggcgcgcc",forwardRegex:"g{2}cgcgc{2}",reverseRegex:"g{2}cgcgc{2}",topSnipOffset:2,bottomSnipOffset:6},{aliases:["Uba69I","TtmII","BscEI","BsrHI","Kpn30I","M.BssHIII","BssBI","Eco143I","Eco152I","Esp7I","Esp8I","CfrJ5I","BsoPI"],site:"gcgcgc",forwardRegex:"gcgcgc",reverseRegex:"gcgcgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EclHKI","BspOVI","AhdI","AspEI","Eam1105I","NruGI","BmeRI","DriI"],site:"gacnnnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{5}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{5}gtc",topSnipOffset:6,bottomSnipOffset:5},{aliases:["Uba1222I","Uba1221I","BpuGCI","Uba1320I","Uba1284I"],site:"gctnagc",forwardRegex:"gct[abcdghkmnrstvwy]agc",reverseRegex:"gct[abcdghkmnrstvwy]agc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BpuCI"],site:"ggcgga",forwardRegex:"g{2}cg{2}a",reverseRegex:"tc{2}gc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EspI","BlpI","Bsp1720I","Bpu1102I","CelII"],site:"gctnagc",forwardRegex:"gct[abcdghkmnrstvwy]agc",reverseRegex:"gct[abcdghkmnrstvwy]agc",topSnipOffset:2,bottomSnipOffset:5},{aliases:["Eco1476I","Eco1427I","Eco1430I","Eco1323I","Eco377I","Eco1386I","Eco37I","Eco1344II","Eco1456I"],site:"ggannnnnnnnatgc",forwardRegex:"g{2}a[abcdghkmnrstvwy]{8}atgc",reverseRegex:"gcat[abcdghkmnrstvwy]{8}tc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MnnI","Hin1160II","ChuEII","Hin1161II"],site:"gtyrac",forwardRegex:"gt[cty][agr]ac",reverseRegex:"gt[cty][agr]ac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SstI","SacI","Psp124BI"],site:"gagctc",forwardRegex:"gagctc",reverseRegex:"gagctc",topSnipOffset:5,bottomSnipOffset:1},{aliases:["SspD5II","NsiI","PinBI","Asi372I","Mph1103I","Csp68KIII","Zsp2I","SepI","EcoT22I","BfrBI"],site:"atgcat",forwardRegex:"atgcat",reverseRegex:"atgcat",topSnipOffset:5,bottomSnipOffset:1},{aliases:["AsnI","AseI","VspI","PshBI","Sru4DI","BpoAI"],site:"attaat",forwardRegex:"at{2}a{2}t",reverseRegex:"at{2}a{2}t",topSnipOffset:2,bottomSnipOffset:4},{aliases:["BmrFI","Msp67I","MspR9I","ScrFI","Bme1390I"],site:"ccngg",forwardRegex:"c{2}[abcdghkmnrstvwy]g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]g{2}",topSnipOffset:2,bottomSnipOffset:3},{aliases:["McrI","BsaOI","BsiEI","Bsh1285I","BstMCI"],site:"cgrycg",forwardRegex:"cg[agr][cty]cg",reverseRegex:"cg[agr][cty]cg",topSnipOffset:4,bottomSnipOffset:2},{aliases:["TspRI","TscAI"],site:"castgnn",forwardRegex:"ca[cgs]tg[abcdghkmnrstvwy]{2}",reverseRegex:"[abcdghkmnrstvwy]{2}ca[cgs]tg",topSnipOffset:7,bottomSnipOffset:0},{aliases:["BsmWI","SmaAI","SspKI","SplAI","PfuNI"],site:"cgtacg",forwardRegex:"cgtacg",reverseRegex:"cgtacg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CdiI"],site:"catcg",forwardRegex:"catcg",reverseRegex:"cgatg",topSnipOffset:4,bottomSnipOffset:4},{aliases:["TrsKTIII"],site:"catatg",forwardRegex:"catatg",reverseRegex:"catatg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BseB631II"],site:"agatct",forwardRegex:"agatct",reverseRegex:"agatct",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Sth302II"],site:"ccgg",forwardRegex:"c{2}g{2}",reverseRegex:"c{2}g{2}",topSnipOffset:2,bottomSnipOffset:2},{aliases:["PbuJKI","Hpy178VI","HpyF67III","HinGUII","HpyF6I"],site:"ggatg",forwardRegex:"g{2}atg",reverseRegex:"catc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaF13I"],site:"gagnnnnnnctgg",forwardRegex:"gag[abcdghkmnrstvwy]{6}ctg{2}",reverseRegex:"c{2}ag[abcdghkmnrstvwy]{6}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MreI","Sse232I"],site:"cgccggcg",forwardRegex:"cgc{2}g{2}cg",reverseRegex:"cgc{2}g{2}cg",topSnipOffset:2,bottomSnipOffset:6},{aliases:["BsaGI","HpyF7II","Pph3215I","Bfu1570I","BsmPI","HpyF46II","Hpy8III"],site:"gwgcwc",forwardRegex:"g[atw]gc[atw]c",reverseRegex:"g[atw]gc[atw]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BceSIII","BceAI"],site:"acggc",forwardRegex:"acg{2}c",reverseRegex:"gc{2}gt",topSnipOffset:17,bottomSnipOffset:19,isType2S:!0},{aliases:["CstMI"],site:"aaggag",forwardRegex:"a{2}g{2}ag",reverseRegex:"ctc{2}t{2}",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["Acc65I","Asp718I","SthI","AhaB8I"],site:"ggtacc",forwardRegex:"g{2}tac{2}",reverseRegex:"g{2}tac{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["EacI","BinI","AlwI","Bst31TI","BspPI","AclWI","BstH9I"],site:"ggatc",forwardRegex:"g{2}atc",reverseRegex:"gatc{2}",topSnipOffset:9,bottomSnipOffset:10,isType2S:!0},{aliases:["BspGI"],site:"ctggac",forwardRegex:"ctg{2}ac",reverseRegex:"gtc{2}ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BspCNI"],site:"ctcag",forwardRegex:"ctcag",reverseRegex:"ctgag",topSnipOffset:14,bottomSnipOffset:12,isType2S:!0},{aliases:["MunI","MfeI"],site:"caattg",forwardRegex:"ca{2}t{2}g",reverseRegex:"ca{2}t{2}g",topSnipOffset:1,bottomSnipOffset:5},{aliases:["StySENI","StySBLI"],site:"cgannnnnntacc",forwardRegex:"cga[abcdghkmnrstvwy]{6}tac{2}",reverseRegex:"g{2}ta[abcdghkmnrstvwy]{6}tcg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BfaI","MthZI","RmaI","FspBI","FgoI","MaeI","XspI"],site:"ctag",forwardRegex:"ctag",reverseRegex:"ctag",topSnipOffset:1,bottomSnipOffset:3},{aliases:["BseYI"],site:"cccagc",forwardRegex:"c{3}agc",reverseRegex:"gctg{3}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["SmlI","SmoI"],site:"ctyrag",forwardRegex:"ct[cty][agr]ag",reverseRegex:"ct[cty][agr]ag",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Tsp509I","Sse9I","TspEI","TasI"],site:"aatt",forwardRegex:"a{2}t{2}",reverseRegex:"a{2}t{2}",topSnipOffset:0,bottomSnipOffset:4},{aliases:["HgaI","CseI"],site:"gacgc",forwardRegex:"gacgc",reverseRegex:"gcgtc",topSnipOffset:10,bottomSnipOffset:15,isType2S:!0},{aliases:["PaeBI","PspALI","SmaI","CfrJ4I"],site:"cccggg",forwardRegex:"c{3}g{3}",reverseRegex:"c{3}g{3}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["SnaBI","Eco105I","BstSNI"],site:"tacgta",forwardRegex:"tacgta",reverseRegex:"tacgta",topSnipOffset:3,bottomSnipOffset:3},{aliases:["Esp3I","BstGZ53I","BsmBI"],isType2S:!0,site:"cgtctc",forwardRegex:"cgtctc",reverseRegex:"gagacg",topSnipOffset:7,bottomSnipOffset:11},{aliases:["Bsp1591I","Cfr19I","Uba1291I","SciAI","KoxI","BstDI","Bse59I","Bst31I","Cfr7I"],site:"ggtnacc",forwardRegex:"g{2}t[abcdghkmnrstvwy]ac{2}",reverseRegex:"g{2}t[abcdghkmnrstvwy]ac{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PstII"],site:"ctgatg",forwardRegex:"ctgatg",reverseRegex:"catcag",topSnipOffset:31,bottomSnipOffset:33,isType2S:!0},{aliases:["PflMI","PflBI","Asp10HII","BasI","Van91I","AcpII","Esp1396I","AccB7I"],site:"ccannnnntgg",forwardRegex:"c{2}a[abcdghkmnrstvwy]{5}tg{2}",reverseRegex:"c{2}a[abcdghkmnrstvwy]{5}tg{2}",topSnipOffset:7,bottomSnipOffset:4},{aliases:["RceI"],site:"catcgac",forwardRegex:"catcgac",reverseRegex:"gtcgatg",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["BstDEI","BstJZ301I","HpyF3I","DdeI"],site:"ctnag",forwardRegex:"ct[abcdghkmnrstvwy]ag",reverseRegex:"ct[abcdghkmnrstvwy]ag",topSnipOffset:1,bottomSnipOffset:4},{aliases:["UbaN6I","Bco631I","Bco63I","Bse631I"],site:"gatnnnnatc",forwardRegex:"gat[abcdghkmnrstvwy]{4}atc",reverseRegex:"gat[abcdghkmnrstvwy]{4}atc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["StySJI"],site:"gagnnnnnngtrc",forwardRegex:"gag[abcdghkmnrstvwy]{6}gt[agr]c",reverseRegex:"g[cty]ac[abcdghkmnrstvwy]{6}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BchI","BsaUI","BsrVI","LfeI"],site:"gcagc",forwardRegex:"gcagc",reverseRegex:"gctgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BscAI","Bst19I"],site:"gcatc",forwardRegex:"gcatc",reverseRegex:"gatgc",topSnipOffset:9,bottomSnipOffset:11,isType2S:!0},{aliases:["KteAI","Uba1393I","Uba1220I"],site:"cccggg",forwardRegex:"c{3}g{3}",reverseRegex:"c{3}g{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BctI"],site:"acggc",forwardRegex:"acg{2}c",reverseRegex:"gc{2}gt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BsePI","PteI","BssHII","BstBZ153I","PauI"],site:"gcgcgc",forwardRegex:"gcgcgc",reverseRegex:"gcgcgc",topSnipOffset:1,bottomSnipOffset:5},{aliases:["StyLTIII"],site:"gagnnnnnnrtayg",forwardRegex:"gag[abcdghkmnrstvwy]{6}[agr]ta[cty]g",reverseRegex:"c[agr]ta[cty][abcdghkmnrstvwy]{6}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["VpaK32I","PciSI","LguI","BspQI","SapI"],isType2S:!0,site:"gctcttc",forwardRegex:"gctct{2}c",reverseRegex:"ga{2}gagc",topSnipOffset:8,bottomSnipOffset:11},{aliases:["BniI"],site:"gcnngc",forwardRegex:"gc[abcdghkmnrstvwy]{2}gc",reverseRegex:"gc[abcdghkmnrstvwy]{2}gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoDR2"],site:"tcannnnnngtcg",forwardRegex:"tca[abcdghkmnrstvwy]{6}gtcg",reverseRegex:"cgac[abcdghkmnrstvwy]{6}tga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TssI"],site:"gagnnnctc",forwardRegex:"gag[abcdghkmnrstvwy]{3}ctc",reverseRegex:"gag[abcdghkmnrstvwy]{3}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Tth111II"],site:"caarca",forwardRegex:"ca{2}[agr]ca",reverseRegex:"tg[cty]t{2}g",topSnipOffset:17,bottomSnipOffset:15,isType2S:!0},{aliases:["BbvCI","AbeI"],site:"cctcagc",forwardRegex:"c{2}tcagc",reverseRegex:"gctgag{2}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["MluI","Bbi24I"],site:"acgcgt",forwardRegex:"acgcgt",reverseRegex:"acgcgt",topSnipOffset:1,bottomSnipOffset:5},{aliases:["MnlI"],site:"cctc",forwardRegex:"c{2}tc",reverseRegex:"gag{2}",topSnipOffset:11,bottomSnipOffset:10,isType2S:!0},{aliases:["SspD5I"],site:"ggtga",forwardRegex:"g{2}tga",reverseRegex:"tcac{2}",topSnipOffset:13,bottomSnipOffset:13,isType2S:!0},{aliases:["AspCNI"],site:"gccgc",forwardRegex:"gc{2}gc",reverseRegex:"gcg{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TauI","BspUI"],site:"gcsgc",forwardRegex:"gc[cgs]gc",reverseRegex:"gc[cgs]gc",topSnipOffset:4,bottomSnipOffset:1},{aliases:["BinSII","BbeI"],site:"ggcgcc",forwardRegex:"g{2}cgc{2}",reverseRegex:"g{2}cgc{2}",topSnipOffset:5,bottomSnipOffset:1},{aliases:["BpmI","GsuI"],site:"ctggag",forwardRegex:"ctg{2}ag",reverseRegex:"ctc{2}ag",topSnipOffset:22,bottomSnipOffset:20,isType2S:!0},{aliases:["NciI","AhaI","AseII","Mgl14481I","AsuC2I","BpuMI","HgiS22I","CauII","BcnI"],site:"ccsgg",forwardRegex:"c{2}[cgs]g{2}",reverseRegex:"c{2}[cgs]g{2}",topSnipOffset:2,bottomSnipOffset:3},{aliases:["Eco1348I","Eco777I","Eco1412I"],site:"ggannnnnntatc",forwardRegex:"g{2}a[abcdghkmnrstvwy]{6}tatc",reverseRegex:"gata[abcdghkmnrstvwy]{6}tc{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AgsI"],site:"ttsaa",forwardRegex:"t{2}[cgs]a{2}",reverseRegex:"t{2}[cgs]a{2}",topSnipOffset:3,bottomSnipOffset:2},{aliases:["Pfl18I","Ssm4I","Ssm5I","NasSI","ScoI","Ecl137I"],site:"gagctc",forwardRegex:"gagctc",reverseRegex:"gagctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CfrBI","StyI","ErhB9II","Eco130I","ErhI","EcoT14I","BsmSI","BssT1I"],site:"ccwwgg",forwardRegex:"c{2}[atw]{2}g{2}",reverseRegex:"c{2}[atw]{2}g{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["AlwFI"],site:"gaaaynnnnnrtg",forwardRegex:"ga{3}[cty][abcdghkmnrstvwy]{5}[agr]tg",reverseRegex:"ca[cty][abcdghkmnrstvwy]{5}[agr]t{3}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CviRI","HpyCH4V","HpyF44III"],site:"tgca",forwardRegex:"tgca",reverseRegex:"tgca",topSnipOffset:2,bottomSnipOffset:2},{aliases:["Bse19I","AteI","NspSAIII"],site:"ccatgg",forwardRegex:"c{2}atg{2}",reverseRegex:"c{2}atg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Srl65DI","Srr17I","Srl55DII","CprJK722I","Srl8DI","PbuMZI"],site:"attaat",forwardRegex:"at{2}a{2}t",reverseRegex:"at{2}a{2}t",topSnipOffset:1,bottomSnipOffset:1},{aliases:["ClcII","GspAII","NspHIII","Bco6I","NspLI","NspMI","BsaTI","CliII","ApcTR183I","AcaIII"],site:"tgcgca",forwardRegex:"tgcgca",reverseRegex:"tgcgca",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CsiI","MabI","SexAI"],site:"accwggt",forwardRegex:"ac{2}[atw]g{2}t",reverseRegex:"ac{2}[atw]g{2}t",topSnipOffset:1,bottomSnipOffset:6},{aliases:["HgiEII"],site:"accnnnnnnggt",forwardRegex:"ac{2}[abcdghkmnrstvwy]{6}g{2}t",reverseRegex:"ac{2}[abcdghkmnrstvwy]{6}g{2}t",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TseDI","BscRI","Bsp21I"],site:"rccggy",forwardRegex:"[agr]c{2}g{2}[cty]",reverseRegex:"[agr]c{2}g{2}[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bse23I","BsmYI"],site:"ccnnnnnnngg",forwardRegex:"c{2}[abcdghkmnrstvwy]{7}g{2}",reverseRegex:"c{2}[abcdghkmnrstvwy]{7}g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NdeI","FauNDI","PfaAII"],site:"catatg",forwardRegex:"catatg",reverseRegex:"catatg",topSnipOffset:2,bottomSnipOffset:4},{aliases:["VneAI","Uba1326I"],site:"rggnccy",forwardRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",reverseRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SrlI","NgoMIV","SceIII","NgoAIV","MroNI","Eco56I"],site:"gccggc",forwardRegex:"gc{2}g{2}c",reverseRegex:"gc{2}g{2}c",topSnipOffset:1,bottomSnipOffset:5},{aliases:["AsiSI","SfaAI","RgaI","SgfI"],site:"gcgatcgc",forwardRegex:"gcgatcgc",reverseRegex:"gcgatcgc",topSnipOffset:5,bottomSnipOffset:3},{aliases:["BtsPI","SaiI","ShaI"],site:"gggtc",forwardRegex:"g{3}tc",reverseRegex:"gac{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Pfl1108I"],site:"tcgtag",forwardRegex:"tcgtag",reverseRegex:"ctacga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoHK31I","Bfi89I","EaeI","CfrI","AcoI"],site:"yggccr",forwardRegex:"[cty]g{2}c{2}[agr]",reverseRegex:"[cty]g{2}c{2}[agr]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["HphI","AsuHPI"],site:"ggtga",forwardRegex:"g{2}tga",reverseRegex:"tcac{2}",topSnipOffset:13,bottomSnipOffset:12,isType2S:!0},{aliases:["Uba1303I","BstZ5I","BscNI"],site:"cgrycg",forwardRegex:"cg[agr][cty]cg",reverseRegex:"cg[agr][cty]cg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bsp6II","FsfI","BspD6II","Eco112I","Eco125I"],site:"ctgaag",forwardRegex:"ctga{2}g",reverseRegex:"ct{2}cag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BstXI","BstHZ55I"],site:"ccannnnnntgg",forwardRegex:"c{2}a[abcdghkmnrstvwy]{6}tg{2}",reverseRegex:"c{2}a[abcdghkmnrstvwy]{6}tg{2}",topSnipOffset:8,bottomSnipOffset:4},{aliases:["Ppu11I","Ppu6I"],site:"yacgtr",forwardRegex:"[cty]acgt[agr]",reverseRegex:"[cty]acgt[agr]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoT104I","SblAI","SblBI","SblCI","Uba1311I","Eco208II","Bst224I"],site:"ccwwgg",forwardRegex:"c{2}[atw]{2}g{2}",reverseRegex:"c{2}[atw]{2}g{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoR124II"],site:"gaannnnnnnrtcg",forwardRegex:"ga{2}[abcdghkmnrstvwy]{7}[agr]tcg",reverseRegex:"cga[cty][abcdghkmnrstvwy]{7}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MamI","BseJI","Bse8I","BsrBRI","BsiBI","BsaBI","Bsh1365I"],site:"gatnnnnatc",forwardRegex:"gat[abcdghkmnrstvwy]{4}atc",reverseRegex:"gat[abcdghkmnrstvwy]{4}atc",topSnipOffset:5,bottomSnipOffset:5},{aliases:["Ssp5230I","AatII"],site:"gacgtc",forwardRegex:"gacgtc",reverseRegex:"gacgtc",topSnipOffset:5,bottomSnipOffset:1},{aliases:["Uba1240I","Bpu1831I","SspM1I","SspM2I","EciAI","SspJI","Eco158II"],site:"tacgta",forwardRegex:"tacgta",reverseRegex:"tacgta",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MaqI"],site:"crttgac",forwardRegex:"c[agr]t{2}gac",reverseRegex:"gtca{2}[cty]g",topSnipOffset:28,bottomSnipOffset:26,isType2S:!0},{aliases:["CjeNII"],site:"gagnnnnngt",forwardRegex:"gag[abcdghkmnrstvwy]{5}gt",reverseRegex:"ac[abcdghkmnrstvwy]{5}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["KpnAI"],site:"gaannnnnntgcc",forwardRegex:"ga{2}[abcdghkmnrstvwy]{6}tgc{2}",reverseRegex:"g{2}ca[abcdghkmnrstvwy]{6}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SleI","AjnI","Psp6I","PspGI","SspAI","EcoRII"],site:"ccwgg",forwardRegex:"c{2}[atw]g{2}",reverseRegex:"c{2}[atw]g{2}",topSnipOffset:0,bottomSnipOffset:5},{aliases:["BstFZ438I","Bme585I","SmuI","FauI"],site:"cccgc",forwardRegex:"c{3}gc",reverseRegex:"gcg{3}",topSnipOffset:9,bottomSnipOffset:11,isType2S:!0},{aliases:["HpyCH4IV","MaeII"],site:"acgt",forwardRegex:"acgt",reverseRegex:"acgt",topSnipOffset:1,bottomSnipOffset:3},{aliases:["TaqII"],site:"caccca",forwardRegex:"cac{3}a",reverseRegex:"tg{3}tg",topSnipOffset:17,bottomSnipOffset:15,isType2S:!0},{aliases:["UbaN9I"],site:"aacgtt",forwardRegex:"a{2}cgt{2}",reverseRegex:"a{2}cgt{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["DrdII"],site:"gaacca",forwardRegex:"ga{2}c{2}a",reverseRegex:"tg{2}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MalI","DpnI","CfuI"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:2,bottomSnipOffset:2},{aliases:["AarI"],isType2S:!0,site:"cacctgc",forwardRegex:"cac{2}tgc",reverseRegex:"gcag{2}tg",topSnipOffset:11,bottomSnipOffset:15},{aliases:["SrfI"],site:"gcccgggc",forwardRegex:"gc{3}g{3}c",reverseRegex:"gc{3}g{3}c",topSnipOffset:4,bottomSnipOffset:4},{aliases:["TatI"],site:"wgtacw",forwardRegex:"[atw]gtac[atw]",reverseRegex:"[atw]gtac[atw]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["EcoDXXI"],site:"tcannnnnnnrttc",forwardRegex:"tca[abcdghkmnrstvwy]{7}[agr]t{2}c",reverseRegex:"ga{2}[cty][abcdghkmnrstvwy]{7}tga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HindII","HincII","HinJCI"],site:"gtyrac",forwardRegex:"gt[cty][agr]ac",reverseRegex:"gt[cty][agr]ac",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BseMI","Bse3DI","BsrDI"],site:"gcaatg",forwardRegex:"gca{2}tg",reverseRegex:"cat{2}gc",topSnipOffset:8,bottomSnipOffset:6,isType2S:!0},{aliases:["HalI","Srl32DII","FunII","Ppu111I","EcoRI","RsrI","Kpn49kI","SsoI","Srl55DI"],site:"gaattc",forwardRegex:"ga{2}t{2}c",reverseRegex:"ga{2}t{2}c",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Hpy166III"],site:"cctc",forwardRegex:"c{2}tc",reverseRegex:"gag{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["FspAI"],site:"rtgcgcay",forwardRegex:"[agr]tgcgca[cty]",reverseRegex:"[agr]tgcgca[cty]",topSnipOffset:4,bottomSnipOffset:4},{aliases:["Eco585I"],site:"gccnnnnnntgcg",forwardRegex:"gc{2}[abcdghkmnrstvwy]{6}tgcg",reverseRegex:"cgca[abcdghkmnrstvwy]{6}g{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PlaDI"],site:"catcag",forwardRegex:"catcag",reverseRegex:"ctgatg",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["Hpy188I"],site:"tcnga",forwardRegex:"tc[abcdghkmnrstvwy]ga",reverseRegex:"tc[abcdghkmnrstvwy]ga",topSnipOffset:3,bottomSnipOffset:2},{aliases:["PciI","PscI","BspLU11I"],site:"acatgt",forwardRegex:"acatgt",reverseRegex:"acatgt",topSnipOffset:1,bottomSnipOffset:5},{aliases:["VchO25I","SnaI"],site:"gtatac",forwardRegex:"gtatac",reverseRegex:"gtatac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TseBI","M.BbvSI","TneI"],site:"gcwgc",forwardRegex:"gc[atw]gc",reverseRegex:"gc[atw]gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["OliI","AleI"],site:"cacnnnngtg",forwardRegex:"cac[abcdghkmnrstvwy]{4}gtg",reverseRegex:"cac[abcdghkmnrstvwy]{4}gtg",topSnipOffset:5,bottomSnipOffset:5},{aliases:["GlaI"],site:"gcgc",forwardRegex:"gcgc",reverseRegex:"gcgc",topSnipOffset:2,bottomSnipOffset:2},{aliases:["BssGI","BscJI","BstTI"],site:"ccannnnnntgg",forwardRegex:"c{2}a[abcdghkmnrstvwy]{6}tg{2}",reverseRegex:"c{2}a[abcdghkmnrstvwy]{6}tg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Tsp4CI","Bst4CI","HpyCH4III","TaaI"],site:"acngt",forwardRegex:"ac[abcdghkmnrstvwy]gt",reverseRegex:"ac[abcdghkmnrstvwy]gt",topSnipOffset:3,bottomSnipOffset:2},{aliases:["AceIII"],site:"cagctc",forwardRegex:"cagctc",reverseRegex:"gagctg",topSnipOffset:13,bottomSnipOffset:17,isType2S:!0},{aliases:["BseNI","BsrI","Bse1I","Tsp1I","BsrSI","Bst11I"],site:"actgg",forwardRegex:"actg{2}",reverseRegex:"c{2}agt",topSnipOffset:6,bottomSnipOffset:4,isType2S:!0},{aliases:["FnuAI","HinfI","CviBI","HhaII","SscL1I"],site:"gantc",forwardRegex:"ga[abcdghkmnrstvwy]tc",reverseRegex:"ga[abcdghkmnrstvwy]tc",topSnipOffset:1,bottomSnipOffset:4},{aliases:["CjuI"],site:"caynnnnnrtg",forwardRegex:"ca[cty][abcdghkmnrstvwy]{5}[agr]tg",reverseRegex:"ca[cty][abcdghkmnrstvwy]{5}[agr]tg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF2I","Bco163I"],site:"ctryag",forwardRegex:"ct[agr][cty]ag",reverseRegex:"ct[agr][cty]ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AanI","PsiI"],site:"ttataa",forwardRegex:"t{2}ata{2}",reverseRegex:"t{2}ata{2}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["StySPI"],site:"aacnnnnnngtrc",forwardRegex:"a{2}c[abcdghkmnrstvwy]{6}gt[agr]c",reverseRegex:"g[cty]ac[abcdghkmnrstvwy]{6}gt{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BpuJI","BstDZ247I","BscGI"],site:"cccgt",forwardRegex:"c{3}gt",reverseRegex:"acg{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Hpy99I"],site:"cgwcg",forwardRegex:"cg[atw]cg",reverseRegex:"cg[atw]cg",topSnipOffset:5,bottomSnipOffset:0},{aliases:["BceSI"],site:"mmcgaag",forwardRegex:"[acm]{2}cga{2}g",reverseRegex:"ct{2}cg[gkt]{2}",topSnipOffset:32,bottomSnipOffset:34,isType2S:!0},{aliases:["HaeI"],site:"wggccw",forwardRegex:"[atw]g{2}c{2}[atw]",reverseRegex:"[atw]g{2}c{2}[atw]",topSnipOffset:3,bottomSnipOffset:3},{aliases:["PspPRI"],site:"ccycag",forwardRegex:"c{2}[cty]cag",reverseRegex:"ctg[agr]g{2}",topSnipOffset:21,bottomSnipOffset:19,isType2S:!0},{aliases:["FokI"],site:"ggatg",forwardRegex:"g{2}atg",reverseRegex:"catc{2}",topSnipOffset:14,bottomSnipOffset:18,isType2S:!0},{aliases:["NgoBV","NgoGV","Bsp29I","HpyF44II","Uba1445I","Uba1305I","HpyF73I","BsaEI","BcrI","Rlu3I","BssI"],site:"ggnncc",forwardRegex:"g{2}[abcdghkmnrstvwy]{2}c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]{2}c{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bce1247I"],site:"gcnnnnnnngc",forwardRegex:"gc[abcdghkmnrstvwy]{7}gc",reverseRegex:"gc[abcdghkmnrstvwy]{7}gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AasI","DrdI","DseDI"],site:"gacnnnnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{6}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{6}gtc",topSnipOffset:7,bottomSnipOffset:5},{aliases:["M.SssI"],site:"cg",forwardRegex:"cg",reverseRegex:"cg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyF61III"],site:"cgwcg",forwardRegex:"cg[atw]cg",reverseRegex:"cg[atw]cg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AflIII"],site:"acrygt",forwardRegex:"ac[agr][cty]gt",reverseRegex:"ac[agr][cty]gt",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Asp700I","BbvAI","MroXI","XmnI","PdmI"],site:"gaannnnttc",forwardRegex:"ga{2}[abcdghkmnrstvwy]{4}t{2}c",reverseRegex:"ga{2}[abcdghkmnrstvwy]{4}t{2}c",topSnipOffset:5,bottomSnipOffset:5},{aliases:["ChaI"],site:"gatc",forwardRegex:"gatc",reverseRegex:"gatc",topSnipOffset:4,bottomSnipOffset:0},{aliases:["EcoEI"],site:"gagnnnnnnnatgc",forwardRegex:"gag[abcdghkmnrstvwy]{7}atgc",reverseRegex:"gcat[abcdghkmnrstvwy]{7}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BspAAII","XbaI"],site:"tctaga",forwardRegex:"tctaga",reverseRegex:"tctaga",topSnipOffset:1,bottomSnipOffset:5},{aliases:["Hpy188III","Hpy178III"],site:"tcnnga",forwardRegex:"tc[abcdghkmnrstvwy]{2}ga",reverseRegex:"tc[abcdghkmnrstvwy]{2}ga",topSnipOffset:2,bottomSnipOffset:4},{aliases:["McaTI"],site:"gcgcgc",forwardRegex:"gcgcgc",reverseRegex:"gcgcgc",topSnipOffset:4,bottomSnipOffset:2},{aliases:["BstZ9I","Uba6I","ApeI"],site:"acgcgt",forwardRegex:"acgcgt",reverseRegex:"acgcgt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BspNCI"],site:"ccaga",forwardRegex:"c{2}aga",reverseRegex:"tctg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoHI","Eco1831I","Kpn49kII"],site:"ccsgg",forwardRegex:"c{2}[cgs]g{2}",reverseRegex:"c{2}[cgs]g{2}",topSnipOffset:0,bottomSnipOffset:5},{aliases:["PpsI","PleI"],site:"gagtc",forwardRegex:"gagtc",reverseRegex:"gactc",topSnipOffset:9,bottomSnipOffset:10,isType2S:!0},{aliases:["BfuI","BciVI"],site:"gtatcc",forwardRegex:"gtatc{2}",reverseRegex:"g{2}atac",topSnipOffset:12,bottomSnipOffset:11,isType2S:!0},{aliases:["TthHB27I"],site:"caarca",forwardRegex:"ca{2}[agr]ca",reverseRegex:"tg[cty]t{2}g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PspXI"],site:"vctcgagb",forwardRegex:"[acgmrsv]ctcgag[bcgksty]",reverseRegex:"[acgmrsv]ctcgag[bcgksty]",topSnipOffset:2,bottomSnipOffset:6},{aliases:["Lsp1270I"],site:"rcatgy",forwardRegex:"[agr]catg[cty]",reverseRegex:"[agr]catg[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyC1I","BccI"],site:"ccatc",forwardRegex:"c{2}atc",reverseRegex:"gatg{2}",topSnipOffset:9,bottomSnipOffset:10,isType2S:!0},{aliases:["BseMII"],site:"ctcag",forwardRegex:"ctcag",reverseRegex:"ctgag",topSnipOffset:15,bottomSnipOffset:13,isType2S:!0},{aliases:["BstENI","EcoNI","XagI"],site:"cctnnnnnagg",forwardRegex:"c{2}t[abcdghkmnrstvwy]{5}ag{2}",reverseRegex:"c{2}t[abcdghkmnrstvwy]{5}ag{2}",topSnipOffset:5,bottomSnipOffset:6},{aliases:["EcoAI","Eco1446I"],site:"gagnnnnnnngtca",forwardRegex:"gag[abcdghkmnrstvwy]{7}gtca",reverseRegex:"tgac[abcdghkmnrstvwy]{7}ctc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MmeI"],site:"tccrac",forwardRegex:"tc{2}[agr]ac",reverseRegex:"gt[cty]g{2}a",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["AjiI","BmgBI","BtrI"],site:"cacgtc",forwardRegex:"cacgtc",reverseRegex:"gacgtg",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BlsI"],site:"gcngc",forwardRegex:"gc[abcdghkmnrstvwy]gc",reverseRegex:"gc[abcdghkmnrstvwy]gc",topSnipOffset:3,bottomSnipOffset:2},{aliases:["Bst170I","BsmGI"],site:"tgtaca",forwardRegex:"tgtaca",reverseRegex:"tgtaca",topSnipOffset:1,bottomSnipOffset:1},{aliases:["HpyBII","Hpy166II","Hpy8I"],site:"gtnnac",forwardRegex:"gt[abcdghkmnrstvwy]{2}ac",reverseRegex:"gt[abcdghkmnrstvwy]{2}ac",topSnipOffset:3,bottomSnipOffset:3},{aliases:["StySKI"],site:"cgatnnnnnnngtta",forwardRegex:"cgat[abcdghkmnrstvwy]{7}gt{2}a",reverseRegex:"ta{2}c[abcdghkmnrstvwy]{7}atcg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Esp23I","Esp16I"],site:"cgtctc",forwardRegex:"cgtctc",reverseRegex:"gagacg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BmgT120I"],site:"ggncc",forwardRegex:"g{2}[abcdghkmnrstvwy]c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]c{2}",topSnipOffset:2,bottomSnipOffset:3},{aliases:["BcoAI","BbrPI","PmlI","PspCI","PmaCI","Eco72I","AcvI"],site:"cacgtg",forwardRegex:"cacgtg",reverseRegex:"cacgtg",topSnipOffset:3,bottomSnipOffset:3},{aliases:["CjeP338II","BscUI","BsmNI","BhaI"],site:"gcatc",forwardRegex:"gcatc",reverseRegex:"gatgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["KasI","SspDI"],site:"ggcgcc",forwardRegex:"g{2}cgc{2}",reverseRegex:"g{2}cgc{2}",topSnipOffset:1,bottomSnipOffset:5},{aliases:["FmuI"],site:"ggncc",forwardRegex:"g{2}[abcdghkmnrstvwy]c{2}",reverseRegex:"g{2}[abcdghkmnrstvwy]c{2}",topSnipOffset:4,bottomSnipOffset:1},{aliases:["RseI","MslI","SmiMI"],site:"caynnnnrtg",forwardRegex:"ca[cty][abcdghkmnrstvwy]{4}[agr]tg",reverseRegex:"ca[cty][abcdghkmnrstvwy]{4}[agr]tg",topSnipOffset:5,bottomSnipOffset:5},{aliases:["NmuCI","Tsp45I","Hpy51I"],site:"gtsac",forwardRegex:"gt[cgs]ac",reverseRegex:"gt[cgs]ac",topSnipOffset:0,bottomSnipOffset:5},{aliases:["Psp5II","PpuMI","PpuXI","Pfl27I","PspPPI"],site:"rggwccy",forwardRegex:"[agr]g{2}[atw]c{2}[cty]",reverseRegex:"[agr]g{2}[atw]c{2}[cty]",topSnipOffset:2,bottomSnipOffset:5},{aliases:["Bba179I","Bst1473I","UbaN10I"],site:"wccggw",forwardRegex:"[atw]c{2}g{2}[atw]",reverseRegex:"[atw]c{2}g{2}[atw]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco912I"],site:"cacnnnnntggc",forwardRegex:"cac[abcdghkmnrstvwy]{5}tg{2}c",reverseRegex:"gc{2}a[abcdghkmnrstvwy]{5}gtg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SsmI"],site:"ctgatg",forwardRegex:"ctgatg",reverseRegex:"catcag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EsaSSI"],site:"gaccac",forwardRegex:"gac{2}ac",reverseRegex:"gtg{2}tc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoDI"],site:"ttannnnnnngtcy",forwardRegex:"t{2}a[abcdghkmnrstvwy]{7}gtc[cty]",reverseRegex:"[agr]gac[abcdghkmnrstvwy]{7}ta{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BsoHI","BscHI"],site:"actgg",forwardRegex:"actg{2}",reverseRegex:"c{2}agt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NmeBI"],site:"gacgc",forwardRegex:"gacgc",reverseRegex:"gcgtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NspBII","MspA1I"],site:"cmgckg",forwardRegex:"c[acm]gc[gkt]g",reverseRegex:"c[acm]gc[gkt]g",topSnipOffset:3,bottomSnipOffset:3},{aliases:["BmgAI"],site:"gkgcmc",forwardRegex:"g[gkt]gc[acm]c",reverseRegex:"g[gkt]gc[acm]c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NmeAIII"],site:"gccgag",forwardRegex:"gc{2}gag",reverseRegex:"ctcg{2}c",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["DrdIV"],site:"tacgac",forwardRegex:"tacgac",reverseRegex:"gtcgta",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["BscQII"],site:"gtctc",forwardRegex:"gtctc",reverseRegex:"gagac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AbsI"],site:"cctcgagg",forwardRegex:"c{2}tcgag{2}",reverseRegex:"c{2}tcgag{2}",topSnipOffset:2,bottomSnipOffset:6},{aliases:["Psp03I"],site:"ggwcc",forwardRegex:"g{2}[atw]c{2}",reverseRegex:"g{2}[atw]c{2}",topSnipOffset:4,bottomSnipOffset:1},{aliases:["BmtI","BspOI","AceII"],site:"gctagc",forwardRegex:"gctagc",reverseRegex:"gctagc",topSnipOffset:5,bottomSnipOffset:1},{aliases:["GsaI"],site:"cccagc",forwardRegex:"c{3}agc",reverseRegex:"gctg{3}",topSnipOffset:5,bottomSnipOffset:1},{aliases:["UbaF9I"],site:"tacnnnnnrtgt",forwardRegex:"tac[abcdghkmnrstvwy]{5}[agr]tgt",reverseRegex:"aca[cty][abcdghkmnrstvwy]{5}gta",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Hin1II","NlaIII","FaeI","Hsp92II","HpyCH4I"],site:"catg",forwardRegex:"catg",reverseRegex:"catg",topSnipOffset:4,bottomSnipOffset:0},{aliases:["Bbr7I"],site:"gaagac",forwardRegex:"ga{2}gac",reverseRegex:"gtct{2}c",topSnipOffset:13,bottomSnipOffset:17,isType2S:!0},{aliases:["Kaz48kI","PssI"],site:"rggnccy",forwardRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",reverseRegex:"[agr]g{2}[abcdghkmnrstvwy]c{2}[cty]",topSnipOffset:5,bottomSnipOffset:2},{aliases:["BoxI","BstPAI","PshAI"],site:"gacnnnngtc",forwardRegex:"gac[abcdghkmnrstvwy]{4}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{4}gtc",topSnipOffset:5,bottomSnipOffset:5},{aliases:["SgrDI"],site:"cgtcgacg",forwardRegex:"cgtcgacg",reverseRegex:"cgtcgacg",topSnipOffset:2,bottomSnipOffset:6},{aliases:["BssIMI","SimI"],site:"gggtc",forwardRegex:"g{3}tc",reverseRegex:"gac{3}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["RleAI"],site:"cccaca",forwardRegex:"c{3}aca",reverseRegex:"tgtg{3}",topSnipOffset:18,bottomSnipOffset:15,isType2S:!0},{aliases:["EciI"],site:"ggcgga",forwardRegex:"g{2}cg{2}a",reverseRegex:"tc{2}gc{2}",topSnipOffset:17,bottomSnipOffset:15,isType2S:!0},{aliases:["Eco57MI"],site:"ctgrag",forwardRegex:"ctg[agr]ag",reverseRegex:"ct[cty]cag",topSnipOffset:22,bottomSnipOffset:20,isType2S:!0},{aliases:["AspJI","Ppu1253I"],site:"gacgtc",forwardRegex:"gacgtc",reverseRegex:"gacgtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaF11I"],site:"tcgta",forwardRegex:"tcgta",reverseRegex:"tacga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SetI"],site:"asst",forwardRegex:"a[cgs]{2}t",reverseRegex:"a[cgs]{2}t",topSnipOffset:4,bottomSnipOffset:0},{aliases:["PspOMII"],site:"cgcccar",forwardRegex:"cgc{3}a[agr]",reverseRegex:"[cty]tg{3}cg",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["BsxI"],site:"actggg",forwardRegex:"actg{3}",reverseRegex:"c{3}agt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco394I"],site:"gacnnnnnrtaay",forwardRegex:"gac[abcdghkmnrstvwy]{5}[agr]ta{2}[cty]",reverseRegex:"[agr]t{2}a[cty][abcdghkmnrstvwy]{5}gtc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["ApyPI"],site:"atcgac",forwardRegex:"atcgac",reverseRegex:"gtcgat",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["AlwNI","CaiI"],site:"cagnnnctg",forwardRegex:"cag[abcdghkmnrstvwy]{3}ctg",reverseRegex:"cag[abcdghkmnrstvwy]{3}ctg",topSnipOffset:6,bottomSnipOffset:3},{aliases:["TsuI"],site:"gcgac",forwardRegex:"gcgac",reverseRegex:"gtcgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Bca77I","BsaWI","BetI"],site:"wccggw",forwardRegex:"[atw]c{2}g{2}[atw]",reverseRegex:"[atw]c{2}g{2}[atw]",topSnipOffset:1,bottomSnipOffset:5},{aliases:["EcoDR3"],site:"tcannnnnnnatcg",forwardRegex:"tca[abcdghkmnrstvwy]{7}atcg",reverseRegex:"cgat[abcdghkmnrstvwy]{7}tga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SgrAI"],site:"crccggyg",forwardRegex:"c[agr]c{2}g{2}[cty]g",reverseRegex:"c[agr]c{2}g{2}[cty]g",topSnipOffset:2,bottomSnipOffset:6},{aliases:["M.NgoMXV"],site:"gcchr",forwardRegex:"gc{2}[achmtwy][agr]",reverseRegex:"[cty][adgkrtw]g{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["EcoRD2"],site:"gaannnnnnrttc",forwardRegex:"ga{2}[abcdghkmnrstvwy]{6}[agr]t{2}c",reverseRegex:"ga{2}[cty][abcdghkmnrstvwy]{6}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TspGWI"],site:"acgga",forwardRegex:"acg{2}a",reverseRegex:"tc{2}gt",topSnipOffset:16,bottomSnipOffset:14,isType2S:!0},{aliases:["CviAII"],site:"catg",forwardRegex:"catg",reverseRegex:"catg",topSnipOffset:1,bottomSnipOffset:3},{aliases:["XcmI"],site:"ccannnnnnnnntgg",forwardRegex:"c{2}a[abcdghkmnrstvwy]{9}tg{2}",reverseRegex:"c{2}a[abcdghkmnrstvwy]{9}tg{2}",topSnipOffset:8,bottomSnipOffset:7},{aliases:["EcoRD3"],site:"gaannnnnnnrttc",forwardRegex:"ga{2}[abcdghkmnrstvwy]{7}[agr]t{2}c",reverseRegex:"ga{2}[cty][abcdghkmnrstvwy]{7}t{2}c",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SpoDI"],site:"gcggrag",forwardRegex:"gcg{2}[agr]ag",reverseRegex:"ct[cty]c{2}gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaN12I"],site:"cacgag",forwardRegex:"cacgag",reverseRegex:"ctcgtg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PspFI"],site:"cccagc",forwardRegex:"c{3}agc",reverseRegex:"gctg{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PfoI"],site:"tccngga",forwardRegex:"tc{2}[abcdghkmnrstvwy]g{2}a",reverseRegex:"tc{2}[abcdghkmnrstvwy]g{2}a",topSnipOffset:1,bottomSnipOffset:6},{aliases:["Sse8647I"],site:"aggwcct",forwardRegex:"ag{2}[atw]c{2}t",reverseRegex:"ag{2}[atw]c{2}t",topSnipOffset:2,bottomSnipOffset:5},{aliases:["KflI","Sse1825I","SanDI"],site:"gggwccc",forwardRegex:"g{3}[atw]c{3}",reverseRegex:"g{3}[atw]c{3}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["Sth132I"],site:"cccg",forwardRegex:"c{3}g",reverseRegex:"cg{3}",topSnipOffset:8,bottomSnipOffset:12,isType2S:!0},{aliases:["CdpI"],site:"gcggag",forwardRegex:"gcg{2}ag",reverseRegex:"ctc{2}gc",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["Asp90I"],site:"acrygt",forwardRegex:"ac[agr][cty]gt",reverseRegex:"ac[agr][cty]gt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["M.CviPI"],site:"gc",forwardRegex:"gc",reverseRegex:"gc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["MauBI"],site:"cgcgcgcg",forwardRegex:"cgcgcgcg",reverseRegex:"cgcgcgcg",topSnipOffset:2,bottomSnipOffset:6},{aliases:["CfrAI"],site:"gcannnnnnnngtgg",forwardRegex:"gca[abcdghkmnrstvwy]{8}gtg{2}",reverseRegex:"c{2}ac[abcdghkmnrstvwy]{8}tgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Eco851I"],site:"gtcannnnnntgay",forwardRegex:"gtca[abcdghkmnrstvwy]{6}tga[cty]",reverseRegex:"[agr]tca[abcdghkmnrstvwy]{6}tgac",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BsgI"],site:"gtgcag",forwardRegex:"gtgcag",reverseRegex:"ctgcac",topSnipOffset:22,bottomSnipOffset:20,isType2S:!0},{aliases:["AquIV"],site:"grggaag",forwardRegex:"g[agr]g{2}a{2}g",reverseRegex:"ct{2}c{2}[cty]c",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["SciI"],site:"ctcgag",forwardRegex:"ctcgag",reverseRegex:"ctcgag",topSnipOffset:3,bottomSnipOffset:3},{aliases:["VpaK11AI"],site:"ggwcc",forwardRegex:"g{2}[atw]c{2}",reverseRegex:"g{2}[atw]c{2}",topSnipOffset:0,bottomSnipOffset:5},{aliases:["CviKI","CviJI","CviKI-1"],site:"rgcy",forwardRegex:"[agr]gc[cty]",reverseRegex:"[agr]gc[cty]",topSnipOffset:2,bottomSnipOffset:2},{aliases:["SnoI","VneI","ApaLI","Alw44I"],site:"gtgcac",forwardRegex:"gtgcac",reverseRegex:"gtgcac",topSnipOffset:1,bottomSnipOffset:5},{aliases:["BspD6I"],site:"gactc",forwardRegex:"gactc",reverseRegex:"gagtc",topSnipOffset:9,bottomSnipOffset:11,isType2S:!0},{aliases:["FatI"],site:"catg",forwardRegex:"catg",reverseRegex:"catg",topSnipOffset:0,bottomSnipOffset:4},{aliases:["ZraI"],site:"gacgtc",forwardRegex:"gacgtc",reverseRegex:"gacgtc",topSnipOffset:3,bottomSnipOffset:3},{aliases:["HineI","HinfIII"],site:"cgaat",forwardRegex:"cga{2}t",reverseRegex:"at{2}cg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaF12I"],site:"ctacnnngtc",forwardRegex:"ctac[abcdghkmnrstvwy]{3}gtc",reverseRegex:"gac[abcdghkmnrstvwy]{3}gtag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Ppu10I"],site:"atgcat",forwardRegex:"atgcat",reverseRegex:"atgcat",topSnipOffset:1,bottomSnipOffset:5},{aliases:["ApaBI"],site:"gcannnnntgc",forwardRegex:"gca[abcdghkmnrstvwy]{5}tgc",reverseRegex:"gca[abcdghkmnrstvwy]{5}tgc",topSnipOffset:8,bottomSnipOffset:3},{aliases:["NhaXI"],site:"caagrag",forwardRegex:"ca{2}g[agr]ag",reverseRegex:"ct[cty]ct{2}g",topSnipOffset:1,bottomSnipOffset:1},{aliases:["PabI"],site:"gtac",forwardRegex:"gtac",reverseRegex:"gtac",topSnipOffset:3,bottomSnipOffset:1},{aliases:["HindI"],site:"cac",forwardRegex:"cac",reverseRegex:"gtg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["M.PhiMx8I"],site:"ctssag",forwardRegex:"ct[cgs]{2}ag",reverseRegex:"ct[cgs]{2}ag",topSnipOffset:1,bottomSnipOffset:1},{aliases:["RhcI"],site:"tcatga",forwardRegex:"tcatga",reverseRegex:"tcatga",topSnipOffset:1,bottomSnipOffset:1},{aliases:["KpnI"],site:"ggtacc",forwardRegex:"g{2}tac{2}",reverseRegex:"g{2}tac{2}",topSnipOffset:5,bottomSnipOffset:1},{aliases:["BpuDI","Bpu10I"],site:"cctnagc",forwardRegex:"c{2}t[abcdghkmnrstvwy]agc",reverseRegex:"gct[abcdghkmnrstvwy]ag{2}",topSnipOffset:2,bottomSnipOffset:5},{aliases:["EcoP15I"],site:"cagcag",forwardRegex:"cagcag",reverseRegex:"ctgctg",topSnipOffset:31,bottomSnipOffset:33,isType2S:!0},{aliases:["Nli3877I"],site:"cycgrg",forwardRegex:"c[cty]cg[agr]g",reverseRegex:"c[cty]cg[agr]g",topSnipOffset:5,bottomSnipOffset:1},{aliases:["StySEAI"],site:"acannnnnntyca",forwardRegex:"aca[abcdghkmnrstvwy]{6}t[cty]ca",reverseRegex:"tg[agr]a[abcdghkmnrstvwy]{6}tgt",topSnipOffset:1,bottomSnipOffset:1},{aliases:["M.CviAIV"],site:"rgcb",forwardRegex:"[agr]gc[bcgksty]",reverseRegex:"[acgmrsv]gc[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["Msp16I"],site:"tggcca",forwardRegex:"tg{2}c{2}a",reverseRegex:"tg{2}c{2}a",topSnipOffset:1,bottomSnipOffset:1},{aliases:["SasI"],site:"gaggag",forwardRegex:"gag{2}ag",reverseRegex:"ctc{2}tc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["AquIII"],site:"gaggag",forwardRegex:"gag{2}ag",reverseRegex:"ctc{2}tc",topSnipOffset:26,bottomSnipOffset:24,isType2S:!0},{aliases:["FaiI"],site:"yatr",forwardRegex:"[cty]at[agr]",reverseRegex:"[cty]at[agr]",topSnipOffset:2,bottomSnipOffset:2},{aliases:["BsbI"],site:"caacac",forwardRegex:"ca{2}cac",reverseRegex:"gtgt{2}g",topSnipOffset:27,bottomSnipOffset:25,isType2S:!0},{aliases:["NgoAV"],site:"gcannnnnnnntgc",forwardRegex:"gca[abcdghkmnrstvwy]{8}tgc",reverseRegex:"gca[abcdghkmnrstvwy]{8}tgc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["BstAPI"],site:"gcannnnntgc",forwardRegex:"gca[abcdghkmnrstvwy]{5}tgc",reverseRegex:"gca[abcdghkmnrstvwy]{5}tgc",topSnipOffset:7,bottomSnipOffset:4},{aliases:["BsmEI"],site:"gagtc",forwardRegex:"gagtc",reverseRegex:"gactc",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NcuII"],site:"cccg",forwardRegex:"c{3}g",reverseRegex:"cg{3}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["CviMI","CviNI","CviLI","CviOI"],site:"rgcy",forwardRegex:"[agr]gc[cty]",reverseRegex:"[agr]gc[cty]",topSnipOffset:1,bottomSnipOffset:1},{aliases:["StySGI"],site:"taannnnnnrtcg",forwardRegex:"ta{2}[abcdghkmnrstvwy]{6}[agr]tcg",reverseRegex:"cga[cty][abcdghkmnrstvwy]{6}t{2}a",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaF14I"],site:"ccannnnntcg",forwardRegex:"c{2}a[abcdghkmnrstvwy]{5}tcg",reverseRegex:"cga[abcdghkmnrstvwy]{5}tg{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["UbaPI"],site:"cgaacg",forwardRegex:"cga{2}cg",reverseRegex:"cgt{2}cg",topSnipOffset:1,bottomSnipOffset:1},{aliases:["TspDTI"],site:"atgaa",forwardRegex:"atga{2}",reverseRegex:"t{2}cat",topSnipOffset:16,bottomSnipOffset:14,isType2S:!0},{aliases:["SspI"],site:"aatatt",forwardRegex:"a{2}tat{2}",reverseRegex:"a{2}tat{2}",topSnipOffset:3,bottomSnipOffset:3},{aliases:["GdiII"],site:"cggccr",forwardRegex:"cg{2}c{2}[agr]",reverseRegex:"[cty]g{2}c{2}g",topSnipOffset:1,bottomSnipOffset:5},{aliases:["StySQI"],site:"aacnnnnnnrtayg",forwardRegex:"a{2}c[abcdghkmnrstvwy]{6}[agr]ta[cty]g",reverseRegex:"c[agr]ta[cty][abcdghkmnrstvwy]{6}gt{2}",topSnipOffset:1,bottomSnipOffset:1},{aliases:["NlaCI"],site:"catcac",forwardRegex:"catcac",reverseRegex:"gtgatg",topSnipOffset:25,bottomSnipOffset:23,isType2S:!0},{aliases:["PacI"],site:"ttaattaa",forwardRegex:"t{2}a{2}t{2}a{2}",reverseRegex:"t{2}a{2}t{2}a{2}",topSnipOffset:5,bottomSnipOffset:3},{aliases:["BarI"],isType2S:!0,site:"gaagnnnnnntac",forwardRegex:"ga{2}g[abcdghkmnrstvwy]{6}tac",reverseRegex:"gta[abcdghkmnrstvwy]{6}ct{2}c",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20},{aliases:["CspCI"],isType2S:!0,site:"caannnnngtgg",forwardRegex:"ca{2}[abcdghkmnrstvwy]{5}gtg{2}",reverseRegex:"c{2}ac[abcdghkmnrstvwy]{5}t{2}g",topSnipOffset:24,bottomSnipOffset:22,cutType:1,usForward:24,usReverse:22},{aliases:["NmeDI"],site:"rccggy",forwardRegex:"[agr]c{2}g{2}[cty]",reverseRegex:"[agr]c{2}g{2}[cty]",topSnipOffset:13,bottomSnipOffset:18,cutType:1,usForward:13,usReverse:18,isType2S:!0},{aliases:["CjePI"],site:"ccannnnnnntc",forwardRegex:"c{2}a[abcdghkmnrstvwy]{7}tc",reverseRegex:"ga[abcdghkmnrstvwy]{7}tg{2}",topSnipOffset:26,bottomSnipOffset:20,cutType:1,usForward:26,usReverse:20,isType2S:!0},{aliases:["CjeI"],site:"ccannnnnngt",forwardRegex:"c{2}a[abcdghkmnrstvwy]{6}gt",reverseRegex:"ac[abcdghkmnrstvwy]{6}tg{2}",topSnipOffset:26,bottomSnipOffset:20,cutType:1,usForward:26,usReverse:20,isType2S:!0},{aliases:["PsrI"],site:"gaacnnnnnntac",forwardRegex:"ga{2}c[abcdghkmnrstvwy]{6}tac",reverseRegex:"gta[abcdghkmnrstvwy]{6}gt{2}c",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20,isType2S:!0},{aliases:["ArsI"],site:"gacnnnnnnttyg",forwardRegex:"gac[abcdghkmnrstvwy]{6}t{2}[cty]g",reverseRegex:"c[agr]a{2}[abcdghkmnrstvwy]{6}gtc",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["TstI"],site:"cacnnnnnntcc",forwardRegex:"cac[abcdghkmnrstvwy]{6}tc{2}",reverseRegex:"g{2}a[abcdghkmnrstvwy]{6}gtg",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["Bsp24I"],site:"gacnnnnnntgg",forwardRegex:"gac[abcdghkmnrstvwy]{6}tg{2}",reverseRegex:"c{2}a[abcdghkmnrstvwy]{6}gtc",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["AloI"],site:"gaacnnnnnntcc",forwardRegex:"ga{2}c[abcdghkmnrstvwy]{6}tc{2}",reverseRegex:"g{2}a[abcdghkmnrstvwy]{6}gt{2}c",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20,isType2S:!0},{aliases:["FalI"],site:"aagnnnnnctt",forwardRegex:"a{2}g[abcdghkmnrstvwy]{5}ct{2}",reverseRegex:"a{2}g[abcdghkmnrstvwy]{5}ct{2}",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["AjuI"],site:"gaannnnnnnttgg",forwardRegex:"ga{2}[abcdghkmnrstvwy]{7}t{2}g{2}",reverseRegex:"c{2}a{2}[abcdghkmnrstvwy]{7}t{2}c",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20,isType2S:!0},{aliases:["AlfI"],site:"gcannnnnntgc",forwardRegex:"gca[abcdghkmnrstvwy]{6}tgc",reverseRegex:"gca[abcdghkmnrstvwy]{6}tgc",topSnipOffset:24,bottomSnipOffset:22,cutType:1,usForward:24,usReverse:22,isType2S:!0},{aliases:["NgoAVIII"],site:"gacnnnnntga",forwardRegex:"gac[abcdghkmnrstvwy]{5}tga",reverseRegex:"tca[abcdghkmnrstvwy]{5}gtc",topSnipOffset:24,bottomSnipOffset:22,cutType:1,usForward:24,usReverse:22,isType2S:!0},{aliases:["HaeIV"],site:"gaynnnnnrtc",forwardRegex:"ga[cty][abcdghkmnrstvwy]{5}[agr]tc",reverseRegex:"ga[cty][abcdghkmnrstvwy]{5}[agr]tc",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20,isType2S:!0},{aliases:["BdaI"],site:"tgannnnnntca",forwardRegex:"tga[abcdghkmnrstvwy]{6}tca",reverseRegex:"tga[abcdghkmnrstvwy]{6}tca",topSnipOffset:24,bottomSnipOffset:22,cutType:1,usForward:24,usReverse:22,isType2S:!0},{aliases:["PpiI"],site:"gaacnnnnnctc",forwardRegex:"ga{2}c[abcdghkmnrstvwy]{5}ctc",reverseRegex:"gag[abcdghkmnrstvwy]{5}gt{2}c",topSnipOffset:25,bottomSnipOffset:20,cutType:1,usForward:25,usReverse:20,isType2S:!0},{aliases:["BcgI"],site:"cgannnnnntgc",forwardRegex:"cga[abcdghkmnrstvwy]{6}tgc",reverseRegex:"gca[abcdghkmnrstvwy]{6}tcg",topSnipOffset:24,bottomSnipOffset:22,cutType:1,usForward:24,usReverse:22,isType2S:!0},{aliases:["BplI"],site:"gagnnnnnctc",forwardRegex:"gag[abcdghkmnrstvwy]{5}ctc",reverseRegex:"gag[abcdghkmnrstvwy]{5}ctc",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["BsaXI"],site:"acnnnnnctcc",forwardRegex:"ac[abcdghkmnrstvwy]{5}ctc{2}",reverseRegex:"g{2}ag[abcdghkmnrstvwy]{5}gt",topSnipOffset:21,bottomSnipOffset:18,cutType:1,usForward:21,usReverse:18,isType2S:!0},{aliases:["Hin4I"],site:"gaynnnnnvtc",forwardRegex:"ga[cty][abcdghkmnrstvwy]{5}[acgmrsv]tc",reverseRegex:"ga[bcgksty][abcdghkmnrstvwy]{5}[agr]tc",topSnipOffset:24,bottomSnipOffset:19,cutType:1,usForward:24,usReverse:19,isType2S:!0},{aliases:["BaeI"],site:"acnnnngtayc",forwardRegex:"ac[abcdghkmnrstvwy]{4}gta[cty]c",reverseRegex:"g[agr]tac[abcdghkmnrstvwy]{4}gt",topSnipOffset:23,bottomSnipOffset:18,cutType:1,usForward:23,usReverse:18,isType2S:!0},{aliases:["SdeOSI"],site:"gacnnnnrtga",forwardRegex:"gac[abcdghkmnrstvwy]{4}[agr]tga",reverseRegex:"tca[cty][abcdghkmnrstvwy]{4}gtc",topSnipOffset:23,bottomSnipOffset:21,cutType:1,usForward:23,usReverse:21,isType2S:!0}],C3={};Wge.forEach(function(n){n.aliases.forEach(function(e){C3[e.toLowerCase()]=Vge({},n,{name:e})})});var R3=C3,Gge=R3,Hge=["aari","aatii","aaui","accebi","acci","accii","acciii","acsi","afai","aflii","alui","aor13hi","aor51hi","apai","apali","asci","asisi","asp35hi","asp713i","aspmi","atsi","atu1i","atu1ii","avrbi","avrii","bali","bamhi","banii","bari","baui","bbvbi","bcni","bcoki","bdii","bgli","bglii","blni","bme216i","bmet110i","bmgt120i","bmui","bnai","bpu1102i","bpuai","bpub5i","bsai","bsavi","bseri","bsgi","bshhi","bsiwi","bsmbi","bsmfi","bsofi","bsp105i","bsp1286i","bsp139i","bsp1407i","bsp4009i","bsp70i","bsp71i","bspa2i","bspci","bspfni","bspt104i","bspt107i","bsrfi","bsshii","bst1107i","bstb7si","bsthi","bstiz316i","bstli","bstpi","bstri","bstxi","bsu1532i","bsu8565i","bsu90i","btgai","btsci","btsi","bvei","ccini","ccop95i","ceqi","cfr10i","cfr45i","cfr47i","cfr6i","cjuii","clai","cpaai","cpoi","cspai","cspci","ddei","dpni","drai","dsai","dsavi","eaei","eagi","eam1105i","ecidi","ecl37i","eco211i","eco240i","eco241i","eco246i","eco247i","eco52i","eco68i","eco81i","eco93i","ecoicri","ecoo109i","ecoo65i","ecopi","ecoprri","ecori","ecorv","ecot14i","ecot22i","ecoviii","ehei","esphk22i","fbai","fdiii","foki","fsei","haeii","haeiii","hapii","hgiai","hgibi","hhai","hin1i","hincii","hindiii","hinfi","hpai","hpyf13iii","hpyf19ii","hpyf21i","hpyf28i","hpyf29i","hpyf36i","hpyf62i","hpyf65i","hpyii","koyi","kpni","m.bbu297i","m.pmudam","maek81i","mboi","mboii","mfli","mizi","mlui","mph1103ii","msei","msii","mspi","mthai","muni","naei","ncoi","ndai","ndei","nflaii","ngbi","ngobviii","ngodviii","ngoeii","ngotii","nhei","nlaiv","noci","noti","novii","nrui","nsbi","nsici","nsp29132i","paci","pae17ki","pca17ai","pfaaiii","pfl16i","ple214i","pmaci","pmei","pru2i","psb9879i","pshai","pshbi","psp1406i","psp31i","psp33i","psp5i","psti","psuni","pvui","pvuii","ral8i","rsplki","saci","sacii","sali","sapi","sau3ai","sauni","sbai","sbfi","scai","sfii","sflhk115731i","slu1777i","smai","smii","snabi","spei","sphi","srfi","srl61di","sse8387i","ssp2i","sspi","stui","suii","swai","taqi","tauii","tsci","tth111i","tthhb8i","uba1093i","uba1095i","uba1122i","uba1160i","uba1229i","uba1371i","uba1380i","uba1403i","uba1415i","uba1437i","uba1439i","uba1440i","uba36i","uba41i","uba42i","uba89i","uban13i","van91i","vcho66i","vpak11bi","vpakutji","xbai","xcyi","xhoi","xmai","xmli","xphi","xspi"],k3={};Hge.forEach(function(n){k3[n]=Gge[n]});var qge=k3,jge=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Kge=pt,Xge=Kge.generateRandomRange,Yge=fu;function Zge(n,e,t,r){for(var s={},i=0;i<n;i++){var a=Jge(e,t,r);s[a.id]=a}return s}function Jge(n,e,t){var r=Xge(n,e,t);return jge({},r,{name:Qge(0,1e5).toString(),type:"misc_feature",id:Yge().str,forward:Math.random()>.5,notes:{}})}function Qge(n,e){return Math.floor(Math.random()*(e-n))+n}var E3=Zge,cp=E3,eme=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.isProtein,r=e.sequenceLength,s=r===void 0?1e3:r,i=e.numFeatures,a=e.numParts,o=e.numPrimers,c=e.numTranslations,l=t&&ok(s,!0),u=!t&&ok(s);return{circular:t?!1:Math.random()>.5,name:"p-"+Math.floor(Math.random*100),description:"",isProtein:t,sequence:u,proteinSequence:l,translations:t?void 0:cp(c||5,0,s-1,s/3),features:cp(i||10,0,s-1,s/3),primers:t?void 0:cp(o||10,0,s-1,50),parts:cp(a||10,0,s-1,s/3)}};function ok(){for(var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:9,e=arguments[1],t="",r=e?"":"gatc",s=0;s<n;s++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}var tme=pt,nme=tme.normalizeRange;function rme(n,e,t,r){if(t||(t=0),n.length<e.length)return null;for(var s=new RegExp(e,"ig"),i,a,o=1/0;(i=s.exec(n+(r?"":n)))&&!(i.index>n.length);){var c=Math.abs(i.index-t);if(c=r?c:Math.min(c,Math.abs(c-n.length)),c>o)break;a=i.index,o=c}return nme({start:a,end:a+e.length-1},n.length)}var sme=rme,ime=fu,ame=Vo,T3=function(e){var t=e.sequence,r=e.minimumOrfSize,s=e.forward,i=e.circular,a=e.useAdditionalOrfStartCodons,o=t.length;s||(t=ame(t)),i&&(t+=t);for(var c=a?/(?=((?:A[TU]G|G[TU]G|C[TU]G)(?:.{3})*?(?:[TU]AG|[TU]AA|[TU]GA)))/gi:/(?=((?:A[TU]G)(?:.{3})*?(?:[TU]AG|[TU]AA|[TU]GA)))/gi,l=void 0,u=[];(l=c.exec(t))!==null;){l.index===c.lastIndex&&c.lastIndex++;var f=l[1].length;if(f>=r){var d=l.index,p=f+d-1;p>=o&&(p-=o),d<o&&u.push({start:d,end:p,length:l[1].length,internalStartCodonIndices:[],frame:d%3,forward:s,annotationTypePlural:"orfs",isOrf:!0,id:ime().str})}}var m={};u.forEach(function(v,b){var y=m[v.end];if(typeof y<"u"){var S=v,w=u[y];w.length<S.length&&(S=u[y],w=v,m[v.end]=b);var C=s?S.start:o-S.start-1;w.internalStartCodonIndices=[].concat(w.internalStartCodonIndices,S.internalStartCodonIndices,[C]),S.remove=!0}else if(m[v.end]=b,!s){var N=v.end;v.end=o-v.start-1,v.start=o-N-1}});var I=u.filter(function(v){return!v.remove});return I},ck=T3,ome=function(e,t,r,s){var i=ck({sequence:e,minimumOrfSize:r,forward:!0,circular:t,useAdditionalOrfStartCodons:s}),a=ck({sequence:e,minimumOrfSize:r,forward:!1,circular:t,useAdditionalOrfStartCodons:s});return i.concat(a)},cme=/[|\\{}()[\]^$+*?.]/g,lme=function(n){if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(cme,"\\$&")},ume=Km,Ym=function(e){var t=ume(e,!0),r=[],s="";return t.forEach(function(i){i.fullCodon&&(r[i.aminoAcidIndex]=i.aminoAcid.value)}),s=r.join(""),s},fme=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},A3=pt,hme=A3.modulateRangeBySequenceLength,dme=A3.flipContainedRange,$3=zt,pme=$3.reduce,gme=$3.uniqBy,mme=lme,J1=Ym,N3=Xn,vme=N3.ambiguous_dna_values,Ime=N3.extended_protein_values,bme=Vo,yme=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=lk(e,t,r),i=r.searchReverseStrand;if(i){var a=e.length,o=void 0;o=bme(e);var c=lk(o,t,r),l=c.map(function(u){return fme({},dme(u,{start:0,end:a-1},a),{bottomStrand:!0})});s=[].concat(s,l)}return s};function lk(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=t.isCircular,s=t.isAmbiguous,i=t.isProteinSequence,a=t.isProteinSearch,o=mme(e);if(s&&(a||i?o=uk(o,!0):o=uk(o)),!o)return[];var c=n;r&&(c=c+c);var l=[{seqToCheck:c,offset:0}];a&&(l=[{seqToCheck:J1(c),offset:0},{seqToCheck:J1(c.substr(1)),offset:1},{seqToCheck:J1(c.substr(2)),offset:2}]);var u=[];return l.forEach(function(f){for(var d=f.seqToCheck,p=f.offset,m=new RegExp(o,"ig"),I=void 0,v=void 0;(I=m.exec(d))!==null;)v={start:I.index,end:I.index+e.length-1},a&&(v.start=v.start*3+p,v.end=v.end*3+2+p),u.push(hme(v,n.length)),m.lastIndex=I.index+1}),gme(u,function(f){return f.start+"-"+f.end})}function uk(n,e){return pme(n,function(t,r){var s=e?Ime[r.toUpperCase()]:vme[r.toUpperCase()];return s&&(s.length===1?t+=s:t+="["+s+"]"),t},"")}var xme=function(e,t,r,s){var i=r[s-1];if(i&&i.aminoAcidIndex===t.aminoAcidIndex){var a=r[s-2];return a&&a.aminoAcidIndex===t.aminoAcidIndex?{start:e-2,end:e}:t.fullCodon===!0?{start:e-1,end:e+1}:{start:e-1,end:e}}else{if(t.fullCodon===!0)return{start:e,end:e+2};var o=r[s-2];return o&&o.aminoAcidIndex===t.aminoAcidIndex?{start:e,end:e+1}:{start:e,end:e+1}}},wme=Ym,Sme=function(e){var t=wme(e);return t.split("").reverse().join("")},Cme=Gx,Zm=function(e){for(var t="",r=0;r<e.length;r++){var s=Cme[e[r]];s||(s=e[r]),t+=s}return t},Rme=tw,O3=Rme,Jm=zt,kme=Jm.flatMap,_3=Jm.extend,Eme=Jm.forEach,Tme=Jm.startCase,Ame=pt,uf=Ame.getRangeLength,$me=Qx,Nme=O3,F3=pt,fk=F3.getSequenceWithinRange,Ome=F3.getZeroedRangeOverlaps,Q1=qc,ev=Ja,nw=function n(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!t)return e;var s=r.exclude,i=s===void 0?{}:s,a=r.excludePartial,o=a===void 0?{}:a,c=Q1(e,r);ev.forEach(function(d){delete c["filtered"+Tme(d)]});var l=_3({},c,{circular:c.sequence.length===uf(t,e.sequence.length)?c.circular:!1,sequence:fk(t,c.sequence),proteinSequence:fk($me(t),c.proteinSequence)},ev.reduce(function(d,p){return i[p]?(d[p]=[],d):(d[p]=D3(c[p],t,c.sequence.length,o[p]),d)},{}));if(t.overlapsSelf){var u=Nme({sequence:l.sequence},c,t.start),f=n(u,{start:t.end+1,end:t.end},r);return ev.forEach(function(d){Eme(f[d],function(p){p.overlapsSelf&&p.start===0&&uf(p,c.sequence.length)===uf(t,c.sequence.length)&&(p.overlapsSelf=!1,p.end=f.sequence.length-1)})}),Q1(f,r)}return Q1(l,r)};function D3(n,e,t,r){return kme(n,function(s){s.locations&&s.locations.length&&(s.locations=D3(s.locations,e,t,r));var i=Ome(s,e,t).map(function(a){return _3({},s,a)});if(r){if(i.length>1)return[];if(i[0]&&uf(i[0],t)!==uf(s,t))return[]}return i}).map(function(s){return s.locations&&s.locations.length&&(s.start=s.locations[0].start,s.end=s.locations[s.locations.length-1].end,s.locations.length===1&&delete s.locations),s})}var _me=Zm,hk=qc,Fme=nw,Dme=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=hk(Fme(e,t.range),t),s=Object.assign({},r,{sequence:_me(r.sequence)});return hk(s,t)},Bme=Xm,B3=function(e,t,r){for(var s={},i=0;i<r.length;i++){var a=r[i],o=Bme(e,t,a);o.length&&(s[a.name]=o)}return s},Mme=function(e){var t=e.topSnipOffset,r=e.bottomSnipOffset;return t===r?"blunt":t<r?"5' overhang":"3' overhang"},Qm={},M3=zt,Pme=M3.flatMap,dk=M3.cloneDeep,Lme=fu,P3=pt,lp=P3.normalizePositionByRangeLength,tv=P3.getRangeLength,Ume=B3;function L3(n){var e=n.cutsites,t=n.sequenceLength,r=n.circular,s=n.includeOverAndUnderHangs,i=n.computePartialDigest,a=n.computeDigestDisabled,o=n.computePartialDigestDisabled,c=n.selectionLayerUpdate,l=n.updateSelectedFragment,u=[],f=[],d=[],p=e.sort(function(m,I){return m.topSnipPosition-I.topSnipPosition});return!r&&e.length&&p.push({id:"seqTerm_"+Lme().str,start:0,end:0,overhangBps:"",topSnipPosition:0,bottomSnipPosition:0,upstreamTopSnip:0,upstreamBottomSnip:0,upstreamTopBeforeBottom:!1,topSnipBeforeBottom:!1,recognitionSiteRange:{start:0,end:0},forward:!0,name:"Sequence_Terminus",restrictionEnzyme:{name:"Sequence_Terminus"}}),p.forEach(function(m,I){i&&!o&&p.forEach(function(v,b){b===I+1||b===0||d.push([m,p[b]])}),a||d.push([m,p[I+1]?p[I+1]:p[0]])}),d.forEach(function(m){var I=m[0],v=m[1],b=void 0,y=void 0,S=void 0;b=lp(I.topSnipPosition,t),y=lp(v.topSnipPosition-1,t),S=tv({start:b,end:y},t);var w=void 0;if(s){var C=S;b=lp(I.topSnipBeforeBottom?I.topSnipPosition:I.bottomSnipPosition,t),y=lp(v.topSnipBeforeBottom?v.bottomSnipPosition-1:v.topSnipPosition-1,t),S=tv({start:b,end:y},t),C>S&&(w=!0,S+=t)}var N=void 0;I.name==="Sequence_Terminus"?(I=dk(I),N=!0,I.name="Linear_Sequence_Start",I.restrictionEnzyme.name="Linear_Sequence_Start"):v.name==="Sequence_Terminus"&&(v=dk(v),N=!0,v.name="Linear_Sequence_End",v.restrictionEnzyme.name="Linear_Sequence_End");var E=b+"-"+y+"-"+S+"-",A=I.restrictionEnzyme.name+" -- "+v.restrictionEnzyme.name+" "+S+" bps";tv({start:b,end:y},t),u.push({isFormedFromLinearEnd:N,madeFromOneCutsite:I===v,start:b,end:y,size:S,overlapsSelf:w,id:E,name:A,cut1:I,cut2:v,onFragmentSelect:c&&l?function(){c({start:b,end:y,name:A}),l(E)}:void 0})}),u.filter(function(m){return m.size?!0:(f.push(m),!1)}),{computePartialDigestDisabled:o,computeDigestDisabled:a,fragments:u,overlappingEnzymes:f}}function zme(n){var e=n.sequence,t=n.circular,r=n.enzymes,s=n.includeOverAndUnderHangs,i=Ume(e,t,r);return L3({includeOverAndUnderHangs:s,cutsites:Pme(i),sequenceLength:e.length,circular:t})}Qm.computeDigestFragments=L3;Qm.getDigestFragsForSeqAndEnzymes=zme;var Vme=pt,up=Vme.normalizePositionByRangeLength1Based,Wme=function(e,t,r){return t.start>-1?[up(t.start,r),up(t.end+2,r)]:e>-1?[up(e,r),up(e+1,r)]:[r,1]},e0=pt,Gme=e0.isPositionWithinRange,fp=e0.getSequenceWithinRange,Hme=e0.normalizePositionByRangeLength,qme=e0.isPositionCloserToRangeStartThanRangeEnd,jme=function(e,t,r){var s={leftHandSide:"",rightHandSide:""};return Gme(t,e)?(s.leftHandSide=fp({start:e.start,end:Hme(t-1,r.length)},r),s.rightHandSide=fp({start:t,end:e.end},r)):qme(t,e,r.length)?s.rightHandSide=fp(e,r):s.leftHandSide=fp(e,r),s},Kme=pt,Xme=Kme.modulatePositionByRange,Yme=function(e,t,r){t=t.toLowerCase(),e=e.toLowerCase();var s=t+t,i=s.indexOf(e);return i>-1?{start:i,end:Xme(i+e.length-1,{start:0,end:t.length-1})}:null},pk=Zm,Zme=pt,Jme=Zme.normalizePositionByRangeLength,Qme=Xm,e0e=function(e,t){t=t.length?t:[t];var r=e.sequence,s=r.length,i=e.circular,a=[];t.forEach(function(l){var u=Qme(r,i,l);a=a.concat(u)});var o=[];if(a.length<1)return o;if(a.length===1)return o.push(nv(a[0],a[0],s)),o;var c=U3(a);return c.forEach(function(l){var u=l[0],f=l[1],d=nv(u,f,s),p=nv(f,u,s);(i||!(d.start>d.end))&&o.push(d),(i||!(p.start>p.end))&&o.push(p)}),o};function nv(n,e,t){var r=gk(n.restrictionEnzyme),s=gk(e.restrictionEnzyme),i=n.topSnipBeforeBottom?n.topSnipPosition:n.bottomSnipPosition,a=Jme((e.topSnipBeforeBottom?e.bottomSnipPosition:e.topSnipPosition)-1,t);return{start:i,start1Based:i+1,end:a,end1Based:a+1,firstCut:n,firstCutOffset:r,firstCutOverhang:n.overhangBps,firstCutOverhangTop:r>0?n.overhangBps:"",firstCutOverhangBottom:r<0?pk(n.overhangBps):"",secondCut:e,secondCutOffset:s,secondCutOverhang:e.overhangBps,secondCutOverhangTop:s<0?e.overhangBps:"",secondCutOverhangBottom:s>0?pk(e.overhangBps):""}}function gk(n){return n.bottomSnipOffset-n.topSnipOffset}function U3(n){if(n.length<2)return[];var e=n[0],t=n.slice(1),r=t.map(function(s){return[e,s]});return r.concat(U3(t))}var t0e=Km,n0e=function(e){var t=t0e(e,!1),r=[],s="";return t.forEach(function(i){i.fullCodon&&(r[i.aminoAcidIndex]=i.aminoAcid.value)}),s=r.join(""),s},r0e=Ym,s0e=Vo,i0e=function(e){return r0e(s0e(e))},z3=function(e,t){return Object.assign({},e,{start:t-(e.end+1),end:t-(e.start+1),forward:!e.forward,strand:e.strand===1?-1:1})},a0e=Vo,o0e=z3,c0e=Ja,l0e=zt,u0e=l0e.map,mk=qc,f0e=nw,h0e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=mk(f0e(e,t.range),t),s=Object.assign({},r,{sequence:a0e(r.sequence)},c0e.reduce(function(i,a){return r[a]&&(i[a]=u0e(r[a],function(o){return o0e(o,r.sequence.length)})),i},{}));return mk(s,t)},d0e=function(e){for(var t="",r=e.length-1;r>=0;r--){var s=e[r];s||(s=e[r]),t+=s}return t},p0e=Xn,g0e=p0e.ambiguous_dna_letters,m0e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.threshold,s=r===void 0?.9:r,i=t.loose,a=t.dnaLetters||i?[].concat(g0e.split(""),["U"]):["G","A","T","C","U"],o=a.reduce(function(f,d){return f[d.toUpperCase()]=!0,f},{}),c=0;if(!e||!e.length)return!0;for(var l=0;l<e.length;l++){var u=e[l];o[u.toUpperCase()]&&(c=c+1)}return c/e.length>s},v0e=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},t0=zt,I0e=t0.each,b0e=t0.forEach,y0e=t0.startsWith,x0e=t0.filter,V3=pt,w0e=V3.getYOffsetForPotentiallyCircularRange,S0e=V3.splitRangeIntoTwoPartsIfItIsCircular,W3=function(e,t,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=s.splitForwardReverse,a={},o={},c={};return I0e(e,function(l){var u=!!(l.locations&&l.locations.length);l.overlapsSelf&&(c[l.id]||(rv({wrappedAnnotations:c,annotation:{start:0,end:t-1,id:"__tempAnnRemoveMe__"+l.id},sequenceLength:t,bpsPerRow:r,annotationsToRowsMap:a,yOffsetLevelMap:o,containsLocations:u,splitForwardReverse:i}),c[l.id]=!0)),rv({wrappedAnnotations:c,annotation:l,sequenceLength:t,bpsPerRow:r,annotationsToRowsMap:a,yOffsetLevelMap:o,containsLocations:u,splitForwardReverse:i}),u&&l.locations.forEach(function(f){rv({wrappedAnnotations:c,annotation:l,sequenceLength:t,bpsPerRow:r,annotationsToRowsMap:a,yOffsetLevelMap:o,location:f,splitForwardReverse:i})})}),b0e(a,function(l,u){a[u]=x0e(l,function(f){return!y0e(f.id,"__tempAnnRemoveMe__")})}),a};function rv(n){n.wrappedAnnotations;var e=n.annotation,t=n.sequenceLength,r=n.bpsPerRow,s=n.annotationsToRowsMap,i=n.yOffsetLevelMap,a=n.location,o=n.containsLocations,c=n.splitForwardReverse,l=S0e(a||e,t);l.forEach(function(u,f){for(var d=Math.floor(u.start/r),p=Math.floor(u.end/r),m=d;m<=p;m++){s[m]||(s[m]=[]);var I=c?e.forward?m+"_forward":m+"_reverse":m,v=s[m];i[I]||(i[I]=[]);var b=void 0,y=i[I],S=m===d?u.start:m*r,w=m===p?u.end:m*r+r-1;e.overlapsSelf?v.forEach(function(C){C.id==="__tempAnnRemoveMe__"+e.id&&(b=C.yOffset)}):a?v.forEach(function(C){C.id===e.id&&(b=C.yOffset)}):(f>0&&v.length&&v[v.length-1].annotation===e?b=v[v.length-1].yOffset:b=w0e(e,y),y[b]||(y[b]=[]),y[b].push({start:S,end:w})),v.push(v0e({id:e.id,annotation:e,start:S,end:w},o&&{containsLocations:o},a&&{isJoinedLocation:!!a},{yOffset:b,enclosingRangeType:u.type}))}})}var C0e=zt,R0e=C0e.cloneDeep,k0e=pt,E0e=k0e.getYOffsetsForPotentiallyCircularRanges,T0e=Ja,A0e=function(e){var t=R0e(e);return T0e.forEach(function(r){if(r!=="cutsites"){var s=E0e(t[r]).maxYOffset;t[r].maxYOffset=s}}),t},$0e=W3,vk=Ja,N0e=function(e,t){var r=e.sequence.length,s=Math.ceil(r/t)||1,i=[],a={};vk.forEach(function(l){a[l]=$0e(e[l],r,t,{splitForwardReverse:l==="primers"})});for(var o=function(u){var f={};f.rowNumber=u,f.start=u*t,f.end=(u+1)*t-1<r?(u+1)*t-1:r-1,f.end<0&&(f.end=0),vk.forEach(function(d){f[d]=a[d][u]||[]}),f.sequence=e.sequence.slice(f.start,f.end+1),i[u]=f},c=0;c<s;c++)o(c);return i},O0e=function(e,t){for(var r=[],s=e.toLowerCase().split(""),i=t.toLowerCase().split(""),a=t.length,o=t.replace(/^-+/g,""),c=t.replace(/-+$/g,""),l=a-o.length,u=a-(a-c.length),f=0;f<s.length;f++)f<l||f>=u?r.push("W"):s[f]===i[f]&&s[f]!=="-"&&i[f]!=="-"?r.push("G"):s[f]!==i[f]&&s[f]!=="-"&&i[f]!=="-"||i[f]==="-"||s[f]==="-"&&s[f-1]!=="-"&&f!==s.length-1&&s[f+1]==="-"?r.push("R"):s[f]==="-"&&s[f-1]!=="-"&&f!==s.length-1&&s[f+1]!=="-"?(r.push("R"),f++):f===s.length-1&&s[f]==="-"&&s[f-1]==="-"?r.splice(-2,1):f===s.length-1&&s[f]==="-"&&s[f-1]!=="-"?(r.pop(),r.push("R")):s[f]==="-"&&s[f-1]==="-"&&s[f+1]!=="-"?f++:s[f]==="-"&&s[f-1]==="-"||console.error("should not reach this step!");return r.join("")},_0e=m3,F0e=zt,hp=F0e.cloneDeep,D0e=function(e,t){for(var r=0;r<t.length;r++)t[r].cigar===null&&t.splice(r,1);var s=_0e(e.sequence,t),i=[{name:e.name,sequence:s.toUpperCase()}];t.forEach(function(C){var N=[];t.forEach(function(cr){var an=cr.cigar.match(/([0-9]*[SMDI])/g),Zn=hp(cr.pos);if(an[0].slice(-1)==="S"){var Xs=an[0].slice(0,-1);Zn=cr.pos-Xs}for(var Ri=0;Ri<an.length;Ri++)if(an[Ri].slice(-1)==="I"){for(var qo=Zn,ku=Number(an[Ri].slice(0,-1)),Qa=0;Qa<Ri;Qa++)if(an[Qa].slice(-1)!=="I"){var jo=Number(an[Qa].slice(0,-1));qo+=jo}var Xc={bpPos:qo,number:ku};N.push(Xc)}});var E=C.cigar.match(/([0-9]*[SMDI])/g),A=hp(C.pos);if(E[0].slice(-1)==="S"){var M=E[0].slice(0,-1);A=C.pos-M}var z=C.seq.split("");A>0&&z.unshift("-".repeat(A-1)),z=z.join("").split("");for(var Y=[],re=0;re<E.length;re++)if(E[re].slice(-1)==="D"){for(var ne=A,le=Number(E[re].slice(0,-1)),j=0;j<re;j++){var ge=Number(E[j].slice(0,-1));ne+=ge}var Se={bpPos:ne,number:le};Y.push(Se)}for(var me=Y.sort(function(cr,an){return cr.bpPos-an.bpPos}),ye=0;ye<me.length;ye++){for(var Ce=me[ye].bpPos,he=me[ye].number,Ne="",xe=0;xe<he;xe++)Ne+="-";z.splice(Ce-1,0,Ne),z=z.join("").split("")}z=z.join("").split("");for(var ae=[],J=[],D=0;D<E.length;D++)if(E[D].slice(-1)==="I"){for(var P=A,Q=Number(E[D].slice(0,-1)),pe=[],Ee=0;Ee<D;Ee++){var L=Number(E[Ee].slice(0,-1));P+=L}for(var q=0;q<Q;q++)pe.push(z[P-1+q]);var Z={bpPos:P,number:Q},se={bpPos:P,number:Q,nucleotides:pe};ae.push(Z),J.push(se)}for(var ie=JSON.parse(JSON.stringify(ae)),B=ae.sort(function(cr,an){return cr.bpPos-an.bpPos}),R=J.sort(function(cr,an){return cr.bpPos-an.bpPos}),k=0;k<B.length;k++){for(var X=B[k].bpPos,fe=B[k].number,Te=0;Te<fe;Te++)z.splice(X-1,1);for(var Be=k+1;Be<B.length;Be++)B[Be].bpPos-=fe}var He=N.sort(function(cr,an){return cr.bpPos-an.bpPos});He=He.filter(function(cr,an){return an===He.findIndex(function(Zn){return JSON.stringify(Zn)===JSON.stringify(cr)})});for(var rt=0;rt<He.length-1;rt++)for(;He[rt].bpPos===He[rt+1].bpPos;)He[rt].number>He[rt+1].number?He.splice(rt+1,1):(He[rt].number<He[rt+1].number||He[rt].number===He[rt+1].number)&&He.splice(rt,1);for(var ct=function(an){var Zn=He.findIndex(function(Xs){return Xs.bpPos===ie[an].bpPos});Zn!==-1&&(He[Zn].number>ie[an].number?He[Zn].number=He[Zn].number-ie[an].number:He[Zn].number<=ie[an].number&&(He.splice(Zn,1),an--)),lt=an},lt=0;lt<ie.length;lt++)ct(lt);for(var W=function(an){var Zn=He.findIndex(function(Xs){return Xs.bpPos===B[an].bpPos});Zn!==-1&&(He[Zn].number>B[an].number?He[Zn].number=He[Zn].number-B[an].number:He[Zn].number<=B[an].number&&(He.splice(Zn,1),an--)),T=an},T=0;T<B.length;T++)W(T);for(var O=JSON.parse(JSON.stringify(R)),ue=0;ue<O.length;ue++){for(var Ae=0,ze=0;ze<ue;ze++)Ae+=O[ze].number-1;O[ue].bpPos=O[ue].bpPos-Ae,R[ue].bpPos=R[ue].bpPos-Ae}for(var lt=0;lt<He.length;lt++)for(var Xe=0;Xe<O.length;Xe++)He[lt].bpPos<=R[Xe].bpPos&&(O[Xe].bpPos+=1);for(var Ct=0;Ct<He.length&&He[Ct].bpPos<=z.length;Ct++){for(var hn=He[Ct].bpPos,en=He[Ct].number,tn="",Ht=0;Ht<en;Ht++)tn+="-";z.splice(hn-1,0,tn);for(var Os=Ct+1;Os<He.length;Os++)He[Os].bpPos+=1}for(var Ci=0;Ci<O.length;Ci++){var Kc=O[Ci].bpPos,ji=O[Ci].nucleotides.join("");z.splice(Kc-1,0,ji)}z=z.join("").split(""),z.length<s.length&&z.push("-".repeat(s.length-z.length)),i.push({name:C.name,sequence:z.join(""),reversed:C.reversed,cigar:C.cigar})});var a=[];t.forEach(function(C){var N=C.cigar.match(/([0-9]*[SMDI])/g),E=hp(C.pos);if(N[0].slice(-1)==="S"){var A=N[0].slice(0,-1);E=C.pos-A,E<0&&a.push(Math.abs(E))}});for(var o=0,c=1;c<i.length;c++){var l=i[c].sequence.split(""),u=t[c-1].cigar.match(/([0-9]*[SMDI])/g),f=hp(t[c-1].pos);if(a.length>0&&(o=Math.max.apply(Math,a)),u[0].slice(-1)==="S"){var d=u[0].slice(0,-1);f=t[c-1].pos-d,f>0?(o>0&&l.unshift("-".repeat(o+1)),i[c].sequence=l.join("")):f<0&&(o>0&&l.unshift("-".repeat(o-Math.abs(f))),i[c].sequence=l.join(""))}else o>0&&l.unshift("-".repeat(o+1)),i[c].sequence=l.join("")}if(o>0){var p=i[0].sequence.split("");p.unshift("-".repeat(o+1)),i[0].sequence=p.join("")}for(var m=[],I=1;I<i.length;I++){var v=i[0];i[I].sequence.length>v.sequence.length&&m.push(i[I].sequence.length)}if(m.length>0)for(var b=Math.max.apply(Math,m),y=0;y<i.length;y++)i[y].sequence.length<b&&(i[y].sequence+="-".repeat(b-i[y].sequence.length));for(var S=1;S<i.length;S++){var w=i[0];i[S].sequence.length<w.sequence.length&&(i[S].sequence+="-".repeat(w.sequence.length-i[S].sequence.length))}return i},B0e=Zm,M0e=I3,G3=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.monovalentCationConc;try{var i=/[^atgc]/i.test(e);if(i)throw new Error("Degenerate bases prohibited in Tm calculation of sequence "+e);for(var a=e.toUpperCase().split(""),o=0,c=0,l=0,u=0,f=1.987,d=-273.15,p=273.15,m=1e3,I={"AA/TT":-7.9,"AT/TA":-7.2,"TA/AT":-7.2,"CA/GT":-8.5,"GT/CA":-8.4,"CT/GA":-7.8,"GA/CT":-8.2,"CG/GC":-10.6,"GC/CG":-9.8,"GG/CC":-8,"TT/AA":-7.9,"TG/AC":-8.5,"AC/TG":-8.4,"AG/TC":-7.8,"TC/AG":-8.2,"CC/GG":-8,initiationWithTerminalGC:.1,initiationWithTerminalAT:2.3},v={"AA/TT":-22.2,"AT/TA":-20.4,"TA/AT":-21.3,"CA/GT":-22.7,"GT/CA":-22.4,"CT/GA":-21,"GA/CT":-22.2,"CG/GC":-27.2,"GC/CG":-24.4,"GG/CC":-19.9,"TT/AA":-22.2,"TG/AC":-22.7,"AC/TG":-22.4,"AG/TC":-21,"TC/AG":-22.2,"CC/GG":-19.9,initiationWithTerminalGC:-2.8,initiationWithTerminalAT:4.1},b=0;b<a.length;b++)if((b===0||b===a.length-1)&&(a[b]==="G"||a[b]==="C"?(l+=I.initiationWithTerminalGC,u+=v.initiationWithTerminalGC):(a[b]==="A"||a[b]==="T")&&(l+=I.initiationWithTerminalAT,u+=v.initiationWithTerminalAT)),b<a.length-1){var y=a[b]+a[b+1],S=B0e(y).toUpperCase(),w=y+"/"+S;if(!I[w]||!v[w])throw new Error("Could not find value for "+w+" of sequence "+e);o+=I[w],c+=v[w]}var C=o+l,N=c+u,E=C*m,A=N+f*Math.log(t),M=E/A+d;if(s){var z=Math.log(s),Y=M0e(e)/100,re=4.29*Y-3.95,ne=re*Math.pow(10,-5)*z+Math.pow(9.4,-6)*Math.pow(z,2),le=1/(1/(M+p)+ne)+d;return le}else return M}catch(j){return"Error calculating Tm for sequence "+e+": "+j}},P0e=G3,L0e=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=r.monovalentCationConc,i=r.polymerase;try{if(e.length!==2)throw new Error(e.length+" sequences received when 2 primers were expected");var a=e.map(function(l){return P0e(l,t,{monovalentCationConc:s})});a.sort(function(l,u){return l-u});var o=a[0],c=void 0;return i==="Q5"?(c=o+1,c>72&&(c=72)):c=o-3,c}catch(l){return"Error calculating annealing temperature: "+l}},sv=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},H3=pt,Ik=H3.normalizePositionByRangeLength,U0e=H3.getRangeLength,q3=function(e,t,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=[],a=[];if(!r.length)return[];var o=r.sort(function(c,l){return c.topSnipPosition-l.topSnipPosition});return t||(o=[{topSnipPosition:0,bottomSnipPosition:0,overhangSize:0,type:"START_OR_END_OF_SEQ",name:"START_OF_SEQ"}].concat(o,[{topSnipPosition:e,bottomSnipPosition:e,overhangSize:0,type:"START_OR_END_OF_SEQ",name:"END_OF_SEQ"}])),o.forEach(function(c,l){!t&&!o[l+1]||(s.computePartialDigests&&o.forEach(function(u,f){f===l+1||f===0||a.push([c,o[f]])}),a.push([c,o[l+1]?o[l+1]:o[0]]))}),a.forEach(function(c){var l=c[0],u=c[1],f=Ik(l.topSnipPosition,e),d=Ik(u.topSnipPosition-1,e),p={start:f,end:d},m=U0e(p,e),I=f+"-"+d+"-"+m+"-";i.push(sv({cut1:sv({},l,{isOverhangIncludedInFragmentSize:l.type!=="START_OR_END_OF_SEQ"&&l.overhangSize>0&&l.topSnipBeforeBottom}),cut2:sv({},u,{isOverhangIncludedInFragmentSize:u.type!=="START_OR_END_OF_SEQ"&&u.overhangSize>0&&!u.topSnipBeforeBottom})},p,{size:m,id:I}))}),i.filter(function(c){return!!c.size}),i},z0e=q3,V0e=Xm,W0e=zt,G0e=W0e.flatMap,H0e=function(e,t,r,s){var i=Array.isArray(r)?r:[r],a=G0e(i,function(o){return V0e(e,t,o)});return z0e(e.length,t,a,s)},j3=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},q0e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},j0e=function(e){return(typeof e>"u"?"undefined":q0e(e))==="object"&&e!==null?bk(j3({},e,{locations:e.locations?e.locations.map(bk):void 0})):K0e(e)};function K0e(n){return n*3}function bk(n){return j3({},n,{start:n.start>-1?n.start*3:n.start,end:n.end>-1?n.end*3+2:n.end})}var X0e=zt,Y0e=X0e.invert,Z0e=Zx,J0e=Y0e(Z0e),Q0e=J0e,e1e=Kh,t1e=function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=0,i=0;i<e.length;i++)s+=e1e[e[i]].mass;return r&&(s/=3),Math.round(s*Math.pow(10,t))/Math.pow(10,t)},n1e=Ja,r1e=n1e.modifiableTypes,s1e=ew,i1e=function(e){var t=e.seqData,r=e.caretPosition,s=e.insertLength;r1e.forEach(function(i){var a=t[i];t[i]=s1e(a,r,s)})},n0=Dpe,rw=d3,a1e=rw.autoAnnotate,o1e=rw.convertApELikeRegexToRegex,c1e=rw.convertProteinSeqToDNAIupac,r0=Wo,l1e=r0.genbankFeatureTypes,K3=r0.getFeatureToColorMap,X3=r0.getFeatureTypes,u1e=r0.getMergedFeatureMap;it.getFeatureToColorMap=K3;it.getFeatureTypes=X3;it.genbankFeatureTypes=l1e;it.getMergedFeatureMap=u1e;it.FeatureTypes=X3();it.featureColors=K3();it.autoAnnotate=a1e;it.convertApELikeRegexToRegex=o1e;it.convertProteinSeqToDNAIupac=c1e;it.diffUtils=n0;it.getDiffFromSeqs=n0.getDiffFromSeqs;it.patchSeqWithDiff=n0.patchSeqWithDiff;it.reverseSeqDiff=n0.reverseSeqDiff;it.getAllInsertionsInSeqReads=p3;it.annotateSingleSeq=Kpe;it.getDegenerateDnaStringFromAAString=c3;it.getDegenerateRnaStringFromAAString=Zpe;it.getVirtualDigest=tge;it.isEnzymeType2S=nge;it.insertGapsIntoRefSeq=m3;it.adjustBpsToReplaceOrInsert=v3;it.annotationTypes=Ja;it.calculatePercentGC=I3;it.calculateTm=fge;it.bioData=Xn;it.cutSequenceByRestrictionEnzyme=Xm;it.deleteSequenceDataAtRange=Uge;it.DNAComplementMap=Gx;it.doesEnzymeChopOutsideOfRecognitionSite=zge;it.aliasedEnzymesByName=R3;it.defaultEnzymesByName=qge;it.generateSequenceData=eme;it.generateAnnotations=E3;it.filterAminoAcidSequenceString=o3;it.filterSequenceString=r3;it.findNearestRangeOfSequenceOverlapToPosition=sme;it.findOrfsInPlasmid=ome;it.findSequenceMatches=yme;it.getAminoAcidDataForEachBaseOfDna=Km;it.getAminoAcidFromSequenceTriplet=t3;it.getAminoAcidStringFromSequenceString=Ym;it.getCodonRangeForAASliver=xme;it.getComplementAminoAcidStringFromSequenceString=Sme;it.getComplementSequenceAndAnnotations=Dme;it.getComplementSequenceString=Zm;it.getCutsitesFromSequence=B3;it.getCutsiteType=Mme;it.computeDigestFragments=Qm.computeDigestFragments;it.getDigestFragsForSeqAndEnzymes=Qm.getDigestFragsForSeqAndEnzymes;it.getInsertBetweenVals=Wme;it.getLeftAndRightOfSequenceInRangeGivenPosition=jme;it.getOrfsFromSequence=T3;it.getOverlapBetweenTwoSequences=Yme;it.getPossiblePartsFromSequenceAndEnzymes=e0e;it.getReverseAminoAcidStringFromSequenceString=n0e;it.getReverseComplementAminoAcidStringFromSequenceString=i0e;it.getReverseComplementAnnotation=z3;it.getReverseComplementSequenceAndAnnotations=h0e;it.getReverseComplementSequenceString=Vo;it.getReverseSequenceString=d0e;it.getSequenceDataBetweenRange=nw;it.guessIfSequenceIsDnaAndNotProtein=m0e;it.insertSequenceDataAtPosition=O3;it.insertSequenceDataAtPositionOrRange=tw;it.mapAnnotationsToRows=W3;it.prepareCircularViewData=A0e;it.prepareRowData=N0e;it.proteinAlphabet=Kh;it.rotateSequenceDataToPosition=x3;it.rotateBpsToPosition=y3;it.threeLetterSequenceStringToAminoAcidMap=Q_;it.tidyUpSequenceData=qc;it.tidyUpAnnotation=a3;it.condensePairwiseAlignmentDifferences=O0e;it.addGapsToSeqReads=D0e;it.calculateNebTm=G3;it.calculateNebTa=L0e;it.getDigestFragmentsForCutsites=q3;it.getDigestFragmentsForRestrictionEnzymes=H0e;it.convertDnaCaretPositionOrRangeToAA=Qx;it.convertAACaretPositionOrRangeToDna=j0e;it.aminoAcidToDegenerateDnaMap=jm;it.aminoAcidToDegenerateRnaMap=Zx;it.degenerateDnaToAminoAcidMap=e3;it.degenerateRnaToAminoAcidMap=Q0e;it.getMassOfAaString=t1e;it.shiftAnnotationsByLen=i1e;it.adjustAnnotationsToInsert=ew;var vI={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t={reformatName:function(s){return s.toString().replace(/ /g,"_")}};e.default=t,n.exports=e.default})(vI,vI.exports);var Y3=vI.exports,II={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t=[{type:"primers"},{pragma:"Teselagen_Part",type:"parts"},{pragma:"j5_warning",type:"warnings"},{pragma:"j5_assembly_piece",type:"assemblyPieces"},{pragma:"j5_lineage_annotation",type:"lineageAnnotations"}];e.default=t,n.exports=e.default})(II,II.exports);var Z3=II.exports,du={};du.__esModule=!0;du.mangleOrStripUrls=h1e;du.unmangleUrls=f1e;function f1e(n){if(!n||typeof n!="string")return n;var e=/%%TG%%_(.*?)_%%TG%%/g;return n.replace(e,function(t,r){return r?""+decodeURIComponent(r):t})}function h1e(n,e){var t=e===void 0?{}:e,r=t.mangleUrls,s=t.doNotMangleOrStripUrls;if(!n)return n;var i=/(((https?:\/\/)|(www\.))[^\s]+)/g;return r||s?s?n:n.replace(i,function(a){return"%%TG%%_"+encodeURIComponent(a)+"_%%TG%%"}):n.replace(i,function(a){return""})}(function(n,e){e.__esModule=!0,e.default=d;var t=c(Qfe),r=it,s=c(Y3),i=zt,a=c(Z3),o=du;function c(p){return p&&p.__esModule?p:{default:p}}function l(p,m){var I=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(I)return(I=I.call(p)).next.bind(I);if(Array.isArray(p)||(I=u(p))||m&&p&&typeof p.length=="number"){I&&(p=I);var v=0;return function(){return v>=p.length?{done:!0}:{done:!1,value:p[v++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u(p,m){if(p){if(typeof p=="string")return f(p,m);var I=Object.prototype.toString.call(p).slice(8,-1);if(I==="Object"&&p.constructor&&(I=p.constructor.name),I==="Map"||I==="Set")return Array.from(p);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return f(p,m)}}function f(p,m){(m==null||m>p.length)&&(m=p.length);for(var I=0,v=new Array(m);I<m;I++)v[I]=p[I];return v}function d(p,m){m===void 0&&(m={});var I=m,v=I.isProtein,b=I.isOligo,y=I.guessIfProtein,S=I.guessIfProteinOptions,w=I.reformatSeqName,C=I.inclusive1BasedStart,N=I.inclusive1BasedEnd,E=I.additionalValidChars,A=I.allowOverflowAnnotations,M=I.coerceFeatureTypes,z={validatedAndCleanedSequence:{},messages:[]};if(!p||typeof p!="object")throw new Error("Invalid sequence");p.name||(p.name=""),p.extraLines||(p.extraLines=[]),p.comments||(p.comments=[]),p.description&&(p.description=(0,o.unmangleUrls)(p.description));var Y=p.name;w&&(p.name=s.default.reformatName(p.name)),Y!==p.name&&z.messages.push("Name ("+Y+") reformatted to "+p.name),Array.isArray(p.sequence)&&(p.sequence=p.sequence.join("")),p.sequence||(z.messages.push("No sequence detected"),p.sequence="");var re;if(v===void 0&&y&&(v=!(0,r.guessIfSequenceIsDnaAndNotProtein)(p.sequence,S)),v)re=(0,r.filterAminoAcidSequenceString)(p.sequence),re!==p.sequence&&(p.sequence=re,z.messages.push("Import Error: Illegal character(s) detected and removed from amino acid sequence. Allowed characters are: xtgalmfwkqespvicyhrndu")),p.type="PROTEIN",p.isProtein=!0,p.proteinSequence||(p.proteinSequence=p.sequence),p.proteinSize=p.proteinSequence.length;else{var ne=p.sequence;b||(p.sequence=p.sequence.replace(/u/gi,function(j){return j==="U"?"T":"t"})),ne!==p.sequence?p.type="RNA":p.type="DNA",re=(0,r.filterSequenceString)(p.sequence,E),re!==p.sequence&&(p.sequence=re,z.messages.push("Import Error: Illegal character(s) detected and removed from sequence. Allowed characters are: atgcyrswkmbvdhn"))}p.size||(p.size=v?p.proteinSequence.length*3:p.sequence.length);var le;return p.circular===!1||p.circular==="false"||p.circular===-1?(p.circular=!1,le=!0):p.circular?p.circular=!0:(p.circular=!1,le=le||!1),(!p.features||!Array.isArray(p.features))&&(z.messages.push("No valid features detected"),p.features=[]),p.features=p.features.filter(function(j){if(!j||typeof j!="object")return z.messages.push("Invalid feature detected and removed"),!1;j.start=parseInt(j.start,10),j.end=parseInt(j.end,10),(!j.name||typeof j.name!="string")&&(z.messages.push('Unable to detect valid name for feature, setting name to "Untitled Feature"'),j.name="Untitled Feature"),!A&&(!(0,t.default)([j.start])||j.start>p.size-(C?0:1))&&(z.messages.push("Invalid feature start: "+j.start+" detected for "+j.name+" and set to 1"),j.start=0),!A&&(!(0,t.default)([j.end])||j.end>p.size-(N?0:1))&&(j.end=Math.max(p.size-1,N?0:1),z.messages.push("Invalid feature end:  "+j.end+" detected for "+j.name+" and set to "+(j.end+1))),j.start-(C?0:1)>j.end-(N?0:1)&&p.circular===!1&&(le?(z.messages.push("Invalid circular feature detected in explicitly linear sequence. "+j.name+". start set to 1"),j.start=0):(z.messages.push("Circular feature detected in implicitly linear sequence. Setting sequence to be circular."),p.circular=!0)),j.strand=parseInt(j.strand,10),j.strand===-1||j.strand===!1||j.strand==="false"||j.strand==="-"?j.strand=-1:j.strand=1;var ge;j.type&&typeof j.type=="string"&&j.type.toLowerCase()==="primer"&&(j.type="primer_bind"),(!j.type||typeof j.type!="string"||!(0,r.getFeatureTypes)({includeHidden:!0}).some(function(he){return he.toLowerCase()===j.type.toLowerCase()?(j.type=he,!0):!1}))&&(M||!j.type)&&(z.messages.push('Invalid feature type detected:  "'+j.type+'" within '+j.name+". set type to misc_feature"),typeof j.type=="string"&&(ge=j.type),j.type="misc_feature"),j.notes||(j.notes={}),ge&&(j.notes.featureType||(j.notes.featureType=[]),j.notes.featureType.push(ge)),j.notes.label?delete j.notes.label:j.notes.gene?delete j.notes.gene:j.notes.name&&delete j.notes.name,j.notes.color&&(j.color=j.notes.color[0]||j.color,delete j.notes.color),j.notes.labelColor&&(j.labelColor=j.notes.labelColor[0]||j.labelColor,delete j.notes.labelColor),j.notes.pragma&&(0,i.some)(j.notes.pragma,function(he){return he==="overlapsSelf"})&&(j.overlapsSelf=!0,j.notes.pragma=(0,i.filter)(j.notes.pragma,function(he){return he!=="overlapsSelf"})),j.notes.note&&(0,i.some)(j.notes.note,function(he){if(he&&typeof he=="string"&&he.toLowerCase().includes("sequence:")){j.notes.note=(0,i.filter)(j.notes.note,function(xe){return he&&!he.toLowerCase().includes("sequence:")}),j.notes.note.length===0&&delete j.notes.note;var Ne=he.match(/sequence:[ \r\n.]*[a-zA-Z]*/i);return Ne&&Ne[0]&&(j.bases=Ne[0].replace(/\s/g,"").replace("sequence:","")),!0}}),j.notes.primerBindsOn&&(0,i.some)(j.notes.primerBindsOn,function(he){he&&(j.primerBindsOn=he,delete j.notes.primerBindsOn)});for(var Se=function(){var Ne=ye.value,xe=Ne.pragma,ae=Ne.type;if(m["accept"+(0,i.upperFirst)(ae)]!==!1&&j.notes.pragma&&(0,i.some)(j.notes.pragma,function(J){return J===xe}))return p[ae]||(p[ae]=[]),j.type=ae.slice(0,-1),delete j.notes.pragma,p[ae].push(j),{v:!1}},me=l(a.default),ye;!(ye=me()).done;){var Ce=Se();if(typeof Ce=="object")return Ce.v}return(0,i.forEach)(j.notes,function(he,Ne){j.notes[Ne]=(0,i.map)(he,function(xe){return(0,o.unmangleUrls)(xe)})}),!0}),z.validatedAndCleanedSequence=p,z}n.exports=e.default})(pI,pI.exports);var d1e=pI.exports;(function(n,e){e.__esModule=!0,e.default=s;var t=r(d1e);function r(i){return i&&i.__esModule?i:{default:i}}function s(i,a){return i&&(Array.isArray(i)||(i=[i]),i.forEach(function(o){if(o.success){var c=(0,t.default)(o.parsedSequence,a);o.messages=o.messages.concat(c.messages),o.parsedSequence=c.validatedAndCleanedSequence}})),i}n.exports=e.default})(dI,dI.exports);var pu=dI.exports;(function(n,e){e.__esModule=!0,e.default=void 0;var t=i(Gm),r=i(__),s=i(pu);function i(c){return c&&c.__esModule?c:{default:c}}function a(c,l){var u=[],f=null;try{for(var d=(0,r.default)(c),p=0;p<d.length;p++)m(d[p]);f&&(u.push(f),f=null)}catch(b){console.error("error:",b),console.error("error.stack: ",b.stack),u=[{success:!1,messages:["Import Error: Invalid File"]}]}return(0,s.default)(u,l);function m(b){if(b=b.trim(),b[0]===";"){if(f)return;f=(0,t.default)(l),I(b)}else b[0]===">"?(f&&(u.push(f),f=null),f=(0,t.default)(l),I(b)):(f||(f=(0,t.default)(l)),b[b.length-1]==="*"?(v(b.substring(0,b.length-1)),u.push(f),f=null):v(b));l&&l.parseFastaAsCircular&&(f.parsedSequence.circular=!0)}function I(b){if(l&&"parseName"in l&&!l.parseName){f.parsedSequence.name=b.slice(1);return}var y=b.indexOf("|");y>-1?(f.parsedSequence.name=b.slice(1,y),f.parsedSequence.description=b.slice(y+1)):f.parsedSequence.name=b.slice(1)}function v(b){f.parsedSequence.sequence+=b}}var o=a;e.default=o,n.exports=e.default})(uI,uI.exports);var J3=uI.exports,bI={exports:{}},yI={exports:{}},xI={exports:{}};(function(n,e){e.__esModule=!0,e.default=r;var t=pt;function r(s,i){i&&i.splitLocations?s&&s.features.forEach(function(a){if(a.locations&&a.locations[0]){if(a.locations.length>1)for(var o=1;o<a.locations.length;o++){var c=a.locations[o],l=JSON.parse(JSON.stringify(a));l.start=c.start,l.end=c.end,delete l.locations,s.features.push(l)}a.start=a.locations[0].start,a.end=a.locations[0].end}delete a.locations}):s&&s.features.forEach(function(a){if(a.locations&&a.locations[0])if(a.start=a.locations[0].start,a.end=a.locations[a.locations.length-1].end,a.locations.length>1){var o=a.locations.some(function(c){return!(0,t.isRangeWithinRange)(c,a,s.sequence.length)});o&&delete a.locations}else delete a.locations}),Array.isArray(s.sequence)&&(s.sequence=s.sequence.join(""))}n.exports=e.default})(xI,xI.exports);var p1e=xI.exports;(function(n,e){e.__esModule=!0,e.default=s;var t=r(p1e);function r(i){return i&&i.__esModule?i:{default:i}}function s(i,a){return i&&(Array.isArray(i)||(i=[i]),i.forEach(function(o){o.success&&(0,t.default)(o.parsedSequence,a)})),i}n.exports=e.default})(yI,yI.exports);var Q3=yI.exports;(function(n,e){e.__esModule=!0,e.default=void 0;var t=it,r=u(Ux),s=c(Q3),i=c(pu),a=c(__),o=c(Gm);function c(I){return I&&I.__esModule?I:{default:I}}function l(I){if(typeof WeakMap!="function")return null;var v=new WeakMap,b=new WeakMap;return(l=function(S){return S?b:v})(I)}function u(I,v){if(!v&&I&&I.__esModule)return I;if(I===null||typeof I!="object"&&typeof I!="function")return{default:I};var b=l(v);if(b&&b.has(I))return b.get(I);var y={},S=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in I)if(w!=="default"&&Object.prototype.hasOwnProperty.call(I,w)){var C=S?Object.getOwnPropertyDescriptor(I,w):null;C&&(C.get||C.set)?Object.defineProperty(y,w,C):y[w]=I[w]}return y.default=I,b&&b.set(I,y),y}function f(I,v){v===void 0&&(v={});var b=v,y=b.inclusive1BasedStart,S=b.inclusive1BasedEnd,w=[],C,N,E={LOCUS_TAG:"LOCUS",DEFINITION_TAG:"DEFINITION",ACCESSION_TAG:"ACCESSION",VERSION_TAG:"VERSION",KEYWORDS_TAG:"KEYWORDS",SOURCE_TAG:"SOURCE",ORGANISM_TAG:"ORGANISM",REFERENCE_TAG:"REFERENCE",AUTHORS_TAG:"AUTHORS",CONSORTIUM_TAG:"CONSRTM",TITLE_TAG:"TITLE",JOURNAL_TAG:"JOURNAL",PUBMED_TAG:"PUBMED",REMARK_TAG:"REMARK",COMMENT_TAG:"COMMENT",FEATURES_TAG:"FEATURES",BASE_COUNT_TAG:"BASE COUNT",ORIGIN_TAG:"ORIGIN",END_SEQUENCE_TAG:"//"},A=!1,M;try{var z=(0,a.default)(I),Y=!1;z===null&&j("Import Error: Sequence file is empty"),z.some(function(Z){if(Z===null)return!0;var se=P(Z),ie=Q(Z),B=L(Z),R=Ee(Z),k=pe(Z);if((se==="LOCUS"||se==="REFERENCE"||se==="FEATURES"||se==="ORIGIN"||se==="//"||k===!0)&&(Y=se),Z.trim()===""||se===";")return!1;if(!A&&Y!==E.LOCUS_TAG)return!0;switch(Y){case E.LOCUS_TAG:A&&(Z=A+Z),me(Z),A=Z;break;case E.FEATURES_TAG:if(ie===""){j("Warning: The feature '"+se+"'' has no location specified. This line has been ignored: line"+Z);break}Ne(Z,se,ie);break;case E.ORIGIN_TAG:Se(Z,se);break;case E.END_SEQUENCE_TAG:ne();break;case E.DEFINITION_TAG:if(Z=Z.replace(/DEFINITION/,""),Z=Z.trim(),C.parsedSequence)C.parsedSequence.definition?C.parsedSequence.definition+=" "+Z:C.parsedSequence.definition=Z,C.parsedSequence.description?C.parsedSequence.description+=" "+Z:C.parsedSequence.description=Z;else throw new Error("no sequence yet created upon which to extract an extra line!");break;case E.ACCESSION_TAG:Z=Z.replace(/ACCESSION/,""),Z=Z.trim(),C.parsedSequence&&(C.parsedSequence.accession=Z);break;case E.VERSION_TAG:Z=Z.replace(/VERSION/,""),Z=Z.trim(),C.parsedSequence&&(C.parsedSequence.version=Z);break;case"COMMENT":if(Z=Z.replace(/COMMENT/,""),Z=Z.trim(),C.parsedSequence)C.parsedSequence.comments||(C.parsedSequence.comments=[]),Z.indexOf("teselagen_unique_id:")>-1?C.parsedSequence.teselagen_unique_id=Z.replace(/ /g,"").replace("teselagen_unique_id:",""):Z.indexOf("library:")>-1?C.parsedSequence.library=Z.replace(/ /g,"").replace("library:",""):C.parsedSequence.comments.push(Z);else throw new Error("no sequence yet created upon which to extract an extra line!");break;default:if(ye(Z),se==="BASE"){j("Warning: This BaseCount line has been ignored: "+Z);break}else k||R||B||j("Warning: This line has been ignored: "+Z)}return!1})}catch(Z){console.error("Error trying to parse file as .gb:",Z),C={success:!1,messages:["Import Error: Invalid File"]}}(!C||C.success&&w[w.length-1]!==C)&&ne();var re=(0,i.default)((0,s.default)(w,v),v);return re.forEach(function(Z){if(Z.success){var se=Z.parsedSequence;se.features.forEach(function(ie){ie.type==="primer"&&(ie.type="primer_bind")}),v.primersAsFeatures||(se.primers=se.features.filter(function(ie){return ie.type==="primer_bind"}),se.features=se.features.filter(function(ie){return ie.type!=="primer_bind"}))}}),re;function ne(){A=!1,ge(),w.push(C||{success:!1})}function le(){return C.parsedSequence.features[C.parsedSequence.features.length-1]}function j(Z){if(C.messages.indexOf(Z===-1))return C.messages.push(Z)}function ge(){if(C&&C.parsedSequence&&C.parsedSequence.features)for(var Z=0;Z<C.parsedSequence.features.length;Z++)C.parsedSequence.features[Z]=q(C.parsedSequence.features[Z])}function Se(Z,se){if(se!==E.ORIGIN_TAG){var ie=Z.replace(/[\s]*[0-9]*/g,"");C.parsedSequence.sequence+=ie}}function me(Z){C=(0,o.default)(v);var se,ie,B,R,k=Z.split(/[\s]+/g);k.length<=1&&(console.warn("Parsing GenBank File: WARNING! Locus line contains no values!"),j("Import Warning: Locus line contains no values: "+Z)),se=k[1];for(var X=1;X<k.length;X++)k[X].match(/circular/gi)?ie=!0:k[X].match(/linear/gi)&&(ie=!1);for(var fe=1;fe<k.length;fe++){var Te=k[fe];Te.match(/-[A-Z]{3}-/g)&&(R=Te),fe===3&&Te.match(/aa/i)&&(v.sequenceTypeFromLocus=Te,v.isProtein=!0),fe===4&&(Te.match(/ds-dna/i)||Te.match(/ss-dna/i)||Te.match(/dna/i))&&(v.isProtein===void 0&&(v.isProtein=!1),v.sequenceTypeFromLocus=Te),typeof k[fe]=="string"&&r.gbDivisions[k[fe].toUpperCase()]&&(B=k[fe].toUpperCase())}(se!=="Exported"||C.parsedSequence.name===r.default.untitledSequenceName)&&(C.parsedSequence.name=se),C.parsedSequence.gbDivision=B,C.parsedSequence.sequenceTypeFromLocus=v.sequenceTypeFromLocus,C.parsedSequence.date=R,C.parsedSequence.circular=ie}function ye(Z){if(C.parsedSequence)C.parsedSequence.extraLines||(C.parsedSequence.extraLines=[]),C.parsedSequence.extraLines.push(Z);else throw new Error("no sequence yet created upon which to extract an extra line!")}var Ce,he;function Ne(Z,se,ie){var B;if(se===E.FEATURES_TAG){Ce=!0;return}if(Ce&&(M=p(Z),Ce=!1),d(Z,M))he?(J(Z.trim(),v),he=!0):(N&&(N[N.length-1]+=Z.trimLeft().replace(/"/g,"")),he=!1);else if(ae(Z))if(le())D(Z),he=!1;else return;else{ie.match(/complement/g)?B=-1:B=1,xe();var R=le();R.type=se,R.strand=B,J(ie,v),he=!0}}function xe(){C.parsedSequence.features.push({locations:[],notes:{}})}function ae(Z){var se=!1;return(Z.trim().charAt(0).match(/\//)||Z.match(/^[\s]*\/[\w]+=[\S]+/))&&(se=!0),se}function J(Z,se){Z=Z.trim();var ie=[];Z.replace(/(\d+)/g,function(Te,Be){ie.push(Be)});for(var B=0;B<ie.length;B+=2){var R=parseInt(ie[B],10)-(y?0:1),k=parseInt(ie[B+1],10)-(S?0:1);isNaN(k)&&(k=R);var X={start:R,end:k},fe=le();fe.locations.push(se.isProtein?(0,t.convertAACaretPositionOrRangeToDna)(X):X)}}function D(Z){var se,ie;se=Z.trimLeft(),se=se.replace(/^\/|"$/g,""),ie=se.split(/="|=/);var B=ie.slice(1).join("=");B&&(B=B.replace(/\\/g," "),Z.match(/="/g)?B=B.replace(/".*/g,""):B.match(/^\d+$/g)&&(B=parseInt(B,10)));var R=ie[0],k=le().notes;k[R]?k[R].push(B):k[R]=[B],N=k[R]}function P(Z){var se;return Z=Z.replace(/^[\s]*/,""),Z.indexOf("=")<0?se=Z.split(/[\s]+/):se=Z.split(/=/),se[0]}function Q(Z){var se;return Z.indexOf("=")<0?(Z=Z.replace(/^[\s]*[\S]+[\s]+|[\s]+$/,""),Z=Z.trim(),Z):(se=Z.split(/=/),se.slice(1).join(""))}function pe(Z){var se=!1;return Z.substr(0,10).match(/^[\S]+/)&&(se=!0),se}function Ee(Z){var se=!1;return Z.substr(0,10).match(/^[\s]+[\S]+/)&&(se=!0),se}function L(Z){var se;return Z.substr(0,10).match(/[\s]{10}/)?se=!0:se=!1,se}function q(Z){if(Z.notes.label?Z.name=Z.notes.label[0]:Z.notes.gene?Z.name=Z.notes.gene[0]:Z.notes.ApEinfo_label?Z.name=Z.notes.ApEinfo_label[0]:Z.notes.name?Z.name=Z.notes.name[0]:Z.notes.organism?Z.name=Z.notes.organism[0]:Z.notes.locus_tag?Z.name=Z.notes.locus_tag[0]:Z.notes.note?Z.name=Z.notes.note[0].substr(0,100):Z.name="Untitled Feature",Z.name=typeof Z.name=="string"?Z.name:String(Z.name),Z.name!==0&&!Z.name&&(Z.name="Untitled Feature"),Z.name.length>100){var se=Z.name;Z.name=Z.name.substr(0,100),j("Warning: Shortening name of feature "+se+" (max 100 chars)")}return Z.notes.direction&&(Z.arrowheadType=Z.notes.direction[0].toUpperCase()==="BOTH"?"BOTH":Z.notes.direction[0].toUpperCase()==="NONE"?"NONE":void 0,delete Z.notes.direction),Z}}function d(I,v){var b=p(I);if(v===b)return!1;var y=I.trim();return!y.charAt(0).match(/\//)}function p(I){var v=/^\s*/.exec(I);return v!==null?v[0].length:0}var m=f;e.default=m,n.exports=e.default})(bI,bI.exports);var eF=bI.exports,wI={exports:{}},s0={};(function(n){n.__esModule=!0,n.default=s,n.searchWholeObjByNameSimple=i,n.searchWholeObjByNameSimpleArray=a;var e=zt,t=function(){function o(l){Object.assign(this,l),this.value=this.obj[this.prop]}var c=o.prototype;return c.toString=function(){var u=this.path,f=this.type;return u+" -> ("+f+") "+this.logValue()},c.logValue=function(){var u=this.value,f=function(p){return Object(p)!==p};return f(u)||Array.isArray(u)?u:{}.toString.call(u)},c.log=function(){console.info(this.toString())},o}(),r=typeof window=="object"?window:Hn;function s(o,c){var l=function(A,M,z){return A==z},u,f,d=c==r?"GLOBAL":"SRC",p=[{where:c,path:d}],m=[],I=[];for(I.log=function(){this.forEach(function(E){return E.log()})};u=p.pop();){var v=u,b=v.where,y=v.path;for(var S in b)try{if(b.hasOwnProperty(S)){if([b[S]]=="[object Object]"){for(var w=-1;m[++w]&&!(f=(0,e.isEqual)(m[w].where,b[S])&&m[w]););f||(u={where:b[S],path:y+"."+S},p.push(u),m.push(u))}if(l(o,b,S)){var C=f?"<"+f.path+">":typeof b[S],N=new t({path:y+"."+S,obj:b,prop:S,type:C});I.push(N)}}}catch{}}return I}function i(o,c){var l,u,f;return(l=s(o,c))===null||l===void 0||(u=l[0])===null||u===void 0||(f=u.value)===null||f===void 0?void 0:f[0]}function a(o,c){var l,u;return(l=s(o,c))===null||l===void 0||(u=l[0])===null||u===void 0?void 0:u.value}})(s0);var sw={},i0={};(function(n){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",r="["+e+"]["+t+"]*",s=new RegExp("^"+r+"$"),i=function(o,c){const l=[];let u=c.exec(o);for(;u;){const f=[];f.startIndex=c.lastIndex-u[0].length;const d=u.length;for(let p=0;p<d;p++)f.push(u[p]);l.push(f),u=c.exec(o)}return l},a=function(o){const c=s.exec(o);return!(c===null||typeof c>"u")};n.isExist=function(o){return typeof o<"u"},n.isEmptyObject=function(o){return Object.keys(o).length===0},n.merge=function(o,c,l){if(c){const u=Object.keys(c),f=u.length;for(let d=0;d<f;d++)l==="strict"?o[u[d]]=[c[u[d]]]:o[u[d]]=c[u[d]]}},n.getValue=function(o){return n.isExist(o)?o:""},n.isName=a,n.getAllMatches=i,n.nameRegexp=r})(i0);const iw=i0,g1e={allowBooleanAttributes:!1,unpairedTags:[]};sw.validate=function(n,e){e=Object.assign({},g1e,e);const t=[];let r=!1,s=!1;n[0]==="\uFEFF"&&(n=n.substr(1));for(let i=0;i<n.length;i++)if(n[i]==="<"&&n[i+1]==="?"){if(i+=2,i=xk(n,i),i.err)return i}else if(n[i]==="<"){let a=i;if(i++,n[i]==="!"){i=wk(n,i);continue}else{let o=!1;n[i]==="/"&&(o=!0,i++);let c="";for(;i<n.length&&n[i]!==">"&&n[i]!==" "&&n[i]!=="	"&&n[i]!==`
`&&n[i]!=="\r";i++)c+=n[i];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),i--),!S1e(c)){let f;return c.trim().length===0?f="Invalid space after '<'.":f="Tag '"+c+"' is an invalid name.",vr("InvalidTag",f,ws(n,i))}const l=I1e(n,i);if(l===!1)return vr("InvalidAttr","Attributes for '"+c+"' have open quote.",ws(n,i));let u=l.value;if(i=l.index,u[u.length-1]==="/"){const f=i-u.length;u=u.substring(0,u.length-1);const d=Sk(u,e);if(d===!0)r=!0;else return vr(d.err.code,d.err.msg,ws(n,f+d.err.line))}else if(o)if(l.tagClosed){if(u.trim().length>0)return vr("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ws(n,a));{const f=t.pop();if(c!==f.tagName){let d=ws(n,f.tagStartPos);return vr("InvalidTag","Expected closing tag '"+f.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+c+"'.",ws(n,a))}t.length==0&&(s=!0)}}else return vr("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ws(n,i));else{const f=Sk(u,e);if(f!==!0)return vr(f.err.code,f.err.msg,ws(n,i-u.length+f.err.line));if(s===!0)return vr("InvalidXml","Multiple possible root nodes found.",ws(n,i));e.unpairedTags.indexOf(c)!==-1||t.push({tagName:c,tagStartPos:a}),r=!0}for(i++;i<n.length;i++)if(n[i]==="<")if(n[i+1]==="!"){i++,i=wk(n,i);continue}else if(n[i+1]==="?"){if(i=xk(n,++i),i.err)return i}else break;else if(n[i]==="&"){const f=x1e(n,i);if(f==-1)return vr("InvalidChar","char '&' is not expected.",ws(n,i));i=f}else if(s===!0&&!yk(n[i]))return vr("InvalidXml","Extra text at the end",ws(n,i));n[i]==="<"&&i--}}else{if(yk(n[i]))continue;return vr("InvalidChar","char '"+n[i]+"' is not expected.",ws(n,i))}if(r){if(t.length==1)return vr("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",ws(n,t[0].tagStartPos));if(t.length>0)return vr("InvalidXml","Invalid '"+JSON.stringify(t.map(i=>i.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return vr("InvalidXml","Start tag expected.",1);return!0};function yk(n){return n===" "||n==="	"||n===`
`||n==="\r"}function xk(n,e){const t=e;for(;e<n.length;e++)if(n[e]=="?"||n[e]==" "){const r=n.substr(t,e-t);if(e>5&&r==="xml")return vr("InvalidXml","XML declaration allowed only at the start of the document.",ws(n,e));if(n[e]=="?"&&n[e+1]==">"){e++;break}else continue}return e}function wk(n,e){if(n.length>e+5&&n[e+1]==="-"&&n[e+2]==="-"){for(e+=3;e<n.length;e++)if(n[e]==="-"&&n[e+1]==="-"&&n[e+2]===">"){e+=2;break}}else if(n.length>e+8&&n[e+1]==="D"&&n[e+2]==="O"&&n[e+3]==="C"&&n[e+4]==="T"&&n[e+5]==="Y"&&n[e+6]==="P"&&n[e+7]==="E"){let t=1;for(e+=8;e<n.length;e++)if(n[e]==="<")t++;else if(n[e]===">"&&(t--,t===0))break}else if(n.length>e+9&&n[e+1]==="["&&n[e+2]==="C"&&n[e+3]==="D"&&n[e+4]==="A"&&n[e+5]==="T"&&n[e+6]==="A"&&n[e+7]==="["){for(e+=8;e<n.length;e++)if(n[e]==="]"&&n[e+1]==="]"&&n[e+2]===">"){e+=2;break}}return e}const m1e='"',v1e="'";function I1e(n,e){let t="",r="",s=!1;for(;e<n.length;e++){if(n[e]===m1e||n[e]===v1e)r===""?r=n[e]:r!==n[e]||(r="");else if(n[e]===">"&&r===""){s=!0;break}t+=n[e]}return r!==""?!1:{value:t,index:e,tagClosed:s}}const b1e=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Sk(n,e){const t=iw.getAllMatches(n,b1e),r={};for(let s=0;s<t.length;s++){if(t[s][1].length===0)return vr("InvalidAttr","Attribute '"+t[s][2]+"' has no space in starting.",Yu(t[s]));if(t[s][3]!==void 0&&t[s][4]===void 0)return vr("InvalidAttr","Attribute '"+t[s][2]+"' is without value.",Yu(t[s]));if(t[s][3]===void 0&&!e.allowBooleanAttributes)return vr("InvalidAttr","boolean attribute '"+t[s][2]+"' is not allowed.",Yu(t[s]));const i=t[s][2];if(!w1e(i))return vr("InvalidAttr","Attribute '"+i+"' is an invalid name.",Yu(t[s]));if(!r.hasOwnProperty(i))r[i]=1;else return vr("InvalidAttr","Attribute '"+i+"' is repeated.",Yu(t[s]))}return!0}function y1e(n,e){let t=/\d/;for(n[e]==="x"&&(e++,t=/[\da-fA-F]/);e<n.length;e++){if(n[e]===";")return e;if(!n[e].match(t))break}return-1}function x1e(n,e){if(e++,n[e]===";")return-1;if(n[e]==="#")return e++,y1e(n,e);let t=0;for(;e<n.length;e++,t++)if(!(n[e].match(/\w/)&&t<20)){if(n[e]===";")break;return-1}return e}function vr(n,e,t){return{err:{code:n,msg:e,line:t.line||t,col:t.col}}}function w1e(n){return iw.isName(n)}function S1e(n){return iw.isName(n)}function ws(n,e){const t=n.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function Yu(n){return n.startIndex+n[1].length}var aw={};const tF={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,e,t){return n}},C1e=function(n){return Object.assign({},tF,n)};aw.buildOptions=C1e;aw.defaultOptions=tF;class R1e{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,[":@"]:e[":@"]}):this.child.push({[e.tagname]:e.child})}}var k1e=R1e;const E1e=i0;function T1e(n,e){const t={};if(n[e+3]==="O"&&n[e+4]==="C"&&n[e+5]==="T"&&n[e+6]==="Y"&&n[e+7]==="P"&&n[e+8]==="E"){e=e+9;let r=1,s=!1,i=!1,a="";for(;e<n.length;e++)if(n[e]==="<"&&!i){if(s&&N1e(n,e))e+=7,[entityName,val,e]=A1e(n,e+1),val.indexOf("&")===-1&&(t[D1e(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(s&&O1e(n,e))e+=8;else if(s&&_1e(n,e))e+=8;else if(s&&F1e(n,e))e+=9;else if($1e)i=!0;else throw new Error("Invalid DOCTYPE");r++,a=""}else if(n[e]===">"){if(i?n[e-1]==="-"&&n[e-2]==="-"&&(i=!1,r--):r--,r===0)break}else n[e]==="["?s=!0:a+=n[e];if(r!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}function A1e(n,e){let t="";for(;e<n.length&&n[e]!=="'"&&n[e]!=='"';e++)t+=n[e];if(t=t.trim(),t.indexOf(" ")!==-1)throw new Error("External entites are not supported");const r=n[e++];let s="";for(;e<n.length&&n[e]!==r;e++)s+=n[e];return[t,s,e]}function $1e(n,e){return n[e+1]==="!"&&n[e+2]==="-"&&n[e+3]==="-"}function N1e(n,e){return n[e+1]==="!"&&n[e+2]==="E"&&n[e+3]==="N"&&n[e+4]==="T"&&n[e+5]==="I"&&n[e+6]==="T"&&n[e+7]==="Y"}function O1e(n,e){return n[e+1]==="!"&&n[e+2]==="E"&&n[e+3]==="L"&&n[e+4]==="E"&&n[e+5]==="M"&&n[e+6]==="E"&&n[e+7]==="N"&&n[e+8]==="T"}function _1e(n,e){return n[e+1]==="!"&&n[e+2]==="A"&&n[e+3]==="T"&&n[e+4]==="T"&&n[e+5]==="L"&&n[e+6]==="I"&&n[e+7]==="S"&&n[e+8]==="T"}function F1e(n,e){return n[e+1]==="!"&&n[e+2]==="N"&&n[e+3]==="O"&&n[e+4]==="T"&&n[e+5]==="A"&&n[e+6]==="T"&&n[e+7]==="I"&&n[e+8]==="O"&&n[e+9]==="N"}function D1e(n){if(E1e.isName(n))return n;throw new Error(`Invalid entity name ${n}`)}var B1e=T1e;const M1e=/^[-+]?0x[a-fA-F0-9]+$/,P1e=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const L1e={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function U1e(n,e={}){if(e=Object.assign({},L1e,e),!n||typeof n!="string")return n;let t=n.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return n;if(e.hex&&M1e.test(t))return Number.parseInt(t,16);{const r=P1e.exec(t);if(r){const s=r[1],i=r[2];let a=z1e(r[3]);const o=r[4]||r[6];if(!e.leadingZeros&&i.length>0&&s&&t[2]!==".")return n;if(!e.leadingZeros&&i.length>0&&!s&&t[1]!==".")return n;{const c=Number(t),l=""+c;return l.search(/[eE]/)!==-1||o?e.eNotation?c:n:t.indexOf(".")!==-1?l==="0"&&a===""||l===a||s&&l==="-"+a?c:n:i?a===l||s+a===l?c:n:t===l||t===s+l?c:n}}else return n}}function z1e(n){return n&&n.indexOf(".")!==-1&&(n=n.replace(/0+$/,""),n==="."?n="0":n[0]==="."?n="0"+n:n[n.length-1]==="."&&(n=n.substr(0,n.length-1))),n}var V1e=U1e;const ow=i0,Zu=k1e,W1e=B1e,G1e=V1e;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,ow.nameRegexp);let H1e=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""}},this.addExternalEntities=q1e,this.parseXml=Z1e,this.parseTextData=j1e,this.resolveNameSpace=K1e,this.buildAttributesMap=Y1e,this.isItStopNode=tve,this.replaceEntitiesValue=Q1e,this.readStopNodeData=rve,this.saveTextToParentTag=eve,this.addChild=J1e}};function q1e(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:n[r]}}}function j1e(n,e,t,r,s,i,a){if(n!==void 0&&(this.options.trimValues&&!r&&(n=n.trim()),n.length>0)){a||(n=this.replaceEntitiesValue(n));const o=this.options.tagValueProcessor(e,n,t,s,i);return o==null?n:typeof o!=typeof n||o!==n?o:this.options.trimValues?CI(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?CI(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function K1e(n){if(this.options.removeNSPrefix){const e=n.split(":"),t=n.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(n=t+e[1])}return n}const X1e=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Y1e(n,e,t){if(!this.options.ignoreAttributes&&typeof n=="string"){const r=ow.getAllMatches(n,X1e),s=r.length,i={};for(let a=0;a<s;a++){const o=this.resolveNameSpace(r[a][1]);let c=r[a][4],l=this.options.attributeNamePrefix+o;if(o.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const u=this.options.attributeValueProcessor(o,c,e);u==null?i[l]=c:typeof u!=typeof c||u!==c?i[l]=u:i[l]=CI(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[l]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const a={};return a[this.options.attributesGroupName]=i,a}return i}}const Z1e=function(n){n=n.replace(/\r\n?/g,`
`);const e=new Zu("!xml");let t=e,r="",s="";for(let i=0;i<n.length;i++)if(n[i]==="<")if(n[i+1]==="/"){const o=pc(n,">",i,"Closing Tag is not closed.");let c=n.substring(i+2,o).trim();if(this.options.removeNSPrefix){const f=c.indexOf(":");f!==-1&&(c=c.substr(f+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),t&&(r=this.saveTextToParentTag(r,t,s));const l=s.substring(s.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let u=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(u=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):u=s.lastIndexOf("."),s=s.substring(0,u),t=this.tagsNodeStack.pop(),r="",i=o}else if(n[i+1]==="?"){let o=SI(n,i,!1,"?>");if(!o)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,t,s),!(this.options.ignoreDeclaration&&o.tagName==="?xml"||this.options.ignorePiTags)){const c=new Zu(o.tagName);c.add(this.options.textNodeName,""),o.tagName!==o.tagExp&&o.attrExpPresent&&(c[":@"]=this.buildAttributesMap(o.tagExp,s,o.tagName)),this.addChild(t,c,s)}i=o.closeIndex+1}else if(n.substr(i+1,3)==="!--"){const o=pc(n,"-->",i+4,"Comment is not closed.");if(this.options.commentPropName){const c=n.substring(i+4,o-2);r=this.saveTextToParentTag(r,t,s),t.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}i=o}else if(n.substr(i+1,2)==="!D"){const o=W1e(n,i);this.docTypeEntities=o.entities,i=o.i}else if(n.substr(i+1,2)==="!["){const o=pc(n,"]]>",i,"CDATA is not closed.")-2,c=n.substring(i+9,o);if(r=this.saveTextToParentTag(r,t,s),this.options.cdataPropName)t.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]);else{let l=this.parseTextData(c,t.tagname,s,!0,!1,!0);l==null&&(l=""),t.add(this.options.textNodeName,l)}i=o+2}else{let o=SI(n,i,this.options.removeNSPrefix),c=o.tagName,l=o.tagExp,u=o.attrExpPresent,f=o.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),t&&r&&t.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,t,s,!1));const d=t;if(d&&this.options.unpairedTags.indexOf(d.tagname)!==-1&&(t=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),c!==e.tagname&&(s+=s?"."+c:c),this.isItStopNode(this.options.stopNodes,s,c)){let p="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)i=o.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)i=o.closeIndex;else{const I=this.readStopNodeData(n,c,f+1);if(!I)throw new Error(`Unexpected end of ${c}`);i=I.i,p=I.tagContent}const m=new Zu(c);c!==l&&u&&(m[":@"]=this.buildAttributesMap(l,s,c)),p&&(p=this.parseTextData(p,c,s,!0,u,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),m.add(this.options.textNodeName,p),this.addChild(t,m,s)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),l=c):l=l.substr(0,l.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const p=new Zu(c);c!==l&&u&&(p[":@"]=this.buildAttributesMap(l,s,c)),this.addChild(t,p,s),s=s.substr(0,s.lastIndexOf("."))}else{const p=new Zu(c);this.tagsNodeStack.push(t),c!==l&&u&&(p[":@"]=this.buildAttributesMap(l,s,c)),this.addChild(t,p,s),t=p}r="",i=f}}else r+=n[i];return e.child};function J1e(n,e,t){const r=this.options.updateTag(e.tagname,t,e[":@"]);r===!1||(typeof r=="string"&&(e.tagname=r),n.addChild(e))}const Q1e=function(n){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];n=n.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];n=n.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];n=n.replace(t.regex,t.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function eve(n,e,t,r){return n&&(r===void 0&&(r=Object.keys(e.child).length===0),n=this.parseTextData(n,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,r),n!==void 0&&n!==""&&e.add(this.options.textNodeName,n),n=""),n}function tve(n,e,t){const r="*."+t;for(const s in n){const i=n[s];if(r===i||e===i)return!0}return!1}function nve(n,e,t=">"){let r,s="";for(let i=e;i<n.length;i++){let a=n[i];if(r)a===r&&(r="");else if(a==='"'||a==="'")r=a;else if(a===t[0])if(t[1]){if(n[i+1]===t[1])return{data:s,index:i}}else return{data:s,index:i};else a==="	"&&(a=" ");s+=a}}function pc(n,e,t,r){const s=n.indexOf(e,t);if(s===-1)throw new Error(r);return s+e.length-1}function SI(n,e,t,r=">"){const s=nve(n,e+1,r);if(!s)return;let i=s.data;const a=s.index,o=i.search(/\s/);let c=i,l=!0;if(o!==-1&&(c=i.substr(0,o).replace(/\s\s*$/,""),i=i.substr(o+1)),t){const u=c.indexOf(":");u!==-1&&(c=c.substr(u+1),l=c!==s.data.substr(u+1))}return{tagName:c,tagExp:i,closeIndex:a,attrExpPresent:l}}function rve(n,e,t){const r=t;let s=1;for(;t<n.length;t++)if(n[t]==="<")if(n[t+1]==="/"){const i=pc(n,">",t,`${e} is not closed`);if(n.substring(t+2,i).trim()===e&&(s--,s===0))return{tagContent:n.substring(r,t),i};t=i}else if(n[t+1]==="?")t=pc(n,"?>",t+1,"StopNode is not closed.");else if(n.substr(t+1,3)==="!--")t=pc(n,"-->",t+3,"StopNode is not closed.");else if(n.substr(t+1,2)==="![")t=pc(n,"]]>",t,"StopNode is not closed.")-2;else{const i=SI(n,t,">");i&&((i&&i.tagName)===e&&i.tagExp[i.tagExp.length-1]!=="/"&&s++,t=i.closeIndex)}}function CI(n,e,t){if(e&&typeof n=="string"){const r=n.trim();return r==="true"?!0:r==="false"?!1:G1e(n,t)}else return ow.isExist(n)?n:""}var sve=H1e,nF={};function ive(n,e){return rF(n,e)}function rF(n,e,t){let r;const s={};for(let i=0;i<n.length;i++){const a=n[i],o=ave(a);let c="";if(t===void 0?c=o:c=t+"."+o,o===e.textNodeName)r===void 0?r=a[o]:r+=""+a[o];else{if(o===void 0)continue;if(a[o]){let l=rF(a[o],e,c);const u=cve(l,e);a[":@"]?ove(l,a[":@"],c,e):Object.keys(l).length===1&&l[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?l=l[e.textNodeName]:Object.keys(l).length===0&&(e.alwaysCreateTextNode?l[e.textNodeName]="":l=""),s[o]!==void 0&&s.hasOwnProperty(o)?(Array.isArray(s[o])||(s[o]=[s[o]]),s[o].push(l)):e.isArray(o,c,u)?s[o]=[l]:s[o]=l}}}return typeof r=="string"?r.length>0&&(s[e.textNodeName]=r):r!==void 0&&(s[e.textNodeName]=r),s}function ave(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];if(r!==":@")return r}}function ove(n,e,t,r){if(e){const s=Object.keys(e),i=s.length;for(let a=0;a<i;a++){const o=s[a];r.isArray(o,t+"."+o,!0,!0)?n[o]=[e[o]]:n[o]=e[o]}}}function cve(n,e){const{textNodeName:t}=e,r=Object.keys(n).length;return!!(r===0||r===1&&(n[t]||typeof n[t]=="boolean"||n[t]===0))}nF.prettify=ive;const{buildOptions:lve}=aw,uve=sve,{prettify:fve}=nF,hve=sw;let dve=class{constructor(e){this.externalEntities={},this.options=lve(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const i=hve.validate(e,t);if(i!==!0)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const r=new uve(this.options);r.addExternalEntities(this.externalEntities);const s=r.parseXml(e);return this.options.preserveOrder||s===void 0?s:fve(s,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};var pve=dve;const gve=`
`;function mve(n,e){let t="";return e.format&&e.indentBy.length>0&&(t=gve),sF(n,e,"",t)}function sF(n,e,t,r){let s="",i=!1;for(let a=0;a<n.length;a++){const o=n[a],c=vve(o);let l="";if(t.length===0?l=c:l=`${t}.${c}`,c===e.textNodeName){let m=o[c];Ive(l,e)||(m=e.tagValueProcessor(c,m),m=iF(m,e)),i&&(s+=r),s+=m,i=!1;continue}else if(c===e.cdataPropName){i&&(s+=r),s+=`<![CDATA[${o[c][0][e.textNodeName]}]]>`,i=!1;continue}else if(c===e.commentPropName){s+=r+`<!--${o[c][0][e.textNodeName]}-->`,i=!0;continue}else if(c[0]==="?"){const m=Ck(o[":@"],e),I=c==="?xml"?"":r;let v=o[c][0][e.textNodeName];v=v.length!==0?" "+v:"",s+=I+`<${c}${v}${m}?>`,i=!0;continue}let u=r;u!==""&&(u+=e.indentBy);const f=Ck(o[":@"],e),d=r+`<${c}${f}`,p=sF(o[c],e,l,u);e.unpairedTags.indexOf(c)!==-1?e.suppressUnpairedNode?s+=d+">":s+=d+"/>":(!p||p.length===0)&&e.suppressEmptyNode?s+=d+"/>":p&&p.endsWith(">")?s+=d+`>${p}${r}</${c}>`:(s+=d+">",p&&r!==""&&(p.includes("/>")||p.includes("</"))?s+=r+e.indentBy+p+r:s+=p,s+=`</${c}>`),i=!0}return s}function vve(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];if(r!==":@")return r}}function Ck(n,e){let t="";if(n&&!e.ignoreAttributes)for(let r in n){let s=e.attributeValueProcessor(r,n[r]);s=iF(s,e),s===!0&&e.suppressBooleanAttributes?t+=` ${r.substr(e.attributeNamePrefix.length)}`:t+=` ${r.substr(e.attributeNamePrefix.length)}="${s}"`}return t}function Ive(n,e){n=n.substr(0,n.length-e.textNodeName.length-1);let t=n.substr(n.lastIndexOf(".")+1);for(let r in e.stopNodes)if(e.stopNodes[r]===n||e.stopNodes[r]==="*."+t)return!0;return!1}function iF(n,e){if(n&&n.length>0&&e.processEntities)for(let t=0;t<e.entities.length;t++){const r=e.entities[t];n=n.replace(r.regex,r.val)}return n}var bve=mve;const yve=bve,xve={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Go(n){this.options=Object.assign({},xve,n),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Cve),this.processTextOrObjNode=wve,this.options.format?(this.indentate=Sve,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Go.prototype.build=function(n){return this.options.preserveOrder?yve(n,this.options):(Array.isArray(n)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(n={[this.options.arrayNodeName]:n}),this.j2x(n,0).val)};Go.prototype.j2x=function(n,e){let t="",r="";for(let s in n)if(!(typeof n[s]>"u"))if(n[s]===null)s[0]==="?"?r+=this.indentate(e)+"<"+s+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+s+"/"+this.tagEndChar;else if(n[s]instanceof Date)r+=this.buildTextValNode(n[s],s,"",e);else if(typeof n[s]!="object"){const i=this.isAttribute(s);if(i)t+=this.buildAttrPairStr(i,""+n[s]);else if(s===this.options.textNodeName){let a=this.options.tagValueProcessor(s,""+n[s]);r+=this.replaceEntitiesValue(a)}else r+=this.buildTextValNode(n[s],s,"",e)}else if(Array.isArray(n[s])){const i=n[s].length;let a="";for(let o=0;o<i;o++){const c=n[s][o];typeof c>"u"||(c===null?s[0]==="?"?r+=this.indentate(e)+"<"+s+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+s+"/"+this.tagEndChar:typeof c=="object"?this.options.oneListGroup?a+=this.j2x(c,e+1).val:a+=this.processTextOrObjNode(c,s,e):a+=this.buildTextValNode(c,s,"",e))}this.options.oneListGroup&&(a=this.buildObjectNode(a,s,"",e)),r+=a}else if(this.options.attributesGroupName&&s===this.options.attributesGroupName){const i=Object.keys(n[s]),a=i.length;for(let o=0;o<a;o++)t+=this.buildAttrPairStr(i[o],""+n[s][i[o]])}else r+=this.processTextOrObjNode(n[s],s,e);return{attrStr:t,val:r}};Go.prototype.buildAttrPairStr=function(n,e){return e=this.options.attributeValueProcessor(n,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+n:" "+n+'="'+e+'"'};function wve(n,e,t){const r=this.j2x(n,t+1);return n[this.options.textNodeName]!==void 0&&Object.keys(n).length===1?this.buildTextValNode(n[this.options.textNodeName],e,r.attrStr,t):this.buildObjectNode(r.val,e,r.attrStr,t)}Go.prototype.buildObjectNode=function(n,e,t,r){if(n==="")return e[0]==="?"?this.indentate(r)+"<"+e+t+"?"+this.tagEndChar:this.indentate(r)+"<"+e+t+this.closeTag(e)+this.tagEndChar;{let s="</"+e+this.tagEndChar,i="";return e[0]==="?"&&(i="?",s=""),t&&n.indexOf("<")===-1?this.indentate(r)+"<"+e+t+i+">"+n+s:this.options.commentPropName!==!1&&e===this.options.commentPropName&&i.length===0?this.indentate(r)+`<!--${n}-->`+this.newLine:this.indentate(r)+"<"+e+t+i+this.tagEndChar+n+this.indentate(r)+s}};Go.prototype.closeTag=function(n){let e="";return this.options.unpairedTags.indexOf(n)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${n}`,e};Go.prototype.buildTextValNode=function(n,e,t,r){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(r)+`<![CDATA[${n}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(r)+`<!--${n}-->`+this.newLine;if(e[0]==="?")return this.indentate(r)+"<"+e+t+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(e,n);return s=this.replaceEntitiesValue(s),s===""?this.indentate(r)+"<"+e+t+this.closeTag(e)+this.tagEndChar:this.indentate(r)+"<"+e+t+">"+s+"</"+e+this.tagEndChar}};Go.prototype.replaceEntitiesValue=function(n){if(n&&n.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const t=this.options.entities[e];n=n.replace(t.regex,t.val)}return n};function Sve(n){return this.options.indentBy.repeat(n)}function Cve(n){return n.startsWith(this.options.attributeNamePrefix)?n.substr(this.attrPrefixLen):!1}var Rve=Go;const kve=sw,Eve=pve,Tve=Rve;var a0={XMLParser:Eve,XMLValidator:kve,XMLBuilder:Tve};(function(n,e){e.__esModule=!0,e.default=void 0;var t=c(pu),r=o(s0),s=a0,i=zt;function a(v){if(typeof WeakMap!="function")return null;var b=new WeakMap,y=new WeakMap;return(a=function(w){return w?y:b})(v)}function o(v,b){if(!b&&v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var y=a(b);if(y&&y.has(v))return y.get(v);var S={},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in v)if(C!=="default"&&Object.prototype.hasOwnProperty.call(v,C)){var N=w?Object.getOwnPropertyDescriptor(v,C):null;N&&(N.get||N.set)?Object.defineProperty(S,C,N):S[C]=v[C]}return S.default=v,y&&y.set(v,S),S}function c(v){return v&&v.__esModule?v:{default:v}}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */l=function(){return v};var v={},b=Object.prototype,y=b.hasOwnProperty,S=typeof Symbol=="function"?Symbol:{},w=S.iterator||"@@iterator",C=S.asyncIterator||"@@asyncIterator",N=S.toStringTag||"@@toStringTag";function E(D,P,Q){return Object.defineProperty(D,P,{value:Q,enumerable:!0,configurable:!0,writable:!0}),D[P]}try{E({},"")}catch{E=function(Q,pe,Ee){return Q[pe]=Ee}}function A(D,P,Q,pe){var Ee=P&&P.prototype instanceof Y?P:Y,L=Object.create(Ee.prototype),q=new xe(pe||[]);return L._invoke=function(Z,se,ie){var B="suspendedStart";return function(R,k){if(B==="executing")throw new Error("Generator is already running");if(B==="completed"){if(R==="throw")throw k;return J()}for(ie.method=R,ie.arg=k;;){var X=ie.delegate;if(X){var fe=Ce(X,ie);if(fe){if(fe===z)continue;return fe}}if(ie.method==="next")ie.sent=ie._sent=ie.arg;else if(ie.method==="throw"){if(B==="suspendedStart")throw B="completed",ie.arg;ie.dispatchException(ie.arg)}else ie.method==="return"&&ie.abrupt("return",ie.arg);B="executing";var Te=M(Z,se,ie);if(Te.type==="normal"){if(B=ie.done?"completed":"suspendedYield",Te.arg===z)continue;return{value:Te.arg,done:ie.done}}Te.type==="throw"&&(B="completed",ie.method="throw",ie.arg=Te.arg)}}}(D,Q,q),L}function M(D,P,Q){try{return{type:"normal",arg:D.call(P,Q)}}catch(pe){return{type:"throw",arg:pe}}}v.wrap=A;var z={};function Y(){}function re(){}function ne(){}var le={};E(le,w,function(){return this});var j=Object.getPrototypeOf,ge=j&&j(j(ae([])));ge&&ge!==b&&y.call(ge,w)&&(le=ge);var Se=ne.prototype=Y.prototype=Object.create(le);function me(D){["next","throw","return"].forEach(function(P){E(D,P,function(Q){return this._invoke(P,Q)})})}function ye(D,P){function Q(Ee,L,q,Z){var se=M(D[Ee],D,L);if(se.type!=="throw"){var ie=se.arg,B=ie.value;return B&&typeof B=="object"&&y.call(B,"__await")?P.resolve(B.__await).then(function(R){Q("next",R,q,Z)},function(R){Q("throw",R,q,Z)}):P.resolve(B).then(function(R){ie.value=R,q(ie)},function(R){return Q("throw",R,q,Z)})}Z(se.arg)}var pe;this._invoke=function(Ee,L){function q(){return new P(function(Z,se){Q(Ee,L,Z,se)})}return pe=pe?pe.then(q,q):q()}}function Ce(D,P){var Q=D.iterator[P.method];if(Q===void 0){if(P.delegate=null,P.method==="throw"){if(D.iterator.return&&(P.method="return",P.arg=void 0,Ce(D,P),P.method==="throw"))return z;P.method="throw",P.arg=new TypeError("The iterator does not provide a 'throw' method")}return z}var pe=M(Q,D.iterator,P.arg);if(pe.type==="throw")return P.method="throw",P.arg=pe.arg,P.delegate=null,z;var Ee=pe.arg;return Ee?Ee.done?(P[D.resultName]=Ee.value,P.next=D.nextLoc,P.method!=="return"&&(P.method="next",P.arg=void 0),P.delegate=null,z):Ee:(P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,z)}function he(D){var P={tryLoc:D[0]};1 in D&&(P.catchLoc=D[1]),2 in D&&(P.finallyLoc=D[2],P.afterLoc=D[3]),this.tryEntries.push(P)}function Ne(D){var P=D.completion||{};P.type="normal",delete P.arg,D.completion=P}function xe(D){this.tryEntries=[{tryLoc:"root"}],D.forEach(he,this),this.reset(!0)}function ae(D){if(D){var P=D[w];if(P)return P.call(D);if(typeof D.next=="function")return D;if(!isNaN(D.length)){var Q=-1,pe=function Ee(){for(;++Q<D.length;)if(y.call(D,Q))return Ee.value=D[Q],Ee.done=!1,Ee;return Ee.value=void 0,Ee.done=!0,Ee};return pe.next=pe}}return{next:J}}function J(){return{value:void 0,done:!0}}return re.prototype=ne,E(Se,"constructor",ne),E(ne,"constructor",re),re.displayName=E(ne,N,"GeneratorFunction"),v.isGeneratorFunction=function(D){var P=typeof D=="function"&&D.constructor;return!!P&&(P===re||(P.displayName||P.name)==="GeneratorFunction")},v.mark=function(D){return Object.setPrototypeOf?Object.setPrototypeOf(D,ne):(D.__proto__=ne,E(D,N,"GeneratorFunction")),D.prototype=Object.create(Se),D},v.awrap=function(D){return{__await:D}},me(ye.prototype),E(ye.prototype,C,function(){return this}),v.AsyncIterator=ye,v.async=function(D,P,Q,pe,Ee){Ee===void 0&&(Ee=Promise);var L=new ye(A(D,P,Q,pe),Ee);return v.isGeneratorFunction(P)?L:L.next().then(function(q){return q.done?q.value:L.next()})},me(Se),E(Se,N,"Generator"),E(Se,w,function(){return this}),E(Se,"toString",function(){return"[object Generator]"}),v.keys=function(D){var P=[];for(var Q in D)P.push(Q);return P.reverse(),function pe(){for(;P.length;){var Ee=P.pop();if(Ee in D)return pe.value=Ee,pe.done=!1,pe}return pe.done=!0,pe}},v.values=ae,xe.prototype={constructor:xe,reset:function(P){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ne),!P)for(var Q in this)Q.charAt(0)==="t"&&y.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=void 0)},stop:function(){this.done=!0;var P=this.tryEntries[0].completion;if(P.type==="throw")throw P.arg;return this.rval},dispatchException:function(P){if(this.done)throw P;var Q=this;function pe(ie,B){return q.type="throw",q.arg=P,Q.next=ie,B&&(Q.method="next",Q.arg=void 0),!!B}for(var Ee=this.tryEntries.length-1;Ee>=0;--Ee){var L=this.tryEntries[Ee],q=L.completion;if(L.tryLoc==="root")return pe("end");if(L.tryLoc<=this.prev){var Z=y.call(L,"catchLoc"),se=y.call(L,"finallyLoc");if(Z&&se){if(this.prev<L.catchLoc)return pe(L.catchLoc,!0);if(this.prev<L.finallyLoc)return pe(L.finallyLoc)}else if(Z){if(this.prev<L.catchLoc)return pe(L.catchLoc,!0)}else{if(!se)throw new Error("try statement without catch or finally");if(this.prev<L.finallyLoc)return pe(L.finallyLoc)}}}},abrupt:function(P,Q){for(var pe=this.tryEntries.length-1;pe>=0;--pe){var Ee=this.tryEntries[pe];if(Ee.tryLoc<=this.prev&&y.call(Ee,"finallyLoc")&&this.prev<Ee.finallyLoc){var L=Ee;break}}L&&(P==="break"||P==="continue")&&L.tryLoc<=Q&&Q<=L.finallyLoc&&(L=null);var q=L?L.completion:{};return q.type=P,q.arg=Q,L?(this.method="next",this.next=L.finallyLoc,z):this.complete(q)},complete:function(P,Q){if(P.type==="throw")throw P.arg;return P.type==="break"||P.type==="continue"?this.next=P.arg:P.type==="return"?(this.rval=this.arg=P.arg,this.method="return",this.next="end"):P.type==="normal"&&Q&&(this.next=Q),z},finish:function(P){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var pe=this.tryEntries[Q];if(pe.finallyLoc===P)return this.complete(pe.completion,pe.afterLoc),Ne(pe),z}},catch:function(P){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var pe=this.tryEntries[Q];if(pe.tryLoc===P){var Ee=pe.completion;if(Ee.type==="throw"){var L=Ee.arg;Ne(pe)}return L}}throw new Error("illegal catch attempt")},delegateYield:function(P,Q,pe){return this.delegate={iterator:ae(P),resultName:Q,nextLoc:pe},this.method==="next"&&(this.arg=void 0),z}},v}function u(v,b,y,S,w,C,N){try{var E=v[C](N),A=E.value}catch(M){y(M);return}E.done?b(A):Promise.resolve(A).then(S,w)}function f(v){return function(){var b=this,y=arguments;return new Promise(function(S,w){var C=v.apply(b,y);function N(A){u(C,S,w,N,E,"next",A)}function E(A){u(C,S,w,N,E,"throw",A)}N(void 0)})}}function d(v,b){return p.apply(this,arguments)}function p(){return p=f(l().mark(function v(b,y){var S,w,C,N,E,A;return l().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(y=y||{},S=function(re){return(0,t.default)(re,y)},w={parsedSequence:null,messages:[],success:!0},z.prev=3,C=new s.XMLParser({isArray:function(){return!0},ignoreAttributes:!1}).parse(b),N=(0,r.default)("DnaComponent",C),!N[0]){z.next=12;break}for(E=[],A=0;A<N[0].value.length;A++){try{w={parsedSequence:null,messages:[],success:!0},w.parsedSequence=m(N[0].value[A],y)}catch(Y){console.error("error:",Y),console.error("error.stack: ",Y.stack),E.push({success:!1,messages:["Error while parsing Sbol format"]})}w.parsedSequence.features.length>0&&w.messages.push("SBOL feature types are stored in feature notes"),E.push(w)}return z.abrupt("return",S(E));case 12:return z.abrupt("return",S({success:!1,messages:["Error: XML is not valid Jbei or Sbol format"]}));case 13:z.next=18;break;case 15:return z.prev=15,z.t0=z.catch(3),z.abrupt("return",S({success:!1,messages:["Error parsing XML to JSON"]}));case 18:case"end":return z.stop()}},v,null,[[3,15]])})),p.apply(this,arguments)}function m(v,b){var y;return(0,i.get)(v,"name[0]")?y=(0,i.get)(v,"name[0]"):y=(0,i.get)(v,"displayId[0]"),{circular:!1,sequence:(0,i.get)(v,"dnaSequence[0].DnaSequence[0].nucleotides"),name:y,features:(0,i.flatMap)(v.annotation,function(S){var w=(0,i.get)(S,"SequenceAnnotation[0]");if(w){var C=(0,r.searchWholeObjByNameSimpleArray)("@_ns2:about",w),N=(0,r.searchWholeObjByNameSimpleArray)("@_ns2:resource",w),E={};[].concat(C,N).forEach(function(M){M&&(E.about||(E.about=[]),E.about.push(M))});var A=(0,r.searchWholeObjByNameSimple)("name",w)||(0,r.searchWholeObjByNameSimple)("displayId",w);return{name:A,notes:E,type:"misc_feature",start:parseInt((0,i.get)(w,"bioStart[0]")-(b.inclusive1BasedStart?0:1)),end:parseInt((0,i.get)(w,"bioEnd[0]")-(b.inclusive1BasedEnd?0:1)),strand:(0,i.get)(w,"strand[0]")}}})}}var I=d;e.default=I,n.exports=e.default})(wI,wI.exports);var aF=wI.exports,RI={exports:{}};(function(n,e){e.__esModule=!0,e.default=t;function t(r){if(typeof r=="string"){var s="",i=r.match(/\.(\w+)$/);return i&&i[1]&&(s=i[1]),s}else return""}n.exports=e.default})(RI,RI.exports);var oF=RI.exports,kI={exports:{}};/*!
 *  Copyright 2008 Fair Oaks Labs, Inc.
 *  All rights reserved.
 */function Ave(){var n,e=!1,t=this;t._DeArray=function(r,s,i){return[r.slice(s,s+i)]},t._EnArray=function(r,s,i,a){for(var o=0;o<i;r[s+o]=a[o]?a[o]:0,o++);},t._DeChar=function(r,s){return String.fromCharCode(r[s])},t._EnChar=function(r,s,i){r[s]=i.charCodeAt(0)},t._DeInt=function(r,s){var i=e?n.len-1:0,a=e?-1:1,o=i+a*n.len,c,l,u;for(c=0,l=i,u=1;l!=o;c+=r[s+l]*u,l+=a,u*=256);return n.bSigned&&c&Math.pow(2,n.len*8-1)&&(c-=Math.pow(2,n.len*8)),c},t._EnInt=function(r,s,i){var a=e?n.len-1:0,o=e?-1:1,c=a+o*n.len,l;for(i=i<n.min?n.min:i>n.max?n.max:i,l=a;l!=c;r[s+l]=i&255,l+=o,i>>=8);},t._DeString=function(r,s,i){for(var a=new Array(i),o=0;o<i;a[o]=String.fromCharCode(r[s+o]),o++);return a.join("")},t._EnString=function(r,s,i,a){for(var o,c=0;c<i;r[s+c]=(o=a.charCodeAt(c))?o:0,c++);},t._DeNullString=function(r,s,i,a){var o=t._DeString(r,s,i,a);return o.substring(0,o.length-1)},t._De754=function(r,s){var i,a,o,c,l,u,f,d,p,m;for(f=n.mLen,d=n.len*8-n.mLen-1,m=(1<<d)-1,p=m>>1,c=e?0:n.len-1,l=e?1:-1,i=r[s+c],c+=l,u=-7,a=i&(1<<-u)-1,i>>=-u,u+=d;u>0;a=a*256+r[s+c],c+=l,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=f;u>0;o=o*256+r[s+c],c+=l,u-=8);switch(a){case 0:a=1-p;break;case m:return o?NaN:(i?-1:1)*(1/0);default:o=o+Math.pow(2,f),a=a-p;break}return(i?-1:1)*o*Math.pow(2,a-f)},t._En754=function(r,s,i){var a,o,c,l,u,f,d,p,m,I;for(d=n.mLen,p=n.len*8-n.mLen-1,I=(1<<p)-1,m=I>>1,a=i<0?1:0,i=Math.abs(i),isNaN(i)||i==1/0?(c=isNaN(i)?1:0,o=I):(o=Math.floor(Math.log(i)/Math.LN2),i*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+m>=1?i+=n.rt/f:i+=n.rt*Math.pow(2,1-m),i*f>=2&&(o++,f/=2),o+m>=I?(c=0,o=I):o+m>=1?(c=(i*f-1)*Math.pow(2,d),o=o+m):(c=i*Math.pow(2,m-1)*Math.pow(2,d),o=0)),l=e?n.len-1:0,u=e?-1:1;d>=8;r[s+l]=c&255,l+=u,c/=256,d-=8);for(o=o<<d|c,p+=d;p>0;r[s+l]=o&255,l+=u,o/=256,p-=8);r[s+l-u]|=a*128},t._sPattern="(\\d+)?([AxcbBhHsSfdiIlL])(\\(([a-zA-Z0-9]+)\\))?",t._lenLut={A:1,x:1,c:1,b:1,B:1,h:2,H:2,s:1,S:1,f:4,d:8,i:4,I:4,l:4,L:4},t._elLut={A:{en:t._EnArray,de:t._DeArray},s:{en:t._EnString,de:t._DeString},S:{en:t._EnString,de:t._DeNullString},c:{en:t._EnChar,de:t._DeChar},b:{en:t._EnInt,de:t._DeInt,len:1,bSigned:!0,min:-Math.pow(2,7),max:Math.pow(2,7)-1},B:{en:t._EnInt,de:t._DeInt,len:1,bSigned:!1,min:0,max:Math.pow(2,8)-1},h:{en:t._EnInt,de:t._DeInt,len:2,bSigned:!0,min:-Math.pow(2,15),max:Math.pow(2,15)-1},H:{en:t._EnInt,de:t._DeInt,len:2,bSigned:!1,min:0,max:Math.pow(2,16)-1},i:{en:t._EnInt,de:t._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},I:{en:t._EnInt,de:t._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},l:{en:t._EnInt,de:t._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},L:{en:t._EnInt,de:t._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},f:{en:t._En754,de:t._De754,len:4,mLen:23,rt:Math.pow(2,-24)-Math.pow(2,-77)},d:{en:t._En754,de:t._De754,len:8,mLen:52,rt:0}},t._UnpackSeries=function(r,s,i,a){for(var o=n.de,c=[],l=0;l<r;c.push(o(i,a+l*s)),l++);return c},t._PackSeries=function(r,s,i,a,o,c){for(var l=n.en,u=0;u<r;l(i,a+u*s,o[c+u]),u++);},t._zip=function(r,s){for(var i={},a=0;a<r.length;a++)i[r[a]]=s[a];return i},t.unpack=function(r,s,i){e=r.charAt(0)!="<",i=i||0;for(var a=new RegExp(this._sPattern,"g"),o,c,l,u=[],f=[];o=a.exec(r);){if(c=o[1]==null||o[1]==""?1:parseInt(o[1]),o[2]==="S"){for(c=0;s[i+c]!==0;)c++;c++}if(l=this._lenLut[o[2]],i+c*l>s.length)return;switch(o[2]){case"A":case"s":case"S":f.push(this._elLut[o[2]].de(s,i,c));break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":n=this._elLut[o[2]],f.push(this._UnpackSeries(c,l,s,i));break}u.push(o[4]),i+=c*l}return f=Array.prototype.concat.apply([],f),u.indexOf(void 0)!==-1?f:this._zip(u,f)},t.packTo=function(r,s,i,a){e=r.charAt(0)!="<";for(var o=new RegExp(this._sPattern,"g"),c,l,u,f=0,d;c=o.exec(r);){if(l=c[1]==null||c[1]==""?1:parseInt(c[1]),c[2]==="S"&&(l=a[f].length+1),u=this._lenLut[c[2]],i+l*u>s.length)return!1;switch(c[2]){case"A":case"s":case"S":if(f+1>a.length)return!1;this._elLut[c[2]].en(s,i,l,a[f]),f+=1;break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":if(n=this._elLut[c[2]],f+l>a.length)return!1;this._PackSeries(l,u,s,i,a,f),f+=l;break;case"x":for(d=0;d<l;d++)s[i+d]=0;break}i+=l*u}return s},t.pack=function(r,s){return this.packTo(r,new Buffer(this.calcLength(r,s)),0,s)},t.calcLength=function(r,s){for(var i=new RegExp(this._sPattern,"g"),a,o=0,c=0;a=i.exec(r);){var l=(a[1]==null||a[1]==""?1:parseInt(a[1]))*this._lenLut[a[2]];a[2]==="S"&&(l=s[c].length+1),o+=l,c++}return o}}var $ve=new Ave,tg={},EI={exports:{}},Yh={},Zh={};Zh.byteLength=_ve;Zh.toByteArray=Dve;Zh.fromByteArray=Pve;var ha=[],ci=[],Nve=typeof Uint8Array<"u"?Uint8Array:Array,iv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var pl=0,Ove=iv.length;pl<Ove;++pl)ha[pl]=iv[pl],ci[iv.charCodeAt(pl)]=pl;ci["-".charCodeAt(0)]=62;ci["_".charCodeAt(0)]=63;function cF(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function _ve(n){var e=cF(n),t=e[0],r=e[1];return(t+r)*3/4-r}function Fve(n,e,t){return(e+t)*3/4-t}function Dve(n){var e,t=cF(n),r=t[0],s=t[1],i=new Nve(Fve(n,r,s)),a=0,o=s>0?r-4:r,c;for(c=0;c<o;c+=4)e=ci[n.charCodeAt(c)]<<18|ci[n.charCodeAt(c+1)]<<12|ci[n.charCodeAt(c+2)]<<6|ci[n.charCodeAt(c+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=e&255;return s===2&&(e=ci[n.charCodeAt(c)]<<2|ci[n.charCodeAt(c+1)]>>4,i[a++]=e&255),s===1&&(e=ci[n.charCodeAt(c)]<<10|ci[n.charCodeAt(c+1)]<<4|ci[n.charCodeAt(c+2)]>>2,i[a++]=e>>8&255,i[a++]=e&255),i}function Bve(n){return ha[n>>18&63]+ha[n>>12&63]+ha[n>>6&63]+ha[n&63]}function Mve(n,e,t){for(var r,s=[],i=e;i<t;i+=3)r=(n[i]<<16&16711680)+(n[i+1]<<8&65280)+(n[i+2]&255),s.push(Bve(r));return s.join("")}function Pve(n){for(var e,t=n.length,r=t%3,s=[],i=16383,a=0,o=t-r;a<o;a+=i)s.push(Mve(n,a,a+i>o?o:a+i));return r===1?(e=n[t-1],s.push(ha[e>>2]+ha[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],s.push(ha[e>>10]+ha[e>>4&63]+ha[e<<2&63]+"=")),s.join("")}var o0={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */o0.read=function(n,e,t,r,s){var i,a,o=s*8-r-1,c=(1<<o)-1,l=c>>1,u=-7,f=t?s-1:0,d=t?-1:1,p=n[e+f];for(f+=d,i=p&(1<<-u)-1,p>>=-u,u+=o;u>0;i=i*256+n[e+f],f+=d,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+n[e+f],f+=d,u-=8);if(i===0)i=1-l;else{if(i===c)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-l}return(p?-1:1)*a*Math.pow(2,i-r)};o0.write=function(n,e,t,r,s,i){var a,o,c,l=i*8-s-1,u=(1<<l)-1,f=u>>1,d=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,m=r?1:-1,I=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+f>=1?e+=d/c:e+=d*Math.pow(2,1-f),e*c>=2&&(a++,c/=2),a+f>=u?(o=0,a=u):a+f>=1?(o=(e*c-1)*Math.pow(2,s),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,s),a=0));s>=8;n[t+p]=o&255,p+=m,o/=256,s-=8);for(a=a<<s|o,l+=s;l>0;n[t+p]=a&255,p+=m,a/=256,l-=8);n[t+p-m]|=I*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){var e=Zh,t=o0,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=o,n.SlowBuffer=y,n.INSPECT_MAX_BYTES=50;var s=2147483647;n.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=i(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var B=new Uint8Array(1),R={foo:function(){return 42}};return Object.setPrototypeOf(R,Uint8Array.prototype),Object.setPrototypeOf(B,R),B.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(B){if(B>s)throw new RangeError('The value "'+B+'" is invalid for option "size"');var R=new Uint8Array(B);return Object.setPrototypeOf(R,o.prototype),R}function o(B,R,k){if(typeof B=="number"){if(typeof R=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(B)}return c(B,R,k)}o.poolSize=8192;function c(B,R,k){if(typeof B=="string")return d(B,R);if(ArrayBuffer.isView(B))return m(B);if(B==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(Z(B,ArrayBuffer)||B&&Z(B.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Z(B,SharedArrayBuffer)||B&&Z(B.buffer,SharedArrayBuffer)))return I(B,R,k);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var X=B.valueOf&&B.valueOf();if(X!=null&&X!==B)return o.from(X,R,k);var fe=v(B);if(fe)return fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return o.from(B[Symbol.toPrimitive]("string"),R,k);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}o.from=function(B,R,k){return c(B,R,k)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function l(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function u(B,R,k){return l(B),B<=0?a(B):R!==void 0?typeof k=="string"?a(B).fill(R,k):a(B).fill(R):a(B)}o.alloc=function(B,R,k){return u(B,R,k)};function f(B){return l(B),a(B<0?0:b(B)|0)}o.allocUnsafe=function(B){return f(B)},o.allocUnsafeSlow=function(B){return f(B)};function d(B,R){if((typeof R!="string"||R==="")&&(R="utf8"),!o.isEncoding(R))throw new TypeError("Unknown encoding: "+R);var k=S(B,R)|0,X=a(k),fe=X.write(B,R);return fe!==k&&(X=X.slice(0,fe)),X}function p(B){for(var R=B.length<0?0:b(B.length)|0,k=a(R),X=0;X<R;X+=1)k[X]=B[X]&255;return k}function m(B){if(Z(B,Uint8Array)){var R=new Uint8Array(B);return I(R.buffer,R.byteOffset,R.byteLength)}return p(B)}function I(B,R,k){if(R<0||B.byteLength<R)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<R+(k||0))throw new RangeError('"length" is outside of buffer bounds');var X;return R===void 0&&k===void 0?X=new Uint8Array(B):k===void 0?X=new Uint8Array(B,R):X=new Uint8Array(B,R,k),Object.setPrototypeOf(X,o.prototype),X}function v(B){if(o.isBuffer(B)){var R=b(B.length)|0,k=a(R);return k.length===0||B.copy(k,0,0,R),k}if(B.length!==void 0)return typeof B.length!="number"||se(B.length)?a(0):p(B);if(B.type==="Buffer"&&Array.isArray(B.data))return p(B.data)}function b(B){if(B>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return B|0}function y(B){return+B!=B&&(B=0),o.alloc(+B)}o.isBuffer=function(R){return R!=null&&R._isBuffer===!0&&R!==o.prototype},o.compare=function(R,k){if(Z(R,Uint8Array)&&(R=o.from(R,R.offset,R.byteLength)),Z(k,Uint8Array)&&(k=o.from(k,k.offset,k.byteLength)),!o.isBuffer(R)||!o.isBuffer(k))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(R===k)return 0;for(var X=R.length,fe=k.length,Te=0,Be=Math.min(X,fe);Te<Be;++Te)if(R[Te]!==k[Te]){X=R[Te],fe=k[Te];break}return X<fe?-1:fe<X?1:0},o.isEncoding=function(R){switch(String(R).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(R,k){if(!Array.isArray(R))throw new TypeError('"list" argument must be an Array of Buffers');if(R.length===0)return o.alloc(0);var X;if(k===void 0)for(k=0,X=0;X<R.length;++X)k+=R[X].length;var fe=o.allocUnsafe(k),Te=0;for(X=0;X<R.length;++X){var Be=R[X];if(Z(Be,Uint8Array))Te+Be.length>fe.length?o.from(Be).copy(fe,Te):Uint8Array.prototype.set.call(fe,Be,Te);else if(o.isBuffer(Be))Be.copy(fe,Te);else throw new TypeError('"list" argument must be an Array of Buffers');Te+=Be.length}return fe};function S(B,R){if(o.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||Z(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var k=B.length,X=arguments.length>2&&arguments[2]===!0;if(!X&&k===0)return 0;for(var fe=!1;;)switch(R){case"ascii":case"latin1":case"binary":return k;case"utf8":case"utf-8":return Q(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k*2;case"hex":return k>>>1;case"base64":return L(B).length;default:if(fe)return X?-1:Q(B).length;R=(""+R).toLowerCase(),fe=!0}}o.byteLength=S;function w(B,R,k){var X=!1;if((R===void 0||R<0)&&(R=0),R>this.length||((k===void 0||k>this.length)&&(k=this.length),k<=0)||(k>>>=0,R>>>=0,k<=R))return"";for(B||(B="utf8");;)switch(B){case"hex":return ye(this,R,k);case"utf8":case"utf-8":return le(this,R,k);case"ascii":return Se(this,R,k);case"latin1":case"binary":return me(this,R,k);case"base64":return ne(this,R,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ce(this,R,k);default:if(X)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),X=!0}}o.prototype._isBuffer=!0;function C(B,R,k){var X=B[R];B[R]=B[k],B[k]=X}o.prototype.swap16=function(){var R=this.length;if(R%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var k=0;k<R;k+=2)C(this,k,k+1);return this},o.prototype.swap32=function(){var R=this.length;if(R%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var k=0;k<R;k+=4)C(this,k,k+3),C(this,k+1,k+2);return this},o.prototype.swap64=function(){var R=this.length;if(R%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var k=0;k<R;k+=8)C(this,k,k+7),C(this,k+1,k+6),C(this,k+2,k+5),C(this,k+3,k+4);return this},o.prototype.toString=function(){var R=this.length;return R===0?"":arguments.length===0?le(this,0,R):w.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(R){if(!o.isBuffer(R))throw new TypeError("Argument must be a Buffer");return this===R?!0:o.compare(this,R)===0},o.prototype.inspect=function(){var R="",k=n.INSPECT_MAX_BYTES;return R=this.toString("hex",0,k).replace(/(.{2})/g,"$1 ").trim(),this.length>k&&(R+=" ... "),"<Buffer "+R+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(R,k,X,fe,Te){if(Z(R,Uint8Array)&&(R=o.from(R,R.offset,R.byteLength)),!o.isBuffer(R))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof R);if(k===void 0&&(k=0),X===void 0&&(X=R?R.length:0),fe===void 0&&(fe=0),Te===void 0&&(Te=this.length),k<0||X>R.length||fe<0||Te>this.length)throw new RangeError("out of range index");if(fe>=Te&&k>=X)return 0;if(fe>=Te)return-1;if(k>=X)return 1;if(k>>>=0,X>>>=0,fe>>>=0,Te>>>=0,this===R)return 0;for(var Be=Te-fe,He=X-k,rt=Math.min(Be,He),ct=this.slice(fe,Te),lt=R.slice(k,X),W=0;W<rt;++W)if(ct[W]!==lt[W]){Be=ct[W],He=lt[W];break}return Be<He?-1:He<Be?1:0};function N(B,R,k,X,fe){if(B.length===0)return-1;if(typeof k=="string"?(X=k,k=0):k>2147483647?k=2147483647:k<-2147483648&&(k=-2147483648),k=+k,se(k)&&(k=fe?0:B.length-1),k<0&&(k=B.length+k),k>=B.length){if(fe)return-1;k=B.length-1}else if(k<0)if(fe)k=0;else return-1;if(typeof R=="string"&&(R=o.from(R,X)),o.isBuffer(R))return R.length===0?-1:E(B,R,k,X,fe);if(typeof R=="number")return R=R&255,typeof Uint8Array.prototype.indexOf=="function"?fe?Uint8Array.prototype.indexOf.call(B,R,k):Uint8Array.prototype.lastIndexOf.call(B,R,k):E(B,[R],k,X,fe);throw new TypeError("val must be string, number or Buffer")}function E(B,R,k,X,fe){var Te=1,Be=B.length,He=R.length;if(X!==void 0&&(X=String(X).toLowerCase(),X==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(B.length<2||R.length<2)return-1;Te=2,Be/=2,He/=2,k/=2}function rt(O,ue){return Te===1?O[ue]:O.readUInt16BE(ue*Te)}var ct;if(fe){var lt=-1;for(ct=k;ct<Be;ct++)if(rt(B,ct)===rt(R,lt===-1?0:ct-lt)){if(lt===-1&&(lt=ct),ct-lt+1===He)return lt*Te}else lt!==-1&&(ct-=ct-lt),lt=-1}else for(k+He>Be&&(k=Be-He),ct=k;ct>=0;ct--){for(var W=!0,T=0;T<He;T++)if(rt(B,ct+T)!==rt(R,T)){W=!1;break}if(W)return ct}return-1}o.prototype.includes=function(R,k,X){return this.indexOf(R,k,X)!==-1},o.prototype.indexOf=function(R,k,X){return N(this,R,k,X,!0)},o.prototype.lastIndexOf=function(R,k,X){return N(this,R,k,X,!1)};function A(B,R,k,X){k=Number(k)||0;var fe=B.length-k;X?(X=Number(X),X>fe&&(X=fe)):X=fe;var Te=R.length;X>Te/2&&(X=Te/2);for(var Be=0;Be<X;++Be){var He=parseInt(R.substr(Be*2,2),16);if(se(He))return Be;B[k+Be]=He}return Be}function M(B,R,k,X){return q(Q(R,B.length-k),B,k,X)}function z(B,R,k,X){return q(pe(R),B,k,X)}function Y(B,R,k,X){return q(L(R),B,k,X)}function re(B,R,k,X){return q(Ee(R,B.length-k),B,k,X)}o.prototype.write=function(R,k,X,fe){if(k===void 0)fe="utf8",X=this.length,k=0;else if(X===void 0&&typeof k=="string")fe=k,X=this.length,k=0;else if(isFinite(k))k=k>>>0,isFinite(X)?(X=X>>>0,fe===void 0&&(fe="utf8")):(fe=X,X=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Te=this.length-k;if((X===void 0||X>Te)&&(X=Te),R.length>0&&(X<0||k<0)||k>this.length)throw new RangeError("Attempt to write outside buffer bounds");fe||(fe="utf8");for(var Be=!1;;)switch(fe){case"hex":return A(this,R,k,X);case"utf8":case"utf-8":return M(this,R,k,X);case"ascii":case"latin1":case"binary":return z(this,R,k,X);case"base64":return Y(this,R,k,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,R,k,X);default:if(Be)throw new TypeError("Unknown encoding: "+fe);fe=(""+fe).toLowerCase(),Be=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(B,R,k){return R===0&&k===B.length?e.fromByteArray(B):e.fromByteArray(B.slice(R,k))}function le(B,R,k){k=Math.min(B.length,k);for(var X=[],fe=R;fe<k;){var Te=B[fe],Be=null,He=Te>239?4:Te>223?3:Te>191?2:1;if(fe+He<=k){var rt,ct,lt,W;switch(He){case 1:Te<128&&(Be=Te);break;case 2:rt=B[fe+1],(rt&192)===128&&(W=(Te&31)<<6|rt&63,W>127&&(Be=W));break;case 3:rt=B[fe+1],ct=B[fe+2],(rt&192)===128&&(ct&192)===128&&(W=(Te&15)<<12|(rt&63)<<6|ct&63,W>2047&&(W<55296||W>57343)&&(Be=W));break;case 4:rt=B[fe+1],ct=B[fe+2],lt=B[fe+3],(rt&192)===128&&(ct&192)===128&&(lt&192)===128&&(W=(Te&15)<<18|(rt&63)<<12|(ct&63)<<6|lt&63,W>65535&&W<1114112&&(Be=W))}}Be===null?(Be=65533,He=1):Be>65535&&(Be-=65536,X.push(Be>>>10&1023|55296),Be=56320|Be&1023),X.push(Be),fe+=He}return ge(X)}var j=4096;function ge(B){var R=B.length;if(R<=j)return String.fromCharCode.apply(String,B);for(var k="",X=0;X<R;)k+=String.fromCharCode.apply(String,B.slice(X,X+=j));return k}function Se(B,R,k){var X="";k=Math.min(B.length,k);for(var fe=R;fe<k;++fe)X+=String.fromCharCode(B[fe]&127);return X}function me(B,R,k){var X="";k=Math.min(B.length,k);for(var fe=R;fe<k;++fe)X+=String.fromCharCode(B[fe]);return X}function ye(B,R,k){var X=B.length;(!R||R<0)&&(R=0),(!k||k<0||k>X)&&(k=X);for(var fe="",Te=R;Te<k;++Te)fe+=ie[B[Te]];return fe}function Ce(B,R,k){for(var X=B.slice(R,k),fe="",Te=0;Te<X.length-1;Te+=2)fe+=String.fromCharCode(X[Te]+X[Te+1]*256);return fe}o.prototype.slice=function(R,k){var X=this.length;R=~~R,k=k===void 0?X:~~k,R<0?(R+=X,R<0&&(R=0)):R>X&&(R=X),k<0?(k+=X,k<0&&(k=0)):k>X&&(k=X),k<R&&(k=R);var fe=this.subarray(R,k);return Object.setPrototypeOf(fe,o.prototype),fe};function he(B,R,k){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+R>k)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(R,k,X){R=R>>>0,k=k>>>0,X||he(R,k,this.length);for(var fe=this[R],Te=1,Be=0;++Be<k&&(Te*=256);)fe+=this[R+Be]*Te;return fe},o.prototype.readUintBE=o.prototype.readUIntBE=function(R,k,X){R=R>>>0,k=k>>>0,X||he(R,k,this.length);for(var fe=this[R+--k],Te=1;k>0&&(Te*=256);)fe+=this[R+--k]*Te;return fe},o.prototype.readUint8=o.prototype.readUInt8=function(R,k){return R=R>>>0,k||he(R,1,this.length),this[R]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(R,k){return R=R>>>0,k||he(R,2,this.length),this[R]|this[R+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(R,k){return R=R>>>0,k||he(R,2,this.length),this[R]<<8|this[R+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(R,k){return R=R>>>0,k||he(R,4,this.length),(this[R]|this[R+1]<<8|this[R+2]<<16)+this[R+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(R,k){return R=R>>>0,k||he(R,4,this.length),this[R]*16777216+(this[R+1]<<16|this[R+2]<<8|this[R+3])},o.prototype.readIntLE=function(R,k,X){R=R>>>0,k=k>>>0,X||he(R,k,this.length);for(var fe=this[R],Te=1,Be=0;++Be<k&&(Te*=256);)fe+=this[R+Be]*Te;return Te*=128,fe>=Te&&(fe-=Math.pow(2,8*k)),fe},o.prototype.readIntBE=function(R,k,X){R=R>>>0,k=k>>>0,X||he(R,k,this.length);for(var fe=k,Te=1,Be=this[R+--fe];fe>0&&(Te*=256);)Be+=this[R+--fe]*Te;return Te*=128,Be>=Te&&(Be-=Math.pow(2,8*k)),Be},o.prototype.readInt8=function(R,k){return R=R>>>0,k||he(R,1,this.length),this[R]&128?(255-this[R]+1)*-1:this[R]},o.prototype.readInt16LE=function(R,k){R=R>>>0,k||he(R,2,this.length);var X=this[R]|this[R+1]<<8;return X&32768?X|4294901760:X},o.prototype.readInt16BE=function(R,k){R=R>>>0,k||he(R,2,this.length);var X=this[R+1]|this[R]<<8;return X&32768?X|4294901760:X},o.prototype.readInt32LE=function(R,k){return R=R>>>0,k||he(R,4,this.length),this[R]|this[R+1]<<8|this[R+2]<<16|this[R+3]<<24},o.prototype.readInt32BE=function(R,k){return R=R>>>0,k||he(R,4,this.length),this[R]<<24|this[R+1]<<16|this[R+2]<<8|this[R+3]},o.prototype.readFloatLE=function(R,k){return R=R>>>0,k||he(R,4,this.length),t.read(this,R,!0,23,4)},o.prototype.readFloatBE=function(R,k){return R=R>>>0,k||he(R,4,this.length),t.read(this,R,!1,23,4)},o.prototype.readDoubleLE=function(R,k){return R=R>>>0,k||he(R,8,this.length),t.read(this,R,!0,52,8)},o.prototype.readDoubleBE=function(R,k){return R=R>>>0,k||he(R,8,this.length),t.read(this,R,!1,52,8)};function Ne(B,R,k,X,fe,Te){if(!o.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(R>fe||R<Te)throw new RangeError('"value" argument is out of bounds');if(k+X>B.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(R,k,X,fe){if(R=+R,k=k>>>0,X=X>>>0,!fe){var Te=Math.pow(2,8*X)-1;Ne(this,R,k,X,Te,0)}var Be=1,He=0;for(this[k]=R&255;++He<X&&(Be*=256);)this[k+He]=R/Be&255;return k+X},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(R,k,X,fe){if(R=+R,k=k>>>0,X=X>>>0,!fe){var Te=Math.pow(2,8*X)-1;Ne(this,R,k,X,Te,0)}var Be=X-1,He=1;for(this[k+Be]=R&255;--Be>=0&&(He*=256);)this[k+Be]=R/He&255;return k+X},o.prototype.writeUint8=o.prototype.writeUInt8=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,1,255,0),this[k]=R&255,k+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,2,65535,0),this[k]=R&255,this[k+1]=R>>>8,k+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,2,65535,0),this[k]=R>>>8,this[k+1]=R&255,k+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,4,4294967295,0),this[k+3]=R>>>24,this[k+2]=R>>>16,this[k+1]=R>>>8,this[k]=R&255,k+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,4,4294967295,0),this[k]=R>>>24,this[k+1]=R>>>16,this[k+2]=R>>>8,this[k+3]=R&255,k+4},o.prototype.writeIntLE=function(R,k,X,fe){if(R=+R,k=k>>>0,!fe){var Te=Math.pow(2,8*X-1);Ne(this,R,k,X,Te-1,-Te)}var Be=0,He=1,rt=0;for(this[k]=R&255;++Be<X&&(He*=256);)R<0&&rt===0&&this[k+Be-1]!==0&&(rt=1),this[k+Be]=(R/He>>0)-rt&255;return k+X},o.prototype.writeIntBE=function(R,k,X,fe){if(R=+R,k=k>>>0,!fe){var Te=Math.pow(2,8*X-1);Ne(this,R,k,X,Te-1,-Te)}var Be=X-1,He=1,rt=0;for(this[k+Be]=R&255;--Be>=0&&(He*=256);)R<0&&rt===0&&this[k+Be+1]!==0&&(rt=1),this[k+Be]=(R/He>>0)-rt&255;return k+X},o.prototype.writeInt8=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,1,127,-128),R<0&&(R=255+R+1),this[k]=R&255,k+1},o.prototype.writeInt16LE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,2,32767,-32768),this[k]=R&255,this[k+1]=R>>>8,k+2},o.prototype.writeInt16BE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,2,32767,-32768),this[k]=R>>>8,this[k+1]=R&255,k+2},o.prototype.writeInt32LE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,4,2147483647,-2147483648),this[k]=R&255,this[k+1]=R>>>8,this[k+2]=R>>>16,this[k+3]=R>>>24,k+4},o.prototype.writeInt32BE=function(R,k,X){return R=+R,k=k>>>0,X||Ne(this,R,k,4,2147483647,-2147483648),R<0&&(R=4294967295+R+1),this[k]=R>>>24,this[k+1]=R>>>16,this[k+2]=R>>>8,this[k+3]=R&255,k+4};function xe(B,R,k,X,fe,Te){if(k+X>B.length)throw new RangeError("Index out of range");if(k<0)throw new RangeError("Index out of range")}function ae(B,R,k,X,fe){return R=+R,k=k>>>0,fe||xe(B,R,k,4),t.write(B,R,k,X,23,4),k+4}o.prototype.writeFloatLE=function(R,k,X){return ae(this,R,k,!0,X)},o.prototype.writeFloatBE=function(R,k,X){return ae(this,R,k,!1,X)};function J(B,R,k,X,fe){return R=+R,k=k>>>0,fe||xe(B,R,k,8),t.write(B,R,k,X,52,8),k+8}o.prototype.writeDoubleLE=function(R,k,X){return J(this,R,k,!0,X)},o.prototype.writeDoubleBE=function(R,k,X){return J(this,R,k,!1,X)},o.prototype.copy=function(R,k,X,fe){if(!o.isBuffer(R))throw new TypeError("argument should be a Buffer");if(X||(X=0),!fe&&fe!==0&&(fe=this.length),k>=R.length&&(k=R.length),k||(k=0),fe>0&&fe<X&&(fe=X),fe===X||R.length===0||this.length===0)return 0;if(k<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(fe<0)throw new RangeError("sourceEnd out of bounds");fe>this.length&&(fe=this.length),R.length-k<fe-X&&(fe=R.length-k+X);var Te=fe-X;return this===R&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(k,X,fe):Uint8Array.prototype.set.call(R,this.subarray(X,fe),k),Te},o.prototype.fill=function(R,k,X,fe){if(typeof R=="string"){if(typeof k=="string"?(fe=k,k=0,X=this.length):typeof X=="string"&&(fe=X,X=this.length),fe!==void 0&&typeof fe!="string")throw new TypeError("encoding must be a string");if(typeof fe=="string"&&!o.isEncoding(fe))throw new TypeError("Unknown encoding: "+fe);if(R.length===1){var Te=R.charCodeAt(0);(fe==="utf8"&&Te<128||fe==="latin1")&&(R=Te)}}else typeof R=="number"?R=R&255:typeof R=="boolean"&&(R=Number(R));if(k<0||this.length<k||this.length<X)throw new RangeError("Out of range index");if(X<=k)return this;k=k>>>0,X=X===void 0?this.length:X>>>0,R||(R=0);var Be;if(typeof R=="number")for(Be=k;Be<X;++Be)this[Be]=R;else{var He=o.isBuffer(R)?R:o.from(R,fe),rt=He.length;if(rt===0)throw new TypeError('The value "'+R+'" is invalid for argument "value"');for(Be=0;Be<X-k;++Be)this[Be+k]=He[Be%rt]}return this};var D=/[^+/0-9A-Za-z-_]/g;function P(B){if(B=B.split("=")[0],B=B.trim().replace(D,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function Q(B,R){R=R||1/0;for(var k,X=B.length,fe=null,Te=[],Be=0;Be<X;++Be){if(k=B.charCodeAt(Be),k>55295&&k<57344){if(!fe){if(k>56319){(R-=3)>-1&&Te.push(239,191,189);continue}else if(Be+1===X){(R-=3)>-1&&Te.push(239,191,189);continue}fe=k;continue}if(k<56320){(R-=3)>-1&&Te.push(239,191,189),fe=k;continue}k=(fe-55296<<10|k-56320)+65536}else fe&&(R-=3)>-1&&Te.push(239,191,189);if(fe=null,k<128){if((R-=1)<0)break;Te.push(k)}else if(k<2048){if((R-=2)<0)break;Te.push(k>>6|192,k&63|128)}else if(k<65536){if((R-=3)<0)break;Te.push(k>>12|224,k>>6&63|128,k&63|128)}else if(k<1114112){if((R-=4)<0)break;Te.push(k>>18|240,k>>12&63|128,k>>6&63|128,k&63|128)}else throw new Error("Invalid code point")}return Te}function pe(B){for(var R=[],k=0;k<B.length;++k)R.push(B.charCodeAt(k)&255);return R}function Ee(B,R){for(var k,X,fe,Te=[],Be=0;Be<B.length&&!((R-=2)<0);++Be)k=B.charCodeAt(Be),X=k>>8,fe=k%256,Te.push(fe),Te.push(X);return Te}function L(B){return e.toByteArray(P(B))}function q(B,R,k,X){for(var fe=0;fe<X&&!(fe+k>=R.length||fe>=B.length);++fe)R[fe+k]=B[fe];return fe}function Z(B,R){return B instanceof R||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===R.name}function se(B){return B!==B}var ie=function(){for(var B="0123456789abcdef",R=new Array(256),k=0;k<16;++k)for(var X=k*16,fe=0;fe<16;++fe)R[X+fe]=B[k]+B[fe];return R}()})(Yh);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=Yh,r=t.Buffer;function s(a,o){for(var c in a)o[c]=a[c]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(s(t,e),e.Buffer=i);function i(a,o,c){return r(a,o,c)}i.prototype=Object.create(r.prototype),s(r,i),i.from=function(a,o,c){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,c)},i.alloc=function(a,o,c){if(typeof a!="number")throw new TypeError("Argument must be a number");var l=r(a);return o!==void 0?typeof c=="string"?l.fill(o,c):l.fill(o):l.fill(0),l},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(a)}})(EI,EI.exports);var Lve=EI.exports,cw=Lve.Buffer,Rk=cw.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Uve(n){if(!n)return"utf8";for(var e;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(e)return;n=(""+n).toLowerCase(),e=!0}}function zve(n){var e=Uve(n);if(typeof e!="string"&&(cw.isEncoding===Rk||!Rk(n)))throw new Error("Unknown encoding: "+n);return e||n}var Vve=tg.StringDecoder=Jh;function Jh(n){this.encoding=zve(n);var e;switch(this.encoding){case"utf16le":this.text=Kve,this.end=Xve,e=4;break;case"utf8":this.fillLast=Hve,e=4;break;case"base64":this.text=Yve,this.end=Zve,e=3;break;default:this.write=Jve,this.end=Qve;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=cw.allocUnsafe(e)}Jh.prototype.write=function(n){if(n.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(n),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<n.length?e?e+this.text(n,t):this.text(n,t):e||""};Jh.prototype.end=jve;Jh.prototype.text=qve;Jh.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function av(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function Wve(n,e,t){var r=e.length-1;if(r<t)return 0;var s=av(e[r]);return s>=0?(s>0&&(n.lastNeed=s-1),s):--r<t||s===-2?0:(s=av(e[r]),s>=0?(s>0&&(n.lastNeed=s-2),s):--r<t||s===-2?0:(s=av(e[r]),s>=0?(s>0&&(s===2?s=0:n.lastNeed=s-3),s):0))}function Gve(n,e,t){if((e[0]&192)!==128)return n.lastNeed=0,"";if(n.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return n.lastNeed=1,"";if(n.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return n.lastNeed=2,""}}function Hve(n){var e=this.lastTotal-this.lastNeed,t=Gve(this,n);if(t!==void 0)return t;if(this.lastNeed<=n.length)return n.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,e,0,n.length),this.lastNeed-=n.length}function qve(n,e){var t=Wve(this,n,e);if(!this.lastNeed)return n.toString("utf8",e);this.lastTotal=t;var r=n.length-(t-this.lastNeed);return n.copy(this.lastChar,0,r),n.toString("utf8",e,r)}function jve(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+"":e}function Kve(n,e){if((n.length-e)%2===0){var t=n.toString("utf16le",e);if(t){var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",e,n.length-1)}function Xve(n){var e=n&&n.length?this.write(n):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function Yve(n,e){var t=(n.length-e)%3;return t===0?n.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",e,n.length-t))}function Zve(n){var e=n&&n.length?this.write(n):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Jve(n){return n.toString(this.encoding)}function Qve(n){return n&&n.length?this.write(n):""}var TI={exports:{}},AI={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t=typeof window<"u"&&typeof window.document<"u";e.default=t,n.exports=e.default})(AI,AI.exports);var lF=AI.exports;(function(n,e){e.__esModule=!0,e.default=s;var t=r(lF);function r(a){return a&&a.__esModule?a:{default:a}}function s(a){if(!t.default)return i(Buffer.isBuffer(a)?a:a.buffer||a);var o=new window.FileReader;return new Promise(function(c,l){o.onload=function(u){c(u.target.result)},o.onerror=function(u){console.error("err:",u),l(u)},o.readAsArrayBuffer(Buffer.isBuffer(a)?a:a.buffer||a)})}function i(a){for(var o=new ArrayBuffer(a.length),c=new Uint8Array(o),l=0;l<a.length;++l)c[l]=a[l];return o}n.exports=e.default})(TI,TI.exports);var uF=TI.exports,fF={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=Zh,t=o0,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=o,n.SlowBuffer=y,n.INSPECT_MAX_BYTES=50;const s=2147483647;n.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=i(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{const W=new Uint8Array(1),T={foo:function(){return 42}};return Object.setPrototypeOf(T,Uint8Array.prototype),Object.setPrototypeOf(W,T),W.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(W){if(W>s)throw new RangeError('The value "'+W+'" is invalid for option "size"');const T=new Uint8Array(W);return Object.setPrototypeOf(T,o.prototype),T}function o(W,T,O){if(typeof W=="number"){if(typeof T=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(W)}return c(W,T,O)}o.poolSize=8192;function c(W,T,O){if(typeof W=="string")return d(W,T);if(ArrayBuffer.isView(W))return m(W);if(W==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W);if(Be(W,ArrayBuffer)||W&&Be(W.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Be(W,SharedArrayBuffer)||W&&Be(W.buffer,SharedArrayBuffer)))return I(W,T,O);if(typeof W=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ue=W.valueOf&&W.valueOf();if(ue!=null&&ue!==W)return o.from(ue,T,O);const Ae=v(W);if(Ae)return Ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof W[Symbol.toPrimitive]=="function")return o.from(W[Symbol.toPrimitive]("string"),T,O);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof W)}o.from=function(W,T,O){return c(W,T,O)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function l(W){if(typeof W!="number")throw new TypeError('"size" argument must be of type number');if(W<0)throw new RangeError('The value "'+W+'" is invalid for option "size"')}function u(W,T,O){return l(W),W<=0?a(W):T!==void 0?typeof O=="string"?a(W).fill(T,O):a(W).fill(T):a(W)}o.alloc=function(W,T,O){return u(W,T,O)};function f(W){return l(W),a(W<0?0:b(W)|0)}o.allocUnsafe=function(W){return f(W)},o.allocUnsafeSlow=function(W){return f(W)};function d(W,T){if((typeof T!="string"||T==="")&&(T="utf8"),!o.isEncoding(T))throw new TypeError("Unknown encoding: "+T);const O=S(W,T)|0;let ue=a(O);const Ae=ue.write(W,T);return Ae!==O&&(ue=ue.slice(0,Ae)),ue}function p(W){const T=W.length<0?0:b(W.length)|0,O=a(T);for(let ue=0;ue<T;ue+=1)O[ue]=W[ue]&255;return O}function m(W){if(Be(W,Uint8Array)){const T=new Uint8Array(W);return I(T.buffer,T.byteOffset,T.byteLength)}return p(W)}function I(W,T,O){if(T<0||W.byteLength<T)throw new RangeError('"offset" is outside of buffer bounds');if(W.byteLength<T+(O||0))throw new RangeError('"length" is outside of buffer bounds');let ue;return T===void 0&&O===void 0?ue=new Uint8Array(W):O===void 0?ue=new Uint8Array(W,T):ue=new Uint8Array(W,T,O),Object.setPrototypeOf(ue,o.prototype),ue}function v(W){if(o.isBuffer(W)){const T=b(W.length)|0,O=a(T);return O.length===0||W.copy(O,0,0,T),O}if(W.length!==void 0)return typeof W.length!="number"||He(W.length)?a(0):p(W);if(W.type==="Buffer"&&Array.isArray(W.data))return p(W.data)}function b(W){if(W>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return W|0}function y(W){return+W!=W&&(W=0),o.alloc(+W)}o.isBuffer=function(T){return T!=null&&T._isBuffer===!0&&T!==o.prototype},o.compare=function(T,O){if(Be(T,Uint8Array)&&(T=o.from(T,T.offset,T.byteLength)),Be(O,Uint8Array)&&(O=o.from(O,O.offset,O.byteLength)),!o.isBuffer(T)||!o.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(T===O)return 0;let ue=T.length,Ae=O.length;for(let ze=0,Xe=Math.min(ue,Ae);ze<Xe;++ze)if(T[ze]!==O[ze]){ue=T[ze],Ae=O[ze];break}return ue<Ae?-1:Ae<ue?1:0},o.isEncoding=function(T){switch(String(T).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(T,O){if(!Array.isArray(T))throw new TypeError('"list" argument must be an Array of Buffers');if(T.length===0)return o.alloc(0);let ue;if(O===void 0)for(O=0,ue=0;ue<T.length;++ue)O+=T[ue].length;const Ae=o.allocUnsafe(O);let ze=0;for(ue=0;ue<T.length;++ue){let Xe=T[ue];if(Be(Xe,Uint8Array))ze+Xe.length>Ae.length?(o.isBuffer(Xe)||(Xe=o.from(Xe)),Xe.copy(Ae,ze)):Uint8Array.prototype.set.call(Ae,Xe,ze);else if(o.isBuffer(Xe))Xe.copy(Ae,ze);else throw new TypeError('"list" argument must be an Array of Buffers');ze+=Xe.length}return Ae};function S(W,T){if(o.isBuffer(W))return W.length;if(ArrayBuffer.isView(W)||Be(W,ArrayBuffer))return W.byteLength;if(typeof W!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof W);const O=W.length,ue=arguments.length>2&&arguments[2]===!0;if(!ue&&O===0)return 0;let Ae=!1;for(;;)switch(T){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":return R(W).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O*2;case"hex":return O>>>1;case"base64":return fe(W).length;default:if(Ae)return ue?-1:R(W).length;T=(""+T).toLowerCase(),Ae=!0}}o.byteLength=S;function w(W,T,O){let ue=!1;if((T===void 0||T<0)&&(T=0),T>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0,T>>>=0,O<=T))return"";for(W||(W="utf8");;)switch(W){case"hex":return ye(this,T,O);case"utf8":case"utf-8":return le(this,T,O);case"ascii":return Se(this,T,O);case"latin1":case"binary":return me(this,T,O);case"base64":return ne(this,T,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ce(this,T,O);default:if(ue)throw new TypeError("Unknown encoding: "+W);W=(W+"").toLowerCase(),ue=!0}}o.prototype._isBuffer=!0;function C(W,T,O){const ue=W[T];W[T]=W[O],W[O]=ue}o.prototype.swap16=function(){const T=this.length;if(T%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let O=0;O<T;O+=2)C(this,O,O+1);return this},o.prototype.swap32=function(){const T=this.length;if(T%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let O=0;O<T;O+=4)C(this,O,O+3),C(this,O+1,O+2);return this},o.prototype.swap64=function(){const T=this.length;if(T%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let O=0;O<T;O+=8)C(this,O,O+7),C(this,O+1,O+6),C(this,O+2,O+5),C(this,O+3,O+4);return this},o.prototype.toString=function(){const T=this.length;return T===0?"":arguments.length===0?le(this,0,T):w.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(T){if(!o.isBuffer(T))throw new TypeError("Argument must be a Buffer");return this===T?!0:o.compare(this,T)===0},o.prototype.inspect=function(){let T="";const O=n.INSPECT_MAX_BYTES;return T=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(T+=" ... "),"<Buffer "+T+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(T,O,ue,Ae,ze){if(Be(T,Uint8Array)&&(T=o.from(T,T.offset,T.byteLength)),!o.isBuffer(T))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof T);if(O===void 0&&(O=0),ue===void 0&&(ue=T?T.length:0),Ae===void 0&&(Ae=0),ze===void 0&&(ze=this.length),O<0||ue>T.length||Ae<0||ze>this.length)throw new RangeError("out of range index");if(Ae>=ze&&O>=ue)return 0;if(Ae>=ze)return-1;if(O>=ue)return 1;if(O>>>=0,ue>>>=0,Ae>>>=0,ze>>>=0,this===T)return 0;let Xe=ze-Ae,Ct=ue-O;const hn=Math.min(Xe,Ct),en=this.slice(Ae,ze),tn=T.slice(O,ue);for(let Ht=0;Ht<hn;++Ht)if(en[Ht]!==tn[Ht]){Xe=en[Ht],Ct=tn[Ht];break}return Xe<Ct?-1:Ct<Xe?1:0};function N(W,T,O,ue,Ae){if(W.length===0)return-1;if(typeof O=="string"?(ue=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,He(O)&&(O=Ae?0:W.length-1),O<0&&(O=W.length+O),O>=W.length){if(Ae)return-1;O=W.length-1}else if(O<0)if(Ae)O=0;else return-1;if(typeof T=="string"&&(T=o.from(T,ue)),o.isBuffer(T))return T.length===0?-1:E(W,T,O,ue,Ae);if(typeof T=="number")return T=T&255,typeof Uint8Array.prototype.indexOf=="function"?Ae?Uint8Array.prototype.indexOf.call(W,T,O):Uint8Array.prototype.lastIndexOf.call(W,T,O):E(W,[T],O,ue,Ae);throw new TypeError("val must be string, number or Buffer")}function E(W,T,O,ue,Ae){let ze=1,Xe=W.length,Ct=T.length;if(ue!==void 0&&(ue=String(ue).toLowerCase(),ue==="ucs2"||ue==="ucs-2"||ue==="utf16le"||ue==="utf-16le")){if(W.length<2||T.length<2)return-1;ze=2,Xe/=2,Ct/=2,O/=2}function hn(tn,Ht){return ze===1?tn[Ht]:tn.readUInt16BE(Ht*ze)}let en;if(Ae){let tn=-1;for(en=O;en<Xe;en++)if(hn(W,en)===hn(T,tn===-1?0:en-tn)){if(tn===-1&&(tn=en),en-tn+1===Ct)return tn*ze}else tn!==-1&&(en-=en-tn),tn=-1}else for(O+Ct>Xe&&(O=Xe-Ct),en=O;en>=0;en--){let tn=!0;for(let Ht=0;Ht<Ct;Ht++)if(hn(W,en+Ht)!==hn(T,Ht)){tn=!1;break}if(tn)return en}return-1}o.prototype.includes=function(T,O,ue){return this.indexOf(T,O,ue)!==-1},o.prototype.indexOf=function(T,O,ue){return N(this,T,O,ue,!0)},o.prototype.lastIndexOf=function(T,O,ue){return N(this,T,O,ue,!1)};function A(W,T,O,ue){O=Number(O)||0;const Ae=W.length-O;ue?(ue=Number(ue),ue>Ae&&(ue=Ae)):ue=Ae;const ze=T.length;ue>ze/2&&(ue=ze/2);let Xe;for(Xe=0;Xe<ue;++Xe){const Ct=parseInt(T.substr(Xe*2,2),16);if(He(Ct))return Xe;W[O+Xe]=Ct}return Xe}function M(W,T,O,ue){return Te(R(T,W.length-O),W,O,ue)}function z(W,T,O,ue){return Te(k(T),W,O,ue)}function Y(W,T,O,ue){return Te(fe(T),W,O,ue)}function re(W,T,O,ue){return Te(X(T,W.length-O),W,O,ue)}o.prototype.write=function(T,O,ue,Ae){if(O===void 0)Ae="utf8",ue=this.length,O=0;else if(ue===void 0&&typeof O=="string")Ae=O,ue=this.length,O=0;else if(isFinite(O))O=O>>>0,isFinite(ue)?(ue=ue>>>0,Ae===void 0&&(Ae="utf8")):(Ae=ue,ue=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ze=this.length-O;if((ue===void 0||ue>ze)&&(ue=ze),T.length>0&&(ue<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ae||(Ae="utf8");let Xe=!1;for(;;)switch(Ae){case"hex":return A(this,T,O,ue);case"utf8":case"utf-8":return M(this,T,O,ue);case"ascii":case"latin1":case"binary":return z(this,T,O,ue);case"base64":return Y(this,T,O,ue);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,T,O,ue);default:if(Xe)throw new TypeError("Unknown encoding: "+Ae);Ae=(""+Ae).toLowerCase(),Xe=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(W,T,O){return T===0&&O===W.length?e.fromByteArray(W):e.fromByteArray(W.slice(T,O))}function le(W,T,O){O=Math.min(W.length,O);const ue=[];let Ae=T;for(;Ae<O;){const ze=W[Ae];let Xe=null,Ct=ze>239?4:ze>223?3:ze>191?2:1;if(Ae+Ct<=O){let hn,en,tn,Ht;switch(Ct){case 1:ze<128&&(Xe=ze);break;case 2:hn=W[Ae+1],(hn&192)===128&&(Ht=(ze&31)<<6|hn&63,Ht>127&&(Xe=Ht));break;case 3:hn=W[Ae+1],en=W[Ae+2],(hn&192)===128&&(en&192)===128&&(Ht=(ze&15)<<12|(hn&63)<<6|en&63,Ht>2047&&(Ht<55296||Ht>57343)&&(Xe=Ht));break;case 4:hn=W[Ae+1],en=W[Ae+2],tn=W[Ae+3],(hn&192)===128&&(en&192)===128&&(tn&192)===128&&(Ht=(ze&15)<<18|(hn&63)<<12|(en&63)<<6|tn&63,Ht>65535&&Ht<1114112&&(Xe=Ht))}}Xe===null?(Xe=65533,Ct=1):Xe>65535&&(Xe-=65536,ue.push(Xe>>>10&1023|55296),Xe=56320|Xe&1023),ue.push(Xe),Ae+=Ct}return ge(ue)}const j=4096;function ge(W){const T=W.length;if(T<=j)return String.fromCharCode.apply(String,W);let O="",ue=0;for(;ue<T;)O+=String.fromCharCode.apply(String,W.slice(ue,ue+=j));return O}function Se(W,T,O){let ue="";O=Math.min(W.length,O);for(let Ae=T;Ae<O;++Ae)ue+=String.fromCharCode(W[Ae]&127);return ue}function me(W,T,O){let ue="";O=Math.min(W.length,O);for(let Ae=T;Ae<O;++Ae)ue+=String.fromCharCode(W[Ae]);return ue}function ye(W,T,O){const ue=W.length;(!T||T<0)&&(T=0),(!O||O<0||O>ue)&&(O=ue);let Ae="";for(let ze=T;ze<O;++ze)Ae+=rt[W[ze]];return Ae}function Ce(W,T,O){const ue=W.slice(T,O);let Ae="";for(let ze=0;ze<ue.length-1;ze+=2)Ae+=String.fromCharCode(ue[ze]+ue[ze+1]*256);return Ae}o.prototype.slice=function(T,O){const ue=this.length;T=~~T,O=O===void 0?ue:~~O,T<0?(T+=ue,T<0&&(T=0)):T>ue&&(T=ue),O<0?(O+=ue,O<0&&(O=0)):O>ue&&(O=ue),O<T&&(O=T);const Ae=this.subarray(T,O);return Object.setPrototypeOf(Ae,o.prototype),Ae};function he(W,T,O){if(W%1!==0||W<0)throw new RangeError("offset is not uint");if(W+T>O)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(T,O,ue){T=T>>>0,O=O>>>0,ue||he(T,O,this.length);let Ae=this[T],ze=1,Xe=0;for(;++Xe<O&&(ze*=256);)Ae+=this[T+Xe]*ze;return Ae},o.prototype.readUintBE=o.prototype.readUIntBE=function(T,O,ue){T=T>>>0,O=O>>>0,ue||he(T,O,this.length);let Ae=this[T+--O],ze=1;for(;O>0&&(ze*=256);)Ae+=this[T+--O]*ze;return Ae},o.prototype.readUint8=o.prototype.readUInt8=function(T,O){return T=T>>>0,O||he(T,1,this.length),this[T]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(T,O){return T=T>>>0,O||he(T,2,this.length),this[T]|this[T+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(T,O){return T=T>>>0,O||he(T,2,this.length),this[T]<<8|this[T+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(T,O){return T=T>>>0,O||he(T,4,this.length),(this[T]|this[T+1]<<8|this[T+2]<<16)+this[T+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(T,O){return T=T>>>0,O||he(T,4,this.length),this[T]*16777216+(this[T+1]<<16|this[T+2]<<8|this[T+3])},o.prototype.readBigUInt64LE=ct(function(T){T=T>>>0,Z(T,"offset");const O=this[T],ue=this[T+7];(O===void 0||ue===void 0)&&se(T,this.length-8);const Ae=O+this[++T]*2**8+this[++T]*2**16+this[++T]*2**24,ze=this[++T]+this[++T]*2**8+this[++T]*2**16+ue*2**24;return BigInt(Ae)+(BigInt(ze)<<BigInt(32))}),o.prototype.readBigUInt64BE=ct(function(T){T=T>>>0,Z(T,"offset");const O=this[T],ue=this[T+7];(O===void 0||ue===void 0)&&se(T,this.length-8);const Ae=O*2**24+this[++T]*2**16+this[++T]*2**8+this[++T],ze=this[++T]*2**24+this[++T]*2**16+this[++T]*2**8+ue;return(BigInt(Ae)<<BigInt(32))+BigInt(ze)}),o.prototype.readIntLE=function(T,O,ue){T=T>>>0,O=O>>>0,ue||he(T,O,this.length);let Ae=this[T],ze=1,Xe=0;for(;++Xe<O&&(ze*=256);)Ae+=this[T+Xe]*ze;return ze*=128,Ae>=ze&&(Ae-=Math.pow(2,8*O)),Ae},o.prototype.readIntBE=function(T,O,ue){T=T>>>0,O=O>>>0,ue||he(T,O,this.length);let Ae=O,ze=1,Xe=this[T+--Ae];for(;Ae>0&&(ze*=256);)Xe+=this[T+--Ae]*ze;return ze*=128,Xe>=ze&&(Xe-=Math.pow(2,8*O)),Xe},o.prototype.readInt8=function(T,O){return T=T>>>0,O||he(T,1,this.length),this[T]&128?(255-this[T]+1)*-1:this[T]},o.prototype.readInt16LE=function(T,O){T=T>>>0,O||he(T,2,this.length);const ue=this[T]|this[T+1]<<8;return ue&32768?ue|4294901760:ue},o.prototype.readInt16BE=function(T,O){T=T>>>0,O||he(T,2,this.length);const ue=this[T+1]|this[T]<<8;return ue&32768?ue|4294901760:ue},o.prototype.readInt32LE=function(T,O){return T=T>>>0,O||he(T,4,this.length),this[T]|this[T+1]<<8|this[T+2]<<16|this[T+3]<<24},o.prototype.readInt32BE=function(T,O){return T=T>>>0,O||he(T,4,this.length),this[T]<<24|this[T+1]<<16|this[T+2]<<8|this[T+3]},o.prototype.readBigInt64LE=ct(function(T){T=T>>>0,Z(T,"offset");const O=this[T],ue=this[T+7];(O===void 0||ue===void 0)&&se(T,this.length-8);const Ae=this[T+4]+this[T+5]*2**8+this[T+6]*2**16+(ue<<24);return(BigInt(Ae)<<BigInt(32))+BigInt(O+this[++T]*2**8+this[++T]*2**16+this[++T]*2**24)}),o.prototype.readBigInt64BE=ct(function(T){T=T>>>0,Z(T,"offset");const O=this[T],ue=this[T+7];(O===void 0||ue===void 0)&&se(T,this.length-8);const Ae=(O<<24)+this[++T]*2**16+this[++T]*2**8+this[++T];return(BigInt(Ae)<<BigInt(32))+BigInt(this[++T]*2**24+this[++T]*2**16+this[++T]*2**8+ue)}),o.prototype.readFloatLE=function(T,O){return T=T>>>0,O||he(T,4,this.length),t.read(this,T,!0,23,4)},o.prototype.readFloatBE=function(T,O){return T=T>>>0,O||he(T,4,this.length),t.read(this,T,!1,23,4)},o.prototype.readDoubleLE=function(T,O){return T=T>>>0,O||he(T,8,this.length),t.read(this,T,!0,52,8)},o.prototype.readDoubleBE=function(T,O){return T=T>>>0,O||he(T,8,this.length),t.read(this,T,!1,52,8)};function Ne(W,T,O,ue,Ae,ze){if(!o.isBuffer(W))throw new TypeError('"buffer" argument must be a Buffer instance');if(T>Ae||T<ze)throw new RangeError('"value" argument is out of bounds');if(O+ue>W.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(T,O,ue,Ae){if(T=+T,O=O>>>0,ue=ue>>>0,!Ae){const Ct=Math.pow(2,8*ue)-1;Ne(this,T,O,ue,Ct,0)}let ze=1,Xe=0;for(this[O]=T&255;++Xe<ue&&(ze*=256);)this[O+Xe]=T/ze&255;return O+ue},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(T,O,ue,Ae){if(T=+T,O=O>>>0,ue=ue>>>0,!Ae){const Ct=Math.pow(2,8*ue)-1;Ne(this,T,O,ue,Ct,0)}let ze=ue-1,Xe=1;for(this[O+ze]=T&255;--ze>=0&&(Xe*=256);)this[O+ze]=T/Xe&255;return O+ue},o.prototype.writeUint8=o.prototype.writeUInt8=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,1,255,0),this[O]=T&255,O+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,2,65535,0),this[O]=T&255,this[O+1]=T>>>8,O+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,2,65535,0),this[O]=T>>>8,this[O+1]=T&255,O+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,4,4294967295,0),this[O+3]=T>>>24,this[O+2]=T>>>16,this[O+1]=T>>>8,this[O]=T&255,O+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,4,4294967295,0),this[O]=T>>>24,this[O+1]=T>>>16,this[O+2]=T>>>8,this[O+3]=T&255,O+4};function xe(W,T,O,ue,Ae){q(T,ue,Ae,W,O,7);let ze=Number(T&BigInt(4294967295));W[O++]=ze,ze=ze>>8,W[O++]=ze,ze=ze>>8,W[O++]=ze,ze=ze>>8,W[O++]=ze;let Xe=Number(T>>BigInt(32)&BigInt(4294967295));return W[O++]=Xe,Xe=Xe>>8,W[O++]=Xe,Xe=Xe>>8,W[O++]=Xe,Xe=Xe>>8,W[O++]=Xe,O}function ae(W,T,O,ue,Ae){q(T,ue,Ae,W,O,7);let ze=Number(T&BigInt(4294967295));W[O+7]=ze,ze=ze>>8,W[O+6]=ze,ze=ze>>8,W[O+5]=ze,ze=ze>>8,W[O+4]=ze;let Xe=Number(T>>BigInt(32)&BigInt(4294967295));return W[O+3]=Xe,Xe=Xe>>8,W[O+2]=Xe,Xe=Xe>>8,W[O+1]=Xe,Xe=Xe>>8,W[O]=Xe,O+8}o.prototype.writeBigUInt64LE=ct(function(T,O=0){return xe(this,T,O,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=ct(function(T,O=0){return ae(this,T,O,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(T,O,ue,Ae){if(T=+T,O=O>>>0,!Ae){const hn=Math.pow(2,8*ue-1);Ne(this,T,O,ue,hn-1,-hn)}let ze=0,Xe=1,Ct=0;for(this[O]=T&255;++ze<ue&&(Xe*=256);)T<0&&Ct===0&&this[O+ze-1]!==0&&(Ct=1),this[O+ze]=(T/Xe>>0)-Ct&255;return O+ue},o.prototype.writeIntBE=function(T,O,ue,Ae){if(T=+T,O=O>>>0,!Ae){const hn=Math.pow(2,8*ue-1);Ne(this,T,O,ue,hn-1,-hn)}let ze=ue-1,Xe=1,Ct=0;for(this[O+ze]=T&255;--ze>=0&&(Xe*=256);)T<0&&Ct===0&&this[O+ze+1]!==0&&(Ct=1),this[O+ze]=(T/Xe>>0)-Ct&255;return O+ue},o.prototype.writeInt8=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,1,127,-128),T<0&&(T=255+T+1),this[O]=T&255,O+1},o.prototype.writeInt16LE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,2,32767,-32768),this[O]=T&255,this[O+1]=T>>>8,O+2},o.prototype.writeInt16BE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,2,32767,-32768),this[O]=T>>>8,this[O+1]=T&255,O+2},o.prototype.writeInt32LE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,4,2147483647,-2147483648),this[O]=T&255,this[O+1]=T>>>8,this[O+2]=T>>>16,this[O+3]=T>>>24,O+4},o.prototype.writeInt32BE=function(T,O,ue){return T=+T,O=O>>>0,ue||Ne(this,T,O,4,2147483647,-2147483648),T<0&&(T=4294967295+T+1),this[O]=T>>>24,this[O+1]=T>>>16,this[O+2]=T>>>8,this[O+3]=T&255,O+4},o.prototype.writeBigInt64LE=ct(function(T,O=0){return xe(this,T,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=ct(function(T,O=0){return ae(this,T,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function J(W,T,O,ue,Ae,ze){if(O+ue>W.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function D(W,T,O,ue,Ae){return T=+T,O=O>>>0,Ae||J(W,T,O,4),t.write(W,T,O,ue,23,4),O+4}o.prototype.writeFloatLE=function(T,O,ue){return D(this,T,O,!0,ue)},o.prototype.writeFloatBE=function(T,O,ue){return D(this,T,O,!1,ue)};function P(W,T,O,ue,Ae){return T=+T,O=O>>>0,Ae||J(W,T,O,8),t.write(W,T,O,ue,52,8),O+8}o.prototype.writeDoubleLE=function(T,O,ue){return P(this,T,O,!0,ue)},o.prototype.writeDoubleBE=function(T,O,ue){return P(this,T,O,!1,ue)},o.prototype.copy=function(T,O,ue,Ae){if(!o.isBuffer(T))throw new TypeError("argument should be a Buffer");if(ue||(ue=0),!Ae&&Ae!==0&&(Ae=this.length),O>=T.length&&(O=T.length),O||(O=0),Ae>0&&Ae<ue&&(Ae=ue),Ae===ue||T.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(ue<0||ue>=this.length)throw new RangeError("Index out of range");if(Ae<0)throw new RangeError("sourceEnd out of bounds");Ae>this.length&&(Ae=this.length),T.length-O<Ae-ue&&(Ae=T.length-O+ue);const ze=Ae-ue;return this===T&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(O,ue,Ae):Uint8Array.prototype.set.call(T,this.subarray(ue,Ae),O),ze},o.prototype.fill=function(T,O,ue,Ae){if(typeof T=="string"){if(typeof O=="string"?(Ae=O,O=0,ue=this.length):typeof ue=="string"&&(Ae=ue,ue=this.length),Ae!==void 0&&typeof Ae!="string")throw new TypeError("encoding must be a string");if(typeof Ae=="string"&&!o.isEncoding(Ae))throw new TypeError("Unknown encoding: "+Ae);if(T.length===1){const Xe=T.charCodeAt(0);(Ae==="utf8"&&Xe<128||Ae==="latin1")&&(T=Xe)}}else typeof T=="number"?T=T&255:typeof T=="boolean"&&(T=Number(T));if(O<0||this.length<O||this.length<ue)throw new RangeError("Out of range index");if(ue<=O)return this;O=O>>>0,ue=ue===void 0?this.length:ue>>>0,T||(T=0);let ze;if(typeof T=="number")for(ze=O;ze<ue;++ze)this[ze]=T;else{const Xe=o.isBuffer(T)?T:o.from(T,Ae),Ct=Xe.length;if(Ct===0)throw new TypeError('The value "'+T+'" is invalid for argument "value"');for(ze=0;ze<ue-O;++ze)this[ze+O]=Xe[ze%Ct]}return this};const Q={};function pe(W,T,O){Q[W]=class extends O{constructor(){super(),Object.defineProperty(this,"message",{value:T.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${W}]`,this.stack,delete this.name}get code(){return W}set code(Ae){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ae,writable:!0})}toString(){return`${this.name} [${W}]: ${this.message}`}}}pe("ERR_BUFFER_OUT_OF_BOUNDS",function(W){return W?`${W} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),pe("ERR_INVALID_ARG_TYPE",function(W,T){return`The "${W}" argument must be of type number. Received type ${typeof T}`},TypeError),pe("ERR_OUT_OF_RANGE",function(W,T,O){let ue=`The value of "${W}" is out of range.`,Ae=O;return Number.isInteger(O)&&Math.abs(O)>2**32?Ae=Ee(String(O)):typeof O=="bigint"&&(Ae=String(O),(O>BigInt(2)**BigInt(32)||O<-(BigInt(2)**BigInt(32)))&&(Ae=Ee(Ae)),Ae+="n"),ue+=` It must be ${T}. Received ${Ae}`,ue},RangeError);function Ee(W){let T="",O=W.length;const ue=W[0]==="-"?1:0;for(;O>=ue+4;O-=3)T=`_${W.slice(O-3,O)}${T}`;return`${W.slice(0,O)}${T}`}function L(W,T,O){Z(T,"offset"),(W[T]===void 0||W[T+O]===void 0)&&se(T,W.length-(O+1))}function q(W,T,O,ue,Ae,ze){if(W>O||W<T){const Xe=typeof T=="bigint"?"n":"";let Ct;throw ze>3?T===0||T===BigInt(0)?Ct=`>= 0${Xe} and < 2${Xe} ** ${(ze+1)*8}${Xe}`:Ct=`>= -(2${Xe} ** ${(ze+1)*8-1}${Xe}) and < 2 ** ${(ze+1)*8-1}${Xe}`:Ct=`>= ${T}${Xe} and <= ${O}${Xe}`,new Q.ERR_OUT_OF_RANGE("value",Ct,W)}L(ue,Ae,ze)}function Z(W,T){if(typeof W!="number")throw new Q.ERR_INVALID_ARG_TYPE(T,"number",W)}function se(W,T,O){throw Math.floor(W)!==W?(Z(W,O),new Q.ERR_OUT_OF_RANGE(O||"offset","an integer",W)):T<0?new Q.ERR_BUFFER_OUT_OF_BOUNDS:new Q.ERR_OUT_OF_RANGE(O||"offset",`>= ${O?1:0} and <= ${T}`,W)}const ie=/[^+/0-9A-Za-z-_]/g;function B(W){if(W=W.split("=")[0],W=W.trim().replace(ie,""),W.length<2)return"";for(;W.length%4!==0;)W=W+"=";return W}function R(W,T){T=T||1/0;let O;const ue=W.length;let Ae=null;const ze=[];for(let Xe=0;Xe<ue;++Xe){if(O=W.charCodeAt(Xe),O>55295&&O<57344){if(!Ae){if(O>56319){(T-=3)>-1&&ze.push(239,191,189);continue}else if(Xe+1===ue){(T-=3)>-1&&ze.push(239,191,189);continue}Ae=O;continue}if(O<56320){(T-=3)>-1&&ze.push(239,191,189),Ae=O;continue}O=(Ae-55296<<10|O-56320)+65536}else Ae&&(T-=3)>-1&&ze.push(239,191,189);if(Ae=null,O<128){if((T-=1)<0)break;ze.push(O)}else if(O<2048){if((T-=2)<0)break;ze.push(O>>6|192,O&63|128)}else if(O<65536){if((T-=3)<0)break;ze.push(O>>12|224,O>>6&63|128,O&63|128)}else if(O<1114112){if((T-=4)<0)break;ze.push(O>>18|240,O>>12&63|128,O>>6&63|128,O&63|128)}else throw new Error("Invalid code point")}return ze}function k(W){const T=[];for(let O=0;O<W.length;++O)T.push(W.charCodeAt(O)&255);return T}function X(W,T){let O,ue,Ae;const ze=[];for(let Xe=0;Xe<W.length&&!((T-=2)<0);++Xe)O=W.charCodeAt(Xe),ue=O>>8,Ae=O%256,ze.push(Ae),ze.push(ue);return ze}function fe(W){return e.toByteArray(B(W))}function Te(W,T,O,ue){let Ae;for(Ae=0;Ae<ue&&!(Ae+O>=T.length||Ae>=W.length);++Ae)T[Ae+O]=W[Ae];return Ae}function Be(W,T){return W instanceof T||W!=null&&W.constructor!=null&&W.constructor.name!=null&&W.constructor.name===T.name}function He(W){return W!==W}const rt=function(){const W="0123456789abcdef",T=new Array(256);for(let O=0;O<16;++O){const ue=O*16;for(let Ae=0;Ae<16;++Ae)T[ue+Ae]=W[O]+W[Ae]}return T}();function ct(W){return typeof BigInt>"u"?lt:W}function lt(){throw new Error("BigInt not supported")}})(fF);(function(n,e){e.__esModule=!0,e.default=void 0;var t=f($ve),r=tg,s=f(uF),i=f(Gm),a=f(pu),o=f(Q3),c=zt,l=a0,u=f(oF);function f(A){return A&&A.__esModule?A:{default:A}}function d(){return d=Object.assign?Object.assign.bind():function(A){for(var M=1;M<arguments.length;M++){var z=arguments[M];for(var Y in z)Object.prototype.hasOwnProperty.call(z,Y)&&(A[Y]=z[Y])}return A},d.apply(this,arguments)}function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */p=function(){return A};var A={},M=Object.prototype,z=M.hasOwnProperty,Y=typeof Symbol=="function"?Symbol:{},re=Y.iterator||"@@iterator",ne=Y.asyncIterator||"@@asyncIterator",le=Y.toStringTag||"@@toStringTag";function j(se,ie,B){return Object.defineProperty(se,ie,{value:B,enumerable:!0,configurable:!0,writable:!0}),se[ie]}try{j({},"")}catch{j=function(B,R,k){return B[R]=k}}function ge(se,ie,B,R){var k=ie&&ie.prototype instanceof ye?ie:ye,X=Object.create(k.prototype),fe=new L(R||[]);return X._invoke=function(Te,Be,He){var rt="suspendedStart";return function(ct,lt){if(rt==="executing")throw new Error("Generator is already running");if(rt==="completed"){if(ct==="throw")throw lt;return Z()}for(He.method=ct,He.arg=lt;;){var W=He.delegate;if(W){var T=Q(W,He);if(T){if(T===me)continue;return T}}if(He.method==="next")He.sent=He._sent=He.arg;else if(He.method==="throw"){if(rt==="suspendedStart")throw rt="completed",He.arg;He.dispatchException(He.arg)}else He.method==="return"&&He.abrupt("return",He.arg);rt="executing";var O=Se(Te,Be,He);if(O.type==="normal"){if(rt=He.done?"completed":"suspendedYield",O.arg===me)continue;return{value:O.arg,done:He.done}}O.type==="throw"&&(rt="completed",He.method="throw",He.arg=O.arg)}}}(se,B,fe),X}function Se(se,ie,B){try{return{type:"normal",arg:se.call(ie,B)}}catch(R){return{type:"throw",arg:R}}}A.wrap=ge;var me={};function ye(){}function Ce(){}function he(){}var Ne={};j(Ne,re,function(){return this});var xe=Object.getPrototypeOf,ae=xe&&xe(xe(q([])));ae&&ae!==M&&z.call(ae,re)&&(Ne=ae);var J=he.prototype=ye.prototype=Object.create(Ne);function D(se){["next","throw","return"].forEach(function(ie){j(se,ie,function(B){return this._invoke(ie,B)})})}function P(se,ie){function B(k,X,fe,Te){var Be=Se(se[k],se,X);if(Be.type!=="throw"){var He=Be.arg,rt=He.value;return rt&&typeof rt=="object"&&z.call(rt,"__await")?ie.resolve(rt.__await).then(function(ct){B("next",ct,fe,Te)},function(ct){B("throw",ct,fe,Te)}):ie.resolve(rt).then(function(ct){He.value=ct,fe(He)},function(ct){return B("throw",ct,fe,Te)})}Te(Be.arg)}var R;this._invoke=function(k,X){function fe(){return new ie(function(Te,Be){B(k,X,Te,Be)})}return R=R?R.then(fe,fe):fe()}}function Q(se,ie){var B=se.iterator[ie.method];if(B===void 0){if(ie.delegate=null,ie.method==="throw"){if(se.iterator.return&&(ie.method="return",ie.arg=void 0,Q(se,ie),ie.method==="throw"))return me;ie.method="throw",ie.arg=new TypeError("The iterator does not provide a 'throw' method")}return me}var R=Se(B,se.iterator,ie.arg);if(R.type==="throw")return ie.method="throw",ie.arg=R.arg,ie.delegate=null,me;var k=R.arg;return k?k.done?(ie[se.resultName]=k.value,ie.next=se.nextLoc,ie.method!=="return"&&(ie.method="next",ie.arg=void 0),ie.delegate=null,me):k:(ie.method="throw",ie.arg=new TypeError("iterator result is not an object"),ie.delegate=null,me)}function pe(se){var ie={tryLoc:se[0]};1 in se&&(ie.catchLoc=se[1]),2 in se&&(ie.finallyLoc=se[2],ie.afterLoc=se[3]),this.tryEntries.push(ie)}function Ee(se){var ie=se.completion||{};ie.type="normal",delete ie.arg,se.completion=ie}function L(se){this.tryEntries=[{tryLoc:"root"}],se.forEach(pe,this),this.reset(!0)}function q(se){if(se){var ie=se[re];if(ie)return ie.call(se);if(typeof se.next=="function")return se;if(!isNaN(se.length)){var B=-1,R=function k(){for(;++B<se.length;)if(z.call(se,B))return k.value=se[B],k.done=!1,k;return k.value=void 0,k.done=!0,k};return R.next=R}}return{next:Z}}function Z(){return{value:void 0,done:!0}}return Ce.prototype=he,j(J,"constructor",he),j(he,"constructor",Ce),Ce.displayName=j(he,le,"GeneratorFunction"),A.isGeneratorFunction=function(se){var ie=typeof se=="function"&&se.constructor;return!!ie&&(ie===Ce||(ie.displayName||ie.name)==="GeneratorFunction")},A.mark=function(se){return Object.setPrototypeOf?Object.setPrototypeOf(se,he):(se.__proto__=he,j(se,le,"GeneratorFunction")),se.prototype=Object.create(J),se},A.awrap=function(se){return{__await:se}},D(P.prototype),j(P.prototype,ne,function(){return this}),A.AsyncIterator=P,A.async=function(se,ie,B,R,k){k===void 0&&(k=Promise);var X=new P(ge(se,ie,B,R),k);return A.isGeneratorFunction(ie)?X:X.next().then(function(fe){return fe.done?fe.value:X.next()})},D(J),j(J,le,"Generator"),j(J,re,function(){return this}),j(J,"toString",function(){return"[object Generator]"}),A.keys=function(se){var ie=[];for(var B in se)ie.push(B);return ie.reverse(),function R(){for(;ie.length;){var k=ie.pop();if(k in se)return R.value=k,R.done=!1,R}return R.done=!0,R}},A.values=q,L.prototype={constructor:L,reset:function(ie){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ee),!ie)for(var B in this)B.charAt(0)==="t"&&z.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=void 0)},stop:function(){this.done=!0;var ie=this.tryEntries[0].completion;if(ie.type==="throw")throw ie.arg;return this.rval},dispatchException:function(ie){if(this.done)throw ie;var B=this;function R(He,rt){return fe.type="throw",fe.arg=ie,B.next=He,rt&&(B.method="next",B.arg=void 0),!!rt}for(var k=this.tryEntries.length-1;k>=0;--k){var X=this.tryEntries[k],fe=X.completion;if(X.tryLoc==="root")return R("end");if(X.tryLoc<=this.prev){var Te=z.call(X,"catchLoc"),Be=z.call(X,"finallyLoc");if(Te&&Be){if(this.prev<X.catchLoc)return R(X.catchLoc,!0);if(this.prev<X.finallyLoc)return R(X.finallyLoc)}else if(Te){if(this.prev<X.catchLoc)return R(X.catchLoc,!0)}else{if(!Be)throw new Error("try statement without catch or finally");if(this.prev<X.finallyLoc)return R(X.finallyLoc)}}}},abrupt:function(ie,B){for(var R=this.tryEntries.length-1;R>=0;--R){var k=this.tryEntries[R];if(k.tryLoc<=this.prev&&z.call(k,"finallyLoc")&&this.prev<k.finallyLoc){var X=k;break}}X&&(ie==="break"||ie==="continue")&&X.tryLoc<=B&&B<=X.finallyLoc&&(X=null);var fe=X?X.completion:{};return fe.type=ie,fe.arg=B,X?(this.method="next",this.next=X.finallyLoc,me):this.complete(fe)},complete:function(ie,B){if(ie.type==="throw")throw ie.arg;return ie.type==="break"||ie.type==="continue"?this.next=ie.arg:ie.type==="return"?(this.rval=this.arg=ie.arg,this.method="return",this.next="end"):ie.type==="normal"&&B&&(this.next=B),me},finish:function(ie){for(var B=this.tryEntries.length-1;B>=0;--B){var R=this.tryEntries[B];if(R.finallyLoc===ie)return this.complete(R.completion,R.afterLoc),Ee(R),me}},catch:function(ie){for(var B=this.tryEntries.length-1;B>=0;--B){var R=this.tryEntries[B];if(R.tryLoc===ie){var k=R.completion;if(k.type==="throw"){var X=k.arg;Ee(R)}return X}}throw new Error("illegal catch attempt")},delegateYield:function(ie,B,R){return this.delegate={iterator:q(ie),resultName:B,nextLoc:R},this.method==="next"&&(this.arg=void 0),me}},A}function m(A,M,z,Y,re,ne,le){try{var j=A[ne](le),ge=j.value}catch(Se){z(Se);return}j.done?M(ge):Promise.resolve(ge).then(Y,re)}function I(A){return function(){var M=this,z=arguments;return new Promise(function(Y,re){var ne=A.apply(M,z);function le(ge){m(ne,Y,re,le,j,"next",ge)}function j(ge){m(ne,Y,re,le,j,"throw",ge)}le(void 0)})}}var v=fF.Buffer;function b(A,M){return y.apply(this,arguments)}function y(){return y=I(p().mark(function A(M,z){var Y;return p().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return z===void 0&&(z={}),ne.prev=1,ne.delegateYield(p().mark(function le(){var j=function(ie,B){var R=v.from(me.slice(he,ie+he));if(he+=ie,B){var k=new r.StringDecoder(B),X=k.write(R);return X}else return R},ge=function(){var se=I(p().mark(function ie(B,R){var k,X;return p().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return Te.next=2,j(B);case 2:return k=Te.sent,Te.next=5,t.default.unpack(">"+R,k);case 5:if(X=Te.sent,X!==void 0){Te.next=8;break}return Te.abrupt("return",void 0);case 8:return Te.next=10,X[0];case 10:return Te.abrupt("return",Te.sent);case 11:case"end":return Te.stop()}},ie)}));return function(B,R){return se.apply(this,arguments)}}(),Se,me,ye,Ce,he,Ne,xe,ae,J,D,P,Q,pe,Ee,L,q,Z;return p().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return Se=(0,i.default)(z),ie.next=3,(0,s.default)(M);case 3:return me=ie.sent,ye=(0,u.default)(z.fileName),Ce=z.isProtein,ye&&/^(prot)$/.test(ye)&&(Ce=!0,z.isProtein=!0),he=0,ie.next=10,j(1);case 10:return ie.next=12,ge(4,"I");case 12:return Ne=ie.sent,ie.next=15,j(8,"ascii");case 15:if(xe=ie.sent,!(Ne!==14||xe!=="SnapGene")){ie.next=18;break}throw new Error("Wrong format for a SnapGene file !");case 18:return ie.t0=d,ie.t1={},ie.t2=Se.parsedSequence,ie.t3=Ce,ie.next=24,ge(2,"H");case 24:if(ie.t4=!!ie.sent,!ie.t4){ie.next=27;break}ie.t4=!Ce;case 27:return ie.t5=ie.t4,ie.next=30,ge(2,"H");case 30:return ie.t6=ie.sent,ie.next=33,ge(2,"H");case 33:return ie.t7=ie.sent,ie.t8=[],ie.t9={isProtein:ie.t3,isDNA:ie.t5,exportVersion:ie.t6,importVersion:ie.t7,features:ie.t8},ie.next=38,(0,ie.t0)(ie.t1,ie.t2,ie.t9);case 38:ae=ie.sent;case 39:if(!(he<=me.byteLength)){ie.next=80;break}return ie.next=42,j(1);case 42:return J=ie.sent,ie.next=45,ge(4,"I");case 45:if(D=ie.sent,!(w(J)===21||w(J)===0)){ie.next=61;break}return ie.next=49,ge(1,"b");case 49:if(P=ie.sent,Q=N(P),ae.circular=E(Q),pe=D-1,!(pe<0)){ie.next=55;break}return ie.abrupt("return",{v:void 0});case 55:return ae.size=Ce?pe*3:pe,ie.next=58,j(pe,"utf8");case 58:ae.sequence=ie.sent,ie.next=78;break;case 61:if(w(J)!==10){ie.next=65;break}return ie.delegateYield(p().mark(function B(){var R,k,X,fe,Te,Be;return p().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return R={0:".",1:"+",2:"-",3:"="},rt.next=3,j(D,"utf8");case 3:k=rt.sent,X=new l.XMLParser({ignoreAttributes:!1,attributeNamePrefix:"",isArray:function(lt){return lt==="Feature"||lt==="Segment"}}).parse(k),fe=X.Features,fe=fe===void 0?{}:fe,Te=fe.Feature,Be=Te===void 0?[]:Te,ae.features=[],Be.forEach(function(ct){var lt=ct.directionality,W=ct.Segment,T=W===void 0?[]:W,O=ct.name,ue=ct.type,Ae=0,ze=0,Xe=T&&T.map(function(Ct){if(!Ct)throw new Error("invalid feature definition");var hn=Ct.range;Ct.color;var en=S(hn),tn=en.start,Ht=en.end;return tn=Ce?tn*3:tn,Ht=Ce?Ht*3+2:Ht,Ae=Math.max(Ae,tn),ze=Math.max(ze,Ht),{start:tn,end:Ht}});ae.features.push(d({name:O,type:ue},(Xe==null?void 0:Xe.length)>1&&{locations:Xe},{strand:R[lt],start:Ae,end:ze}))});case 10:case"end":return rt.stop()}},B)})(),"t10",63);case 63:ie.next=78;break;case 65:if(w(J)!==6){ie.next=76;break}return ie.next=68,j(D,"utf8");case 68:Ee=ie.sent,L=new l.XMLParser({}).parse(Ee),q=(0,c.get)(L,"Notes.CustomMapLabel"),q&&(ae.name=q),Z=(0,c.get)(L,"Notes.Description"),Z&&typeof Z=="string"&&(ae.description=Z.replace("<html><body>","").replace("</body></html>","")),ie.next=78;break;case 76:return ie.next=78,j(D);case 78:ie.next=39;break;case 80:return Se.parsedSequence=ae,ie.abrupt("return",{v:(0,a.default)((0,o.default)([Se],z),z)});case 82:case"end":return ie.stop()}},le)})(),"t0",3);case 3:if(Y=ne.t0,typeof Y!="object"){ne.next=6;break}return ne.abrupt("return",Y.v);case 6:ne.next=12;break;case 8:return ne.prev=8,ne.t1=ne.catch(1),console.error("Error trying to parse file as snapgene:",ne.t1),ne.abrupt("return",[{success:!1,messages:["Import Error: Invalid File"]}]);case 12:case"end":return ne.stop()}},A,null,[[1,8]])})),y.apply(this,arguments)}function S(A){var M=A.split("-"),z=M[0],Y=M[1];return{start:z-1,end:Y-1}}function w(A){var M=A+"",z=M.charCodeAt(0);if(z>=55296&&z<=56319){var Y=z;if(M.length===1)return z;var re=M.charCodeAt(1);return(Y-55296)*1024+(re-56320)+65536}return z>=56320&&z<=57343,z}var C=b;e.default=C;function N(A){return(A>>>0).toString(2)}function E(A){return Number(A.toString().split("").pop())===1}n.exports=e.default})(kI,kI.exports);var hF=kI.exports,lw={};(function(n){n.__esModule=!0,n.convertBasePosTraceToPerBpTrace=m,n.default=void 0;var e=r(Gm),t=r(uF);function r(I){return I&&I.__esModule?I:{default:I}}function s(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */s=function(){return I};var I={},v=Object.prototype,b=v.hasOwnProperty,y=typeof Symbol=="function"?Symbol:{},S=y.iterator||"@@iterator",w=y.asyncIterator||"@@asyncIterator",C=y.toStringTag||"@@toStringTag";function N(J,D,P){return Object.defineProperty(J,D,{value:P,enumerable:!0,configurable:!0,writable:!0}),J[D]}try{N({},"")}catch{N=function(P,Q,pe){return P[Q]=pe}}function E(J,D,P,Q){var pe=D&&D.prototype instanceof z?D:z,Ee=Object.create(pe.prototype),L=new Ne(Q||[]);return Ee._invoke=function(q,Z,se){var ie="suspendedStart";return function(B,R){if(ie==="executing")throw new Error("Generator is already running");if(ie==="completed"){if(B==="throw")throw R;return ae()}for(se.method=B,se.arg=R;;){var k=se.delegate;if(k){var X=ye(k,se);if(X){if(X===M)continue;return X}}if(se.method==="next")se.sent=se._sent=se.arg;else if(se.method==="throw"){if(ie==="suspendedStart")throw ie="completed",se.arg;se.dispatchException(se.arg)}else se.method==="return"&&se.abrupt("return",se.arg);ie="executing";var fe=A(q,Z,se);if(fe.type==="normal"){if(ie=se.done?"completed":"suspendedYield",fe.arg===M)continue;return{value:fe.arg,done:se.done}}fe.type==="throw"&&(ie="completed",se.method="throw",se.arg=fe.arg)}}}(J,P,L),Ee}function A(J,D,P){try{return{type:"normal",arg:J.call(D,P)}}catch(Q){return{type:"throw",arg:Q}}}I.wrap=E;var M={};function z(){}function Y(){}function re(){}var ne={};N(ne,S,function(){return this});var le=Object.getPrototypeOf,j=le&&le(le(xe([])));j&&j!==v&&b.call(j,S)&&(ne=j);var ge=re.prototype=z.prototype=Object.create(ne);function Se(J){["next","throw","return"].forEach(function(D){N(J,D,function(P){return this._invoke(D,P)})})}function me(J,D){function P(pe,Ee,L,q){var Z=A(J[pe],J,Ee);if(Z.type!=="throw"){var se=Z.arg,ie=se.value;return ie&&typeof ie=="object"&&b.call(ie,"__await")?D.resolve(ie.__await).then(function(B){P("next",B,L,q)},function(B){P("throw",B,L,q)}):D.resolve(ie).then(function(B){se.value=B,L(se)},function(B){return P("throw",B,L,q)})}q(Z.arg)}var Q;this._invoke=function(pe,Ee){function L(){return new D(function(q,Z){P(pe,Ee,q,Z)})}return Q=Q?Q.then(L,L):L()}}function ye(J,D){var P=J.iterator[D.method];if(P===void 0){if(D.delegate=null,D.method==="throw"){if(J.iterator.return&&(D.method="return",D.arg=void 0,ye(J,D),D.method==="throw"))return M;D.method="throw",D.arg=new TypeError("The iterator does not provide a 'throw' method")}return M}var Q=A(P,J.iterator,D.arg);if(Q.type==="throw")return D.method="throw",D.arg=Q.arg,D.delegate=null,M;var pe=Q.arg;return pe?pe.done?(D[J.resultName]=pe.value,D.next=J.nextLoc,D.method!=="return"&&(D.method="next",D.arg=void 0),D.delegate=null,M):pe:(D.method="throw",D.arg=new TypeError("iterator result is not an object"),D.delegate=null,M)}function Ce(J){var D={tryLoc:J[0]};1 in J&&(D.catchLoc=J[1]),2 in J&&(D.finallyLoc=J[2],D.afterLoc=J[3]),this.tryEntries.push(D)}function he(J){var D=J.completion||{};D.type="normal",delete D.arg,J.completion=D}function Ne(J){this.tryEntries=[{tryLoc:"root"}],J.forEach(Ce,this),this.reset(!0)}function xe(J){if(J){var D=J[S];if(D)return D.call(J);if(typeof J.next=="function")return J;if(!isNaN(J.length)){var P=-1,Q=function pe(){for(;++P<J.length;)if(b.call(J,P))return pe.value=J[P],pe.done=!1,pe;return pe.value=void 0,pe.done=!0,pe};return Q.next=Q}}return{next:ae}}function ae(){return{value:void 0,done:!0}}return Y.prototype=re,N(ge,"constructor",re),N(re,"constructor",Y),Y.displayName=N(re,C,"GeneratorFunction"),I.isGeneratorFunction=function(J){var D=typeof J=="function"&&J.constructor;return!!D&&(D===Y||(D.displayName||D.name)==="GeneratorFunction")},I.mark=function(J){return Object.setPrototypeOf?Object.setPrototypeOf(J,re):(J.__proto__=re,N(J,C,"GeneratorFunction")),J.prototype=Object.create(ge),J},I.awrap=function(J){return{__await:J}},Se(me.prototype),N(me.prototype,w,function(){return this}),I.AsyncIterator=me,I.async=function(J,D,P,Q,pe){pe===void 0&&(pe=Promise);var Ee=new me(E(J,D,P,Q),pe);return I.isGeneratorFunction(D)?Ee:Ee.next().then(function(L){return L.done?L.value:Ee.next()})},Se(ge),N(ge,C,"Generator"),N(ge,S,function(){return this}),N(ge,"toString",function(){return"[object Generator]"}),I.keys=function(J){var D=[];for(var P in J)D.push(P);return D.reverse(),function Q(){for(;D.length;){var pe=D.pop();if(pe in J)return Q.value=pe,Q.done=!1,Q}return Q.done=!0,Q}},I.values=xe,Ne.prototype={constructor:Ne,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(he),!D)for(var P in this)P.charAt(0)==="t"&&b.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=void 0)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if(D.type==="throw")throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var P=this;function Q(se,ie){return L.type="throw",L.arg=D,P.next=se,ie&&(P.method="next",P.arg=void 0),!!ie}for(var pe=this.tryEntries.length-1;pe>=0;--pe){var Ee=this.tryEntries[pe],L=Ee.completion;if(Ee.tryLoc==="root")return Q("end");if(Ee.tryLoc<=this.prev){var q=b.call(Ee,"catchLoc"),Z=b.call(Ee,"finallyLoc");if(q&&Z){if(this.prev<Ee.catchLoc)return Q(Ee.catchLoc,!0);if(this.prev<Ee.finallyLoc)return Q(Ee.finallyLoc)}else if(q){if(this.prev<Ee.catchLoc)return Q(Ee.catchLoc,!0)}else{if(!Z)throw new Error("try statement without catch or finally");if(this.prev<Ee.finallyLoc)return Q(Ee.finallyLoc)}}}},abrupt:function(D,P){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var pe=this.tryEntries[Q];if(pe.tryLoc<=this.prev&&b.call(pe,"finallyLoc")&&this.prev<pe.finallyLoc){var Ee=pe;break}}Ee&&(D==="break"||D==="continue")&&Ee.tryLoc<=P&&P<=Ee.finallyLoc&&(Ee=null);var L=Ee?Ee.completion:{};return L.type=D,L.arg=P,Ee?(this.method="next",this.next=Ee.finallyLoc,M):this.complete(L)},complete:function(D,P){if(D.type==="throw")throw D.arg;return D.type==="break"||D.type==="continue"?this.next=D.arg:D.type==="return"?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):D.type==="normal"&&P&&(this.next=P),M},finish:function(D){for(var P=this.tryEntries.length-1;P>=0;--P){var Q=this.tryEntries[P];if(Q.finallyLoc===D)return this.complete(Q.completion,Q.afterLoc),he(Q),M}},catch:function(D){for(var P=this.tryEntries.length-1;P>=0;--P){var Q=this.tryEntries[P];if(Q.tryLoc===D){var pe=Q.completion;if(pe.type==="throw"){var Ee=pe.arg;he(Q)}return Ee}}throw new Error("illegal catch attempt")},delegateYield:function(D,P,Q){return this.delegate={iterator:xe(D),resultName:P,nextLoc:Q},this.method==="next"&&(this.arg=void 0),M}},I}function i(){return i=Object.assign?Object.assign.bind():function(I){for(var v=1;v<arguments.length;v++){var b=arguments[v];for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(I[y]=b[y])}return I},i.apply(this,arguments)}function a(I,v,b,y,S,w,C){try{var N=I[w](C),E=N.value}catch(A){b(A);return}N.done?v(E):Promise.resolve(E).then(y,S)}function o(I){return function(){var v=this,b=arguments;return new Promise(function(y,S){var w=I.apply(v,b);function C(E){a(w,y,S,C,N,"next",E)}function N(E){a(w,y,S,C,N,"throw",E)}C(void 0)})}}function c(I,v){return l.apply(this,arguments)}function l(){return l=o(s().mark(function I(v,b){var y,S,w,C,N;return s().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return b===void 0&&(b={}),A.next=3,(0,t.default)(v);case 3:return y=A.sent,S=new DataView(y),w=new f(S),C=w.getTraceData(),N=(0,e.default)(b),N.parsedSequence=i({},N.parsedSequence,{sequence:C.baseCalls.join(""),chromatogramData:C}),A.abrupt("return",[N]);case 10:case"end":return A.stop()}},I)})),l.apply(this,arguments)}var u=c;n.default=u;function f(I){var v=I.getInt32(26),b=I.getInt32(18),y=v+b*28;this.getNumber=function(S,w){for(var C=[],N=0;N<w;N+=1)C.push(I.getInt8(S+N));return C},this.getChar=function(S,w){for(var C=[],N=0;N<w;N+=1)C.push(String.fromCharCode(I.getInt8(S+N)));return C},this.getShort=function(S,w){for(var C=[],N=0;N<w;N+=2)C.push(I.getInt16(S+N));return C},this.getTagName=function(S){for(var w="",C=S;C<S+4;C++)w+=String.fromCharCode(I.getInt8(C));return w},this.getDataTag=function(S){var w,C=v;do{var N=this.getTagName(C),E=I.getInt32(C+4);if(N==S.tagName&&E===S.tagNum){var A=I.getInt32(C+16),M=I.getInt32(C+20);w=this[S.typeToReturn](M,A)}C+=28}while(C<y);return w},this.getTraceData=function(){var S={};return S.aTrace=this.getDataTag(d.colorDataA),S.tTrace=this.getDataTag(d.colorDataT),S.gTrace=this.getDataTag(d.colorDataG),S.cTrace=this.getDataTag(d.colorDataC),S.basePos=this.getDataTag(d.peakLocations),S.baseCalls=this.getDataTag(d.baseCalls2),S.qualNums=this.getDataTag(d.qualNums),S.qualNums&&(S.qualNums.filter(function(w){return w!==1&&w!==0}).length||delete S.qualNums),m(S)},this.getFirstEntry=function(){for(var S="",w=v;w<y;w+=28){for(var C="",N=w;N<w+4;N++)C+=String.fromCharCode(I.getInt8(N));S+=" - "+C}return S}}var d={baseCalls1:{tagName:"PBAS",tagNum:1,typeToReturn:"getChar"},baseCalls2:{tagName:"PBAS",tagNum:2,typeToReturn:"getChar"},qualNums:{tagName:"PCON",tagNum:2,typeToReturn:"getNumber"},peakLocations:{tagName:"PLOC",tagNum:2,typeToReturn:"getShort"},peakDev:{tagName:"P1RL",tagNum:1,typeToReturn:"getShort"},peakOneAmp:{tagName:"P1AM",tagNum:1,typeToReturn:"getShort"},colorDataA:{tagName:"DATA",tagNum:10,typeToReturn:"getShort"},colorDataT:{tagName:"DATA",tagNum:11,typeToReturn:"getShort"},colorDataG:{tagName:"DATA",tagNum:9,typeToReturn:"getShort"},colorDataC:{tagName:"DATA",tagNum:12,typeToReturn:"getShort"}},p=3;function m(I){var v=I.basePos,b=I.aTrace,y=b.length,S=0,w=v[1],C;function N(){w?C=S+Math.ceil((w-S)/2):C=y}N();for(var E=[],A=function(Y){var re={aTrace:[],tTrace:[],gTrace:[],cTrace:[]};E[Y]=re,["aTrace","tTrace","gTrace","cTrace"].forEach(function(ne){for(var le=re[ne],j=I[ne],ge=S;ge<C+p;ge++)le.push(j[ge]||0)}),Y!==v.length-1&&(S=C+p,w=v[Y+2],N())},M=0;M<v.length;M++)A(M);return i({baseTraces:E},I)}})(lw);var $I={exports:{}},uw={exports:{}},Nl=typeof Reflect=="object"?Reflect:null,kk=Nl&&typeof Nl.apply=="function"?Nl.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},bp;Nl&&typeof Nl.ownKeys=="function"?bp=Nl.ownKeys:Object.getOwnPropertySymbols?bp=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:bp=function(e){return Object.getOwnPropertyNames(e)};function eIe(n){console&&console.warn&&console.warn(n)}var dF=Number.isNaN||function(e){return e!==e};function En(){En.init.call(this)}uw.exports=En;uw.exports.once=sIe;En.EventEmitter=En;En.prototype._events=void 0;En.prototype._eventsCount=0;En.prototype._maxListeners=void 0;var Ek=10;function c0(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(En,"defaultMaxListeners",{enumerable:!0,get:function(){return Ek},set:function(n){if(typeof n!="number"||n<0||dF(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Ek=n}});En.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};En.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||dF(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function pF(n){return n._maxListeners===void 0?En.defaultMaxListeners:n._maxListeners}En.prototype.getMaxListeners=function(){return pF(this)};En.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")kk(c,this,t);else for(var l=c.length,u=bF(c,l),r=0;r<l;++r)kk(u[r],this,t);return!0};function gF(n,e,t,r){var s,i,a;if(c0(t),i=n._events,i===void 0?(i=n._events=Object.create(null),n._eventsCount=0):(i.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),i=n._events),a=i[e]),a===void 0)a=i[e]=t,++n._eventsCount;else if(typeof a=="function"?a=i[e]=r?[t,a]:[a,t]:r?a.unshift(t):a.push(t),s=pF(n),s>0&&a.length>s&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=n,o.type=e,o.count=a.length,eIe(o)}return n}En.prototype.addListener=function(e,t){return gF(this,e,t,!1)};En.prototype.on=En.prototype.addListener;En.prototype.prependListener=function(e,t){return gF(this,e,t,!0)};function tIe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function mF(n,e,t){var r={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},s=tIe.bind(r);return s.listener=t,r.wrapFn=s,s}En.prototype.once=function(e,t){return c0(t),this.on(e,mF(this,e,t)),this};En.prototype.prependOnceListener=function(e,t){return c0(t),this.prependListener(e,mF(this,e,t)),this};En.prototype.removeListener=function(e,t){var r,s,i,a,o;if(c0(t),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,i=a;break}if(i<0)return this;i===0?r.shift():nIe(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,o||t)}return this};En.prototype.off=En.prototype.removeListener;En.prototype.removeAllListeners=function(e){var t,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),a;for(s=0;s<i.length;++s)a=i[s],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function vF(n,e,t){var r=n._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?rIe(s):bF(s,s.length)}En.prototype.listeners=function(e){return vF(this,e,!0)};En.prototype.rawListeners=function(e){return vF(this,e,!1)};En.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):IF.call(n,e)};En.prototype.listenerCount=IF;function IF(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}En.prototype.eventNames=function(){return this._eventsCount>0?bp(this._events):[]};function bF(n,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=n[r];return t}function nIe(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function rIe(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function sIe(n,e){return new Promise(function(t,r){function s(a){n.removeListener(e,i),r(a)}function i(){typeof n.removeListener=="function"&&n.removeListener("error",s),t([].slice.call(arguments))}yF(n,e,i,{once:!0}),e!=="error"&&iIe(n,s,{once:!0})})}function iIe(n,e,t){typeof n.on=="function"&&yF(n,"error",e,t)}function yF(n,e,t,r){if(typeof n.on=="function")r.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function s(i){r.once&&n.removeEventListener(e,s),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var fw=uw.exports,NI={exports:{}};typeof Object.create=="function"?NI.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:NI.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}};var gu=NI.exports,ov,Tk;function xF(){return Tk||(Tk=1,ov=fw.EventEmitter),ov}var cv,Ak;function aIe(){if(Ak)return cv;Ak=1;function n(m,I){var v=Object.keys(m);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(m);I&&(b=b.filter(function(y){return Object.getOwnPropertyDescriptor(m,y).enumerable})),v.push.apply(v,b)}return v}function e(m){for(var I=1;I<arguments.length;I++){var v=arguments[I]!=null?arguments[I]:{};I%2?n(Object(v),!0).forEach(function(b){t(m,b,v[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(v)):n(Object(v)).forEach(function(b){Object.defineProperty(m,b,Object.getOwnPropertyDescriptor(v,b))})}return m}function t(m,I,v){return I=a(I),I in m?Object.defineProperty(m,I,{value:v,enumerable:!0,configurable:!0,writable:!0}):m[I]=v,m}function r(m,I){if(!(m instanceof I))throw new TypeError("Cannot call a class as a function")}function s(m,I){for(var v=0;v<I.length;v++){var b=I[v];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(m,a(b.key),b)}}function i(m,I,v){return I&&s(m.prototype,I),v&&s(m,v),Object.defineProperty(m,"prototype",{writable:!1}),m}function a(m){var I=o(m,"string");return typeof I=="symbol"?I:String(I)}function o(m,I){if(typeof m!="object"||m===null)return m;var v=m[Symbol.toPrimitive];if(v!==void 0){var b=v.call(m,I||"default");if(typeof b!="object")return b;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(m)}var c=Yh,l=c.Buffer,u=py,f=u.inspect,d=f&&f.custom||"inspect";function p(m,I,v){l.prototype.copy.call(m,I,v)}return cv=function(){function m(){r(this,m),this.head=null,this.tail=null,this.length=0}return i(m,[{key:"push",value:function(v){var b={data:v,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length}},{key:"unshift",value:function(v){var b={data:v,next:this.head};this.length===0&&(this.tail=b),this.head=b,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var b=this.head,y=""+b.data;b=b.next;)y+=v+b.data;return y}},{key:"concat",value:function(v){if(this.length===0)return l.alloc(0);for(var b=l.allocUnsafe(v>>>0),y=this.head,S=0;y;)p(y.data,b,S),S+=y.data.length,y=y.next;return b}},{key:"consume",value:function(v,b){var y;return v<this.head.data.length?(y=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):v===this.head.data.length?y=this.shift():y=b?this._getString(v):this._getBuffer(v),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var b=this.head,y=1,S=b.data;for(v-=S.length;b=b.next;){var w=b.data,C=v>w.length?w.length:v;if(C===w.length?S+=w:S+=w.slice(0,v),v-=C,v===0){C===w.length?(++y,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=w.slice(C));break}++y}return this.length-=y,S}},{key:"_getBuffer",value:function(v){var b=l.allocUnsafe(v),y=this.head,S=1;for(y.data.copy(b),v-=y.data.length;y=y.next;){var w=y.data,C=v>w.length?w.length:v;if(w.copy(b,b.length-v,0,C),v-=C,v===0){C===w.length?(++S,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=w.slice(C));break}++S}return this.length-=S,b}},{key:d,value:function(v,b){return f(this,e(e({},b),{},{depth:0,customInspect:!1}))}}]),m}(),cv}var lv,$k;function wF(){if($k)return lv;$k=1;function n(a,o){var c=this,l=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return l||u?(o?o(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(s,this,a)):process.nextTick(s,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(f){!o&&f?c._writableState?c._writableState.errorEmitted?process.nextTick(t,c):(c._writableState.errorEmitted=!0,process.nextTick(e,c,f)):process.nextTick(e,c,f):o?(process.nextTick(t,c),o(f)):process.nextTick(t,c)}),this)}function e(a,o){s(a,o),t(a)}function t(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function r(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(a,o){a.emit("error",o)}function i(a,o){var c=a._readableState,l=a._writableState;c&&c.autoDestroy||l&&l.autoDestroy?a.destroy(o):a.emit("error",o)}return lv={destroy:n,undestroy:r,errorOrDestroy:i},lv}var uv={},Nk;function mu(){if(Nk)return uv;Nk=1;function n(o,c){o.prototype=Object.create(c.prototype),o.prototype.constructor=o,o.__proto__=c}var e={};function t(o,c,l){l||(l=Error);function u(d,p,m){return typeof c=="string"?c:c(d,p,m)}var f=function(d){n(p,d);function p(m,I,v){return d.call(this,u(m,I,v))||this}return p}(l);f.prototype.name=l.name,f.prototype.code=o,e[o]=f}function r(o,c){if(Array.isArray(o)){var l=o.length;return o=o.map(function(u){return String(u)}),l>2?"one of ".concat(c," ").concat(o.slice(0,l-1).join(", "),", or ")+o[l-1]:l===2?"one of ".concat(c," ").concat(o[0]," or ").concat(o[1]):"of ".concat(c," ").concat(o[0])}else return"of ".concat(c," ").concat(String(o))}function s(o,c,l){return o.substr(!l||l<0?0:+l,c.length)===c}function i(o,c,l){return(l===void 0||l>o.length)&&(l=o.length),o.substring(l-c.length,l)===c}function a(o,c,l){return typeof l!="number"&&(l=0),l+c.length>o.length?!1:o.indexOf(c,l)!==-1}return t("ERR_INVALID_OPT_VALUE",function(o,c){return'The value "'+c+'" is invalid for option "'+o+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(o,c,l){var u;typeof c=="string"&&s(c,"not ")?(u="must not be",c=c.replace(/^not /,"")):u="must be";var f;if(i(o," argument"))f="The ".concat(o," ").concat(u," ").concat(r(c,"type"));else{var d=a(o,".")?"property":"argument";f='The "'.concat(o,'" ').concat(d," ").concat(u," ").concat(r(c,"type"))}return f+=". Received type ".concat(typeof l),f},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(o){return"The "+o+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(o){return"Cannot call "+o+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(o){return"Unknown encoding: "+o},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),uv.codes=e,uv}var fv,Ok;function SF(){if(Ok)return fv;Ok=1;var n=mu().codes.ERR_INVALID_OPT_VALUE;function e(r,s,i){return r.highWaterMark!=null?r.highWaterMark:s?r[i]:null}function t(r,s,i,a){var o=e(s,a,i);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var c=a?i:"highWaterMark";throw new n(c,o)}return Math.floor(o)}return r.objectMode?16:16*1024}return fv={getHighWaterMark:t},fv}var hv,_k;function oIe(){if(_k)return hv;_k=1,hv=n;function n(t,r){if(e("noDeprecation"))return t;var s=!1;function i(){if(!s){if(e("throwDeprecation"))throw new Error(r);e("traceDeprecation")?console.trace(r):console.warn(r),s=!0}return t.apply(this,arguments)}return i}function e(t){try{if(!Hn.localStorage)return!1}catch{return!1}var r=Hn.localStorage[t];return r==null?!1:String(r).toLowerCase()==="true"}return hv}var dv,Fk;function CF(){if(Fk)return dv;Fk=1,dv=A;function n(D){var P=this;this.next=null,this.entry=null,this.finish=function(){J(P,D)}}var e;A.WritableState=N;var t={deprecate:oIe()},r=xF(),s=Yh.Buffer,i=(typeof Hn<"u"?Hn:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(D){return s.from(D)}function o(D){return s.isBuffer(D)||D instanceof i}var c=wF(),l=SF(),u=l.getHighWaterMark,f=mu().codes,d=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,I=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,b=f.ERR_STREAM_NULL_VALUES,y=f.ERR_STREAM_WRITE_AFTER_END,S=f.ERR_UNKNOWN_ENCODING,w=c.errorOrDestroy;gu(A,r);function C(){}function N(D,P,Q){e=e||Hl(),D=D||{},typeof Q!="boolean"&&(Q=P instanceof e),this.objectMode=!!D.objectMode,Q&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=u(this,D,"writableHighWaterMark",Q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var pe=D.decodeStrings===!1;this.decodeStrings=!pe,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Ee){ge(P,Ee)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}N.prototype.getBuffer=function(){for(var P=this.bufferedRequest,Q=[];P;)Q.push(P),P=P.next;return Q},function(){try{Object.defineProperty(N.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var E;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(E=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(P){return E.call(this,P)?!0:this!==A?!1:P&&P._writableState instanceof N}})):E=function(P){return P instanceof this};function A(D){e=e||Hl();var P=this instanceof e;if(!P&&!E.call(A,this))return new A(D);this._writableState=new N(D,this,P),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),r.call(this)}A.prototype.pipe=function(){w(this,new I)};function M(D,P){var Q=new y;w(D,Q),process.nextTick(P,Q)}function z(D,P,Q,pe){var Ee;return Q===null?Ee=new b:typeof Q!="string"&&!P.objectMode&&(Ee=new d("chunk",["string","Buffer"],Q)),Ee?(w(D,Ee),process.nextTick(pe,Ee),!1):!0}A.prototype.write=function(D,P,Q){var pe=this._writableState,Ee=!1,L=!pe.objectMode&&o(D);return L&&!s.isBuffer(D)&&(D=a(D)),typeof P=="function"&&(Q=P,P=null),L?P="buffer":P||(P=pe.defaultEncoding),typeof Q!="function"&&(Q=C),pe.ending?M(this,Q):(L||z(this,pe,D,Q))&&(pe.pendingcb++,Ee=re(this,pe,L,D,P,Q)),Ee},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,!D.writing&&!D.corked&&!D.bufferProcessing&&D.bufferedRequest&&ye(this,D))},A.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())>-1))throw new S(P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Y(D,P,Q){return!D.objectMode&&D.decodeStrings!==!1&&typeof P=="string"&&(P=s.from(P,Q)),P}Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function re(D,P,Q,pe,Ee,L){if(!Q){var q=Y(P,pe,Ee);pe!==q&&(Q=!0,Ee="buffer",pe=q)}var Z=P.objectMode?1:pe.length;P.length+=Z;var se=P.length<P.highWaterMark;if(se||(P.needDrain=!0),P.writing||P.corked){var ie=P.lastBufferedRequest;P.lastBufferedRequest={chunk:pe,encoding:Ee,isBuf:Q,callback:L,next:null},ie?ie.next=P.lastBufferedRequest:P.bufferedRequest=P.lastBufferedRequest,P.bufferedRequestCount+=1}else ne(D,P,!1,Z,pe,Ee,L);return se}function ne(D,P,Q,pe,Ee,L,q){P.writelen=pe,P.writecb=q,P.writing=!0,P.sync=!0,P.destroyed?P.onwrite(new v("write")):Q?D._writev(Ee,P.onwrite):D._write(Ee,L,P.onwrite),P.sync=!1}function le(D,P,Q,pe,Ee){--P.pendingcb,Q?(process.nextTick(Ee,pe),process.nextTick(xe,D,P),D._writableState.errorEmitted=!0,w(D,pe)):(Ee(pe),D._writableState.errorEmitted=!0,w(D,pe),xe(D,P))}function j(D){D.writing=!1,D.writecb=null,D.length-=D.writelen,D.writelen=0}function ge(D,P){var Q=D._writableState,pe=Q.sync,Ee=Q.writecb;if(typeof Ee!="function")throw new m;if(j(Q),P)le(D,Q,pe,P,Ee);else{var L=Ce(Q)||D.destroyed;!L&&!Q.corked&&!Q.bufferProcessing&&Q.bufferedRequest&&ye(D,Q),pe?process.nextTick(Se,D,Q,L,Ee):Se(D,Q,L,Ee)}}function Se(D,P,Q,pe){Q||me(D,P),P.pendingcb--,pe(),xe(D,P)}function me(D,P){P.length===0&&P.needDrain&&(P.needDrain=!1,D.emit("drain"))}function ye(D,P){P.bufferProcessing=!0;var Q=P.bufferedRequest;if(D._writev&&Q&&Q.next){var pe=P.bufferedRequestCount,Ee=new Array(pe),L=P.corkedRequestsFree;L.entry=Q;for(var q=0,Z=!0;Q;)Ee[q]=Q,Q.isBuf||(Z=!1),Q=Q.next,q+=1;Ee.allBuffers=Z,ne(D,P,!0,P.length,Ee,"",L.finish),P.pendingcb++,P.lastBufferedRequest=null,L.next?(P.corkedRequestsFree=L.next,L.next=null):P.corkedRequestsFree=new n(P),P.bufferedRequestCount=0}else{for(;Q;){var se=Q.chunk,ie=Q.encoding,B=Q.callback,R=P.objectMode?1:se.length;if(ne(D,P,!1,R,se,ie,B),Q=Q.next,P.bufferedRequestCount--,P.writing)break}Q===null&&(P.lastBufferedRequest=null)}P.bufferedRequest=Q,P.bufferProcessing=!1}A.prototype._write=function(D,P,Q){Q(new p("_write()"))},A.prototype._writev=null,A.prototype.end=function(D,P,Q){var pe=this._writableState;return typeof D=="function"?(Q=D,D=null,P=null):typeof P=="function"&&(Q=P,P=null),D!=null&&this.write(D,P),pe.corked&&(pe.corked=1,this.uncork()),pe.ending||ae(this,pe,Q),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ce(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function he(D,P){D._final(function(Q){P.pendingcb--,Q&&w(D,Q),P.prefinished=!0,D.emit("prefinish"),xe(D,P)})}function Ne(D,P){!P.prefinished&&!P.finalCalled&&(typeof D._final=="function"&&!P.destroyed?(P.pendingcb++,P.finalCalled=!0,process.nextTick(he,D,P)):(P.prefinished=!0,D.emit("prefinish")))}function xe(D,P){var Q=Ce(P);if(Q&&(Ne(D,P),P.pendingcb===0&&(P.finished=!0,D.emit("finish"),P.autoDestroy))){var pe=D._readableState;(!pe||pe.autoDestroy&&pe.endEmitted)&&D.destroy()}return Q}function ae(D,P,Q){P.ending=!0,xe(D,P),Q&&(P.finished?process.nextTick(Q):D.once("finish",Q)),P.ended=!0,D.writable=!1}function J(D,P,Q){var pe=D.entry;for(D.entry=null;pe;){var Ee=pe.callback;P.pendingcb--,Ee(Q),pe=pe.next}P.corkedRequestsFree.next=D}return Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),A.prototype.destroy=c.destroy,A.prototype._undestroy=c.undestroy,A.prototype._destroy=function(D,P){P(D)},dv}var pv,Dk;function Hl(){if(Dk)return pv;Dk=1;var n=Object.keys||function(l){var u=[];for(var f in l)u.push(f);return u};pv=a;var e=RF(),t=CF();gu(a,e);for(var r=n(t.prototype),s=0;s<r.length;s++){var i=r[s];a.prototype[i]||(a.prototype[i]=t.prototype[i])}function a(l){if(!(this instanceof a))return new a(l);e.call(this,l),t.call(this,l),this.allowHalfOpen=!0,l&&(l.readable===!1&&(this.readable=!1),l.writable===!1&&(this.writable=!1),l.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||process.nextTick(c,this)}function c(l){l.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),pv}var gv,Bk;function hw(){if(Bk)return gv;Bk=1;var n=mu().codes.ERR_STREAM_PREMATURE_CLOSE;function e(i){var a=!1;return function(){if(!a){a=!0;for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];i.apply(this,c)}}}function t(){}function r(i){return i.setHeader&&typeof i.abort=="function"}function s(i,a,o){if(typeof a=="function")return s(i,null,a);a||(a={}),o=e(o||t);var c=a.readable||a.readable!==!1&&i.readable,l=a.writable||a.writable!==!1&&i.writable,u=function(){i.writable||d()},f=i._writableState&&i._writableState.finished,d=function(){l=!1,f=!0,c||o.call(i)},p=i._readableState&&i._readableState.endEmitted,m=function(){c=!1,p=!0,l||o.call(i)},I=function(S){o.call(i,S)},v=function(){var S;if(c&&!p)return(!i._readableState||!i._readableState.ended)&&(S=new n),o.call(i,S);if(l&&!f)return(!i._writableState||!i._writableState.ended)&&(S=new n),o.call(i,S)},b=function(){i.req.on("finish",d)};return r(i)?(i.on("complete",d),i.on("abort",v),i.req?b():i.on("request",b)):l&&!i._writableState&&(i.on("end",u),i.on("close",u)),i.on("end",m),i.on("finish",d),a.error!==!1&&i.on("error",I),i.on("close",v),function(){i.removeListener("complete",d),i.removeListener("abort",v),i.removeListener("request",b),i.req&&i.req.removeListener("finish",d),i.removeListener("end",u),i.removeListener("close",u),i.removeListener("finish",d),i.removeListener("end",m),i.removeListener("error",I),i.removeListener("close",v)}}return gv=s,gv}var mv,Mk;function cIe(){if(Mk)return mv;Mk=1;var n;function e(S,w,C){return w=t(w),w in S?Object.defineProperty(S,w,{value:C,enumerable:!0,configurable:!0,writable:!0}):S[w]=C,S}function t(S){var w=r(S,"string");return typeof w=="symbol"?w:String(w)}function r(S,w){if(typeof S!="object"||S===null)return S;var C=S[Symbol.toPrimitive];if(C!==void 0){var N=C.call(S,w||"default");if(typeof N!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(S)}var s=hw(),i=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),u=Symbol("handlePromise"),f=Symbol("stream");function d(S,w){return{value:S,done:w}}function p(S){var w=S[i];if(w!==null){var C=S[f].read();C!==null&&(S[l]=null,S[i]=null,S[a]=null,w(d(C,!1)))}}function m(S){process.nextTick(p,S)}function I(S,w){return function(C,N){S.then(function(){if(w[c]){C(d(void 0,!0));return}w[u](C,N)},N)}}var v=Object.getPrototypeOf(function(){}),b=Object.setPrototypeOf((n={get stream(){return this[f]},next:function(){var w=this,C=this[o];if(C!==null)return Promise.reject(C);if(this[c])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise(function(M,z){process.nextTick(function(){w[o]?z(w[o]):M(d(void 0,!0))})});var N=this[l],E;if(N)E=new Promise(I(N,this));else{var A=this[f].read();if(A!==null)return Promise.resolve(d(A,!1));E=new Promise(this[u])}return this[l]=E,E}},e(n,Symbol.asyncIterator,function(){return this}),e(n,"return",function(){var w=this;return new Promise(function(C,N){w[f].destroy(null,function(E){if(E){N(E);return}C(d(void 0,!0))})})}),n),v),y=function(w){var C,N=Object.create(b,(C={},e(C,f,{value:w,writable:!0}),e(C,i,{value:null,writable:!0}),e(C,a,{value:null,writable:!0}),e(C,o,{value:null,writable:!0}),e(C,c,{value:w._readableState.endEmitted,writable:!0}),e(C,u,{value:function(A,M){var z=N[f].read();z?(N[l]=null,N[i]=null,N[a]=null,A(d(z,!1))):(N[i]=A,N[a]=M)},writable:!0}),C));return N[l]=null,s(w,function(E){if(E&&E.code!=="ERR_STREAM_PREMATURE_CLOSE"){var A=N[a];A!==null&&(N[l]=null,N[i]=null,N[a]=null,A(E)),N[o]=E;return}var M=N[i];M!==null&&(N[l]=null,N[i]=null,N[a]=null,M(d(void 0,!0))),N[c]=!0}),w.on("readable",m.bind(null,N)),N};return mv=y,mv}var vv,Pk;function lIe(){return Pk||(Pk=1,vv=function(){throw new Error("Readable.from is not available in the browser")}),vv}var Iv,Lk;function RF(){if(Lk)return Iv;Lk=1,Iv=M;var n;M.ReadableState=A,fw.EventEmitter;var e=function(q,Z){return q.listeners(Z).length},t=xF(),r=Yh.Buffer,s=(typeof Hn<"u"?Hn:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function i(L){return r.from(L)}function a(L){return r.isBuffer(L)||L instanceof s}var o=py,c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var l=aIe(),u=wF(),f=SF(),d=f.getHighWaterMark,p=mu().codes,m=p.ERR_INVALID_ARG_TYPE,I=p.ERR_STREAM_PUSH_AFTER_EOF,v=p.ERR_METHOD_NOT_IMPLEMENTED,b=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,y,S,w;gu(M,t);var C=u.errorOrDestroy,N=["error","close","destroy","pause","resume"];function E(L,q,Z){if(typeof L.prependListener=="function")return L.prependListener(q,Z);!L._events||!L._events[q]?L.on(q,Z):Array.isArray(L._events[q])?L._events[q].unshift(Z):L._events[q]=[Z,L._events[q]]}function A(L,q,Z){n=n||Hl(),L=L||{},typeof Z!="boolean"&&(Z=q instanceof n),this.objectMode=!!L.objectMode,Z&&(this.objectMode=this.objectMode||!!L.readableObjectMode),this.highWaterMark=d(this,L,"readableHighWaterMark",Z),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=L.emitClose!==!1,this.autoDestroy=!!L.autoDestroy,this.destroyed=!1,this.defaultEncoding=L.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,L.encoding&&(y||(y=tg.StringDecoder),this.decoder=new y(L.encoding),this.encoding=L.encoding)}function M(L){if(n=n||Hl(),!(this instanceof M))return new M(L);var q=this instanceof n;this._readableState=new A(L,this,q),this.readable=!0,L&&(typeof L.read=="function"&&(this._read=L.read),typeof L.destroy=="function"&&(this._destroy=L.destroy)),t.call(this)}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(q){this._readableState&&(this._readableState.destroyed=q)}}),M.prototype.destroy=u.destroy,M.prototype._undestroy=u.undestroy,M.prototype._destroy=function(L,q){q(L)},M.prototype.push=function(L,q){var Z=this._readableState,se;return Z.objectMode?se=!0:typeof L=="string"&&(q=q||Z.defaultEncoding,q!==Z.encoding&&(L=r.from(L,q),q=""),se=!0),z(this,L,q,!1,se)},M.prototype.unshift=function(L){return z(this,L,null,!0,!1)};function z(L,q,Z,se,ie){c("readableAddChunk",q);var B=L._readableState;if(q===null)B.reading=!1,ge(L,B);else{var R;if(ie||(R=re(B,q)),R)C(L,R);else if(B.objectMode||q&&q.length>0)if(typeof q!="string"&&!B.objectMode&&Object.getPrototypeOf(q)!==r.prototype&&(q=i(q)),se)B.endEmitted?C(L,new b):Y(L,B,q,!0);else if(B.ended)C(L,new I);else{if(B.destroyed)return!1;B.reading=!1,B.decoder&&!Z?(q=B.decoder.write(q),B.objectMode||q.length!==0?Y(L,B,q,!1):ye(L,B)):Y(L,B,q,!1)}else se||(B.reading=!1,ye(L,B))}return!B.ended&&(B.length<B.highWaterMark||B.length===0)}function Y(L,q,Z,se){q.flowing&&q.length===0&&!q.sync?(q.awaitDrain=0,L.emit("data",Z)):(q.length+=q.objectMode?1:Z.length,se?q.buffer.unshift(Z):q.buffer.push(Z),q.needReadable&&Se(L)),ye(L,q)}function re(L,q){var Z;return!a(q)&&typeof q!="string"&&q!==void 0&&!L.objectMode&&(Z=new m("chunk",["string","Buffer","Uint8Array"],q)),Z}M.prototype.isPaused=function(){return this._readableState.flowing===!1},M.prototype.setEncoding=function(L){y||(y=tg.StringDecoder);var q=new y(L);this._readableState.decoder=q,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,se="";Z!==null;)se+=q.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),se!==""&&this._readableState.buffer.push(se),this._readableState.length=se.length,this};var ne=1073741824;function le(L){return L>=ne?L=ne:(L--,L|=L>>>1,L|=L>>>2,L|=L>>>4,L|=L>>>8,L|=L>>>16,L++),L}function j(L,q){return L<=0||q.length===0&&q.ended?0:q.objectMode?1:L!==L?q.flowing&&q.length?q.buffer.head.data.length:q.length:(L>q.highWaterMark&&(q.highWaterMark=le(L)),L<=q.length?L:q.ended?q.length:(q.needReadable=!0,0))}M.prototype.read=function(L){c("read",L),L=parseInt(L,10);var q=this._readableState,Z=L;if(L!==0&&(q.emittedReadable=!1),L===0&&q.needReadable&&((q.highWaterMark!==0?q.length>=q.highWaterMark:q.length>0)||q.ended))return c("read: emitReadable",q.length,q.ended),q.length===0&&q.ended?Q(this):Se(this),null;if(L=j(L,q),L===0&&q.ended)return q.length===0&&Q(this),null;var se=q.needReadable;c("need readable",se),(q.length===0||q.length-L<q.highWaterMark)&&(se=!0,c("length less than watermark",se)),q.ended||q.reading?(se=!1,c("reading or ended",se)):se&&(c("do read"),q.reading=!0,q.sync=!0,q.length===0&&(q.needReadable=!0),this._read(q.highWaterMark),q.sync=!1,q.reading||(L=j(Z,q)));var ie;return L>0?ie=P(L,q):ie=null,ie===null?(q.needReadable=q.length<=q.highWaterMark,L=0):(q.length-=L,q.awaitDrain=0),q.length===0&&(q.ended||(q.needReadable=!0),Z!==L&&q.ended&&Q(this)),ie!==null&&this.emit("data",ie),ie};function ge(L,q){if(c("onEofChunk"),!q.ended){if(q.decoder){var Z=q.decoder.end();Z&&Z.length&&(q.buffer.push(Z),q.length+=q.objectMode?1:Z.length)}q.ended=!0,q.sync?Se(L):(q.needReadable=!1,q.emittedReadable||(q.emittedReadable=!0,me(L)))}}function Se(L){var q=L._readableState;c("emitReadable",q.needReadable,q.emittedReadable),q.needReadable=!1,q.emittedReadable||(c("emitReadable",q.flowing),q.emittedReadable=!0,process.nextTick(me,L))}function me(L){var q=L._readableState;c("emitReadable_",q.destroyed,q.length,q.ended),!q.destroyed&&(q.length||q.ended)&&(L.emit("readable"),q.emittedReadable=!1),q.needReadable=!q.flowing&&!q.ended&&q.length<=q.highWaterMark,D(L)}function ye(L,q){q.readingMore||(q.readingMore=!0,process.nextTick(Ce,L,q))}function Ce(L,q){for(;!q.reading&&!q.ended&&(q.length<q.highWaterMark||q.flowing&&q.length===0);){var Z=q.length;if(c("maybeReadMore read 0"),L.read(0),Z===q.length)break}q.readingMore=!1}M.prototype._read=function(L){C(this,new v("_read()"))},M.prototype.pipe=function(L,q){var Z=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=L;break;case 1:se.pipes=[se.pipes,L];break;default:se.pipes.push(L);break}se.pipesCount+=1,c("pipe count=%d opts=%j",se.pipesCount,q);var ie=(!q||q.end!==!1)&&L!==process.stdout&&L!==process.stderr,B=ie?k:lt;se.endEmitted?process.nextTick(B):Z.once("end",B),L.on("unpipe",R);function R(W,T){c("onunpipe"),W===Z&&T&&T.hasUnpiped===!1&&(T.hasUnpiped=!0,Te())}function k(){c("onend"),L.end()}var X=he(Z);L.on("drain",X);var fe=!1;function Te(){c("cleanup"),L.removeListener("close",rt),L.removeListener("finish",ct),L.removeListener("drain",X),L.removeListener("error",He),L.removeListener("unpipe",R),Z.removeListener("end",k),Z.removeListener("end",lt),Z.removeListener("data",Be),fe=!0,se.awaitDrain&&(!L._writableState||L._writableState.needDrain)&&X()}Z.on("data",Be);function Be(W){c("ondata");var T=L.write(W);c("dest.write",T),T===!1&&((se.pipesCount===1&&se.pipes===L||se.pipesCount>1&&Ee(se.pipes,L)!==-1)&&!fe&&(c("false write response, pause",se.awaitDrain),se.awaitDrain++),Z.pause())}function He(W){c("onerror",W),lt(),L.removeListener("error",He),e(L,"error")===0&&C(L,W)}E(L,"error",He);function rt(){L.removeListener("finish",ct),lt()}L.once("close",rt);function ct(){c("onfinish"),L.removeListener("close",rt),lt()}L.once("finish",ct);function lt(){c("unpipe"),Z.unpipe(L)}return L.emit("pipe",Z),se.flowing||(c("pipe resume"),Z.resume()),L};function he(L){return function(){var Z=L._readableState;c("pipeOnDrain",Z.awaitDrain),Z.awaitDrain&&Z.awaitDrain--,Z.awaitDrain===0&&e(L,"data")&&(Z.flowing=!0,D(L))}}M.prototype.unpipe=function(L){var q=this._readableState,Z={hasUnpiped:!1};if(q.pipesCount===0)return this;if(q.pipesCount===1)return L&&L!==q.pipes?this:(L||(L=q.pipes),q.pipes=null,q.pipesCount=0,q.flowing=!1,L&&L.emit("unpipe",this,Z),this);if(!L){var se=q.pipes,ie=q.pipesCount;q.pipes=null,q.pipesCount=0,q.flowing=!1;for(var B=0;B<ie;B++)se[B].emit("unpipe",this,{hasUnpiped:!1});return this}var R=Ee(q.pipes,L);return R===-1?this:(q.pipes.splice(R,1),q.pipesCount-=1,q.pipesCount===1&&(q.pipes=q.pipes[0]),L.emit("unpipe",this,Z),this)},M.prototype.on=function(L,q){var Z=t.prototype.on.call(this,L,q),se=this._readableState;return L==="data"?(se.readableListening=this.listenerCount("readable")>0,se.flowing!==!1&&this.resume()):L==="readable"&&!se.endEmitted&&!se.readableListening&&(se.readableListening=se.needReadable=!0,se.flowing=!1,se.emittedReadable=!1,c("on readable",se.length,se.reading),se.length?Se(this):se.reading||process.nextTick(xe,this)),Z},M.prototype.addListener=M.prototype.on,M.prototype.removeListener=function(L,q){var Z=t.prototype.removeListener.call(this,L,q);return L==="readable"&&process.nextTick(Ne,this),Z},M.prototype.removeAllListeners=function(L){var q=t.prototype.removeAllListeners.apply(this,arguments);return(L==="readable"||L===void 0)&&process.nextTick(Ne,this),q};function Ne(L){var q=L._readableState;q.readableListening=L.listenerCount("readable")>0,q.resumeScheduled&&!q.paused?q.flowing=!0:L.listenerCount("data")>0&&L.resume()}function xe(L){c("readable nexttick read 0"),L.read(0)}M.prototype.resume=function(){var L=this._readableState;return L.flowing||(c("resume"),L.flowing=!L.readableListening,ae(this,L)),L.paused=!1,this};function ae(L,q){q.resumeScheduled||(q.resumeScheduled=!0,process.nextTick(J,L,q))}function J(L,q){c("resume",q.reading),q.reading||L.read(0),q.resumeScheduled=!1,L.emit("resume"),D(L),q.flowing&&!q.reading&&L.read(0)}M.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function D(L){var q=L._readableState;for(c("flow",q.flowing);q.flowing&&L.read()!==null;);}M.prototype.wrap=function(L){var q=this,Z=this._readableState,se=!1;L.on("end",function(){if(c("wrapped end"),Z.decoder&&!Z.ended){var R=Z.decoder.end();R&&R.length&&q.push(R)}q.push(null)}),L.on("data",function(R){if(c("wrapped data"),Z.decoder&&(R=Z.decoder.write(R)),!(Z.objectMode&&R==null)&&!(!Z.objectMode&&(!R||!R.length))){var k=q.push(R);k||(se=!0,L.pause())}});for(var ie in L)this[ie]===void 0&&typeof L[ie]=="function"&&(this[ie]=function(k){return function(){return L[k].apply(L,arguments)}}(ie));for(var B=0;B<N.length;B++)L.on(N[B],this.emit.bind(this,N[B]));return this._read=function(R){c("wrapped _read",R),se&&(se=!1,L.resume())},this},typeof Symbol=="function"&&(M.prototype[Symbol.asyncIterator]=function(){return S===void 0&&(S=cIe()),S(this)}),Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(M.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(M.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(q){this._readableState&&(this._readableState.flowing=q)}}),M._fromList=P,Object.defineProperty(M.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function P(L,q){if(q.length===0)return null;var Z;return q.objectMode?Z=q.buffer.shift():!L||L>=q.length?(q.decoder?Z=q.buffer.join(""):q.buffer.length===1?Z=q.buffer.first():Z=q.buffer.concat(q.length),q.buffer.clear()):Z=q.buffer.consume(L,q.decoder),Z}function Q(L){var q=L._readableState;c("endReadable",q.endEmitted),q.endEmitted||(q.ended=!0,process.nextTick(pe,q,L))}function pe(L,q){if(c("endReadableNT",L.endEmitted,L.length),!L.endEmitted&&L.length===0&&(L.endEmitted=!0,q.readable=!1,q.emit("end"),L.autoDestroy)){var Z=q._writableState;(!Z||Z.autoDestroy&&Z.finished)&&q.destroy()}}typeof Symbol=="function"&&(M.from=function(L,q){return w===void 0&&(w=lIe()),w(M,L,q)});function Ee(L,q){for(var Z=0,se=L.length;Z<se;Z++)if(L[Z]===q)return Z;return-1}return Iv}var bv,Uk;function kF(){if(Uk)return bv;Uk=1,bv=o;var n=mu().codes,e=n.ERR_METHOD_NOT_IMPLEMENTED,t=n.ERR_MULTIPLE_CALLBACK,r=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,i=Hl();gu(o,i);function a(u,f){var d=this._transformState;d.transforming=!1;var p=d.writecb;if(p===null)return this.emit("error",new t);d.writechunk=null,d.writecb=null,f!=null&&this.push(f),p(u);var m=this._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}function o(u){if(!(this instanceof o))return new o(u);i.call(this,u),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.on("prefinish",c)}function c(){var u=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(f,d){l(u,f,d)}):l(this,null,null)}o.prototype.push=function(u,f){return this._transformState.needTransform=!1,i.prototype.push.call(this,u,f)},o.prototype._transform=function(u,f,d){d(new e("_transform()"))},o.prototype._write=function(u,f,d){var p=this._transformState;if(p.writecb=d,p.writechunk=u,p.writeencoding=f,!p.transforming){var m=this._readableState;(p.needTransform||m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}},o.prototype._read=function(u){var f=this._transformState;f.writechunk!==null&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},o.prototype._destroy=function(u,f){i.prototype._destroy.call(this,u,function(d){f(d)})};function l(u,f,d){if(f)return u.emit("error",f);if(d!=null&&u.push(d),u._writableState.length)throw new s;if(u._transformState.transforming)throw new r;return u.push(null)}return bv}var yv,zk;function uIe(){if(zk)return yv;zk=1,yv=e;var n=kF();gu(e,n);function e(t){if(!(this instanceof e))return new e(t);n.call(this,t)}return e.prototype._transform=function(t,r,s){s(null,t)},yv}var xv,Vk;function fIe(){if(Vk)return xv;Vk=1;var n;function e(d){var p=!1;return function(){p||(p=!0,d.apply(void 0,arguments))}}var t=mu().codes,r=t.ERR_MISSING_ARGS,s=t.ERR_STREAM_DESTROYED;function i(d){if(d)throw d}function a(d){return d.setHeader&&typeof d.abort=="function"}function o(d,p,m,I){I=e(I);var v=!1;d.on("close",function(){v=!0}),n===void 0&&(n=hw()),n(d,{readable:p,writable:m},function(y){if(y)return I(y);v=!0,I()});var b=!1;return function(y){if(!v&&!b){if(b=!0,a(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();I(y||new s("pipe"))}}}function c(d){d()}function l(d,p){return d.pipe(p)}function u(d){return!d.length||typeof d[d.length-1]!="function"?i:d.pop()}function f(){for(var d=arguments.length,p=new Array(d),m=0;m<d;m++)p[m]=arguments[m];var I=u(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new r("streams");var v,b=p.map(function(y,S){var w=S<p.length-1,C=S>0;return o(y,w,C,function(N){v||(v=N),N&&b.forEach(c),!w&&(b.forEach(c),I(v))})});return p.reduce(l)}return xv=f,xv}var EF=bi,dw=fw.EventEmitter,hIe=gu;hIe(bi,dw);bi.Readable=RF();bi.Writable=CF();bi.Duplex=Hl();bi.Transform=kF();bi.PassThrough=uIe();bi.finished=hw();bi.pipeline=fIe();bi.Stream=bi;function bi(){dw.call(this)}bi.prototype.pipe=function(n,e){var t=this;function r(u){n.writable&&n.write(u)===!1&&t.pause&&t.pause()}t.on("data",r);function s(){t.readable&&t.resume&&t.resume()}n.on("drain",s),!n._isStdio&&(!e||e.end!==!1)&&(t.on("end",a),t.on("close",o));var i=!1;function a(){i||(i=!0,n.end())}function o(){i||(i=!0,typeof n.destroy=="function"&&n.destroy())}function c(u){if(l(),dw.listenerCount(this,"error")===0)throw u}t.on("error",c),n.on("error",c);function l(){t.removeListener("data",r),n.removeListener("drain",s),t.removeListener("end",a),t.removeListener("close",o),t.removeListener("error",c),n.removeListener("error",c),t.removeListener("end",l),t.removeListener("close",l),n.removeListener("close",l)}return t.on("end",l),t.on("close",l),n.on("close",l),n.emit("pipe",t),n};function ff(n){return n.replace(/%([0-9A-Fa-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))}function TF(n,e){return String(e).replace(n,t=>`%${t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}`)}function af(n){return TF(/[\n;\r\t=%&,\x00-\x1f\x7f-\xff]/g,n)}function Ma(n){return TF(/[\n\r\t%\x00-\x1f\x7f-\xff]/g,n)}function AF(n){if(!(n&&n.length)||n===".")return{};const e={};return n.replace(/\r?\n$/,"").split(";").forEach(t=>{const r=t.split("=",2);if(!(r[1]&&r[1].length))return;r[0]=r[0].trim();let s=e[r[0].trim()];s||(s=[],e[r[0]]=s),s.push(...r[1].split(",").map(i=>i.trim()).map(ff))}),e}function $F(n){const e=n.split("	").map(r=>r==="."||r===""?null:r);return{seq_id:e[0]&&ff(e[0]),source:e[1]&&ff(e[1]),type:e[2]&&ff(e[2]),start:e[3]===null?null:parseInt(e[3],10),end:e[4]===null?null:parseInt(e[4],10),score:e[5]===null?null:parseFloat(e[5]),strand:e[6],phase:e[7],attributes:e[8]===null?null:AF(e[8])}}function NF(n){const e=/^\s*##\s*(\S+)\s*(.*)/.exec(n);if(!e)return null;const[,t]=e;let[,,r]=e;const s={directive:t};if(r.length&&(r=r.replace(/\r?\n$/,""),s.value=r),t==="sequence-region"){const i=r.split(/\s+/,3);return{...s,seq_id:i[0],start:i[1]&&i[1].replace(/\D/g,""),end:i[2]&&i[2].replace(/\D/g,"")}}else if(t==="genome-build"){const[i,a]=r.split(/\s+/,2);return{...s,source:i,buildName:a}}return s}function OF(n){const e=[];return Object.entries(n).forEach(([t,r])=>{if(!r)return;let s;r.hasOwnProperty("toString")?s=af(r.toString()):Array.isArray(r)?s=r.map(af).join(","):s=af(r),e.push(`${af(t)}=${s}`)}),e.length?e.join(";"):"."}function dIe(n,e){const t=n.attributes===null||n.attributes===void 0?".":OF(n.attributes),s=`${[n.seq_id===null?".":Ma(n.seq_id),n.source===null?".":Ma(n.source),n.type===null?".":Ma(n.type),n.start===null?".":Ma(n.start),n.end===null?".":Ma(n.end),n.score===null?".":Ma(n.score),n.strand===null?".":Ma(n.strand),n.phase===null?".":Ma(n.phase),t].join("	")}
`;return e[s]?"":(e[s]=!0,s)}function yp(n,e){if(Array.isArray(n))return n.map(r=>yp(r,e)).join("");const t=[dIe(n,e)];return pIe(n)&&t.push(...n.child_features.map(r=>yp(r,e)),...n.derived_features.map(r=>yp(r,e))),t.join("")}function _F(n){return yp(n,{})}function FF(n){let e=`##${n.directive}`;return n.value&&(e+=` ${n.value}`),e+=`
`,e}function DF(n){return`# ${n.comment}
`}function pw(n){return`>${n.id}${n.description?` ${n.description}`:""}
${n.sequence}
`}function ng(n){function e(t){return"attributes"in t?_F(t):"directive"in t?FF(t):"sequence"in t?pw(t):"comment"in t?DF(t):`# (invalid item found during format)
`}return Array.isArray(n)?n.map(e):e(n)}function pIe(n){return n.child_features!==void 0&&n.derived_features!==void 0}const gIe=Object.freeze(Object.defineProperty({__proto__:null,escape:af,escapeColumn:Ma,formatAttributes:OF,formatComment:DF,formatDirective:FF,formatFeature:_F,formatItem:ng,formatSequence:pw,parseAttributes:AF,parseDirective:NF,parseFeature:$F,unescape:ff},Symbol.toStringTag,{value:"Module"})),Wk={Parent:"child_features",Derives_from:"derived_features"};class Gk{constructor(e){this.seqCallback=e,this.currentSequence=void 0}addLine(e){const t=/^>\s*(\S+)\s*(.*)/.exec(e);t?(this._flush(),this.currentSequence={id:t[1],sequence:""},t[2]&&(this.currentSequence.description=t[2].trim())):this.currentSequence&&/\S/.test(e)&&(this.currentSequence.sequence+=e.replace(/\s/g,""))}_flush(){this.currentSequence&&this.seqCallback(this.currentSequence)}finish(){this._flush()}}class BF{constructor(e){this.fastaParser=void 0,this.eof=!1,this.lineNumber=0,this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},this._underConstructionOrphans={};const t=()=>{};this.featureCallback=e.featureCallback||t,this.endCallback=e.endCallback||t,this.commentCallback=e.commentCallback||t,this.errorCallback=e.errorCallback||t,this.directiveCallback=e.directiveCallback||t,this.sequenceCallback=e.sequenceCallback||t,this.disableDerivesFromReferences=e.disableDerivesFromReferences||!1,this.bufferSize=e.bufferSize===void 0?1e3:e.bufferSize}addLine(e){if(this.fastaParser){this.fastaParser.addLine(e);return}if(this.eof)return;if(this.lineNumber+=1,/^\s*[^#\s>]/.test(e)){this._bufferLine(e);return}const t=/^\s*(#+)(.*)/.exec(e);if(t){const[,r]=t;let[,,s]=t;if(r.length===3)this._emitAllUnderConstructionFeatures();else if(r.length===2){const i=NF(e);i&&(i.directive==="FASTA"?(this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new Gk(this.sequenceCallback)):this._emitItem(i))}else s=s.replace(/\s*/,""),this._emitItem({comment:s})}else if(!/^\s*$/.test(e))if(/^\s*>/.test(e))this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new Gk(this.sequenceCallback),this.fastaParser.addLine(e);else{const r=e.replace(/\r?\n?$/g,"");throw new Error(`GFF3 parse error.  Cannot parse '${r}'.`)}}finish(){this._emitAllUnderConstructionFeatures(),this.fastaParser&&this.fastaParser.finish(),this.endCallback()}_emitItem(e){Array.isArray(e)?this.featureCallback(e):"directive"in e?this.directiveCallback(e):"comment"in e&&this.commentCallback(e)}_enforceBufferSizeLimit(e=0){const t=r=>{r&&Array.isArray(r)&&r[0].attributes&&r[0].attributes.ID&&r[0].attributes.ID[0]&&(r[0].attributes.ID.forEach(i=>{delete this._underConstructionById[i],delete this._completedReferences[i]}),r.forEach(i=>{i.child_features&&i.child_features.forEach(a=>t(a)),i.derived_features&&i.derived_features.forEach(a=>t(a))}))};for(;this._underConstructionTopLevel.length+e>this.bufferSize;){const r=this._underConstructionTopLevel.shift();r&&(this._emitItem(r),t(r))}}_emitAllUnderConstructionFeatures(){if(this._underConstructionTopLevel.forEach(this._emitItem.bind(this)),this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},Array.from(Object.values(this._underConstructionOrphans)).length)throw new Error(`some features reference other features that do not exist in the file (or in the same '###' scope). ${Object.keys(this._underConstructionOrphans)}`)}_bufferLine(e){var t,r,s;const a={...$F(e),child_features:[],derived_features:[]},o=((t=a.attributes)===null||t===void 0?void 0:t.ID)||[],c=((r=a.attributes)===null||r===void 0?void 0:r.Parent)||[],l=this.disableDerivesFromReferences?[]:((s=a.attributes)===null||s===void 0?void 0:s.Derives_from)||[];if(!o.length&&!c.length&&!l.length){this._emitItem([a]);return}let u;o.forEach(f=>{const d=this._underConstructionById[f];d?(d[d.length-1].type!==a.type&&this._parseError(`multi-line feature "${f}" has inconsistent types: "${a.type}", "${d[d.length-1].type}"`),d.push(a),u=d):(u=[a],this._enforceBufferSizeLimit(1),!c.length&&!l.length&&this._underConstructionTopLevel.push(u),this._underConstructionById[f]=u,this._resolveReferencesTo(u,f))}),this._resolveReferencesFrom(u||[a],{Parent:c,Derives_from:l},o)}_resolveReferencesTo(e,t){const r=this._underConstructionOrphans[t];r&&(e.forEach(s=>{s.child_features.push(...r.Parent)}),e.forEach(s=>{s.derived_features.push(...r.Derives_from)}),delete this._underConstructionOrphans[t])}_parseError(e){this.eof=!0,this.errorCallback(`${this.lineNumber}: ${e}`)}_resolveReferencesFrom(e,t,r){function s(i,a,o){let c=i[a];c||(c={},i[a]=c);const l=c[o]||!1;return c[o]=!0,l}t.Parent.forEach(i=>{const a=this._underConstructionById[i];if(a){const o=Wk.Parent;r.filter(c=>s(this._completedReferences,c,`Parent,${i}`)).length||a.forEach(c=>{c[o].push(e)})}else{let o=this._underConstructionOrphans[i];o||(o={Parent:[],Derives_from:[]},this._underConstructionOrphans[i]=o),o.Parent.push(e)}}),t.Derives_from.forEach(i=>{const a=this._underConstructionById[i];if(a){const o=Wk.Derives_from;r.filter(c=>s(this._completedReferences,c,`Derives_from,${i}`)).length||a.forEach(c=>{c[o].push(e)})}else{let o=this._underConstructionOrphans[i];o||(o={Parent:[],Derives_from:[]},this._underConstructionOrphans[i]=o),o.Derives_from.push(e)}})}}function OI(n){process&&process.nextTick?process.nextTick(n):n()}function MF(n){const e={encoding:"utf8",parseFeatures:!0,parseDirectives:!1,parseSequences:!0,parseComments:!1,bufferSize:1e3,disableDerivesFromReferences:!1,...n};return n.parseAll&&(e.parseFeatures=!0,e.parseDirectives=!0,e.parseComments=!0,e.parseSequences=!0),e}class mIe extends EF.Transform{constructor(e={}){super({objectMode:!0}),this.textBuffer="";const t=MF(e);this.encoding=e.encoding||"utf8",this.decoder=new Vve;const r=this.push.bind(this);this.parser=new BF({featureCallback:t.parseFeatures?r:void 0,directiveCallback:t.parseDirectives?r:void 0,commentCallback:t.parseComments?r:void 0,sequenceCallback:t.parseSequences?r:void 0,errorCallback:s=>this.emit("error",s),bufferSize:t.bufferSize,disableDerivesFromReferences:t.disableDerivesFromReferences})}_addLine(e){e&&this.parser.addLine(e)}_nextText(e){const t=(this.textBuffer+e).split(/\r?\n/);this.textBuffer=t.pop()||"",t.forEach(r=>this._addLine(r))}_transform(e,t,r){this._nextText(this.decoder.write(e)),OI(r)}_flush(e){this.decoder.end&&this._nextText(this.decoder.end()),this.textBuffer!=null&&this._addLine(this.textBuffer),this.parser.finish(),OI(e)}}function vIe(n={}){return new mIe(n)}function IIe(n,e={}){if(!n)return[];const t=MF(e),r=[],s=r.push.bind(r),i=new BF({featureCallback:t.parseFeatures?s:void 0,directiveCallback:t.parseDirectives?s:void 0,commentCallback:t.parseComments?s:void 0,sequenceCallback:t.parseSequences?s:void 0,disableDerivesFromReferences:t.disableDerivesFromReferences||!1,bufferSize:1/0,errorCallback:a=>{throw a}});return n.split(/\r?\n/).forEach(i.addLine.bind(i)),i.finish(),r}function bIe(n){const e=[],t=[];n.forEach(s=>{"sequence"in s?t.push(s):e.push(s)});let r=e.map(ng).join("");return t.length&&(r+=`##FASTA
`,r+=t.map(pw).join("")),r}class PF extends EF.Transform{constructor(e={}){super(Object.assign(e,{objectMode:!0})),this.linesSinceLastSyncMark=0,this.haveWeEmittedData=!1,this.fastaMode=!1,this.minLinesBetweenSyncMarks=e.minSyncLines||100,this.insertVersionDirective=e.insertVersionDirective||!1}_transform(e,t,r){let s;if(!this.haveWeEmittedData&&this.insertVersionDirective){const i=Array.isArray(e)?e[0]:e;"directive"in i&&i.directive!=="gff-version"&&this.push(`##gff-version 3
`)}if("sequence"in e&&!this.fastaMode&&(this.push(`##FASTA
`),this.fastaMode=!0),Array.isArray(e)?s=e.map(ng).join(""):s=ng(e),this.push(s),this.linesSinceLastSyncMark>=this.minLinesBetweenSyncMarks)this.push(`###
`),this.linesSinceLastSyncMark=0;else{let i=0;for(let a=0;a<s.length;a+=1)s[a]===`
`&&(i+=1);this.linesSinceLastSyncMark+=i}this.haveWeEmittedData=!0,OI(r)}}function yIe(n={}){return new PF(n)}function xIe(n,e,t={}){const r={insertVersionDirective:!0,...t};return new Promise((s,i)=>{n.pipe(new PF(r)).on("end",()=>s(null)).on("error",i).pipe(e)})}const wIe={parseStream:vIe,parseStringSync:IIe,formatSync:bIe,formatStream:yIe,formatFile:xIe,util:gIe},SIe=Object.freeze(Object.defineProperty({__proto__:null,default:wIe},Symbol.toStringTag,{value:"Module"})),CIe=EE(SIe);(function(n,e){e.__esModule=!0,e.default=void 0;var t=s(CIe),r=s(zt);function s(o){return o&&o.__esModule?o:{default:o}}function i(o,c){var l=t.default.parseStringSync(o),u=[],f=[],d={};return l.forEach(function(p){if(p.sequence)f.push(p);else{var m=p[0];d[m.seq_id]||(d[m.seq_id]=[]);var I=m.attributes||{},v=r.default.get(I,"ID[0]");d[m.seq_id].push({name:v,start:m.start,end:m.end,strand:m.strand==="+"?1:-1,type:m.type})}}),f.forEach(function(p){var m=p.id,I={messages:[],success:!0,parsedSequence:{name:m,sequence:p.sequence,circular:!1,features:d[p.id]}};u.push(I)}),u}var a=i;e.default=a,n.exports=e.default})($I,$I.exports);var RIe=$I.exports,_I={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t=a(pu),r=s0,s=a0,i=zt;function a(m){return m&&m.__esModule?m:{default:m}}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return m};var m={},I=Object.prototype,v=I.hasOwnProperty,b=typeof Symbol=="function"?Symbol:{},y=b.iterator||"@@iterator",S=b.asyncIterator||"@@asyncIterator",w=b.toStringTag||"@@toStringTag";function C(ae,J,D){return Object.defineProperty(ae,J,{value:D,enumerable:!0,configurable:!0,writable:!0}),ae[J]}try{C({},"")}catch{C=function(D,P,Q){return D[P]=Q}}function N(ae,J,D,P){var Q=J&&J.prototype instanceof M?J:M,pe=Object.create(Q.prototype),Ee=new he(P||[]);return pe._invoke=function(L,q,Z){var se="suspendedStart";return function(ie,B){if(se==="executing")throw new Error("Generator is already running");if(se==="completed"){if(ie==="throw")throw B;return xe()}for(Z.method=ie,Z.arg=B;;){var R=Z.delegate;if(R){var k=me(R,Z);if(k){if(k===A)continue;return k}}if(Z.method==="next")Z.sent=Z._sent=Z.arg;else if(Z.method==="throw"){if(se==="suspendedStart")throw se="completed",Z.arg;Z.dispatchException(Z.arg)}else Z.method==="return"&&Z.abrupt("return",Z.arg);se="executing";var X=E(L,q,Z);if(X.type==="normal"){if(se=Z.done?"completed":"suspendedYield",X.arg===A)continue;return{value:X.arg,done:Z.done}}X.type==="throw"&&(se="completed",Z.method="throw",Z.arg=X.arg)}}}(ae,D,Ee),pe}function E(ae,J,D){try{return{type:"normal",arg:ae.call(J,D)}}catch(P){return{type:"throw",arg:P}}}m.wrap=N;var A={};function M(){}function z(){}function Y(){}var re={};C(re,y,function(){return this});var ne=Object.getPrototypeOf,le=ne&&ne(ne(Ne([])));le&&le!==I&&v.call(le,y)&&(re=le);var j=Y.prototype=M.prototype=Object.create(re);function ge(ae){["next","throw","return"].forEach(function(J){C(ae,J,function(D){return this._invoke(J,D)})})}function Se(ae,J){function D(Q,pe,Ee,L){var q=E(ae[Q],ae,pe);if(q.type!=="throw"){var Z=q.arg,se=Z.value;return se&&typeof se=="object"&&v.call(se,"__await")?J.resolve(se.__await).then(function(ie){D("next",ie,Ee,L)},function(ie){D("throw",ie,Ee,L)}):J.resolve(se).then(function(ie){Z.value=ie,Ee(Z)},function(ie){return D("throw",ie,Ee,L)})}L(q.arg)}var P;this._invoke=function(Q,pe){function Ee(){return new J(function(L,q){D(Q,pe,L,q)})}return P=P?P.then(Ee,Ee):Ee()}}function me(ae,J){var D=ae.iterator[J.method];if(D===void 0){if(J.delegate=null,J.method==="throw"){if(ae.iterator.return&&(J.method="return",J.arg=void 0,me(ae,J),J.method==="throw"))return A;J.method="throw",J.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var P=E(D,ae.iterator,J.arg);if(P.type==="throw")return J.method="throw",J.arg=P.arg,J.delegate=null,A;var Q=P.arg;return Q?Q.done?(J[ae.resultName]=Q.value,J.next=ae.nextLoc,J.method!=="return"&&(J.method="next",J.arg=void 0),J.delegate=null,A):Q:(J.method="throw",J.arg=new TypeError("iterator result is not an object"),J.delegate=null,A)}function ye(ae){var J={tryLoc:ae[0]};1 in ae&&(J.catchLoc=ae[1]),2 in ae&&(J.finallyLoc=ae[2],J.afterLoc=ae[3]),this.tryEntries.push(J)}function Ce(ae){var J=ae.completion||{};J.type="normal",delete J.arg,ae.completion=J}function he(ae){this.tryEntries=[{tryLoc:"root"}],ae.forEach(ye,this),this.reset(!0)}function Ne(ae){if(ae){var J=ae[y];if(J)return J.call(ae);if(typeof ae.next=="function")return ae;if(!isNaN(ae.length)){var D=-1,P=function Q(){for(;++D<ae.length;)if(v.call(ae,D))return Q.value=ae[D],Q.done=!1,Q;return Q.value=void 0,Q.done=!0,Q};return P.next=P}}return{next:xe}}function xe(){return{value:void 0,done:!0}}return z.prototype=Y,C(j,"constructor",Y),C(Y,"constructor",z),z.displayName=C(Y,w,"GeneratorFunction"),m.isGeneratorFunction=function(ae){var J=typeof ae=="function"&&ae.constructor;return!!J&&(J===z||(J.displayName||J.name)==="GeneratorFunction")},m.mark=function(ae){return Object.setPrototypeOf?Object.setPrototypeOf(ae,Y):(ae.__proto__=Y,C(ae,w,"GeneratorFunction")),ae.prototype=Object.create(j),ae},m.awrap=function(ae){return{__await:ae}},ge(Se.prototype),C(Se.prototype,S,function(){return this}),m.AsyncIterator=Se,m.async=function(ae,J,D,P,Q){Q===void 0&&(Q=Promise);var pe=new Se(N(ae,J,D,P),Q);return m.isGeneratorFunction(J)?pe:pe.next().then(function(Ee){return Ee.done?Ee.value:pe.next()})},ge(j),C(j,w,"Generator"),C(j,y,function(){return this}),C(j,"toString",function(){return"[object Generator]"}),m.keys=function(ae){var J=[];for(var D in ae)J.push(D);return J.reverse(),function P(){for(;J.length;){var Q=J.pop();if(Q in ae)return P.value=Q,P.done=!1,P}return P.done=!0,P}},m.values=Ne,he.prototype={constructor:he,reset:function(J){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Ce),!J)for(var D in this)D.charAt(0)==="t"&&v.call(this,D)&&!isNaN(+D.slice(1))&&(this[D]=void 0)},stop:function(){this.done=!0;var J=this.tryEntries[0].completion;if(J.type==="throw")throw J.arg;return this.rval},dispatchException:function(J){if(this.done)throw J;var D=this;function P(Z,se){return Ee.type="throw",Ee.arg=J,D.next=Z,se&&(D.method="next",D.arg=void 0),!!se}for(var Q=this.tryEntries.length-1;Q>=0;--Q){var pe=this.tryEntries[Q],Ee=pe.completion;if(pe.tryLoc==="root")return P("end");if(pe.tryLoc<=this.prev){var L=v.call(pe,"catchLoc"),q=v.call(pe,"finallyLoc");if(L&&q){if(this.prev<pe.catchLoc)return P(pe.catchLoc,!0);if(this.prev<pe.finallyLoc)return P(pe.finallyLoc)}else if(L){if(this.prev<pe.catchLoc)return P(pe.catchLoc,!0)}else{if(!q)throw new Error("try statement without catch or finally");if(this.prev<pe.finallyLoc)return P(pe.finallyLoc)}}}},abrupt:function(J,D){for(var P=this.tryEntries.length-1;P>=0;--P){var Q=this.tryEntries[P];if(Q.tryLoc<=this.prev&&v.call(Q,"finallyLoc")&&this.prev<Q.finallyLoc){var pe=Q;break}}pe&&(J==="break"||J==="continue")&&pe.tryLoc<=D&&D<=pe.finallyLoc&&(pe=null);var Ee=pe?pe.completion:{};return Ee.type=J,Ee.arg=D,pe?(this.method="next",this.next=pe.finallyLoc,A):this.complete(Ee)},complete:function(J,D){if(J.type==="throw")throw J.arg;return J.type==="break"||J.type==="continue"?this.next=J.arg:J.type==="return"?(this.rval=this.arg=J.arg,this.method="return",this.next="end"):J.type==="normal"&&D&&(this.next=D),A},finish:function(J){for(var D=this.tryEntries.length-1;D>=0;--D){var P=this.tryEntries[D];if(P.finallyLoc===J)return this.complete(P.completion,P.afterLoc),Ce(P),A}},catch:function(J){for(var D=this.tryEntries.length-1;D>=0;--D){var P=this.tryEntries[D];if(P.tryLoc===J){var Q=P.completion;if(Q.type==="throw"){var pe=Q.arg;Ce(P)}return pe}}throw new Error("illegal catch attempt")},delegateYield:function(J,D,P){return this.delegate={iterator:Ne(J),resultName:D,nextLoc:P},this.method==="next"&&(this.arg=void 0),A}},m}function c(m,I,v,b,y,S,w){try{var C=m[S](w),N=C.value}catch(E){v(E);return}C.done?I(N):Promise.resolve(N).then(b,y)}function l(m){return function(){var I=this,v=arguments;return new Promise(function(b,y){var S=m.apply(I,v);function w(N){c(S,b,y,w,C,"next",N)}function C(N){c(S,b,y,w,C,"throw",N)}w(void 0)})}}function u(m,I){return f.apply(this,arguments)}function f(){return f=l(o().mark(function m(I,v){var b,y,S,w,C;return o().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(v=v||{},b=function(M){return(0,t.default)(M,v)},E.prev=2,y=new s.XMLParser({isArray:function(){return!0}}).parse(I),S=(0,r.searchWholeObjByNameSimpleArray)("geneiousDocument",y),w=[],S!=null&&S.length){E.next=8;break}return E.abrupt("return",b({success:!1,messages:["Error: XML is not valid geneious format"]}));case 8:if((0,i.forEach)(S,function(A){var M={parsedSequence:null,messages:[],success:!0};try{M.parsedSequence=d(A,v),w.push(M)}catch(z){console.error("error:",z),console.error("error.stack: ",z.stack),w.push({success:!1,messages:["Error while parsing Geneious format"]})}}),C=(0,i.filter)(w,function(A){var M,z;return A==null||(M=A.parsedSequence)===null||M===void 0||(z=M.sequence)===null||z===void 0?void 0:z.length}),!C.length){E.next=12;break}return E.abrupt("return",C);case 12:return E.abrupt("return",b(w));case 15:return E.prev=15,E.t0=E.catch(2),console.error("e:",E.t0),E.abrupt("return",b({success:!1,messages:["Error parsing geneious to JSON"]}));case 19:case"end":return E.stop()}},m,null,[[2,15]])})),f.apply(this,arguments)}function d(m,I){var v=(0,r.searchWholeObjByNameSimple)("isCircular",m),b=(0,r.searchWholeObjByNameSimple)("originalElement",m);b=(0,r.searchWholeObjByNameSimple)("XMLSerialisableRootElement",b);var y=(0,r.searchWholeObjByNameSimple)("charSequence",b),S=(0,i.flatMap)((0,r.searchWholeObjByNameSimpleArray)("annotation",b),function(C){if(C){var N=(0,r.searchWholeObjByNameSimple)("description",C),E=(0,r.searchWholeObjByNameSimpleArray)("interval",C),A=(0,r.searchWholeObjByNameSimple)("type",C),M=E[0],z=E[E.length-1],Y=(0,r.searchWholeObjByNameSimple)("minimumIndex",M)-1,re=(0,r.searchWholeObjByNameSimple)("maximumIndex",z)-1,ne;E.length>1&&(ne=E.map(function(ge){var Se=(0,r.searchWholeObjByNameSimple)("minimumIndex",ge)-1,me=(0,r.searchWholeObjByNameSimple)("maximumIndex",ge)-1;return{start:Se,end:me}}));var le=(0,r.searchWholeObjByNameSimple)("direction",M)==="leftToRight"?1:-1,j=(0,r.searchWholeObjByNameSimple)("direction",M)==="none"?"NONE":void 0;return{name:N,type:A,locations:ne,arrowheadType:j,start:Y,end:re,strand:le}}}),w=(0,r.searchWholeObjByNameSimple)("name",b);return{sequence:y,circular:v,name:w,features:S}}var p=u;e.default=p,n.exports=e.default})(_I,_I.exports);var LF=_I.exports,FI={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t=i(pu),r=a0,s=zt;function i(p){return p&&p.__esModule?p:{default:p}}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return p};var p={},m=Object.prototype,I=m.hasOwnProperty,v=typeof Symbol=="function"?Symbol:{},b=v.iterator||"@@iterator",y=v.asyncIterator||"@@asyncIterator",S=v.toStringTag||"@@toStringTag";function w(xe,ae,J){return Object.defineProperty(xe,ae,{value:J,enumerable:!0,configurable:!0,writable:!0}),xe[ae]}try{w({},"")}catch{w=function(J,D,P){return J[D]=P}}function C(xe,ae,J,D){var P=ae&&ae.prototype instanceof A?ae:A,Q=Object.create(P.prototype),pe=new Ce(D||[]);return Q._invoke=function(Ee,L,q){var Z="suspendedStart";return function(se,ie){if(Z==="executing")throw new Error("Generator is already running");if(Z==="completed"){if(se==="throw")throw ie;return Ne()}for(q.method=se,q.arg=ie;;){var B=q.delegate;if(B){var R=Se(B,q);if(R){if(R===E)continue;return R}}if(q.method==="next")q.sent=q._sent=q.arg;else if(q.method==="throw"){if(Z==="suspendedStart")throw Z="completed",q.arg;q.dispatchException(q.arg)}else q.method==="return"&&q.abrupt("return",q.arg);Z="executing";var k=N(Ee,L,q);if(k.type==="normal"){if(Z=q.done?"completed":"suspendedYield",k.arg===E)continue;return{value:k.arg,done:q.done}}k.type==="throw"&&(Z="completed",q.method="throw",q.arg=k.arg)}}}(xe,J,pe),Q}function N(xe,ae,J){try{return{type:"normal",arg:xe.call(ae,J)}}catch(D){return{type:"throw",arg:D}}}p.wrap=C;var E={};function A(){}function M(){}function z(){}var Y={};w(Y,b,function(){return this});var re=Object.getPrototypeOf,ne=re&&re(re(he([])));ne&&ne!==m&&I.call(ne,b)&&(Y=ne);var le=z.prototype=A.prototype=Object.create(Y);function j(xe){["next","throw","return"].forEach(function(ae){w(xe,ae,function(J){return this._invoke(ae,J)})})}function ge(xe,ae){function J(P,Q,pe,Ee){var L=N(xe[P],xe,Q);if(L.type!=="throw"){var q=L.arg,Z=q.value;return Z&&typeof Z=="object"&&I.call(Z,"__await")?ae.resolve(Z.__await).then(function(se){J("next",se,pe,Ee)},function(se){J("throw",se,pe,Ee)}):ae.resolve(Z).then(function(se){q.value=se,pe(q)},function(se){return J("throw",se,pe,Ee)})}Ee(L.arg)}var D;this._invoke=function(P,Q){function pe(){return new ae(function(Ee,L){J(P,Q,Ee,L)})}return D=D?D.then(pe,pe):pe()}}function Se(xe,ae){var J=xe.iterator[ae.method];if(J===void 0){if(ae.delegate=null,ae.method==="throw"){if(xe.iterator.return&&(ae.method="return",ae.arg=void 0,Se(xe,ae),ae.method==="throw"))return E;ae.method="throw",ae.arg=new TypeError("The iterator does not provide a 'throw' method")}return E}var D=N(J,xe.iterator,ae.arg);if(D.type==="throw")return ae.method="throw",ae.arg=D.arg,ae.delegate=null,E;var P=D.arg;return P?P.done?(ae[xe.resultName]=P.value,ae.next=xe.nextLoc,ae.method!=="return"&&(ae.method="next",ae.arg=void 0),ae.delegate=null,E):P:(ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,E)}function me(xe){var ae={tryLoc:xe[0]};1 in xe&&(ae.catchLoc=xe[1]),2 in xe&&(ae.finallyLoc=xe[2],ae.afterLoc=xe[3]),this.tryEntries.push(ae)}function ye(xe){var ae=xe.completion||{};ae.type="normal",delete ae.arg,xe.completion=ae}function Ce(xe){this.tryEntries=[{tryLoc:"root"}],xe.forEach(me,this),this.reset(!0)}function he(xe){if(xe){var ae=xe[b];if(ae)return ae.call(xe);if(typeof xe.next=="function")return xe;if(!isNaN(xe.length)){var J=-1,D=function P(){for(;++J<xe.length;)if(I.call(xe,J))return P.value=xe[J],P.done=!1,P;return P.value=void 0,P.done=!0,P};return D.next=D}}return{next:Ne}}function Ne(){return{value:void 0,done:!0}}return M.prototype=z,w(le,"constructor",z),w(z,"constructor",M),M.displayName=w(z,S,"GeneratorFunction"),p.isGeneratorFunction=function(xe){var ae=typeof xe=="function"&&xe.constructor;return!!ae&&(ae===M||(ae.displayName||ae.name)==="GeneratorFunction")},p.mark=function(xe){return Object.setPrototypeOf?Object.setPrototypeOf(xe,z):(xe.__proto__=z,w(xe,S,"GeneratorFunction")),xe.prototype=Object.create(le),xe},p.awrap=function(xe){return{__await:xe}},j(ge.prototype),w(ge.prototype,y,function(){return this}),p.AsyncIterator=ge,p.async=function(xe,ae,J,D,P){P===void 0&&(P=Promise);var Q=new ge(C(xe,ae,J,D),P);return p.isGeneratorFunction(ae)?Q:Q.next().then(function(pe){return pe.done?pe.value:Q.next()})},j(le),w(le,S,"Generator"),w(le,b,function(){return this}),w(le,"toString",function(){return"[object Generator]"}),p.keys=function(xe){var ae=[];for(var J in xe)ae.push(J);return ae.reverse(),function D(){for(;ae.length;){var P=ae.pop();if(P in xe)return D.value=P,D.done=!1,D}return D.done=!0,D}},p.values=he,Ce.prototype={constructor:Ce,reset:function(ae){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ye),!ae)for(var J in this)J.charAt(0)==="t"&&I.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=void 0)},stop:function(){this.done=!0;var ae=this.tryEntries[0].completion;if(ae.type==="throw")throw ae.arg;return this.rval},dispatchException:function(ae){if(this.done)throw ae;var J=this;function D(q,Z){return pe.type="throw",pe.arg=ae,J.next=q,Z&&(J.method="next",J.arg=void 0),!!Z}for(var P=this.tryEntries.length-1;P>=0;--P){var Q=this.tryEntries[P],pe=Q.completion;if(Q.tryLoc==="root")return D("end");if(Q.tryLoc<=this.prev){var Ee=I.call(Q,"catchLoc"),L=I.call(Q,"finallyLoc");if(Ee&&L){if(this.prev<Q.catchLoc)return D(Q.catchLoc,!0);if(this.prev<Q.finallyLoc)return D(Q.finallyLoc)}else if(Ee){if(this.prev<Q.catchLoc)return D(Q.catchLoc,!0)}else{if(!L)throw new Error("try statement without catch or finally");if(this.prev<Q.finallyLoc)return D(Q.finallyLoc)}}}},abrupt:function(ae,J){for(var D=this.tryEntries.length-1;D>=0;--D){var P=this.tryEntries[D];if(P.tryLoc<=this.prev&&I.call(P,"finallyLoc")&&this.prev<P.finallyLoc){var Q=P;break}}Q&&(ae==="break"||ae==="continue")&&Q.tryLoc<=J&&J<=Q.finallyLoc&&(Q=null);var pe=Q?Q.completion:{};return pe.type=ae,pe.arg=J,Q?(this.method="next",this.next=Q.finallyLoc,E):this.complete(pe)},complete:function(ae,J){if(ae.type==="throw")throw ae.arg;return ae.type==="break"||ae.type==="continue"?this.next=ae.arg:ae.type==="return"?(this.rval=this.arg=ae.arg,this.method="return",this.next="end"):ae.type==="normal"&&J&&(this.next=J),E},finish:function(ae){for(var J=this.tryEntries.length-1;J>=0;--J){var D=this.tryEntries[J];if(D.finallyLoc===ae)return this.complete(D.completion,D.afterLoc),ye(D),E}},catch:function(ae){for(var J=this.tryEntries.length-1;J>=0;--J){var D=this.tryEntries[J];if(D.tryLoc===ae){var P=D.completion;if(P.type==="throw"){var Q=P.arg;ye(D)}return Q}}throw new Error("illegal catch attempt")},delegateYield:function(ae,J,D){return this.delegate={iterator:he(ae),resultName:J,nextLoc:D},this.method==="next"&&(this.arg=void 0),E}},p}function o(p,m,I,v,b,y,S){try{var w=p[y](S),C=w.value}catch(N){I(N);return}w.done?m(C):Promise.resolve(C).then(v,b)}function c(p){return function(){var m=this,I=arguments;return new Promise(function(v,b){var y=p.apply(m,I);function S(C){o(y,v,b,S,w,"next",C)}function w(C){o(y,v,b,S,w,"throw",C)}S(void 0)})}}function l(p,m){return u.apply(this,arguments)}function u(){return u=c(a().mark(function p(m,I){var v,b,y,S,w,C;return a().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(I=I||{},v=function(M){return(0,t.default)(M,I)},E.prev=2,b=new r.XMLParser({}).parse(m),y=b["seq:seq"],S=[],y){E.next=8;break}return E.abrupt("return",v({success:!1,messages:["Error: XML is not valid jbei format"]}));case 8:w={parsedSequence:null,messages:[],success:!0};try{w.parsedSequence=f(y,I),S.push(w)}catch(A){console.error("error:",A),console.error("error.stack: ",A.stack),S.push({success:!1,messages:["Error while parsing JBEI format"]})}if(C=(0,s.filter)(S,function(A){var M,z;return A==null||(M=A.parsedSequence)===null||M===void 0||(z=M.sequence)===null||z===void 0?void 0:z.length}),!C.length){E.next=13;break}return E.abrupt("return",C);case 13:return E.abrupt("return",v(S));case 16:return E.prev=16,E.t0=E.catch(2),console.error("e:",E.t0),E.abrupt("return",v({success:!1,messages:["Error parsing jbei to JSON"]}));case 20:case"end":return E.stop()}},p,null,[[2,16]])})),u.apply(this,arguments)}function f(p,m){var I=p["seq:sequence"],v=p["seq:name"],b=p["seq:circular"],y=p["seq:features"]["seq:feature"];return{sequence:I,circular:b,name:v,features:(Array.isArray(y)?y:[y]).map(function(S){var w=S["seq:complement"],C=S["seq:label"],N=S["seq:type"],E=S["seq:location"],A,M,z=Array.isArray(E)?E:[E],Y=z.map(function(re,ne){var le=re["seq:genbankStart"],j=re["seq:end"];return ne===0&&(A=le-1),ne===z.length-1&&(M=j-1),{start:le-1,end:j-1}});return{start:A,end:M,locations:Y.length>1?Y:void 0,name:C,type:N,strand:w?-1:1}})}}var d=l;e.default=d,n.exports=e.default})(FI,FI.exports);var UF=FI.exports,Dt={},zF={};(function(n){var e={};n.default=function(t,r,s,i,a){var o=new Worker(e[r]||(e[r]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(c){var l=c.data,u=l.$e$;if(u){var f=new Error(u[0]);f.code=u[1],f.stack=u[2],a(f,null)}else a(null,l)},o.postMessage(s,i),o}})(zF);var kIe=zF,sn=Uint8Array,ts=Uint16Array,vu=Uint32Array,Iu=new sn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bu=new sn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rf=new sn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),VF=function(n,e){for(var t=new ts(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var s=new vu(t[30]),r=1;r<30;++r)for(var i=t[r];i<t[r+1];++i)s[i]=i-t[r]<<5|r;return[t,s]},WF=VF(Iu,2),gw=WF[0],rg=WF[1];gw[28]=258,rg[258]=28;var GF=VF(bu,0),HF=GF[0],DI=GF[1],kf=new ts(32768);for(var Un=0;Un<32768;++Un){var uo=(Un&43690)>>>1|(Un&21845)<<1;uo=(uo&52428)>>>2|(uo&13107)<<2,uo=(uo&61680)>>>4|(uo&3855)<<4,kf[Un]=((uo&65280)>>>8|(uo&255)<<8)>>>1}var gi=function(n,e,t){for(var r=n.length,s=0,i=new ts(e);s<r;++s)n[s]&&++i[n[s]-1];var a=new ts(e);for(s=0;s<e;++s)a[s]=a[s-1]+i[s-1]<<1;var o;if(t){o=new ts(1<<e);var c=15-e;for(s=0;s<r;++s)if(n[s])for(var l=s<<4|n[s],u=e-n[s],f=a[n[s]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)o[kf[f]>>>c]=l}else for(o=new ts(r),s=0;s<r;++s)n[s]&&(o[s]=kf[a[n[s]-1]++]>>>15-n[s]);return o},ja=new sn(288);for(var Un=0;Un<144;++Un)ja[Un]=8;for(var Un=144;Un<256;++Un)ja[Un]=9;for(var Un=256;Un<280;++Un)ja[Un]=7;for(var Un=280;Un<288;++Un)ja[Un]=8;var ql=new sn(32);for(var Un=0;Un<32;++Un)ql[Un]=5;var qF=gi(ja,9,0),jF=gi(ja,9,1),KF=gi(ql,5,0),XF=gi(ql,5,1),xp=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},ai=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},wp=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},Qh=function(n){return(n+7)/8|0},mi=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var r=new(n.BYTES_PER_ELEMENT==2?ts:n.BYTES_PER_ELEMENT==4?vu:sn)(t-e);return r.set(n.subarray(e,t)),r};Dt.FlateErrorCode={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14};var YF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Tt=function(n,e,t){var r=new Error(e||YF[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,Tt),!t)throw r;return r},ed=function(n,e,t){var r=n.length;if(!r||t&&t.f&&!t.l)return e||new sn(0);var s=!e||t,i=!t||t.i;t||(t={}),e||(e=new sn(r*3));var a=function(D){var P=e.length;if(D>P){var Q=new sn(Math.max(P*2,D));Q.set(e),e=Q}},o=t.f||0,c=t.p||0,l=t.b||0,u=t.l,f=t.d,d=t.m,p=t.n,m=r*8;do{if(!u){o=ai(n,c,1);var I=ai(n,c+1,3);if(c+=3,I)if(I==1)u=jF,f=XF,d=9,p=5;else if(I==2){var S=ai(n,c,31)+257,w=ai(n,c+10,15)+4,C=S+ai(n,c+5,31)+1;c+=14;for(var N=new sn(C),E=new sn(19),A=0;A<w;++A)E[Rf[A]]=ai(n,c+A*3,7);c+=w*3;for(var M=xp(E),z=(1<<M)-1,Y=gi(E,M,1),A=0;A<C;){var re=Y[ai(n,c,z)];c+=re&15;var v=re>>>4;if(v<16)N[A++]=v;else{var ne=0,le=0;for(v==16?(le=3+ai(n,c,3),c+=2,ne=N[A-1]):v==17?(le=3+ai(n,c,7),c+=3):v==18&&(le=11+ai(n,c,127),c+=7);le--;)N[A++]=ne}}var j=N.subarray(0,S),ge=N.subarray(S);d=xp(j),p=xp(ge),u=gi(j,d,1),f=gi(ge,p,1)}else Tt(1);else{var v=Qh(c)+4,b=n[v-4]|n[v-3]<<8,y=v+b;if(y>r){i&&Tt(0);break}s&&a(l+b),e.set(n.subarray(v,y),l),t.b=l+=b,t.p=c=y*8,t.f=o;continue}if(c>m){i&&Tt(0);break}}s&&a(l+131072);for(var Se=(1<<d)-1,me=(1<<p)-1,ye=c;;ye=c){var ne=u[wp(n,c)&Se],Ce=ne>>>4;if(c+=ne&15,c>m){i&&Tt(0);break}if(ne||Tt(2),Ce<256)e[l++]=Ce;else if(Ce==256){ye=c,u=null;break}else{var he=Ce-254;if(Ce>264){var A=Ce-257,Ne=Iu[A];he=ai(n,c,(1<<Ne)-1)+gw[A],c+=Ne}var xe=f[wp(n,c)&me],ae=xe>>>4;xe||Tt(3),c+=xe&15;var ge=HF[ae];if(ae>3){var Ne=bu[ae];ge+=wp(n,c)&(1<<Ne)-1,c+=Ne}if(c>m){i&&Tt(0);break}s&&a(l+131072);for(var J=l+he;l<J;l+=4)e[l]=e[l-ge],e[l+1]=e[l+1-ge],e[l+2]=e[l+2-ge],e[l+3]=e[l+3-ge];l=J}}t.l=u,t.p=ye,t.b=l,t.f=o,u&&(o=1,t.m=d,t.d=f,t.n=p)}while(!o);return l==e.length?e:mi(e,0,l)},Ji=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8},Il=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>>8,n[r+2]|=t>>>16},Sp=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var s=t.length,i=t.slice();if(!s)return[za,0];if(s==1){var a=new sn(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort(function(C,N){return C.f-N.f}),t.push({s:-1,f:25001});var o=t[0],c=t[1],l=0,u=1,f=2;for(t[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=s-1;)o=t[t[l].f<t[f].f?l++:f++],c=t[l!=u&&t[l].f<t[f].f?l++:f++],t[u++]={s:-1,f:o.f+c.f,l:o,r:c};for(var d=i[0].s,r=1;r<s;++r)i[r].s>d&&(d=i[r].s);var p=new ts(d+1),m=sg(t[u-1],p,0);if(m>e){var r=0,I=0,v=m-e,b=1<<v;for(i.sort(function(N,E){return p[E.s]-p[N.s]||N.f-E.f});r<s;++r){var y=i[r].s;if(p[y]>e)I+=b-(1<<m-p[y]),p[y]=e;else break}for(I>>>=v;I>0;){var S=i[r].s;p[S]<e?I-=1<<e-p[S]++-1:++r}for(;r>=0&&I;--r){var w=i[r].s;p[w]==e&&(--p[w],++I)}m=e}return[new sn(p),m]},sg=function(n,e,t){return n.s==-1?Math.max(sg(n.l,e,t+1),sg(n.r,e,t+1)):e[n.s]=t},BI=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new ts(++e),r=0,s=n[0],i=1,a=function(c){t[r++]=c},o=1;o<=e;++o)if(n[o]==s&&o!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(s),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(s);i=1,s=n[o]}return[t.subarray(0,r),e]},bl=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},ig=function(n,e,t){var r=t.length,s=Qh(e+2);n[s]=r&255,n[s+1]=r>>>8,n[s+2]=n[s]^255,n[s+3]=n[s+1]^255;for(var i=0;i<r;++i)n[s+i+4]=t[i];return(s+4+r)*8},MI=function(n,e,t,r,s,i,a,o,c,l,u){Ji(e,u++,t),++s[256];for(var f=Sp(s,15),d=f[0],p=f[1],m=Sp(i,15),I=m[0],v=m[1],b=BI(d),y=b[0],S=b[1],w=BI(I),C=w[0],N=w[1],E=new ts(19),A=0;A<y.length;++A)E[y[A]&31]++;for(var A=0;A<C.length;++A)E[C[A]&31]++;for(var M=Sp(E,7),z=M[0],Y=M[1],re=19;re>4&&!z[Rf[re-1]];--re);var ne=l+5<<3,le=bl(s,ja)+bl(i,ql)+a,j=bl(s,d)+bl(i,I)+a+14+3*re+bl(E,z)+(2*E[16]+3*E[17]+7*E[18]);if(ne<=le&&ne<=j)return ig(e,u,n.subarray(c,c+l));var ge,Se,me,ye;if(Ji(e,u,1+(j<le)),u+=2,j<le){ge=gi(d,p,0),Se=d,me=gi(I,v,0),ye=I;var Ce=gi(z,Y,0);Ji(e,u,S-257),Ji(e,u+5,N-1),Ji(e,u+10,re-4),u+=14;for(var A=0;A<re;++A)Ji(e,u+3*A,z[Rf[A]]);u+=3*re;for(var he=[y,C],Ne=0;Ne<2;++Ne)for(var xe=he[Ne],A=0;A<xe.length;++A){var ae=xe[A]&31;Ji(e,u,Ce[ae]),u+=z[ae],ae>15&&(Ji(e,u,xe[A]>>>5&127),u+=xe[A]>>>12)}}else ge=qF,Se=ja,me=KF,ye=ql;for(var A=0;A<o;++A)if(r[A]>255){var ae=r[A]>>>18&31;Il(e,u,ge[ae+257]),u+=Se[ae+257],ae>7&&(Ji(e,u,r[A]>>>23&31),u+=Iu[ae]);var J=r[A]&31;Il(e,u,me[J]),u+=ye[J],J>3&&(Il(e,u,r[A]>>>5&8191),u+=bu[J])}else Il(e,u,ge[r[A]]),u+=Se[r[A]];return Il(e,u,ge[256]),u+Se[256]},ZF=new vu([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),za=new sn(0),JF=function(n,e,t,r,s,i){var a=n.length,o=new sn(r+a+5*(1+Math.ceil(a/7e3))+s),c=o.subarray(r,o.length-s),l=0;if(!e||a<8)for(var u=0;u<=a;u+=65535){var f=u+65535;f>=a&&(c[l>>3]=i),l=ig(c,l+1,n.subarray(u,f))}else{for(var d=ZF[e-1],p=d>>>13,m=d&8191,I=(1<<t)-1,v=new ts(32768),b=new ts(I+1),y=Math.ceil(t/3),S=2*y,w=function(se){return(n[se]^n[se+1]<<y^n[se+2]<<S)&I},C=new vu(25e3),N=new ts(288),E=new ts(32),A=0,M=0,u=0,z=0,Y=0,re=0;u<a;++u){var ne=w(u),le=u&32767,j=b[ne];if(v[le]=j,b[ne]=le,Y<=u){var ge=a-u;if((A>7e3||z>24576)&&ge>423){l=MI(n,c,0,C,N,E,M,z,re,u-re,l),z=A=M=0,re=u;for(var Se=0;Se<286;++Se)N[Se]=0;for(var Se=0;Se<30;++Se)E[Se]=0}var me=2,ye=0,Ce=m,he=le-j&32767;if(ge>2&&ne==w(u-he))for(var Ne=Math.min(p,ge)-1,xe=Math.min(32767,u),ae=Math.min(258,ge);he<=xe&&--Ce&&le!=j;){if(n[u+me]==n[u+me-he]){for(var J=0;J<ae&&n[u+J]==n[u+J-he];++J);if(J>me){if(me=J,ye=he,J>Ne)break;for(var D=Math.min(he,J-2),P=0,Se=0;Se<D;++Se){var Q=u-he+Se+32768&32767,pe=v[Q],Ee=Q-pe+32768&32767;Ee>P&&(P=Ee,j=Q)}}}le=j,j=v[le],he+=le-j+32768&32767}if(ye){C[z++]=268435456|rg[me]<<18|DI[ye];var L=rg[me]&31,q=DI[ye]&31;M+=Iu[L]+bu[q],++N[257+L],++E[q],Y=u+me,++A}else C[z++]=n[u],++N[n[u]]}}l=MI(n,c,i,C,N,E,M,z,re,u-re,l),!i&&l&7&&(l=ig(c,l+1,za))}return mi(o,0,r+Qh(l)+s)},QF=function(){for(var n=new Int32Array(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(t&1&&-306674912)^t>>>1;n[e]=t}return n}(),yu=function(){var n=-1;return{p:function(e){for(var t=n,r=0;r<e.length;++r)t=QF[t&255^e[r]]^t>>>8;n=t},d:function(){return~n}}},mw=function(){var n=1,e=0;return{p:function(t){for(var r=n,s=e,i=t.length|0,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)s+=r+=t[a];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}n=r,e=s},d:function(){return n%=65521,e%=65521,(n&255)<<24|n>>>8<<16|(e&255)<<8|e>>>8}}},jc=function(n,e,t,r,s){return JF(n,e.level==null?6:e.level,e.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):12+e.mem,t,r,!s)},td=function(n,e){var t={};for(var r in n)t[r]=n[r];for(var r in e)t[r]=e[r];return t},Hk=function(n,e,t){for(var r=n(),s=n.toString(),i=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],c=i[a];if(typeof o=="function"){e+=";"+c+"=";var l=o.toString();if(o.prototype)if(l.indexOf("[native code]")!=-1){var u=l.indexOf(" ",8)+1;e+=l.slice(u,l.indexOf("(",u))}else{e+=l;for(var f in o.prototype)e+=";"+c+".prototype."+f+"="+o.prototype[f].toString()}else e+=l}else t[c]=o}return[e,t]},dp=[],EIe=function(n){var e=[];for(var t in n)n[t].buffer&&e.push((n[t]=new n[t].constructor(n[t])).buffer);return e},eD=function(n,e,t,r){var s;if(!dp[t]){for(var i="",a={},o=n.length-1,c=0;c<o;++c)s=Hk(n[c],i,a),i=s[0],a=s[1];dp[t]=Hk(n[o],i,a)}var l=td({},dp[t][1]);return kIe.default(dp[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,l,EIe(l),r)},xu=function(){return[sn,ts,vu,Iu,bu,Rf,gw,HF,jF,XF,kf,YF,gi,xp,ai,wp,Qh,mi,Tt,ed,Ru,Ho,vw]},wu=function(){return[sn,ts,vu,Iu,bu,Rf,rg,DI,qF,ja,KF,ql,kf,ZF,za,gi,Ji,Il,Sp,sg,BI,bl,ig,MI,Qh,mi,JF,jc,nd,Ho]},tD=function(){return[Iw,yw,xn,yu,QF]},nD=function(){return[bw,iD]},rD=function(){return[xw,xn,mw]},sD=function(){return[aD]},Ho=function(n){return postMessage(n,[n.buffer])},vw=function(n){return n&&n.size&&new sn(n.size)},Su=function(n,e,t,r,s,i){var a=eD(t,r,s,function(o,c){a.terminate(),i(o,c)});return a.postMessage([n,e],e.consume?[n.buffer]:[]),function(){a.terminate()}},yi=function(n){return n.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return n.push(e.data[0],e.data[1])}},Cu=function(n,e,t,r,s){var i,a=eD(n,r,s,function(o,c){o?(a.terminate(),e.ondata.call(e,o)):(c[1]&&a.terminate(),e.ondata.call(e,o,c[0],c[1]))});a.postMessage(t),e.push=function(o,c){e.ondata||Tt(5),i&&e.ondata(Tt(4,0,1),null,!!c),a.postMessage([o,i=c],[o.buffer])},e.terminate=function(){a.terminate()}},fs=function(n,e){return n[e]|n[e+1]<<8},pr=function(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0},wv=function(n,e){return pr(n,e)+pr(n,e+4)*4294967296},xn=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},Iw=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:e.level==9?2:0,n[9]=3,e.mtime!=0&&xn(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var r=0;r<=t.length;++r)n[r+10]=t.charCodeAt(r)}},bw=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&Tt(6,"invalid gzip data");var e=n[3],t=10;e&4&&(t+=n[10]|(n[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!n[t++]);return t+(e&2)},iD=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},yw=function(n){return 10+(n.filename&&n.filename.length+1||0)},xw=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;n[0]=120,n[1]=r<<6|(r?32-2*r:1)},aD=function(n){((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&Tt(6,"invalid zlib data"),n[1]&32&&Tt(6,"invalid zlib data: preset dictionaries not supported")};function ww(n,e){return!e&&typeof n=="function"&&(e=n,n={}),this.ondata=e,n}var Sa=function(){function n(e,t){!t&&typeof e=="function"&&(t=e,e={}),this.ondata=t,this.o=e||{}}return n.prototype.p=function(e,t){this.ondata(jc(e,this.o,0,0,!t),t)},n.prototype.push=function(e,t){this.ondata||Tt(5),this.d&&Tt(4),this.d=t,this.p(e,t||!1)},n}();Dt.Deflate=Sa;var oD=function(){function n(e,t){Cu([wu,function(){return[yi,Sa]}],this,ww.call(this,e,t),function(r){var s=new Sa(r.data);onmessage=yi(s)},6)}return n}();Dt.AsyncDeflate=oD;function cD(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[wu],function(r){return Ho(nd(r.data[0],r.data[1]))},0,t)}Dt.deflate=cD;function nd(n,e){return jc(n,e||{},0,0)}Dt.deflateSync=nd;var Es=function(){function n(e){this.s={},this.p=new sn(0),this.ondata=e}return n.prototype.e=function(e){this.ondata||Tt(5),this.d&&Tt(4);var t=this.p.length,r=new sn(t+e.length);r.set(this.p),r.set(e,t),this.p=r},n.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=ed(this.p,this.o,this.s);this.ondata(mi(r,t,this.s.b),this.d),this.o=mi(r,this.s.b-32768),this.s.b=this.o.length,this.p=mi(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,t){this.e(e),this.c(t)},n}();Dt.Inflate=Es;var Sw=function(){function n(e){this.ondata=e,Cu([xu,function(){return[yi,Es]}],this,0,function(){var t=new Es;onmessage=yi(t)},7)}return n}();Dt.AsyncInflate=Sw;function Cw(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[xu],function(r){return Ho(Ru(r.data[0],vw(r.data[1])))},1,t)}Dt.inflate=Cw;function Ru(n,e){return ed(n,e)}Dt.inflateSync=Ru;var ag=function(){function n(e,t){this.c=yu(),this.l=0,this.v=1,Sa.call(this,e,t)}return n.prototype.push=function(e,t){Sa.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var r=jc(e,this.o,this.v&&yw(this.o),t&&8,!t);this.v&&(Iw(r,this.o),this.v=0),t&&(xn(r,r.length-8,this.c.d()),xn(r,r.length-4,this.l)),this.ondata(r,t)},n}();Dt.Gzip=ag;Dt.Compress=ag;var lD=function(){function n(e,t){Cu([wu,tD,function(){return[yi,Sa,ag]}],this,ww.call(this,e,t),function(r){var s=new ag(r.data);onmessage=yi(s)},8)}return n}();Dt.AsyncGzip=lD;Dt.AsyncCompress=lD;function uD(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[wu,tD,function(){return[og]}],function(r){return Ho(og(r.data[0],r.data[1]))},2,t)}Dt.gzip=uD;Dt.compress=uD;function og(n,e){e||(e={});var t=yu(),r=n.length;t.p(n);var s=jc(n,e,yw(e),8),i=s.length;return Iw(s,e),xn(s,i-8,t.d()),xn(s,i-4,r),s}Dt.gzipSync=og;Dt.compressSync=og;var cg=function(){function n(e){this.v=1,Es.call(this,e)}return n.prototype.push=function(e,t){if(Es.prototype.e.call(this,e),this.v){var r=this.p.length>3?bw(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}t&&(this.p.length<8&&Tt(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),Es.prototype.c.call(this,t)},n}();Dt.Gunzip=cg;var fD=function(){function n(e){this.ondata=e,Cu([xu,nD,function(){return[yi,Es,cg]}],this,0,function(){var t=new cg;onmessage=yi(t)},9)}return n}();Dt.AsyncGunzip=fD;function hD(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[xu,nD,function(){return[lg]}],function(r){return Ho(lg(r.data[0]))},3,t)}Dt.gunzip=hD;function lg(n,e){return ed(n.subarray(bw(n),-8),e||new sn(iD(n)))}Dt.gunzipSync=lg;var PI=function(){function n(e,t){this.c=mw(),this.v=1,Sa.call(this,e,t)}return n.prototype.push=function(e,t){Sa.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e);var r=jc(e,this.o,this.v&&2,t&&4,!t);this.v&&(xw(r,this.o),this.v=0),t&&xn(r,r.length-4,this.c.d()),this.ondata(r,t)},n}();Dt.Zlib=PI;var TIe=function(){function n(e,t){Cu([wu,rD,function(){return[yi,Sa,PI]}],this,ww.call(this,e,t),function(r){var s=new PI(r.data);onmessage=yi(s)},10)}return n}();Dt.AsyncZlib=TIe;function AIe(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[wu,rD,function(){return[LI]}],function(r){return Ho(LI(r.data[0],r.data[1]))},4,t)}Dt.zlib=AIe;function LI(n,e){e||(e={});var t=mw();t.p(n);var r=jc(n,e,2,4);return xw(r,e),xn(r,r.length-4,t.d()),r}Dt.zlibSync=LI;var ug=function(){function n(e){this.v=1,Es.call(this,e)}return n.prototype.push=function(e,t){if(Es.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}t&&(this.p.length<4&&Tt(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Es.prototype.c.call(this,t)},n}();Dt.Unzlib=ug;var dD=function(){function n(e){this.ondata=e,Cu([xu,sD,function(){return[yi,Es,ug]}],this,0,function(){var t=new ug;onmessage=yi(t)},11)}return n}();Dt.AsyncUnzlib=dD;function pD(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),Su(n,e,[xu,sD,function(){return[fg]}],function(r){return Ho(fg(r.data[0],vw(r.data[1])))},5,t)}Dt.unzlib=pD;function fg(n,e){return ed((aD(n),n.subarray(2,-4)),e)}Dt.unzlibSync=fg;var gD=function(){function n(e){this.G=cg,this.I=Es,this.Z=ug,this.ondata=e}return n.prototype.push=function(e,t){if(this.ondata||Tt(5),this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var r=new sn(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var s=this,i=function(){s.ondata.apply(s,arguments)};this.s=this.p[0]==31&&this.p[1]==139&&this.p[2]==8?new this.G(i):(this.p[0]&15)!=8||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,t),this.p=null}}},n}();Dt.Decompress=gD;var $Ie=function(){function n(e){this.G=fD,this.I=Sw,this.Z=dD,this.ondata=e}return n.prototype.push=function(e,t){gD.prototype.push.call(this,e,t)},n}();Dt.AsyncDecompress=$Ie;function NIe(n,e,t){return t||(t=e,e={}),typeof t!="function"&&Tt(7),n[0]==31&&n[1]==139&&n[2]==8?hD(n,e,t):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?Cw(n,e,t):pD(n,e,t)}Dt.decompress=NIe;function OIe(n,e){return n[0]==31&&n[1]==139&&n[2]==8?lg(n,e):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?Ru(n,e):fg(n,e)}Dt.decompressSync=OIe;var Rw=function(n,e,t,r){for(var s in n){var i=n[s],a=e+s,o=r;Array.isArray(i)&&(o=td(r,i[1]),i=i[0]),i instanceof sn?t[a]=[i,o]:(t[a+="/"]=[new sn(0),o],Rw(i,a,t,r))}},qk=typeof TextEncoder<"u"&&new TextEncoder,UI=typeof TextDecoder<"u"&&new TextDecoder,mD=0;try{UI.decode(za,{stream:!0}),mD=1}catch{}var vD=function(n){for(var e="",t=0;;){var r=n[t++],s=(r>127)+(r>223)+(r>239);if(t+s>n.length)return[e,mi(n,t-1)];s?s==3?(r=((r&15)<<18|(n[t++]&63)<<12|(n[t++]&63)<<6|n[t++]&63)-65536,e+=String.fromCharCode(55296|r>>10,56320|r&1023)):s&1?e+=String.fromCharCode((r&31)<<6|n[t++]&63):e+=String.fromCharCode((r&15)<<12|(n[t++]&63)<<6|n[t++]&63):e+=String.fromCharCode(r)}},_Ie=function(){function n(e){this.ondata=e,mD?this.t=new TextDecoder:this.p=za}return n.prototype.push=function(e,t){if(this.ondata||Tt(5),t=!!t,this.t){this.ondata(this.t.decode(e,{stream:!0}),t),t&&(this.t.decode().length&&Tt(8),this.t=null);return}this.p||Tt(4);var r=new sn(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var s=vD(r),i=s[0],a=s[1];t?(a.length&&Tt(8),this.p=null):this.p=a,this.ondata(i,t)},n}();Dt.DecodeUTF8=_Ie;var FIe=function(){function n(e){this.ondata=e}return n.prototype.push=function(e,t){this.ondata||Tt(5),this.d&&Tt(4),this.ondata(Oo(e),this.d=t||!1)},n}();Dt.EncodeUTF8=FIe;function Oo(n,e){if(e){for(var t=new sn(n.length),r=0;r<n.length;++r)t[r]=n.charCodeAt(r);return t}if(qk)return qk.encode(n);for(var s=n.length,i=new sn(n.length+(n.length>>1)),a=0,o=function(u){i[a++]=u},r=0;r<s;++r){if(a+5>i.length){var c=new sn(a+8+(s-r<<1));c.set(i),i=c}var l=n.charCodeAt(r);l<128||e?o(l):l<2048?(o(192|l>>6),o(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|n.charCodeAt(++r)&1023,o(240|l>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|l&63)):(o(224|l>>12),o(128|l>>6&63),o(128|l&63))}return mi(i,0,a)}Dt.strToU8=Oo;function kw(n,e){if(e){for(var t="",r=0;r<n.length;r+=16384)t+=String.fromCharCode.apply(null,n.subarray(r,r+16384));return t}else{if(UI)return UI.decode(n);var s=vD(n),i=s[0],a=s[1];return a.length&&Tt(8),i}}Dt.strFromU8=kw;var ID=function(n){return n==1?3:n<6?2:n==9?1:0},bD=function(n,e){return e+30+fs(n,e+26)+fs(n,e+28)},yD=function(n,e,t){var r=fs(n,e+28),s=kw(n.subarray(e+46,e+46+r),!(fs(n,e+8)&2048)),i=e+46+r,a=pr(n,e+20),o=t&&a==4294967295?xD(n,i):[a,pr(n,e+24),pr(n,e+42)],c=o[0],l=o[1],u=o[2];return[fs(n,e+10),c,l,s,i+fs(n,e+30)+fs(n,e+32),u]},xD=function(n,e){for(;fs(n,e)!=1;e+=4+fs(n,e+2));return[wv(n,e+12),wv(n,e+4),wv(n,e+20)]},So=function(n){var e=0;if(n)for(var t in n){var r=n[t].length;r>65535&&Tt(9),e+=r+4}return e},jl=function(n,e,t,r,s,i,a,o){var c=r.length,l=t.extra,u=o&&o.length,f=So(l);xn(n,e,a!=null?33639248:67324752),e+=4,a!=null&&(n[e++]=20,n[e++]=t.os),n[e]=20,e+=2,n[e++]=t.flag<<1|(i<0&&8),n[e++]=s&&8,n[e++]=t.compression&255,n[e++]=t.compression>>8;var d=new Date(t.mtime==null?Date.now():t.mtime),p=d.getFullYear()-1980;if((p<0||p>119)&&Tt(10),xn(n,e,p<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>>1),e+=4,i!=-1&&(xn(n,e,t.crc),xn(n,e+4,i<0?-i-2:i),xn(n,e+8,t.size)),xn(n,e+12,c),xn(n,e+14,f),e+=16,a!=null&&(xn(n,e,u),xn(n,e+6,t.attrs),xn(n,e+10,a),e+=14),n.set(r,e),e+=c,f)for(var m in l){var I=l[m],v=I.length;xn(n,e,+m),xn(n,e+2,v),n.set(I,e+4),e+=4+v}return u&&(n.set(o,e),e+=u),e},Ew=function(n,e,t,r,s){xn(n,e,101010256),xn(n,e+8,t),xn(n,e+10,t),xn(n,e+12,r),xn(n,e+16,s)},Ef=function(){function n(e){this.filename=e,this.c=yu(),this.size=0,this.compression=0}return n.prototype.process=function(e,t){this.ondata(null,e,t)},n.prototype.push=function(e,t){this.ondata||Tt(5),this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},n}();Dt.ZipPassThrough=Ef;var DIe=function(){function n(e,t){var r=this;t||(t={}),Ef.call(this,e),this.d=new Sa(t,function(s,i){r.ondata(null,s,i)}),this.compression=8,this.flag=ID(t.level)}return n.prototype.process=function(e,t){try{this.d.push(e,t)}catch(r){this.ondata(r,null,t)}},n.prototype.push=function(e,t){Ef.prototype.push.call(this,e,t)},n}();Dt.ZipDeflate=DIe;var BIe=function(){function n(e,t){var r=this;t||(t={}),Ef.call(this,e),this.d=new oD(t,function(s,i,a){r.ondata(s,i,a)}),this.compression=8,this.flag=ID(t.level),this.terminate=this.d.terminate}return n.prototype.process=function(e,t){this.d.push(e,t)},n.prototype.push=function(e,t){Ef.prototype.push.call(this,e,t)},n}();Dt.AsyncZipDeflate=BIe;var MIe=function(){function n(e){this.ondata=e,this.u=[],this.d=1}return n.prototype.add=function(e){var t=this;if(this.ondata||Tt(5),this.d&2)this.ondata(Tt(4+(this.d&1)*8,0,1),null,!1);else{var r=Oo(e.filename),s=r.length,i=e.comment,a=i&&Oo(i),o=s!=e.filename.length||a&&i.length!=a.length,c=s+So(e.extra)+30;s>65535&&this.ondata(Tt(11,0,1),null,!1);var l=new sn(c);jl(l,0,e,r,o,-1);var u=[l],f=function(){for(var v=0,b=u;v<b.length;v++){var y=b[v];t.ondata(null,y,!1)}u=[]},d=this.d;this.d=0;var p=this.u.length,m=td(e,{f:r,u:o,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(f(),d){var v=t.u[p+1];v?v.r():t.d=1}d=1}}),I=0;e.ondata=function(v,b,y){if(v)t.ondata(v,b,y),t.terminate();else if(I+=b.length,u.push(b),y){var S=new sn(16);xn(S,0,134695760),xn(S,4,e.crc),xn(S,8,I),xn(S,12,e.size),u.push(S),m.c=I,m.b=c+I+16,m.crc=e.crc,m.size=e.size,d&&m.r(),d=1}else d&&f()},this.u.push(m)}},n.prototype.end=function(){var e=this;if(this.d&2){this.ondata(Tt(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){e.d&1&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},n.prototype.e=function(){for(var e=0,t=0,r=0,s=0,i=this.u;s<i.length;s++){var a=i[s];r+=46+a.f.length+So(a.extra)+(a.o?a.o.length:0)}for(var o=new sn(r+22),c=0,l=this.u;c<l.length;c++){var a=l[c];jl(o,e,a,a.f,a.u,-a.c-2,t,a.o),e+=46+a.f.length+So(a.extra)+(a.o?a.o.length:0),t+=a.b}Ew(o,e,this.u.length,r,t),this.ondata(null,o,!0),this.d=2},n.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){var r=t[e];r.t()}this.d=2},n}();Dt.Zip=MIe;function PIe(n,e,t){t||(t=e,e={}),typeof t!="function"&&Tt(7);var r={};Rw(n,"",r,e);var s=Object.keys(r),i=s.length,a=0,o=0,c=i,l=new Array(i),u=[],f=function(){for(var v=0;v<u.length;++v)u[v]()},d=function(v,b){hg(function(){t(v,b)})};hg(function(){d=t});var p=function(){var v=new sn(o+22),b=a,y=o-a;o=0;for(var S=0;S<c;++S){var w=l[S];try{var C=w.c.length;jl(v,o,w,w.f,w.u,C);var N=30+w.f.length+So(w.extra),E=o+N;v.set(w.c,E),jl(v,a,w,w.f,w.u,C,o,w.m),a+=16+N+(w.m?w.m.length:0),o=E+C}catch(A){return d(A,null)}}Ew(v,a,l.length,y,b),d(null,v)};i||p();for(var m=function(v){var b=s[v],y=r[b],S=y[0],w=y[1],C=yu(),N=S.length;C.p(S);var E=Oo(b),A=E.length,M=w.comment,z=M&&Oo(M),Y=z&&z.length,re=So(w.extra),ne=w.level==0?0:8,le=function(j,ge){if(j)f(),d(j,null);else{var Se=ge.length;l[v]=td(w,{size:N,crc:C.d(),c:ge,f:E,m:z,u:A!=b.length||z&&M.length!=Y,compression:ne}),a+=30+A+re+Se,o+=76+2*(A+re)+(Y||0)+Se,--i||p()}};if(A>65535&&le(Tt(11,0,1),null),!ne)le(null,S);else if(N<16e4)try{le(null,nd(S,w))}catch(j){le(j,null)}else u.push(cD(S,w,le))},I=0;I<c;++I)m(I);return f}Dt.zip=PIe;function LIe(n,e){e||(e={});var t={},r=[];Rw(n,"",t,e);var s=0,i=0;for(var a in t){var o=t[a],c=o[0],l=o[1],u=l.level==0?0:8,f=Oo(a),d=f.length,p=l.comment,m=p&&Oo(p),I=m&&m.length,v=So(l.extra);d>65535&&Tt(11);var b=u?nd(c,l):c,y=b.length,S=yu();S.p(c),r.push(td(l,{size:c.length,crc:S.d(),c:b,f,m,u:d!=a.length||m&&p.length!=I,o:s,compression:u})),s+=30+d+v+y,i+=76+2*(d+v)+(I||0)+y}for(var w=new sn(i+22),C=s,N=i-s,E=0;E<r.length;++E){var f=r[E];jl(w,f.o,f,f.f,f.u,f.c.length);var A=30+f.f.length+So(f.extra);w.set(f.c,f.o+A),jl(w,s,f,f.f,f.u,f.c.length,f.o,f.m),s+=16+A+(f.m?f.m.length:0)}return Ew(w,s,r.length,N,C),w}Dt.zipSync=LIe;var wD=function(){function n(){}return n.prototype.push=function(e,t){this.ondata(null,e,t)},n.compression=0,n}();Dt.UnzipPassThrough=wD;var UIe=function(){function n(){var e=this;this.i=new Es(function(t,r){e.ondata(null,t,r)})}return n.prototype.push=function(e,t){try{this.i.push(e,t)}catch(r){this.ondata(r,null,t)}},n.compression=8,n}();Dt.UnzipInflate=UIe;var zIe=function(){function n(e,t){var r=this;t<32e4?this.i=new Es(function(s,i){r.ondata(null,s,i)}):(this.i=new Sw(function(s,i,a){r.ondata(s,i,a)}),this.terminate=this.i.terminate)}return n.prototype.push=function(e,t){this.i.terminate&&(e=mi(e,0)),this.i.push(e,t)},n.compression=8,n}();Dt.AsyncUnzipInflate=zIe;var VIe=function(){function n(e){this.onfile=e,this.k=[],this.o={0:wD},this.p=za}return n.prototype.push=function(e,t){var r=this;if(this.onfile||Tt(5),this.p||Tt(4),this.c>0){var s=Math.min(this.c,e.length),i=e.subarray(0,s);if(this.c-=s,this.d?this.d.push(i,!this.c):this.k[0].push(i),e=e.subarray(s),e.length)return this.push(e,t)}else{var a=0,o=0,c=void 0,l=void 0;this.p.length?e.length?(l=new sn(this.p.length+e.length),l.set(this.p),l.set(e,this.p.length)):l=this.p:l=e;for(var u=l.length,f=this.c,d=f&&this.d,p=function(){var b,y=pr(l,o);if(y==67324752){a=1,c=o,m.d=null,m.c=0;var S=fs(l,o+6),w=fs(l,o+8),C=S&2048,N=S&8,E=fs(l,o+26),A=fs(l,o+28);if(u>o+30+E+A){var M=[];m.k.unshift(M),a=2;var z=pr(l,o+18),Y=pr(l,o+22),re=kw(l.subarray(o+30,o+=30+E),!C);z==4294967295?(b=N?[-2]:xD(l,o),z=b[0],Y=b[1]):N&&(z=-1),o+=A,m.c=z;var ne,le={name:re,compression:w,start:function(){if(le.ondata||Tt(5),!z)le.ondata(null,za,!0);else{var j=r.o[w];j||le.ondata(Tt(14,"unknown compression type "+w,1),null,!1),ne=z<0?new j(re):new j(re,z,Y),ne.ondata=function(ye,Ce,he){le.ondata(ye,Ce,he)};for(var ge=0,Se=M;ge<Se.length;ge++){var me=Se[ge];ne.push(me,!1)}r.k[0]==M&&r.c?r.d=ne:ne.push(za,!0)}},terminate:function(){ne&&ne.terminate&&ne.terminate()}};z>=0&&(le.size=z,le.originalSize=Y),m.onfile(le)}return"break"}else if(f){if(y==134695760)return c=o+=12+(f==-2&&8),a=3,m.c=0,"break";if(y==33639248)return c=o-=4,a=3,m.c=0,"break"}},m=this;o<u-4;++o){var I=p();if(I==="break")break}if(this.p=za,f<0){var v=a?l.subarray(0,c-12-(f==-2&&8)-(pr(l,c-16)==134695760&&4)):l.subarray(0,o);d?d.push(v,!!a):this.k[+(a==2)].push(v)}if(a&2)return this.push(l.subarray(o),t);this.p=l.subarray(o)}t&&(this.c&&Tt(13),this.p=null)},n.prototype.register=function(e){this.o[e.compression]=e},n}();Dt.Unzip=VIe;var hg=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(n){n()};function WIe(n,e,t){t||(t=e,e={}),typeof t!="function"&&Tt(7);var r=[],s=function(){for(var v=0;v<r.length;++v)r[v]()},i={},a=function(v,b){hg(function(){t(v,b)})};hg(function(){a=t});for(var o=n.length-22;pr(n,o)!=101010256;--o)if(!o||n.length-o>65558)return a(Tt(13,0,1),null),s;var c=fs(n,o+8);if(c){var l=c,u=pr(n,o+16),f=u==4294967295||l==65535;if(f){var d=pr(n,o-12);f=pr(n,d)==101075792,f&&(l=c=pr(n,d+32),u=pr(n,d+48))}for(var p=e&&e.filter,m=function(v){var b=yD(n,u,f),y=b[0],S=b[1],w=b[2],C=b[3],N=b[4],E=b[5],A=bD(n,E);u=N;var M=function(Y,re){Y?(s(),a(Y,null)):(re&&(i[C]=re),--c||a(null,i))};if(!p||p({name:C,size:S,originalSize:w,compression:y}))if(!y)M(null,mi(n,A,A+S));else if(y==8){var z=n.subarray(A,A+S);if(S<32e4)try{M(null,Ru(z,new sn(w)))}catch(Y){M(Y,null)}else r.push(Cw(z,{size:w},M))}else M(Tt(14,"unknown compression type "+y,1),null);else M(null,null)},I=0;I<l;++I)m(I)}else a(null,{});return s}Dt.unzip=WIe;function GIe(n,e){for(var t={},r=n.length-22;pr(n,r)!=101010256;--r)(!r||n.length-r>65558)&&Tt(13);var s=fs(n,r+8);if(!s)return{};var i=pr(n,r+16),a=i==4294967295||s==65535;if(a){var o=pr(n,r-12);a=pr(n,o)==101075792,a&&(s=pr(n,o+32),i=pr(n,o+48))}for(var c=e&&e.filter,l=0;l<s;++l){var u=yD(n,i,a),f=u[0],d=u[1],p=u[2],m=u[3],I=u[4],v=u[5],b=bD(n,v);i=I,(!c||c({name:m,size:d,originalSize:p,compression:f}))&&(f?f==8?t[m]=Ru(n.subarray(b,b+d),new sn(p)):Tt(14,"unknown compression type "+f):t[m]=mi(n,b,b+d))}return t}Dt.unzipSync=GIe;(function(n,e){e.__esModule=!0,e.default=void 0;var t=m(J3),r=m(eF),s=m(aF),i=m(oF),a=m(hF),o=m(lw),c=m(RIe),l=m(lF),u=it,f=m(LF),d=m(UF),p=Dt;function m(Y){return Y&&Y.__esModule?Y:{default:Y}}function I(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */I=function(){return Y};var Y={},re=Object.prototype,ne=re.hasOwnProperty,le=typeof Symbol=="function"?Symbol:{},j=le.iterator||"@@iterator",ge=le.asyncIterator||"@@asyncIterator",Se=le.toStringTag||"@@toStringTag";function me(R,k,X){return Object.defineProperty(R,k,{value:X,enumerable:!0,configurable:!0,writable:!0}),R[k]}try{me({},"")}catch{me=function(X,fe,Te){return X[fe]=Te}}function ye(R,k,X,fe){var Te=k&&k.prototype instanceof Ne?k:Ne,Be=Object.create(Te.prototype),He=new se(fe||[]);return Be._invoke=function(rt,ct,lt){var W="suspendedStart";return function(T,O){if(W==="executing")throw new Error("Generator is already running");if(W==="completed"){if(T==="throw")throw O;return B()}for(lt.method=T,lt.arg=O;;){var ue=lt.delegate;if(ue){var Ae=L(ue,lt);if(Ae){if(Ae===he)continue;return Ae}}if(lt.method==="next")lt.sent=lt._sent=lt.arg;else if(lt.method==="throw"){if(W==="suspendedStart")throw W="completed",lt.arg;lt.dispatchException(lt.arg)}else lt.method==="return"&&lt.abrupt("return",lt.arg);W="executing";var ze=Ce(rt,ct,lt);if(ze.type==="normal"){if(W=lt.done?"completed":"suspendedYield",ze.arg===he)continue;return{value:ze.arg,done:lt.done}}ze.type==="throw"&&(W="completed",lt.method="throw",lt.arg=ze.arg)}}}(R,X,He),Be}function Ce(R,k,X){try{return{type:"normal",arg:R.call(k,X)}}catch(fe){return{type:"throw",arg:fe}}}Y.wrap=ye;var he={};function Ne(){}function xe(){}function ae(){}var J={};me(J,j,function(){return this});var D=Object.getPrototypeOf,P=D&&D(D(ie([])));P&&P!==re&&ne.call(P,j)&&(J=P);var Q=ae.prototype=Ne.prototype=Object.create(J);function pe(R){["next","throw","return"].forEach(function(k){me(R,k,function(X){return this._invoke(k,X)})})}function Ee(R,k){function X(Te,Be,He,rt){var ct=Ce(R[Te],R,Be);if(ct.type!=="throw"){var lt=ct.arg,W=lt.value;return W&&typeof W=="object"&&ne.call(W,"__await")?k.resolve(W.__await).then(function(T){X("next",T,He,rt)},function(T){X("throw",T,He,rt)}):k.resolve(W).then(function(T){lt.value=T,He(lt)},function(T){return X("throw",T,He,rt)})}rt(ct.arg)}var fe;this._invoke=function(Te,Be){function He(){return new k(function(rt,ct){X(Te,Be,rt,ct)})}return fe=fe?fe.then(He,He):He()}}function L(R,k){var X=R.iterator[k.method];if(X===void 0){if(k.delegate=null,k.method==="throw"){if(R.iterator.return&&(k.method="return",k.arg=void 0,L(R,k),k.method==="throw"))return he;k.method="throw",k.arg=new TypeError("The iterator does not provide a 'throw' method")}return he}var fe=Ce(X,R.iterator,k.arg);if(fe.type==="throw")return k.method="throw",k.arg=fe.arg,k.delegate=null,he;var Te=fe.arg;return Te?Te.done?(k[R.resultName]=Te.value,k.next=R.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,he):Te:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,he)}function q(R){var k={tryLoc:R[0]};1 in R&&(k.catchLoc=R[1]),2 in R&&(k.finallyLoc=R[2],k.afterLoc=R[3]),this.tryEntries.push(k)}function Z(R){var k=R.completion||{};k.type="normal",delete k.arg,R.completion=k}function se(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(q,this),this.reset(!0)}function ie(R){if(R){var k=R[j];if(k)return k.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var X=-1,fe=function Te(){for(;++X<R.length;)if(ne.call(R,X))return Te.value=R[X],Te.done=!1,Te;return Te.value=void 0,Te.done=!0,Te};return fe.next=fe}}return{next:B}}function B(){return{value:void 0,done:!0}}return xe.prototype=ae,me(Q,"constructor",ae),me(ae,"constructor",xe),xe.displayName=me(ae,Se,"GeneratorFunction"),Y.isGeneratorFunction=function(R){var k=typeof R=="function"&&R.constructor;return!!k&&(k===xe||(k.displayName||k.name)==="GeneratorFunction")},Y.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,ae):(R.__proto__=ae,me(R,Se,"GeneratorFunction")),R.prototype=Object.create(Q),R},Y.awrap=function(R){return{__await:R}},pe(Ee.prototype),me(Ee.prototype,ge,function(){return this}),Y.AsyncIterator=Ee,Y.async=function(R,k,X,fe,Te){Te===void 0&&(Te=Promise);var Be=new Ee(ye(R,k,X,fe),Te);return Y.isGeneratorFunction(k)?Be:Be.next().then(function(He){return He.done?He.value:Be.next()})},pe(Q),me(Q,Se,"Generator"),me(Q,j,function(){return this}),me(Q,"toString",function(){return"[object Generator]"}),Y.keys=function(R){var k=[];for(var X in R)k.push(X);return k.reverse(),function fe(){for(;k.length;){var Te=k.pop();if(Te in R)return fe.value=Te,fe.done=!1,fe}return fe.done=!0,fe}},Y.values=ie,se.prototype={constructor:se,reset:function(k){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Z),!k)for(var X in this)X.charAt(0)==="t"&&ne.call(this,X)&&!isNaN(+X.slice(1))&&(this[X]=void 0)},stop:function(){this.done=!0;var k=this.tryEntries[0].completion;if(k.type==="throw")throw k.arg;return this.rval},dispatchException:function(k){if(this.done)throw k;var X=this;function fe(lt,W){return He.type="throw",He.arg=k,X.next=lt,W&&(X.method="next",X.arg=void 0),!!W}for(var Te=this.tryEntries.length-1;Te>=0;--Te){var Be=this.tryEntries[Te],He=Be.completion;if(Be.tryLoc==="root")return fe("end");if(Be.tryLoc<=this.prev){var rt=ne.call(Be,"catchLoc"),ct=ne.call(Be,"finallyLoc");if(rt&&ct){if(this.prev<Be.catchLoc)return fe(Be.catchLoc,!0);if(this.prev<Be.finallyLoc)return fe(Be.finallyLoc)}else if(rt){if(this.prev<Be.catchLoc)return fe(Be.catchLoc,!0)}else{if(!ct)throw new Error("try statement without catch or finally");if(this.prev<Be.finallyLoc)return fe(Be.finallyLoc)}}}},abrupt:function(k,X){for(var fe=this.tryEntries.length-1;fe>=0;--fe){var Te=this.tryEntries[fe];if(Te.tryLoc<=this.prev&&ne.call(Te,"finallyLoc")&&this.prev<Te.finallyLoc){var Be=Te;break}}Be&&(k==="break"||k==="continue")&&Be.tryLoc<=X&&X<=Be.finallyLoc&&(Be=null);var He=Be?Be.completion:{};return He.type=k,He.arg=X,Be?(this.method="next",this.next=Be.finallyLoc,he):this.complete(He)},complete:function(k,X){if(k.type==="throw")throw k.arg;return k.type==="break"||k.type==="continue"?this.next=k.arg:k.type==="return"?(this.rval=this.arg=k.arg,this.method="return",this.next="end"):k.type==="normal"&&X&&(this.next=X),he},finish:function(k){for(var X=this.tryEntries.length-1;X>=0;--X){var fe=this.tryEntries[X];if(fe.finallyLoc===k)return this.complete(fe.completion,fe.afterLoc),Z(fe),he}},catch:function(k){for(var X=this.tryEntries.length-1;X>=0;--X){var fe=this.tryEntries[X];if(fe.tryLoc===k){var Te=fe.completion;if(Te.type==="throw"){var Be=Te.arg;Z(fe)}return Be}}throw new Error("illegal catch attempt")},delegateYield:function(k,X,fe){return this.delegate={iterator:ie(k),resultName:X,nextLoc:fe},this.method==="next"&&(this.arg=void 0),he}},Y}function v(Y,re){var ne=typeof Symbol<"u"&&Y[Symbol.iterator]||Y["@@iterator"];if(ne)return(ne=ne.call(Y)).next.bind(ne);if(Array.isArray(Y)||(ne=b(Y))||re&&Y&&typeof Y.length=="number"){ne&&(Y=ne);var le=0;return function(){return le>=Y.length?{done:!0}:{done:!1,value:Y[le++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(Y,re){if(Y){if(typeof Y=="string")return y(Y,re);var ne=Object.prototype.toString.call(Y).slice(8,-1);if(ne==="Object"&&Y.constructor&&(ne=Y.constructor.name),ne==="Map"||ne==="Set")return Array.from(Y);if(ne==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ne))return y(Y,re)}}function y(Y,re){(re==null||re>Y.length)&&(re=Y.length);for(var ne=0,le=new Array(re);ne<re;ne++)le[ne]=Y[ne];return le}function S(){return S=Object.assign?Object.assign.bind():function(Y){for(var re=1;re<arguments.length;re++){var ne=arguments[re];for(var le in ne)Object.prototype.hasOwnProperty.call(ne,le)&&(Y[le]=ne[le])}return Y},S.apply(this,arguments)}function w(Y,re,ne,le,j,ge,Se){try{var me=Y[ge](Se),ye=me.value}catch(Ce){ne(Ce);return}me.done?re(ye):Promise.resolve(ye).then(le,j)}function C(Y){return function(){var re=this,ne=arguments;return new Promise(function(le,j){var ge=Y.apply(re,ne);function Se(ye){w(ge,le,j,Se,me,"next",ye)}function me(ye){w(ge,le,j,Se,me,"throw",ye)}Se(void 0)})}}function N(Y,re){return E.apply(this,arguments)}function E(){return E=C(I().mark(function Y(re,ne){var le,j,ge,Se,me,ye,Ce,he,Ne,xe,ae,J,D,P,Q,pe;return I().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(pe=function(Z){return Z.some(function(se){return se.success})},ne=ne||{},j=ne.fileName||"",!j&&typeof re!="string"&&(j=re.name,ne.fileName=j),ge=(0,i.default)(j),typeof re!="string"){L.next=9;break}le=re,L.next=34;break;case 9:if(!/^(ab1)$/.test(ge)){L.next=13;break}return L.abrupt("return",(0,o.default)(re,ne));case 13:if(!/^(prot)$/.test(ge)){L.next=17;break}return L.abrupt("return",(0,a.default)(re,ne));case 17:if(!/^(dna)$/.test(ge)){L.next=21;break}return L.abrupt("return",(0,a.default)(re,ne));case 21:if(!/^(geneious)$/.test(ge)){L.next=31;break}return L.next=24,z(re);case 24:return Se=L.sent,me=(0,p.unzipSync)(Se),ye=Object.values(me)[0],Ce=new TextDecoder().decode(ye,{stream:!1}),L.abrupt("return",(0,f.default)(Ce,ne));case 31:return L.next=33,M(re,ne);case 33:le=L.sent;case 34:if(!/^(fasta|fas|fa|fna|ffn)$/.test(ge)){L.next=38;break}return L.abrupt("return",(0,t.default)(le,ne));case 38:if(!/^(gb|gbk)$/.test(ge)){L.next=42;break}return L.abrupt("return",(0,r.default)(le,ne));case 42:if(!(/^(seq)$/.test(ge)||/^(xml)$/.test(ge)&&le.includes("seq:seq")&&le.includes("jbei"))){L.next=46;break}return L.abrupt("return",(0,d.default)(le,ne));case 46:if(!/^(json)$/.test(ge)){L.next=61;break}if(he={messages:["Unable to parse JSON file "+j],success:!1},L.prev=48,Ne=(0,u.tidyUpSequenceData)(JSON.parse(le),ne),Ne.sequence.length){L.next=52;break}return L.abrupt("return",[he]);case 52:return L.abrupt("return",[{parsedSequence:Ne,success:!0}]);case 55:return L.prev=55,L.t0=L.catch(48),console.error("error:",L.t0),L.abrupt("return",[he]);case 59:L.next=86;break;case 61:if(!/^(gp|genpep)$/.test(ge)){L.next=65;break}return L.abrupt("return",(0,r.default)(le,S({},ne,{isProtein:!0})));case 65:if(!/^(xml|rdf)$/.test(ge)){L.next=69;break}return L.abrupt("return",(0,s.default)(re,ne));case 69:if(!/^(gff|gff3)$/.test(ge)){L.next=73;break}return L.abrupt("return",(0,c.default)(re,ne));case 73:xe=[{fn:r.default,name:"Genbank Parser"},{fn:t.default,name:"Fasta Parser"}],ae=le[le.search(/\S|$/)],ae===">"?xe=xe.sort(function(q,Z){return q.name==="Fasta Parser"?-1:1}):ae==="L"&&(xe=xe.sort(function(q,Z){return q.name==="Genbank Parser"?-1:1})),J=I().mark(function q(){var Z,se;return I().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return Z=P.value,B.next=3,Z.fn(le,ne);case 3:if(se=B.sent,!pe(se)){B.next=7;break}return se.forEach(function(R){R.messages.push("Parsed using "+Z.name+".")}),B.abrupt("return",{v:se});case 7:case"end":return B.stop()}},q)}),D=v(xe);case 78:if((P=D()).done){L.next=85;break}return L.delegateYield(J(),"t1",80);case 80:if(Q=L.t1,typeof Q!="object"){L.next=83;break}return L.abrupt("return",Q.v);case 83:L.next=78;break;case 85:return L.abrupt("return",[{messages:["Unable to parse file as FASTA, genbank, JBEI, or SBOL formats"],success:!1}]);case 86:case"end":return L.stop()}},Y,null,[[48,55]])})),E.apply(this,arguments)}var A=N;e.default=A;function M(Y,re){var ne=re===void 0?{}:re,le=ne.emulateBrowser;if(!l.default&&!le)return Buffer.isBuffer(Y)?Y.toString("utf-8"):Buffer.isBuffer(Y.buffer)?Y.buffer.toString("utf-8"):Y;var j=new window.FileReader;return j.readAsText(Y,"UTF-8"),new Promise(function(ge,Se){j.onload=function(me){ge(me.target.result)},j.onerror=function(me){console.error("err:",me),Se(me)}})}function z(Y,re){var ne=re===void 0?{}:re,le=ne.emulateBrowser;if(!l.default&&!le)return Buffer.isBuffer(Y)?new Uint8Array(Y):Buffer.isBuffer(Y.buffer)?new Uint8Array(Y.buffer):Y;var j=new window.FileReader;return j.readAsArrayBuffer(Y),new Promise(function(ge,Se){j.onload=function(me){var ye=me.target.result,Ce=new Uint8Array(ye);ge(Ce)},j.onerror=function(me){console.error("err:",me),Se(me)}})}n.exports=e.default})(lI,lI.exports);var HIe=lI.exports,zI={exports:{}},SD={exports:{}},qIe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},CD={exports:{}},jIe=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")},KIe=jIe,XIe=Array.prototype.concat,YIe=Array.prototype.slice,jk=CD.exports=function(e){for(var t=[],r=0,s=e.length;r<s;r++){var i=e[r];KIe(i)?t=XIe.call(t,YIe.call(i)):t.push(i)}return t};jk.wrap=function(n){return function(){return n(jk(arguments))}};var ZIe=CD.exports,hf=qIe,rd=ZIe,RD=Object.hasOwnProperty,kD=Object.create(null);for(var Sv in hf)RD.call(hf,Sv)&&(kD[hf[Sv]]=Sv);var Ws=SD.exports={to:{},get:{}};Ws.get=function(n){var e=n.substring(0,3).toLowerCase(),t,r;switch(e){case"hsl":t=Ws.get.hsl(n),r="hsl";break;case"hwb":t=Ws.get.hwb(n),r="hwb";break;default:t=Ws.get.rgb(n),r="rgb";break}return t?{model:r,value:t}:null};Ws.get.rgb=function(n){if(!n)return null;var e=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,i=/^(\w+)$/,a=[0,0,0,1],o,c,l;if(o=n.match(t)){for(l=o[2],o=o[1],c=0;c<3;c++){var u=c*2;a[c]=parseInt(o.slice(u,u+2),16)}l&&(a[3]=parseInt(l,16)/255)}else if(o=n.match(e)){for(o=o[1],l=o[3],c=0;c<3;c++)a[c]=parseInt(o[c]+o[c],16);l&&(a[3]=parseInt(l+l,16)/255)}else if(o=n.match(r)){for(c=0;c<3;c++)a[c]=parseInt(o[c+1],0);o[4]&&(o[5]?a[3]=parseFloat(o[4])*.01:a[3]=parseFloat(o[4]))}else if(o=n.match(s)){for(c=0;c<3;c++)a[c]=Math.round(parseFloat(o[c+1])*2.55);o[4]&&(o[5]?a[3]=parseFloat(o[4])*.01:a[3]=parseFloat(o[4]))}else return(o=n.match(i))?o[1]==="transparent"?[0,0,0,0]:RD.call(hf,o[1])?(a=hf[o[1]],a[3]=1,a):null:null;for(c=0;c<3;c++)a[c]=Co(a[c],0,255);return a[3]=Co(a[3],0,1),a};Ws.get.hsl=function(n){if(!n)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var r=parseFloat(t[4]),s=(parseFloat(t[1])%360+360)%360,i=Co(parseFloat(t[2]),0,100),a=Co(parseFloat(t[3]),0,100),o=Co(isNaN(r)?1:r,0,1);return[s,i,a,o]}return null};Ws.get.hwb=function(n){if(!n)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=n.match(e);if(t){var r=parseFloat(t[4]),s=(parseFloat(t[1])%360+360)%360,i=Co(parseFloat(t[2]),0,100),a=Co(parseFloat(t[3]),0,100),o=Co(isNaN(r)?1:r,0,1);return[s,i,a,o]}return null};Ws.to.hex=function(){var n=rd(arguments);return"#"+pp(n[0])+pp(n[1])+pp(n[2])+(n[3]<1?pp(Math.round(n[3]*255)):"")};Ws.to.rgb=function(){var n=rd(arguments);return n.length<4||n[3]===1?"rgb("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+")":"rgba("+Math.round(n[0])+", "+Math.round(n[1])+", "+Math.round(n[2])+", "+n[3]+")"};Ws.to.rgb.percent=function(){var n=rd(arguments),e=Math.round(n[0]/255*100),t=Math.round(n[1]/255*100),r=Math.round(n[2]/255*100);return n.length<4||n[3]===1?"rgb("+e+"%, "+t+"%, "+r+"%)":"rgba("+e+"%, "+t+"%, "+r+"%, "+n[3]+")"};Ws.to.hsl=function(){var n=rd(arguments);return n.length<4||n[3]===1?"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)":"hsla("+n[0]+", "+n[1]+"%, "+n[2]+"%, "+n[3]+")"};Ws.to.hwb=function(){var n=rd(arguments),e="";return n.length>=4&&n[3]!==1&&(e=", "+n[3]),"hwb("+n[0]+", "+n[1]+"%, "+n[2]+"%"+e+")"};Ws.to.keyword=function(n){return kD[n.slice(0,3)]};function Co(n,e,t){return Math.min(Math.max(e,n),t)}function pp(n){var e=Math.round(n).toString(16).toUpperCase();return e.length<2?"0"+e:e}var JIe=SD.exports,QIe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const Tf=QIe,ED={};for(const n of Object.keys(Tf))ED[Tf[n]]=n;const wt={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var TD=wt;for(const n of Object.keys(wt)){if(!("channels"in wt[n]))throw new Error("missing channels property: "+n);if(!("labels"in wt[n]))throw new Error("missing channel labels property: "+n);if(wt[n].labels.length!==wt[n].channels)throw new Error("channel and label counts mismatch: "+n);const{channels:e,labels:t}=wt[n];delete wt[n].channels,delete wt[n].labels,Object.defineProperty(wt[n],"channels",{value:e}),Object.defineProperty(wt[n],"labels",{value:t})}wt.rgb.hsl=function(n){const e=n[0]/255,t=n[1]/255,r=n[2]/255,s=Math.min(e,t,r),i=Math.max(e,t,r),a=i-s;let o,c;i===s?o=0:e===i?o=(t-r)/a:t===i?o=2+(r-e)/a:r===i&&(o=4+(e-t)/a),o=Math.min(o*60,360),o<0&&(o+=360);const l=(s+i)/2;return i===s?c=0:l<=.5?c=a/(i+s):c=a/(2-i-s),[o,c*100,l*100]};wt.rgb.hsv=function(n){let e,t,r,s,i;const a=n[0]/255,o=n[1]/255,c=n[2]/255,l=Math.max(a,o,c),u=l-Math.min(a,o,c),f=function(d){return(l-d)/6/u+1/2};return u===0?(s=0,i=0):(i=u/l,e=f(a),t=f(o),r=f(c),a===l?s=r-t:o===l?s=1/3+e-r:c===l&&(s=2/3+t-e),s<0?s+=1:s>1&&(s-=1)),[s*360,i*100,l*100]};wt.rgb.hwb=function(n){const e=n[0],t=n[1];let r=n[2];const s=wt.rgb.hsl(n)[0],i=1/255*Math.min(e,Math.min(t,r));return r=1-1/255*Math.max(e,Math.max(t,r)),[s,i*100,r*100]};wt.rgb.cmyk=function(n){const e=n[0]/255,t=n[1]/255,r=n[2]/255,s=Math.min(1-e,1-t,1-r),i=(1-e-s)/(1-s)||0,a=(1-t-s)/(1-s)||0,o=(1-r-s)/(1-s)||0;return[i*100,a*100,o*100,s*100]};function ebe(n,e){return(n[0]-e[0])**2+(n[1]-e[1])**2+(n[2]-e[2])**2}wt.rgb.keyword=function(n){const e=ED[n];if(e)return e;let t=1/0,r;for(const s of Object.keys(Tf)){const i=Tf[s],a=ebe(n,i);a<t&&(t=a,r=s)}return r};wt.keyword.rgb=function(n){return Tf[n]};wt.rgb.xyz=function(n){let e=n[0]/255,t=n[1]/255,r=n[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92;const s=e*.4124+t*.3576+r*.1805,i=e*.2126+t*.7152+r*.0722,a=e*.0193+t*.1192+r*.9505;return[s*100,i*100,a*100]};wt.rgb.lab=function(n){const e=wt.rgb.xyz(n);let t=e[0],r=e[1],s=e[2];t/=95.047,r/=100,s/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const i=116*r-16,a=500*(t-r),o=200*(r-s);return[i,a,o]};wt.hsl.rgb=function(n){const e=n[0]/360,t=n[1]/100,r=n[2]/100;let s,i,a;if(t===0)return a=r*255,[a,a,a];r<.5?s=r*(1+t):s=r+t-r*t;const o=2*r-s,c=[0,0,0];for(let l=0;l<3;l++)i=e+1/3*-(l-1),i<0&&i++,i>1&&i--,6*i<1?a=o+(s-o)*6*i:2*i<1?a=s:3*i<2?a=o+(s-o)*(2/3-i)*6:a=o,c[l]=a*255;return c};wt.hsl.hsv=function(n){const e=n[0];let t=n[1]/100,r=n[2]/100,s=t;const i=Math.max(r,.01);r*=2,t*=r<=1?r:2-r,s*=i<=1?i:2-i;const a=(r+t)/2,o=r===0?2*s/(i+s):2*t/(r+t);return[e,o*100,a*100]};wt.hsv.rgb=function(n){const e=n[0]/60,t=n[1]/100;let r=n[2]/100;const s=Math.floor(e)%6,i=e-Math.floor(e),a=255*r*(1-t),o=255*r*(1-t*i),c=255*r*(1-t*(1-i));switch(r*=255,s){case 0:return[r,c,a];case 1:return[o,r,a];case 2:return[a,r,c];case 3:return[a,o,r];case 4:return[c,a,r];case 5:return[r,a,o]}};wt.hsv.hsl=function(n){const e=n[0],t=n[1]/100,r=n[2]/100,s=Math.max(r,.01);let i,a;a=(2-t)*r;const o=(2-t)*s;return i=t*s,i/=o<=1?o:2-o,i=i||0,a/=2,[e,i*100,a*100]};wt.hwb.rgb=function(n){const e=n[0]/360;let t=n[1]/100,r=n[2]/100;const s=t+r;let i;s>1&&(t/=s,r/=s);const a=Math.floor(6*e),o=1-r;i=6*e-a,a&1&&(i=1-i);const c=t+i*(o-t);let l,u,f;switch(a){default:case 6:case 0:l=o,u=c,f=t;break;case 1:l=c,u=o,f=t;break;case 2:l=t,u=o,f=c;break;case 3:l=t,u=c,f=o;break;case 4:l=c,u=t,f=o;break;case 5:l=o,u=t,f=c;break}return[l*255,u*255,f*255]};wt.cmyk.rgb=function(n){const e=n[0]/100,t=n[1]/100,r=n[2]/100,s=n[3]/100,i=1-Math.min(1,e*(1-s)+s),a=1-Math.min(1,t*(1-s)+s),o=1-Math.min(1,r*(1-s)+s);return[i*255,a*255,o*255]};wt.xyz.rgb=function(n){const e=n[0]/100,t=n[1]/100,r=n[2]/100;let s,i,a;return s=e*3.2406+t*-1.5372+r*-.4986,i=e*-.9689+t*1.8758+r*.0415,a=e*.0557+t*-.204+r*1.057,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,a=a>.0031308?1.055*a**(1/2.4)-.055:a*12.92,s=Math.min(Math.max(0,s),1),i=Math.min(Math.max(0,i),1),a=Math.min(Math.max(0,a),1),[s*255,i*255,a*255]};wt.xyz.lab=function(n){let e=n[0],t=n[1],r=n[2];e/=95.047,t/=100,r/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116;const s=116*t-16,i=500*(e-t),a=200*(t-r);return[s,i,a]};wt.lab.xyz=function(n){const e=n[0],t=n[1],r=n[2];let s,i,a;i=(e+16)/116,s=t/500+i,a=i-r/200;const o=i**3,c=s**3,l=a**3;return i=o>.008856?o:(i-16/116)/7.787,s=c>.008856?c:(s-16/116)/7.787,a=l>.008856?l:(a-16/116)/7.787,s*=95.047,i*=100,a*=108.883,[s,i,a]};wt.lab.lch=function(n){const e=n[0],t=n[1],r=n[2];let s;s=Math.atan2(r,t)*360/2/Math.PI,s<0&&(s+=360);const a=Math.sqrt(t*t+r*r);return[e,a,s]};wt.lch.lab=function(n){const e=n[0],t=n[1],s=n[2]/360*2*Math.PI,i=t*Math.cos(s),a=t*Math.sin(s);return[e,i,a]};wt.rgb.ansi16=function(n,e=null){const[t,r,s]=n;let i=e===null?wt.rgb.hsv(n)[2]:e;if(i=Math.round(i/50),i===0)return 30;let a=30+(Math.round(s/255)<<2|Math.round(r/255)<<1|Math.round(t/255));return i===2&&(a+=60),a};wt.hsv.ansi16=function(n){return wt.rgb.ansi16(wt.hsv.rgb(n),n[2])};wt.rgb.ansi256=function(n){const e=n[0],t=n[1],r=n[2];return e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5)};wt.ansi16.rgb=function(n){let e=n%10;if(e===0||e===7)return n>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const t=(~~(n>50)+1)*.5,r=(e&1)*t*255,s=(e>>1&1)*t*255,i=(e>>2&1)*t*255;return[r,s,i]};wt.ansi256.rgb=function(n){if(n>=232){const i=(n-232)*10+8;return[i,i,i]}n-=16;let e;const t=Math.floor(n/36)/5*255,r=Math.floor((e=n%36)/6)/5*255,s=e%6/5*255;return[t,r,s]};wt.rgb.hex=function(n){const t=(((Math.round(n[0])&255)<<16)+((Math.round(n[1])&255)<<8)+(Math.round(n[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t};wt.hex.rgb=function(n){const e=n.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let t=e[0];e[0].length===3&&(t=t.split("").map(o=>o+o).join(""));const r=parseInt(t,16),s=r>>16&255,i=r>>8&255,a=r&255;return[s,i,a]};wt.rgb.hcg=function(n){const e=n[0]/255,t=n[1]/255,r=n[2]/255,s=Math.max(Math.max(e,t),r),i=Math.min(Math.min(e,t),r),a=s-i;let o,c;return a<1?o=i/(1-a):o=0,a<=0?c=0:s===e?c=(t-r)/a%6:s===t?c=2+(r-e)/a:c=4+(e-t)/a,c/=6,c%=1,[c*360,a*100,o*100]};wt.hsl.hcg=function(n){const e=n[1]/100,t=n[2]/100,r=t<.5?2*e*t:2*e*(1-t);let s=0;return r<1&&(s=(t-.5*r)/(1-r)),[n[0],r*100,s*100]};wt.hsv.hcg=function(n){const e=n[1]/100,t=n[2]/100,r=e*t;let s=0;return r<1&&(s=(t-r)/(1-r)),[n[0],r*100,s*100]};wt.hcg.rgb=function(n){const e=n[0]/360,t=n[1]/100,r=n[2]/100;if(t===0)return[r*255,r*255,r*255];const s=[0,0,0],i=e%1*6,a=i%1,o=1-a;let c=0;switch(Math.floor(i)){case 0:s[0]=1,s[1]=a,s[2]=0;break;case 1:s[0]=o,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=a;break;case 3:s[0]=0,s[1]=o,s[2]=1;break;case 4:s[0]=a,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=o}return c=(1-t)*r,[(t*s[0]+c)*255,(t*s[1]+c)*255,(t*s[2]+c)*255]};wt.hcg.hsv=function(n){const e=n[1]/100,t=n[2]/100,r=e+t*(1-e);let s=0;return r>0&&(s=e/r),[n[0],s*100,r*100]};wt.hcg.hsl=function(n){const e=n[1]/100,r=n[2]/100*(1-e)+.5*e;let s=0;return r>0&&r<.5?s=e/(2*r):r>=.5&&r<1&&(s=e/(2*(1-r))),[n[0],s*100,r*100]};wt.hcg.hwb=function(n){const e=n[1]/100,t=n[2]/100,r=e+t*(1-e);return[n[0],(r-e)*100,(1-r)*100]};wt.hwb.hcg=function(n){const e=n[1]/100,r=1-n[2]/100,s=r-e;let i=0;return s<1&&(i=(r-s)/(1-s)),[n[0],s*100,i*100]};wt.apple.rgb=function(n){return[n[0]/65535*255,n[1]/65535*255,n[2]/65535*255]};wt.rgb.apple=function(n){return[n[0]/255*65535,n[1]/255*65535,n[2]/255*65535]};wt.gray.rgb=function(n){return[n[0]/100*255,n[0]/100*255,n[0]/100*255]};wt.gray.hsl=function(n){return[0,0,n[0]]};wt.gray.hsv=wt.gray.hsl;wt.gray.hwb=function(n){return[0,100,n[0]]};wt.gray.cmyk=function(n){return[0,0,0,n[0]]};wt.gray.lab=function(n){return[n[0],0,0]};wt.gray.hex=function(n){const e=Math.round(n[0]/100*255)&255,r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r};wt.rgb.gray=function(n){return[(n[0]+n[1]+n[2])/3/255*100]};const dg=TD;function tbe(){const n={},e=Object.keys(dg);for(let t=e.length,r=0;r<t;r++)n[e[r]]={distance:-1,parent:null};return n}function nbe(n){const e=tbe(),t=[n];for(e[n].distance=0;t.length;){const r=t.pop(),s=Object.keys(dg[r]);for(let i=s.length,a=0;a<i;a++){const o=s[a],c=e[o];c.distance===-1&&(c.distance=e[r].distance+1,c.parent=r,t.unshift(o))}}return e}function rbe(n,e){return function(t){return e(n(t))}}function sbe(n,e){const t=[e[n].parent,n];let r=dg[e[n].parent][n],s=e[n].parent;for(;e[s].parent;)t.unshift(e[s].parent),r=rbe(dg[e[s].parent][s],r),s=e[s].parent;return r.conversion=t,r}var ibe=function(n){const e=nbe(n),t={},r=Object.keys(e);for(let s=r.length,i=0;i<s;i++){const a=r[i];e[a].parent!==null&&(t[a]=sbe(a,e))}return t};const VI=TD,abe=ibe,yl={},obe=Object.keys(VI);function cbe(n){const e=function(...t){const r=t[0];return r==null?r:(r.length>1&&(t=r),n(t))};return"conversion"in n&&(e.conversion=n.conversion),e}function lbe(n){const e=function(...t){const r=t[0];if(r==null)return r;r.length>1&&(t=r);const s=n(t);if(typeof s=="object")for(let i=s.length,a=0;a<i;a++)s[a]=Math.round(s[a]);return s};return"conversion"in n&&(e.conversion=n.conversion),e}obe.forEach(n=>{yl[n]={},Object.defineProperty(yl[n],"channels",{value:VI[n].channels}),Object.defineProperty(yl[n],"labels",{value:VI[n].labels});const e=abe(n);Object.keys(e).forEach(r=>{const s=e[r];yl[n][r]=lbe(s),yl[n][r].raw=cbe(s)})});var ube=yl;const xl=JIe,Us=ube,AD=["keyword","gray","hex"],WI={};for(const n of Object.keys(Us))WI[[...Us[n].labels].sort().join("")]=n;const pg={};function Br(n,e){if(!(this instanceof Br))return new Br(n,e);if(e&&e in AD&&(e=null),e&&!(e in Us))throw new Error("Unknown model: "+e);let t,r;if(n==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(n instanceof Br)this.model=n.model,this.color=[...n.color],this.valpha=n.valpha;else if(typeof n=="string"){const s=xl.get(n);if(s===null)throw new Error("Unable to parse color from string: "+n);this.model=s.model,r=Us[this.model].channels,this.color=s.value.slice(0,r),this.valpha=typeof s.value[r]=="number"?s.value[r]:1}else if(n.length>0){this.model=e||"rgb",r=Us[this.model].channels;const s=Array.prototype.slice.call(n,0,r);this.color=GI(s,r),this.valpha=typeof n[r]=="number"?n[r]:1}else if(typeof n=="number")this.model="rgb",this.color=[n>>16&255,n>>8&255,n&255],this.valpha=1;else{this.valpha=1;const s=Object.keys(n);"alpha"in n&&(s.splice(s.indexOf("alpha"),1),this.valpha=typeof n.alpha=="number"?n.alpha:0);const i=s.sort().join("");if(!(i in WI))throw new Error("Unable to parse color from object: "+JSON.stringify(n));this.model=WI[i];const{labels:a}=Us[this.model],o=[];for(t=0;t<a.length;t++)o.push(n[a[t]]);this.color=GI(o)}if(pg[this.model])for(r=Us[this.model].channels,t=0;t<r;t++){const s=pg[this.model][t];s&&(this.color[t]=s(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Br.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(n){let e=this.model in xl.to?this:this.rgb();e=e.round(typeof n=="number"?n:1);const t=e.valpha===1?e.color:[...e.color,this.valpha];return xl.to[e.model](t)},percentString(n){const e=this.rgb().round(typeof n=="number"?n:1),t=e.valpha===1?e.color:[...e.color,this.valpha];return xl.to.rgb.percent(t)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const n={},{channels:e}=Us[this.model],{labels:t}=Us[this.model];for(let r=0;r<e;r++)n[t[r]]=this.color[r];return this.valpha!==1&&(n.alpha=this.valpha),n},unitArray(){const n=this.rgb().color;return n[0]/=255,n[1]/=255,n[2]/=255,this.valpha!==1&&n.push(this.valpha),n},unitObject(){const n=this.rgb().object();return n.r/=255,n.g/=255,n.b/=255,this.valpha!==1&&(n.alpha=this.valpha),n},round(n){return n=Math.max(n||0,0),new Br([...this.color.map(hbe(n)),this.valpha],this.model)},alpha(n){return n!==void 0?new Br([...this.color,Math.max(0,Math.min(1,n))],this.model):this.valpha},red:tr("rgb",0,kr(255)),green:tr("rgb",1,kr(255)),blue:tr("rgb",2,kr(255)),hue:tr(["hsl","hsv","hsl","hwb","hcg"],0,n=>(n%360+360)%360),saturationl:tr("hsl",1,kr(100)),lightness:tr("hsl",2,kr(100)),saturationv:tr("hsv",1,kr(100)),value:tr("hsv",2,kr(100)),chroma:tr("hcg",1,kr(100)),gray:tr("hcg",2,kr(100)),white:tr("hwb",1,kr(100)),wblack:tr("hwb",2,kr(100)),cyan:tr("cmyk",0,kr(100)),magenta:tr("cmyk",1,kr(100)),yellow:tr("cmyk",2,kr(100)),black:tr("cmyk",3,kr(100)),x:tr("xyz",0,kr(95.047)),y:tr("xyz",1,kr(100)),z:tr("xyz",2,kr(108.833)),l:tr("lab",0,kr(100)),a:tr("lab",1),b:tr("lab",2),keyword(n){return n!==void 0?new Br(n):Us[this.model].keyword(this.color)},hex(n){return n!==void 0?new Br(n):xl.to.hex(this.rgb().round().color)},hexa(n){if(n!==void 0)return new Br(n);const e=this.rgb().round().color;let t=Math.round(this.valpha*255).toString(16).toUpperCase();return t.length===1&&(t="0"+t),xl.to.hex(e)+t},rgbNumber(){const n=this.rgb().color;return(n[0]&255)<<16|(n[1]&255)<<8|n[2]&255},luminosity(){const n=this.rgb().color,e=[];for(const[t,r]of n.entries()){const s=r/255;e[t]=s<=.04045?s/12.92:((s+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(n){const e=this.luminosity(),t=n.luminosity();return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)},level(n){const e=this.contrast(n);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){const n=this.rgb().color;return(n[0]*2126+n[1]*7152+n[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const n=this.rgb();for(let e=0;e<3;e++)n.color[e]=255-n.color[e];return n},lighten(n){const e=this.hsl();return e.color[2]+=e.color[2]*n,e},darken(n){const e=this.hsl();return e.color[2]-=e.color[2]*n,e},saturate(n){const e=this.hsl();return e.color[1]+=e.color[1]*n,e},desaturate(n){const e=this.hsl();return e.color[1]-=e.color[1]*n,e},whiten(n){const e=this.hwb();return e.color[1]+=e.color[1]*n,e},blacken(n){const e=this.hwb();return e.color[2]+=e.color[2]*n,e},grayscale(){const n=this.rgb().color,e=n[0]*.3+n[1]*.59+n[2]*.11;return Br.rgb(e,e,e)},fade(n){return this.alpha(this.valpha-this.valpha*n)},opaquer(n){return this.alpha(this.valpha+this.valpha*n)},rotate(n){const e=this.hsl();let t=e.color[0];return t=(t+n)%360,t=t<0?360+t:t,e.color[0]=t,e},mix(n,e){if(!n||!n.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof n);const t=n.rgb(),r=this.rgb(),s=e===void 0?.5:e,i=2*s-1,a=t.alpha()-r.alpha(),o=((i*a===-1?i:(i+a)/(1+i*a))+1)/2,c=1-o;return Br.rgb(o*t.red()+c*r.red(),o*t.green()+c*r.green(),o*t.blue()+c*r.blue(),t.alpha()*s+r.alpha()*(1-s))}};for(const n of Object.keys(Us)){if(AD.includes(n))continue;const{channels:e}=Us[n];Br.prototype[n]=function(...t){return this.model===n?new Br(this):t.length>0?new Br(t,n):new Br([...dbe(Us[this.model][n].raw(this.color)),this.valpha],n)},Br[n]=function(...t){let r=t[0];return typeof r=="number"&&(r=GI(t,e)),new Br(r,n)}}function fbe(n,e){return Number(n.toFixed(e))}function hbe(n){return function(e){return fbe(e,n)}}function tr(n,e,t){n=Array.isArray(n)?n:[n];for(const r of n)(pg[r]||(pg[r]=[]))[e]=t;return n=n[0],function(r){let s;return r!==void 0?(t&&(r=t(r)),s=this[n](),s.color[e]=r,s):(s=this[n]().color[e],t&&(s=t(s)),s)}}function kr(n){return function(e){return Math.max(0,Math.min(n,e))}}function dbe(n){return Array.isArray(n)?n:[n]}function GI(n,e){for(let t=0;t<e;t++)typeof n[t]!="number"&&(n[t]=0);return n}var pbe=Br;(function(n,e){e.__esModule=!0,e.default=m;var t=zt,r=c(pbe),s=c(Y3),i=c(Z3),a=it,o=du;function c(E){return E&&E.__esModule?E:{default:E}}function l(){return l=Object.assign?Object.assign.bind():function(E){for(var A=1;A<arguments.length;A++){var M=arguments[A];for(var z in M)Object.prototype.hasOwnProperty.call(M,z)&&(E[z]=M[z])}return E},l.apply(this,arguments)}var u={trim:function(A){return A.replace(/^\s+|\s+$/g,"")},ltrim:function(A){return A.replace(/^\s+/,"")},rtrim:function(A){return A.replace(/\s+$/,"")},lpad:function(A,M,z){for(var Y=A;Y.length<z;)Y=M+Y;return Y},rpad:function(A,M,z){for(var Y=A;Y.length<z;)Y=Y+M;return Y}},f={isDigestPart:"isDigestPart",isDigestValid:"isDigestValid","re5Prime.name":"re5PrimeName","re5Prime.recognitionRegex":"re5PrimePattern",re5PrimeOverhang:"re5PrimeOverhang",re5PrimeOverhangStrand:"re5PrimeOverhangStrand",re5PrimeRecognitionTypeCode:"re5PrimeRecognitionTypeCode","re3Prime.name":"re3PrimeName","re3Prime.recognitionRegex":"re3PrimePattern",re3PrimeOverhang:"re3PrimeOverhang",re3PrimeOverhangStrand:"re3PrimeOverhangStrand",re3PrimeRecognitionTypeCode:"re3PrimeRecognitionTypeCode"};function d(E,A,M){return E.slice(A,M).join("")}function p(E,A,M){return E.slice(A,M)}function m(E,A){A=A||{},A.reformatSeqName=A.reformatSeqName!==!1;var M=(0,t.cloneDeep)(E);if(!M)return!1;try{(M.isProtein||M.type==="protein"||M.type==="AA")&&(M.isProtein=!0,M.sequence=M.proteinSequence||M.sequence,A.isProtein=!0);var z=null,Y=typeof M.sequence=="string"?p:d;M.sequence||(M.sequence="");var re=[];re.push(I(M,A)),(M.definition||M.description)&&re.push("DEFINITION  "+(0,o.mangleOrStripUrls)(M.definition||M.description,A)),M.accession&&re.push("ACCESSION  "+M.accession),M.version&&re.push("VERSION  "+M.version),M.extraLines&&(re=re.concat(M.extraLines)),M.comments&&M.comments.forEach(function(ye){re.push("COMMENT             "+ye)}),M.teselagen_unique_id&&re.push("COMMENT             teselagen_unique_id: "+M.teselagen_unique_id),M.library&&re.push("COMMENT             library: "+M.library);var ne=15;M.features=(0,t.map)(M.features).concat((0,t.flatMap)(i.default,function(ye){var Ce=ye.pragma,he=ye.type;return(0,t.flatMap)(M[he],function(Ne){return(0,t.isObject)(Ne)?(he==="primers"&&(Ne.type="primer_bind"),he==="parts"&&Ne.isDigestPart&&N(Ne),Ne.notes=Ce?l({},Ne.notes,{pragma:[Ce]}):Ne.notes,Ne):[]})})),M.features.forEach(function(ye){var Ce=ye.type;Ce&&Ce.length>ne&&(ne=Ce.length)});var le;(0,t.each)(M.features,function(ye,Ce){le||(le=!0,re.push("FEATURES             Location/Qualifiers")),re.push(y(ye,l({},A,{featurePadLength:ne+1})))}),re.push("ORIGIN      ");for(var j=0;j<M.sequence.length;j=j+60){var ge=[],Se=u.lpad(""+(j+1)," ",9);ge.push(Se);for(var me=j;me<j+60;me=me+10)ge.push(Y(M.sequence,me,me+10));re.push(ge.join(" "))}return re.push("//"),z=re.join(`\r
`),z}catch(ye){return console.warn("Error processing sequence << Check jsonToGenbank.js"),console.warn(M),console.warn(ye.stack),!1}}function I(E,A){E.sequence.symbols&&(E.sequence=E.sequence.symbols.split(""));var M,z;E.isProtein?z="":E.type==="RNA"?z="RNA":z="DNA";var Y=v(),re=u.rpad("LOCUS"," ",12),ne=E.name||"Untitled_Sequence";return ne=A.reformatSeqName?s.default.reformatName(ne):ne,re+=u.rpad(ne," ",16),re+=" ",re+=u.lpad(String(E.sequence.length)," ",11),re+=E.isProtein?" aa ":" bp ",M="",re+=u.lpad(M," ",3),re+=u.rpad(z," ",6),re+="  ",!E.circular||E.circular==="0"?re+="linear  ":re+="circular",re+=" ",re+=u.rpad(E.gbDivision||"SYN"," ",1),re+=" ",re+=Y,re}function v(){var E=new Date;E=E.toString().split(" ");var A=E[2],M=E[1].toUpperCase(),z=E[3];return A+"-"+M+"-"+z}function b(E,A,M){return u.lpad("/"," ",22)+E+'="'+(0,o.mangleOrStripUrls)(A,M)+'"'}function y(E,A){var M=[];E.type==="primer"&&(E.type="primer_bind");var z="     "+u.rpad(E.type||"misc_feature"," ",A.featurePadLength),Y="";if(E.locations&&E.locations.length>1?(E.locations.forEach(function(le,j){Y+=S(parseInt(le.start,10)+(A.inclusive1BasedStart?0:1),A.isProtein)+".."+w(parseInt(le.end,10)+(A.inclusive1BasedEnd?0:1),A.isProtein),j!==E.locations.length-1&&(Y+=",")}),Y="join("+Y+")"):Y+=S(parseInt(E.start,10)+(A.inclusive1BasedStart?0:1),A.isProtein)+".."+w(parseInt(E.end,10)+(A.inclusive1BasedEnd?0:1),A.isProtein),E.strand===-1&&(Y="complement("+Y+")"),M.push(z+Y),M.push(b("label",E.name||"Untitled Feature",A)),E.bases&&E.bases.length&&E.type==="primer_bind"&&C(E,"note","sequence: "+E.bases),E.primerBindsOn&&E.type==="primer_bind"&&C(E,"primerBindsOn",E.primerBindsOn),E.overlapsSelf&&C(E,"pragma","overlapsSelf"),E.arrowheadType){var re=E.arrowheadType.toUpperCase()==="BOTH"?"BOTH":E.arrowheadType.toUpperCase()==="NONE"?"NONE":void 0;re&&C(E,"direction",re)}var ne=E.notes;if(ne)try{if(typeof ne=="string")try{ne=JSON.parse(ne)}catch{console.warn("Warning: Note incorrectly sent as a string."),ne={}}Object.keys(ne).forEach(function(le){le==="color"||le==="labelColor"||(ne[le]instanceof Array?ne[le].forEach(function(j){M.push(b(le,j,A))}):(console.warn("Warning: Note object expected array values"),console.warn(ne)))})}catch{console.warn("Warning: Note cannot be processed")}return E.color=E.notes&&E.notes.color||E.color,E.labelColor=E.notes&&E.notes.labelColor||E.labelColor,E.color&&r.default.rgb(E.color).string()!==r.default.rgb((0,a.getFeatureToColorMap)({includeHidden:!0})[E.type]).string()&&M.push(b("color",E.color,A)),E.labelColor&&M.push(b("labelColor",E.labelColor,A)),M.join(`\r
`)}function S(E,A){return A?Math.floor((E+2)/3):E}function w(E,A){return A?Math.floor(E/3):E}function C(E,A,M){E.notes||(E.notes={}),E.notes[A]||(E.notes[A]=[]),E.notes[A].push(M)}function N(E){Object.entries(f).forEach(function(A){var M=A[0],z=A[1];C(E,z,String((0,t.get)(E,M)))})}n.exports=e.default})(zI,zI.exports);var gbe=zI.exports,HI={exports:{}};(function(n,e){e.__esModule=!0,e.default=s;var t=it,r=du;function s(i,a){var o=(0,t.tidyUpSequenceData)(i),c=o.name,l=o.circular,u=o.description,f=o.size,d=o.sequence,p=o.isProtein,m=o.proteinSize,I=o.proteinSequence;a=a||{};var v=d,b=f;p&&I&&(v=I,b=m);var y="";return y+=">"+(c||"Untitled Sequence")+"|",y+="|"+b,y+=u?"|"+(0,r.mangleOrStripUrls)(u,a):"",y+="|"+(l?"circular":"linear"),y+=`
`,y+=(v.match(/.{1,80}/g)||[]).join(`
`),y}n.exports=e.default})(HI,HI.exports);var mbe=HI.exports,qI={exports:{}};(function(n,e){e.__esModule=!0,e.default=void 0;var t=it;function r(i,a){a===void 0&&(a={});var o=a.featuresOnly?i:(0,t.tidyUpSequenceData)(i),c=o.name,l=o.features,u=o.size,f=o.description,d=o.circular,p="";p+=(c||"Untitled Sequence")+"|",p+="|"+u,p+=f?"|"+f:"",p+="|"+(d?"circular":"linear");var m=a.sequenceName||p,I="";return I+='track name="'+m+'" description="'+c+` Annotations" itemRgb="On"
`,l.forEach(function(v){var b=v.start,y=v.end,S=v.name,w=v.type,C=v.forward,N=v.strand,E=S||w,A;C||N===1?A="+":!C||N===-1?A="-":A=".";var M=w==="CDS"?"230,88,0":"";I+=m+"	"+b+"	"+(y+1)+"	"+E+"		"+A+"			"+M+`
`}),I}var s=r;e.default=s,n.exports=e.default})(qI,qI.exports);var vbe=qI.exports,jI={exports:{}};(function(n,e){e.__esModule=!0,e.default=r;var t=zt;function r(s){var i=(0,t.cloneDeep)(s);return i&&(delete i.cutsites,delete i.orfs,(0,t.forEach)(i.translations,function(a){delete a.aminoAcids}),i)}n.exports=e.default})(jI,jI.exports);var $D=jI.exports,KI={exports:{}};(function(n,e){e.__esModule=!0,e.default=t;function t(r,s){s===void 0&&(s=[]);var i=r.replace(/u/gi,function(a,o){return s.push({type:"misc_feature",name:"tg_uracil",strand:1,start:o,end:o}),a==="U"?"T":"t"});return i}n.exports=e.default})(KI,KI.exports);var Ibe=KI.exports,XI={exports:{}};(function(n,e){e.__esModule=!0,e.default=a;var t=zt,r=i($D),s=it;function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return JSON.stringify((0,t.omit)((0,r.default)((0,s.tidyUpSequenceData)(o,{annotationsAsObjects:!1})),["sequenceFragments","sequenceFeatures","cutsites","orfs","filteredParts","filteredFeatures"]))}n.exports=e.default})(XI,XI.exports);var bbe=XI.exports;ND=void 0;var ybe=Ks(HIe),ND=ybe.default,xbe=Ks(J3);xbe.default;var wbe=Ks(eF);wbe.default;var Sbe=Ks(aF);Sbe.default;var Cbe=Ks(LF);Cbe.default;var Rbe=Ks(UF);Rbe.default;var kbe=Ks(gbe);kbe.default;var OD=FD(lw);OD.default;OD.convertBasePosTraceToPerBpTrace;var Ebe=Ks(mbe);Ebe.default;var Tbe=Ks(hF);Tbe.default;var Abe=Ks(vbe);Abe.default;var $be=Ks($D);$be.default;var Tw=FD(s0);Tw.default;Tw.searchWholeObjByNameSimple;Tw.searchWholeObjByNameSimpleArray;var Nbe=Ks(Ibe);Nbe.default;var Obe=Ks(bbe);Obe.default;function _D(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(_D=function(s){return s?t:e})(n)}function FD(n,e){if(!e&&n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=_D(e);if(t&&t.has(n))return t.get(n);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var a=s?Object.getOwnPropertyDescriptor(n,i):null;a&&(a.get||a.set)?Object.defineProperty(r,i,a):r[i]=n[i]}return r.default=n,t&&t.set(n,r),r}function Ks(n){return n&&n.__esModule?n:{default:n}}var Mt=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t},vt=globalThis&&globalThis.__classPrivateFieldGet||function(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)},fo,ac,Fi,wl,of,Qi,ea,ta,na,ra,sa,ia,aa,oc,Sl,ho,Cp,po;const _be=function(n){var e=131,t=137,r=0;n+="x";var s=Math.floor(9007199254740991/t);for(let i=0;i<n.length;i++)r>s&&(r=Math.floor(r/t)),r=r*e+n.charCodeAt(i);return r},yt="0123456789abcdef".split(""),Fbe=[-2147483648,8388608,32768,128],_i=[24,16,8,0],gp=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Fr=[];class Dbe{constructor(e=!1,t=!1){fo.set(this,void 0),ac.set(this,void 0),Fi.set(this,void 0),wl.set(this,void 0),of.set(this,void 0),Qi.set(this,void 0),ea.set(this,void 0),ta.set(this,void 0),na.set(this,void 0),ra.set(this,void 0),sa.set(this,void 0),ia.set(this,void 0),aa.set(this,void 0),oc.set(this,void 0),Sl.set(this,void 0),ho.set(this,void 0),Cp.set(this,0),po.set(this,void 0),this.init(e,t)}init(e,t){t?(Fr[0]=Fr[16]=Fr[1]=Fr[2]=Fr[3]=Fr[4]=Fr[5]=Fr[6]=Fr[7]=Fr[8]=Fr[9]=Fr[10]=Fr[11]=Fr[12]=Fr[13]=Fr[14]=Fr[15]=0,Mt(this,ac,Fr)):Mt(this,ac,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e?(Mt(this,Qi,3238371032),Mt(this,ea,914150663),Mt(this,ta,812702999),Mt(this,na,4144912697),Mt(this,ra,4290775857),Mt(this,sa,1750603025),Mt(this,ia,1694076839),Mt(this,aa,3204075428)):(Mt(this,Qi,1779033703),Mt(this,ea,3144134277),Mt(this,ta,1013904242),Mt(this,na,2773480762),Mt(this,ra,1359893119),Mt(this,sa,2600822924),Mt(this,ia,528734635),Mt(this,aa,1541459225)),Mt(this,fo,Mt(this,po,Mt(this,Fi,Mt(this,Sl,0)))),Mt(this,wl,Mt(this,oc,!1)),Mt(this,of,!0),Mt(this,ho,e)}update(e){if(vt(this,wl))return this;let t;e instanceof ArrayBuffer?t=new Uint8Array(e):t=e;let r=0;const s=t.length,i=vt(this,ac);for(;r<s;){let a;if(vt(this,oc)&&(Mt(this,oc,!1),i[0]=vt(this,fo),i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),typeof t!="string")for(a=vt(this,po);r<s&&a<64;++r)i[a>>2]|=t[r]<<_i[a++&3];else for(a=vt(this,po);r<s&&a<64;++r){let o=t.charCodeAt(r);o<128?i[a>>2]|=o<<_i[a++&3]:o<2048?(i[a>>2]|=(192|o>>6)<<_i[a++&3],i[a>>2]|=(128|o&63)<<_i[a++&3]):o<55296||o>=57344?(i[a>>2]|=(224|o>>12)<<_i[a++&3],i[a>>2]|=(128|o>>6&63)<<_i[a++&3],i[a>>2]|=(128|o&63)<<_i[a++&3]):(o=65536+((o&1023)<<10|t.charCodeAt(++r)&1023),i[a>>2]|=(240|o>>18)<<_i[a++&3],i[a>>2]|=(128|o>>12&63)<<_i[a++&3],i[a>>2]|=(128|o>>6&63)<<_i[a++&3],i[a>>2]|=(128|o&63)<<_i[a++&3])}Mt(this,Cp,a),Mt(this,Fi,vt(this,Fi)+(a-vt(this,po))),a>=64?(Mt(this,fo,i[16]),Mt(this,po,a-64),this.hash(),Mt(this,oc,!0)):Mt(this,po,a)}return vt(this,Fi)>4294967295&&(Mt(this,Sl,vt(this,Sl)+(vt(this,Fi)/4294967296<<0)),Mt(this,Fi,vt(this,Fi)%4294967296)),this}finalize(){if(vt(this,wl))return;Mt(this,wl,!0);const e=vt(this,ac),t=vt(this,Cp);e[16]=vt(this,fo),e[t>>2]|=Fbe[t&3],Mt(this,fo,e[16]),t>=56&&(vt(this,oc)||this.hash(),e[0]=vt(this,fo),e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=vt(this,Sl)<<3|vt(this,Fi)>>>29,e[15]=vt(this,Fi)<<3,this.hash()}hash(){let e=vt(this,Qi),t=vt(this,ea),r=vt(this,ta),s=vt(this,na),i=vt(this,ra),a=vt(this,sa),o=vt(this,ia),c=vt(this,aa);const l=vt(this,ac);let u,f,d,p,m,I,v,b,y,S;for(let w=16;w<64;++w)p=l[w-15],u=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,p=l[w-2],f=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,l[w]=l[w-16]+u+l[w-7]+f<<0;S=t&r;for(let w=0;w<64;w+=4)vt(this,of)?(vt(this,ho)?(v=300032,p=l[0]-1413257819,c=p-150054599<<0,s=p+24177077<<0):(v=704751109,p=l[0]-210244248,c=p-1521486534<<0,s=p+143694565<<0),Mt(this,of,!1)):(u=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),f=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7),v=e&t,d=v^e&r^S,I=i&a^~i&o,p=c+f+I+gp[w]+l[w],m=u+d,c=s+p<<0,s=p+m<<0),u=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),f=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),b=s&e,d=b^s&t^v,I=c&i^~c&a,p=o+f+I+gp[w+1]+l[w+1],m=u+d,o=r+p<<0,r=p+m<<0,u=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),f=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),y=r&s,d=y^r&e^b,I=o&c^~o&i,p=a+f+I+gp[w+2]+l[w+2],m=u+d,a=t+p<<0,t=p+m<<0,u=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),f=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),S=t&r,d=S^t&s^y,I=a&o^~a&c,p=i+f+I+gp[w+3]+l[w+3],m=u+d,i=e+p<<0,e=p+m<<0;Mt(this,Qi,vt(this,Qi)+e<<0),Mt(this,ea,vt(this,ea)+t<<0),Mt(this,ta,vt(this,ta)+r<<0),Mt(this,na,vt(this,na)+s<<0),Mt(this,ra,vt(this,ra)+i<<0),Mt(this,sa,vt(this,sa)+a<<0),Mt(this,ia,vt(this,ia)+o<<0),Mt(this,aa,vt(this,aa)+c<<0)}hex(){this.finalize();const e=vt(this,Qi),t=vt(this,ea),r=vt(this,ta),s=vt(this,na),i=vt(this,ra),a=vt(this,sa),o=vt(this,ia),c=vt(this,aa);let l=yt[e>>28&15]+yt[e>>24&15]+yt[e>>20&15]+yt[e>>16&15]+yt[e>>12&15]+yt[e>>8&15]+yt[e>>4&15]+yt[e&15]+yt[t>>28&15]+yt[t>>24&15]+yt[t>>20&15]+yt[t>>16&15]+yt[t>>12&15]+yt[t>>8&15]+yt[t>>4&15]+yt[t&15]+yt[r>>28&15]+yt[r>>24&15]+yt[r>>20&15]+yt[r>>16&15]+yt[r>>12&15]+yt[r>>8&15]+yt[r>>4&15]+yt[r&15]+yt[s>>28&15]+yt[s>>24&15]+yt[s>>20&15]+yt[s>>16&15]+yt[s>>12&15]+yt[s>>8&15]+yt[s>>4&15]+yt[s&15]+yt[i>>28&15]+yt[i>>24&15]+yt[i>>20&15]+yt[i>>16&15]+yt[i>>12&15]+yt[i>>8&15]+yt[i>>4&15]+yt[i&15]+yt[a>>28&15]+yt[a>>24&15]+yt[a>>20&15]+yt[a>>16&15]+yt[a>>12&15]+yt[a>>8&15]+yt[a>>4&15]+yt[a&15]+yt[o>>28&15]+yt[o>>24&15]+yt[o>>20&15]+yt[o>>16&15]+yt[o>>12&15]+yt[o>>8&15]+yt[o>>4&15]+yt[o&15];return vt(this,ho)||(l+=yt[c>>28&15]+yt[c>>24&15]+yt[c>>20&15]+yt[c>>16&15]+yt[c>>12&15]+yt[c>>8&15]+yt[c>>4&15]+yt[c&15]),l}toString(){return this.hex()}digest(){this.finalize();const e=vt(this,Qi),t=vt(this,ea),r=vt(this,ta),s=vt(this,na),i=vt(this,ra),a=vt(this,sa),o=vt(this,ia),c=vt(this,aa),l=[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255,i>>24&255,i>>16&255,i>>8&255,i&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255];return vt(this,ho)||l.push(c>>24&255,c>>16&255,c>>8&255,c&255),l}array(){return this.digest()}arrayBuffer(){this.finalize();const e=new ArrayBuffer(vt(this,ho)?28:32),t=new DataView(e);return t.setUint32(0,vt(this,Qi)),t.setUint32(4,vt(this,ea)),t.setUint32(8,vt(this,ta)),t.setUint32(12,vt(this,na)),t.setUint32(16,vt(this,ra)),t.setUint32(20,vt(this,sa)),t.setUint32(24,vt(this,ia)),vt(this,ho)||t.setUint32(28,vt(this,aa)),e}}fo=new WeakMap,ac=new WeakMap,Fi=new WeakMap,wl=new WeakMap,of=new WeakMap,Qi=new WeakMap,ea=new WeakMap,ta=new WeakMap,na=new WeakMap,ra=new WeakMap,sa=new WeakMap,ia=new WeakMap,aa=new WeakMap,oc=new WeakMap,Sl=new WeakMap,ho=new WeakMap,Cp=new WeakMap,po=new WeakMap;function Bbe(n){const e=new Dbe;return e.update(n),parseInt(e.hex().substring(0,8),16)}const Mbe=function(n){var e="#";return n.forEach(function(t){t<16&&(e+=0),e+=t.toString(16)}),e},Pbe=function(n,e,t){n/=360;var r=t<.5?t*(1+e):t+e-t*e,s=2*t-r;return[n+1/3,n,n-1/3].map(function(i){return i<0&&i++,i>1&&i--,i<1/6?i=s+(r-s)*6*i:i<.5?i=r:i<2/3?i=s+(r-s)*6*(2/3-i):i=s,Math.round(i*255)})};class Lbe{constructor(e={}){const[t,r]=[e.lightness,e.saturation].map(function(s){return s=s!==void 0?s:[.35,.5,.65],Array.isArray(s)?s.concat():[s]});this.L=t,this.S=r,typeof e.hue=="number"&&(e.hue={min:e.hue,max:e.hue}),typeof e.hue=="object"&&!Array.isArray(e.hue)&&(e.hue=[e.hue]),typeof e.hue>"u"&&(e.hue=[]),this.hueRanges=e.hue.map(function(s){return{min:typeof s.min>"u"?0:s.min,max:typeof s.max>"u"?360:s.max}}),this.hash=Bbe,typeof e.hash=="function"&&(this.hash=e.hash),e.hash==="bkdr"&&(this.hash=_be)}hsl(e){var t,r,s,i=this.hash(e),a=727;if(this.hueRanges.length){const o=this.hueRanges[i%this.hueRanges.length];t=i/this.hueRanges.length%a*(o.max-o.min)/a+o.min}else t=i%359;return i=Math.ceil(i/360),r=this.S[i%this.S.length],i=Math.ceil(i/this.S.length),s=this.L[i%this.L.length],[t,r,s]}rgb(e){var t=this.hsl(e);return Pbe.apply(this,t)}hex(e){var t=this.rgb(e);return Mbe(t)}}const pn=n=>(B6("data-v-f1974db4"),n=n(),M6(),n),Ube={class:"container mx-auto"},zbe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Vbe={class:"col-span-3 md:col-span-1"},Wbe={class:"w-full md:max-w-md transition-all flex p-4 mb-4 text-sm text-blue-800 rounded-lg bg-blue-50 dark:bg-gray-800 dark:text-blue-400 hover:bg-blue-100 hover:dark:bg-gray-700 hover:text-base",role:"alert"},Gbe=pn(()=>We("svg",{class:"flex-shrink-0 inline w-4 h-4 mr-3 mt-[2px]","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),Hbe=pn(()=>We("span",{class:"sr-only"},"Status",-1)),qbe=pn(()=>We("span",{class:"font-medium"},"Riboswitch annotation status",-1)),jbe={class:"mt-1.5 ml-4 list-disc list-inside"},Kbe={key:0,class:"text-red-800 dark:text-red-400"},Xbe={key:1},Ybe={key:0},Zbe={key:1},Jbe={key:2},Qbe={key:3},eye={key:2},tye={key:3},nye={key:4,class:"animate-pulse"},rye={key:5,class:"text-red-800 dark:text-red-400"},sye={class:"relative w-full md:max-w-md p-4 bg-gray-200 border border-gray-200 rounded-lg shadow sm:p-8 dark:bg-gray-800 dark:border-gray-700"},iye=pn(()=>We("div",{role:"status"},[We("svg",{"aria-hidden":"true",class:"w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[We("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),We("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]),We("span",{class:"sr-only"},"Loading...")],-1)),aye=[iye],oye=pn(()=>We("div",{class:"flex items-center justify-between mb-4"},[We("h5",{class:"text-xl font-bold leading-none text-gray-900 dark:text-white"},"Input the DNA sequence"),We("a",{href:"#",class:"text-sm font-medium text-blue-600 hover:underline dark:text-blue-500","data-tooltip-target":"helpInputTooltip","data-tooltip-trigger":"click","data-tooltip-placement":"bottom"},[We("p",null," Help?")]),We("div",{id:"helpInputTooltip",role:"tooltip",class:"absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-gray-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700 w-60"},[We("p",null,"You can upload your DNA sequence formats like FASTA, GenBank, etc."),We("p",null,"Select either one sequence to process, or you can choose bulk option to run the tool for all sequences in the file"),We("p",{class:"text-gray-100"},"Select bulk process with caution, as it will use local PC resources and might take some time depending on your PC specs.")])],-1)),cye={class:"flex-root"},lye={class:"flex items-center justify-center w-full flex-wrap gap-y-2"},uye={key:0,class:"w-full mb-4"},fye={class:"flex items-center p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-600 dark:text-red-400",role:"alert"},hye=pn(()=>We("svg",{class:"flex-shrink-0 inline w-4 h-4 mr-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),dye=pn(()=>We("span",{class:"sr-only"},"Info",-1)),pye={key:1,class:"w-full",id:"file-selector"},gye={for:"dropzone-file",class:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"},mye=D6('<div class="flex flex-col items-center justify-center pt-5 pb-6" data-v-f1974db4><svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16" data-v-f1974db4><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2" data-v-f1974db4></path></svg><p class="mb-2 text-sm text-gray-500 dark:text-gray-400" data-v-f1974db4><span class="font-semibold" data-v-f1974db4>Click to upload</span> or drag and drop</p><p class="text-xs text-gray-500 dark:text-gray-400" data-v-f1974db4>FASTA, GenBank or SBOL (<b data-v-f1974db4>MAX. 20MB</b>)</p></div>',1),vye={class:"w-full mt-4",id:"file-control"},Iye={class:"flex items-center justify-between"},bye=pn(()=>We("span",{class:"inline-flex items-center justify-between"},[We("svg",{class:"w-6 h-6 text-gray-800 dark:text-white","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.828 10h6.239m-6.239 4h6.239M6 1v4a1 1 0 0 1-1 1H1m14-4v16a.97.97 0 0 1-.933 1H1.933A.97.97 0 0 1 1 18V5.828a2 2 0 0 1 .586-1.414l2.828-2.828A2 2 0 0 1 5.828 1h8.239A.97.97 0 0 1 15 2Z"})])],-1)),yye={href:"#",class:"text-blue-700 dark:text-blue-400 font-medium"},xye=pn(()=>We("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m13 7-6 6m0-6 6 6m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)),wye=[xye],Sye=pn(()=>We("div",{id:"tooltip-close-btn",role:"tooltip",class:"absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700"}," Remove uploaded file ",-1)),Cye={key:0,class:"w-full mt-4"},Rye=pn(()=>We("div",{class:"flex items-center p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-600 dark:text-red-400",role:"alert"},[We("svg",{class:"flex-shrink-0 inline w-4 h-4 mr-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})]),We("span",{class:"sr-only"},"Info"),We("div",null," Unable to parse any sequence from the selected file. ")],-1)),kye=[Rye],Eye={class:"w-full mt-4",id:"sequence-selector"},Tye=pn(()=>We("h5",{class:"text-xl font-bold leading-none text-gray-900 dark:text-white mb-4"},"Select your sequence",-1)),Aye={id:"sequenceSearch","data-dropdown-toggle":"sequenceSearchDropdown","data-dropdown-placement":"bottom",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center justify-between dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 w-full",type:"button"},$ye=pn(()=>We("svg",{class:"w-2.5 h-2.5 ml-2.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})],-1)),Nye={id:"sequenceSearchDropdown",class:"z-10 hidden bg-gray-300 shadow-inner rounded-lg w-72 dark:bg-gray-700"},Oye={class:"p-3"},_ye=pn(()=>We("label",{for:"input-group-search",class:"sr-only"},"Search",-1)),Fye={class:"relative"},Dye=pn(()=>We("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[We("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1)),Bye={class:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200 border-b border-gray-200","aria-labelledby":"dropdownSearchButton"},Mye={class:"flex items-center pl-2 rounded hover:bg-gray-100 dark:hover:bg-gray-600"},Pye=["onClick"],Lye=["checked"],Uye={class:"w-full py-2 ml-2 text-sm font-medium text-gray-900 rounded dark:text-gray-300"},zye={class:"flex justify-between"},Vye=pn(()=>We("span",{class:"mr-4"},[We("svg",{class:"w-4 h-4 text-blue-600","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"})])],-1)),Wye=pn(()=>We("span",{class:"mr-4"},[We("svg",{class:"w-4 h-4 text-red-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 18 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M1 5h16M7 8v8m4-8v8M7 1h4a1 1 0 0 1 1 1v3H6V2a1 1 0 0 1 1-1ZM3 5h12v13a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V5Z"})])],-1)),Gye={key:1,class:"flex items-center w-full p-4 mt-4 text-sm text-yellow-800 rounded-lg bg-yellow-50 dark:bg-gray-600 dark:text-yellow-300",role:"alert"},Hye=pn(()=>We("svg",{class:"flex-shrink-0 inline w-4 h-4 mr-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),qye=pn(()=>We("span",{class:"sr-only"},"Info",-1)),jye=pn(()=>We("div",null,[We("span",{class:"font-medium"},"Batch Process"),Dr(" will only list first 50, if any, sequences in browser and remaining result will be available for download as a CSV file. ")],-1)),Kye=[Hye,qye,jye],Xye={key:2,class:"flex items-center w-full p-4 mt-4 text-sm text-blue-800 border border-blue-300 rounded-lg bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-blue-800",role:"alert"},Yye=pn(()=>We("svg",{class:"flex-shrink-0 inline w-4 h-4 mr-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[We("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1)),Zye=pn(()=>We("span",{class:"sr-only"},"Info",-1)),Jye={class:"font-medium"},Qye=pn(()=>We("i",null,"base-pairs count",-1)),exe=pn(()=>We("span",{class:"font-medium"},"only first 250bp will be considered",-1)),txe={class:"w-full mt-4 flex justify-center"},nxe={class:"inline-flex rounded-md shadow-sm",role:"group"},rxe=["disabled"],sxe=pn(()=>We("svg",{class:"w-3 h-3 mr-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 18"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 5h9M5 9h5m8-8H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h4l3.5 4 3.5-4h5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1Z"})],-1)),ixe=["disabled"],axe=pn(()=>We("svg",{class:"w-3 h-3 mr-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 12 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.041 11.862A5 5 0 0 1 11 15.831V19M1 1v3.169a5 5 0 0 0 1.891 3.916M11 1v3.169a5 5 0 0 1-2.428 4.288l-5.144 3.086A5 5 0 0 0 1 15.831V19M1 3h10M1.399 6h9.252M2 14h8.652M1 17h10"})],-1)),oxe={class:"relative w-full mt-4 md:max-w-md p-4 bg-gray-200 border border-gray-200 rounded-lg shadow sm:p-8 dark:bg-gray-800 dark:border-gray-700"},cxe=pn(()=>We("div",{class:"flex items-center justify-between mb-4"},[We("h5",{class:"text-xl font-bold leading-none text-gray-900 dark:text-white"},"Enter the sequence manually"),We("a",{href:"#",class:"text-sm font-medium text-blue-600 hover:underline dark:text-blue-500","data-tooltip-target":"helpManualInputTooltip","data-tooltip-trigger":"click","data-tooltip-placement":"bottom"},[We("p",null," Help?")]),We("div",{id:"helpManualInputTooltip",role:"tooltip",class:"absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-gray-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700 w-60"},[We("p",null,"Enter the sequence in the textbox and run the tool to generate result for the input sequence.")])],-1)),lxe={class:"flex-root"},uxe={class:"flex items-center justify-center w-full flex-wrap gap-y-2"},fxe={class:"w-full mb-4 border border-gray-200 rounded-lg bg-gray-50 dark:bg-gray-700 dark:border-gray-600"},hxe={class:"py-2 bg-white rounded-t-lg dark:bg-gray-800"},dxe=pn(()=>We("label",{for:"comment",class:"sr-only"},"Your comment",-1)),pxe=pn(()=>We("svg",{class:"w-3.5 h-3.5 mr-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 12 20"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.041 11.862A5 5 0 0 1 11 15.831V19M1 1v3.169a5 5 0 0 0 1.891 3.916M11 1v3.169a5 5 0 0 1-2.428 4.288l-5.144 3.086A5 5 0 0 0 1 15.831V19M1 3h10M1.399 6h9.252M2 14h8.652M1 17h10"})],-1)),gxe={key:0,class:"grid grid-cols-1 p-4"},mxe=pn(()=>We("div",{class:"inline-flex items-center justify-center w-full"},[We("hr",{class:"w-full h-px my-8 bg-gray-200 border-0 dark:bg-gray-700"}),We("span",{class:"absolute px-3 font-medium text-gray-900 -translate-x-1/2 bg-white left-1/2 dark:text-white dark:bg-gray-900"}," Annotation Result ")],-1)),vxe={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Ixe={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},bxe=pn(()=>We("caption",{class:"p-5 text-lg font-semibold text-left text-gray-900 bg-white dark:text-white dark:bg-gray-800"},[Dr(" Riboswitch Annotations "),We("p",{class:"mt-1 text-sm font-normal text-gray-500 dark:text-gray-400"},[Dr("You can visualize and analyze first 50 sequences input directly in your browser, for further analysis you can download a "),We("span",{class:"bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300"},".CSV"),Dr("file containing the analysis result of all the selected sequences")])],-1)),yxe=pn(()=>We("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[We("tr",null,[We("th",{scope:"col",class:"px-6 py-3"}," # "),We("th",{scope:"col",class:"px-6 py-3"}," Sequence ID "),We("th",{scope:"col",class:"px-6 py-3"}," Riboswitch Detector "),We("th",{scope:"col",class:"px-6 py-3"}," Detector Probability "),We("th",{scope:"col",class:"px-6 py-3"}," Riboswitch Class "),We("th",{scope:"col",class:"px-6 py-3"}," Classifier Probability "),We("th",{scope:"col",class:"px-3 py-3"},[We("span",{class:"sr-only"},"Visualize")])])],-1)),xxe={class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700"},wxe={class:"px-6 py-4"},Sxe={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},Cxe={class:"px-6 py-4"},Rxe={class:"px-6 py-4"},kxe={class:"px-6 py-4"},Exe={class:"px-6 py-4"},Txe={class:"px-3 py-4 text-right"},Axe=["onClick"],$xe={class:"flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0 p-4 bg-white dark:bg-gray-800","aria-label":"Table navigation"},Nxe={class:"text-sm font-normal text-gray-500 dark:text-gray-400"},Oxe={class:"font-semibold text-gray-900 dark:text-white"},_xe={class:"font-semibold text-gray-900 dark:text-white"},Fxe={class:"inline-flex -space-x-px text-sm h-8"},Dxe=pn(()=>We("svg",{class:"w-4 h-4 mr-2","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 19"},[We("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 15h.01M4 12H2a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-3M9.5 1v10.93m4-3.93-4 4-4-4"})],-1)),Bxe=pn(()=>We("div",{id:"download-help-tooltip",role:"tooltip",class:"absolute z-10 w-56 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700"},[Dr(" Click here to download a "),We("span",{class:"bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-blue-900 dark:text-blue-300"},".CSV"),Dr(" file containing the complete result, including the 50 displayed and also the sequences not displayed in the table. ")],-1)),Mxe=["disabled"],Pxe=["disabled"],Lxe={__name:"index",setup(n){var e={},t=null;const{annotationResult:r,annotateSequenceList:s,modelError:i,loadModel:a}=Mfe(),{totalPages:o,currentPage:c,pageItems:l,populateData:u,goToPage:f,totalItemsCount:d}=Pfe(),{downloadPredictionCSV:p}=Lfe();var m=null;const I=new Lbe,v=Ss(),b=Ss(),y=Ss(""),S=Ss(""),w=Ss(""),C=$6({}),N=Ss(""),E=Ss(0),A=N6(()=>N.value==""||!N.value?Object.keys(e):Object.keys(e).filter(Ce=>Ce.toLocaleLowerCase().includes(N.value.toLocaleLowerCase()))),M=ye=>{if(E.value=0,!ye){Object.keys(C).forEach(Ne=>delete C[Ne]);return}for(var Ce in A.value){var he=A.value[Ce];C[he]=1,e[he].seq.length>250&&E.value++}},z=async ye=>{try{if(y.value="",S.value="Parsing uploaded file",t=ye.target.files[0],t.size>2e7)throw ye.preventDefault(),"File size is too big";const Ce=await ND(t);e={},Ce.forEach((he,Ne)=>{let xe=he.parsedSequence.name,ae=xe.split(" ")[0];e[ae]={name:xe,id:ae,seq:he.parsedSequence.sequence}}),S.value="",y.value="",w.value=t.name,M(!1),N.value="~~~~~~",N.value=null}catch(Ce){console.log(Ce),S.value="",y.value=Ce}},Y=()=>{S.value="",e={},y.value="",w.value="",M(!1),E.value=0},re=ye=>{let Ce=e[ye].seq.length;C[ye]?(Ce>250&&(E.value=Math.max(E.value-1,0)),delete C[ye]):(Ce>250&&E.value++,C[ye]=1)},ne=(ye,Ce)=>{if(ye==null){m.setState({name:"Example Sequence",seq:"ATGCATGCATGCATGCATGC"});return}console.log("annotating:",ye);let he=ye.id,Ne=[],xe=Ce?Ce.seq:e[he].seq;if(console.log("seq=",xe),ye.classifierModelClassification){let ae=ye.classifierModelClassification.prediction+1,J=Ip[ae];Ne.push({name:J,start:0,end:Math.min(xe.length,250),direction:1,color:I.hex(J)})}m.setState({name:he,seq:xe,annotations:Ne})},le=()=>Object.keys(C).map(ye=>e[ye]),j=async(ye,Ce)=>{try{await s(ye),u(r.value.slice(0,50));let Ne=null;for(var he=0;he<r.value.length;he++){let xe=r.value[he];if(xe.classifierModelClassification){Ne=xe;break}}Ce?ne(Ne,ye[0]):ne(Ne)}catch(Ne){y.value=typeof Ne=="string"?Ne:"There was an error processing the selected sequence(s)"}finally{S.value=""}},ge=async()=>{let ye=le(),Ce=ye[0];S.value=`Annotating sequence: ${Ce.name}`,await j(ye)},Se=async()=>{let ye=le();S.value=`Annotating ${ye.length} sequences`,await j(ye)},me=async()=>{if(v.value=(v.value||"").trim().replace(`
`,"").replace(" ",""),!v.value){y.value="No sequence provided";return}let ye=[{name:"Input Sequence",id:"Input-Sequence",seq:v.value}];S.value="Annotating input sequence",await j(ye,!0)};return O6({title:"Riboswitch Sensor Tool - CompBio Lab",meta:[{name:"description",content:"An ML tool to detect, classify, and annotate riboswitches"}],script:[{src:"https://unpkg.com/seqviz"}]}),_6(()=>{initFlowbite(),m=window.seqviz.Viewer(b.value,{name:"Example Sequence",seq:"ATGCATGCATGCATGCATGC"}),m.render(),a(),console.log("RIBOSWITCH CLASS LABELS:",Ip)}),F6(()=>{initFlowbite()}),(ye,Ce)=>(hr(),fr("div",Ube,[We("div",zbe,[We("div",Vbe,[We("div",Wbe,[Gbe,Hbe,We("div",null,[qbe,We("ul",jbe,[Et(i)?(hr(),fr("li",Kbe," Annotation tool will not work, as there was an error loading the ML models. ")):Ni("",!0),Object.keys(Et(e)).length>0?(hr(),fr("span",Xbe,[We("li",null," Parsed "+_r(Object.keys(Et(e)).length)+" sequences from the selected sequence file. ",1),Object.keys(Et(C)).length<1?(hr(),fr("li",Ybe," Select sequence(s) to annotate ")):Object.keys(Et(C)).length==1?(hr(),fr("li",Zbe," Single sequence annotation is available ")):(hr(),fr("li",Jbe," Batch sequence annotation is available ")),Et(E)>0?(hr(),fr("li",Qbe," Clipped "+_r(Et(E))+" sequences base-pair length ",1)):Ni("",!0)])):(hr(),fr("li",eye," Select a file to parse sequences from it ")),Et(r).length>0?(hr(),fr("li",tye," Annotated "+_r(Et(r).length)+" sequence(s) ",1)):Ni("",!0),Et(S)?(hr(),fr("li",nye,[We("b",null,_r(Et(S)),1)])):Ni("",!0),Et(y)?(hr(),fr("li",rye," There was an error processing your request ")):Ni("",!0)])])]),We("div",sye,[We("span",{class:MS([{hidden:!Et(S)},"bg-blue-200 text-xs font-medium text-blue-800 text-center p-2 rounded-md dark:bg-blue-900 dark:text-blue-200 absolute -translate-y-1/2 translate-x-1/2 left-auto top-0 right-0"])},aye,2),oye,We("div",cye,[We("div",lye,[Et(y)||Et(i)?(hr(),fr("div",uye,[We("div",fye,[hye,dye,We("div",null,_r(Et(y)||Et(i)),1)])])):Ni("",!0),Et(w)?Ni("",!0):(hr(),fr("div",pye,[We("label",gye,[mye,We("input",{onChange:z,id:"dropzone-file",type:"file",class:"hidden",accept:".fasta,.fa,.gb,.gnk,.sbol"},null,32)])])),We("span",{class:MS({hidden:!Et(w)})},[We("div",vye,[We("p",Iye,[bye,Dr(),We("a",yye,_r(Et(w)||"FILE_NAME_PLACEHOLDER.fasta"),1),We("span",{onClick:Ce[0]||(Ce[0]=he=>!Et(S)&&Y()),class:"inline-flex items-center justify-between cursor-pointer text-gray-800 dark:text-white hover:hover:text-red-500 dark:hover:text-red-500","data-tooltip-target":"tooltip-close-btn"},wye)]),Sye]),Object.keys(Et(e)).length<1?(hr(),fr("div",Cye,kye)):Ni("",!0),We("div",Eye,[Tye,We("button",Aye,[Dr(_r(Object.keys(Et(C)).length>0?`Selected ${Object.keys(Et(C)).length} sequence(s)`:"Select sequence(s)")+" ",1),$ye]),We("div",Nye,[We("div",Oye,[_ye,We("div",Fye,[Dye,PS(We("input",{type:"text","onUpdate:modelValue":Ce[1]||(Ce[1]=he=>US(N)?N.value=he:null),id:"input-group-search",class:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Search Sequence ID"},null,512),[[LS,Et(N)]])])]),We("ul",Bye,[(hr(!0),fr(zS,null,VS(Et(A),he=>(hr(),fr("li",Mye,[We("div",{class:"flex items-center pl-2 rounded hover:bg-gray-100 dark:hover:bg-gray-600",onClick:Ne=>re(he)},[We("input",{onChange:()=>{},checked:!!Et(C)[he],type:"checkbox",value:"",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"},null,40,Lye),We("label",Uye,_r(he),1)],8,Pye)]))),256))]),We("div",zye,[We("a",{href:"#",onClick:Ce[2]||(Ce[2]=he=>M(!0)),class:"inline-flex items-center p-3 text-sm font-medium text-black hover:text-white dark:text-white dark:hover:text-white rounded-b-lg hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 hover:underline"},[Vye,Dr(" Select all ")]),We("a",{href:"#",onClick:Ce[3]||(Ce[3]=he=>M(!1)),class:"inline-flex items-center p-3 text-sm font-medium text-black hover:text-white dark:text-white dark:hover:text-white rounded-b-lg hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 hover:underline"},[Wye,Dr(" Clear all ")])])])]),Object.keys(Et(C)).length>1?(hr(),fr("div",Gye,Kye)):Ni("",!0),Et(E)>0?(hr(),fr("div",Xye,[Yye,Zye,We("div",null,[We("span",Jye,_r(Et(E))+" of the selected sequences",1),Dr(" have "),Qye,Dr(" greater than 250, "),exe])])):Ni("",!0),We("div",txe,[We("div",nxe,[We("button",{onClick:ge,disabled:!!Et(i)||!!Et(S)||Object.keys(Et(C)).length!=1,type:"button",class:"inline-flex items-center px-4 py-2 text-sm font-medium text-black bg-green-400 border border-gray-200 rounded-l-lg enabled:hover:bg-green-500 enabled:hover:text-black focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-green-700 dark:border-gray-600 dark:text-white enabled:dark:hover:text-white enabled:dark:hover:bg-green-600 dark:focus:ring-blue-500 dark:focus:text-white disabled:bg-green-600 disabled:dark:bg-green-800"},[sxe,Dr(" Annotate Sequence ")],8,rxe),We("button",{onClick:Se,disabled:!!Et(i)||!!Et(S)||Object.keys(Et(C)).length<2,type:"button",class:"inline-flex items-center px-4 py-2 text-sm font-medium text-black bg-green-400 border border-gray-200 rounded-r-md enabled:hover:bg-green-500 enabled:hover:text-black focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-green-700 dark:border-gray-600 dark:text-white enabled:dark:hover:text-white enabled:dark:hover:bg-green-600 dark:focus:ring-blue-500 dark:focus:text-white disabled:bg-green-600 disabled:dark:bg-green-800"},[axe,Dr(" Batch Annotate ")],8,ixe)])])],2)])])]),We("div",oxe,[cxe,We("div",lxe,[We("div",uxe,[We("div",fxe,[We("div",hxe,[dxe,PS(We("textarea",{"onUpdate:modelValue":Ce[4]||(Ce[4]=he=>US(v)?v.value=he:null),id:"comment",rows:"4",class:"w-full px-0 text-sm text-gray-900 bg-white border-0 dark:bg-gray-800 focus:ring-0 dark:text-white dark:placeholder-gray-400",placeholder:"ATGCATGCATGC...",required:""},null,512),[[LS,Et(v)]])]),We("div",{class:"flex items-center justify-center px-3 py-2 border-t dark:border-gray-600"},[We("button",{onClick:me,type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-md px-5 py-2.5 text-center inline-flex items-center mr-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},[pxe,Dr(" Annotate ")])])])])])])]),We("div",{ref_key:"sequenceVisualizerElement",ref:b,class:"min-h-[34rem] max-h-[40rem] md:col-span-2 dark:text-white bg-gray-200 border border-gray-200 rounded-lg shadow sm:p-4 dark:bg-gray-400 dark:border-gray-700"},null,512)]),Et(r).length>0?(hr(),fr("div",gxe,[mxe,We("div",vxe,[We("table",Ixe,[bxe,yxe,We("tbody",null,[(hr(!0),fr(zS,null,VS(Et(l),he=>(hr(),fr("tr",xxe,[We("td",wxe,_r(he.index),1),We("th",Sxe,_r(he.item.id),1),We("td",Cxe,_r(he.item.detectorModelClassification.prediction==1),1),We("td",Rxe,_r(he.item.detectorModelClassification.probability.toFixed(4)),1),We("td",kxe,_r(he.item.classifierModelClassification?Et(Ip)[he.item.classifierModelClassification.prediction+1]:""),1),We("td",Exe,_r(he.item.classifierModelClassification?he.item.classifierModelClassification.probability.toFixed(4):""),1),We("td",Txe,[We("a",{onClick:Ne=>ne(he.item),href:"#",class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"Visualize",8,Axe)])]))),256))])]),We("nav",$xe,[We("span",Nxe,[Dr(" Showing "),We("span",Oxe,_r(Et(l).length&&Et(l)[0].index||0)+" - "+_r(Et(l).length&&Et(l)[Et(l).length-1].index||0),1),Dr(" of "),We("span",_xe,_r(Et(d)),1)]),We("ul",Fxe,[We("button",{onClick:Ce[5]||(Ce[5]=he=>Et(p)(Et(r))),"data-tooltip-target":"download-help-tooltip",type:"button",class:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},[Dxe,Dr(" Download CSV ")]),Bxe,We("li",null,[We("button",{onClick:Ce[6]||(Ce[6]=he=>Et(f)(Et(c)-1)),disabled:Et(c)==1,class:"flex items-center justify-center px-3 h-8 ml-0 leading-tight text-gray-500 bg-white border border-gray-300 rounded-l-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:pointer-events-none"},"Previous",8,Mxe)]),We("li",null,[We("button",{onClick:Ce[7]||(Ce[7]=he=>Et(f)(Et(c)+1)),disabled:Et(c)==Et(o),class:"flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-r-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white disabled:pointer-events-none"},"Next",8,Pxe)])])])])])):Ni("",!0)]))}},Yxe=P6(Lxe,[["__scopeId","data-v-f1974db4"]]);export{Yxe as default};
